{"version":3,"sources":["kendo.spreadsheet.js"],"names":["f","define","kendo","UndoRedoStack","Observable","extend","init","options","fn","call","this","clear","events","push","command","stack","slice","currentCommandIndex","undo","canUndo","trigger","redo","canRedo","length","deepExtend","util","amd","a1","a2","a3","$","normalizeText","text","String","replace","REPLACE_REGEX","SPACE","objectKey","object","key","parts","sort","join","hashKey","str","i","hash","charCodeAt","zeroSize","width","height","baseline","measureText","style","measureBox","TextMetrics","current","measure","LRUCache","DEFAULT_OPTIONS","defaultMeasureBox","window","Class","size","_size","_length","_map","put","value","map","entry","_head","_tail","newer","older","get","baselineMarkerSize","document","createElement","cssText","_cache","styleKey","cacheKey","cachedResult","baselineMarker","textStr","box","_baselineMarker","cloneNode","textContent","appendChild","body","offsetWidth","offsetHeight","offsetTop","parentNode","removeChild","marker","jQuery","sqr","renderSize","renderPos","pos","result","toHyphens","split","arabicToRoman","n","literals","1","10","100","2","20","200","3","30","300","4","40","400","5","50","500","6","60","600","7","70","700","8","80","800","9","90","900","1000","values","roman","shift","romanToArabic","r","digits","prev","v","toLowerCase","x","l","c","d","m","charAt","memoize","cache","Object","create","id","arguments","apply","isUnicodeLetter","ch","RX_UNICODE_LETTER","test","withExit","obj","Return","ex","now","Date","getTime","RegExp","CODE","out","UCS2","code","parse","data","callbacks","readChar","index","croak","msg","Error","readWhile","pred","a","readAsciiWhile","STRING","skipWhitespace","isWhitespace","eat","save","skip","isDigit","isHexDigit","isNameStart","isName","xmlComment","END_COMMENT","xmlTag","name","attrs","QUESTION_MARK","xmlDecl","START_COMMENT","xmlName","xmlAttrs","END_SHORT_TAG","GREATER_THAN","xmlContent","pop","END_TAG","START_CDATA","END_CDATA","LESS_THAN","AMPERSAND","xmlEntity","xmlString","quote","QUOTE","APOSTROPHE","SHARP","LOWERCASE_X","UPPERCASE_X","parseInt","isNaN","ENTITIES","undefined","SEMICOLON","END_DECLARATION","$tag","EQUAL","what","thing","arg1","arg2","is","selector","j","exit","EXIT","tmp","fromCharCode","amp","lt","gt","quot","apos","nbsp","parseXML","copyToClipboard","html","textarea","addClass","val","appendTo","focus","select","execCommand","remove","COMMAND_TYPES","Command","DrawingCommand","ReorderDrawingsCommand","TargetValueCommand","PropertyChangeCommand","ApplyFilterCommand","DeleteCommand","AddCommand","NameCommand","support","browser","msie","version","AUTO_FILL","CLEAR","CUT","EDIT","PASTE","VALIDATION","spreadsheet","_workbook","workbook","_property","property","_state","range","_setRange","_range","exec","setState","getState","state","rejectState","validationState","title","message","reason","type","_forEachCell","callback","ref","_ref","forEach","sheet","toRangeRef","bind","usesImage","DrawingUpdateCommand","_sheet","_drawing","drawing","_orig","clone","_previous","previous","reset","_activeDrawing","triggerChange","layout","img","image","InsertImageCommand","_blob","blob","_width","_height","aspect","Math","min","addDrawing","topLeftCell","topLeft","offsetX","offsetY","opacity","addImage","removeDrawing","DeleteDrawingCommand","_origIndex","_drawings","indexOf","splice","_newIndex","_reorder","drawings","BringToFrontCommand","SendToBackCommand","_target","target","_value","ColumnWidthCommand","columnWidth","RowHeightCommand","rowHeight","HyperlinkCommand","_link","link","_prevLink","_prevUnderline","underline","_hasSetValue","GridLinesChangeCommand","showGridLines","prototype","skipHiddenCells","enable","ClearContentCommand","rowValues","nullValues","currentRange","canEditArrayFormula","refs","concat","row","changeType","clearContent","_getValidationState","cell","EditCommand","_editRange","arrayFormula","activeCellSelection","withCultureDecimals","_exec","editRange","input","wrap","_adjustRowHeight","calc","ParseError","InsertCommentCommand","TextWrapCommand","forEachRow","_rowHeight","AdjustDecimalsCommand","_delta","delta","formatting","batch","forEachCell","col","format","adjustDecimals","BorderChangeCommand","_type","border","_style","_batch","self","noBorders","insideBorders","outsideBorders","allBorders","leftBorder","leftColumn","borderLeft","rightBorder","rightColumn","borderRight","topBorder","topRow","borderTop","bottomBorder","bottomRow","borderBottom","insideHorizontalBorders","insideVerticalBorders","MergeCellCommand","activate","activeCell","unmerge","cells","merge","horizontally","vertically","forEachColumn","FreezePanesCommand","_topLeft","panes","frozenColumns","frozenRows","rows","columns","unfreeze","PasteCommand","_clipboard","clipboard","_event","event","_clipboardContent","_content","_clipboardPasteRef","pasteRef","activeSheet","status","canPaste","clipboardContent","preventDefault","menuInvoked","pasteOnMerged","overflow","pasteOnDisabled","AdjustRowHeightCommand","rowIndex","ToolbarPasteCommand","paste","_view","CutCommand","_eventType","rangeValues","currentRow","canCopy","selection","cut","copy","multiSelection","CopyCommand","noop","ToolbarCopyCommand","AutoFillCommand","origin","_origin","autoFillData","intersectingArrayFormula","_previewFillFrom","props","dest","_properties","Range","FillError","ToolbarCutCommand","FilterCommand","filter","hasFilter","SortCommand","column","ascending","expandRange","cantSort","_sheetRef","clearFilter","filterRule","exists","valueFilter","ValueFilter","customFilter","CustomFilter","eq","element","ClearFilterCommand","HideLineCommand","axis","setAxisState","getAxisState","axisManager","hideSelectedRows","hideSelectedColumns","UnHideLineCommand","unhideSelectedRows","unhideSelectedColumns","_expandedRange","_expand","_indexes","_undoOne","_restoreModifiedFormulas","formulas","recalc","DeleteRowCommand","resize","left","Infinity","right","deleteSelectedRows","insertRow","DeleteColumnCommand","top","bottom","deleteSelectedColumns","insertColumn","_pos","count","base","AddColumnCommand","preventAddColumn","addColumnLeft","addColumnRight","deleteColumn","AddRowCommand","preventAddRow","addRowAbove","addRowBelow","deleteRow","EditValidationCommand","validation","OpenCommand","cannotUndo","file","match","fromFile","then","errors","excelImportErrors","openDialog","SaveAsCommand","fileName","extension","saveAsExcel","saveAsPDF","pdf","_name","nameDefinition","DefineNameCommand","defineName","DeleteNameCommand","undefineName","classNames","FormulaBar","wrapper","ui","Widget","formulaInput","FormulaInput","destroy","isOpenParen","isCloseParen","isMatchingParen","close","open","touches","begin","end","knownFunction","runtime","FUNCS","isEqualToken","tok1","tok2","ns","keys","styles","KEY_NAMES","PRIVATE_FORMULA_CHECK","listWrapper","27","37","39","35","36","32","attr","css","autoScale","on","scale","_highlightedRefs","_staticTokens","_formulaSource","_formulaList","_popup","_tooltip","_keydown","_keyup","_blur","_input","_focus","_paste","filterOperator","scalePadding","minLength","removeAttr","toggleClass","getPos","lookup","lookupNode","loop","node","nodeType","firstChild","nextSibling","nodeValue","div","sel","getSelection","focusNode","focusOffset","b","anchorNode","anchorOffset","collapsed","setPos","differ","startOffset","endOffset","startContainer","endContainer","len","el","eiv","createRange","setStart","setEnd","getRangeAt","removeAllRanges","addRange","home","toUpperCase","formulaSource","DataSource","list","StaticList","insertAfter","autoBind","selectable","change","_formulaListChange","dataSource","dataValueField","template","e","activeToken","completion","ctx","tokenCtx","_tokenContext","_mute","token","nextToken","_replaceAt","popup","Popup","anchor","clearTimeout","_focusId","_isFormula","keyCode","_navigated","_move","_keyDownTimeout","setTimeout","_syntaxHighlight","view","visible","focusFirst","_sync","_focusTimeout","ev","clipboardData","getData","originalEvent","substr","DOWN","focusNext","UP","focusPrev","focusLast","ENTER","TAB","PAGEUP","PAGEDOWN","tokens","tok","point","tokenize","_editorToSync","isActive","_textContainer","computedStyles","getComputedStyles","position","visibility","whiteSpace","_span","_cellTooltip","tooltip","toggleTooltip","show","toggle","_activeElement","field","operator","hide","rectangle","canInsertRef","isKeyboardAction","idx","_canInsertRef","afterPoint","canReplace","canInsertBetween","strictMode","refAtPoint","simplify","relative","setSheet","print","newValue","rest","syncWith","iehandler","eventName","handler","off","txt","innerText","highlightedRefs","refClasses","Pane","series","refIndex","parens","active","cls","colorClass","unshift","reverse","htmlEncode","substring","_setStaticTokens","insertNewline","eof","Mac","isAlphaNum","keyName","EventListener","13","38","33","34","46","113","navigator","platform","observer","handlers","_handlers","_observer","keyDownProxy","keyDown","mouseProxy","mouse","touchProxy","touch","threshold","_pressLocation","documentElement","handleEvent","rightClick","dx","dy","distance","which","button","pageX","y","pageY","sqrt","catchAllHandler","eventKey","mod","metaKey","ctrlKey","altKey","shiftKey","skew","level","temp","insert","NilNode","RangeTreeNode","start","diff","heir","intersecting","ranges","intersects","tree","root","RangeTree","RangeList","Iterator","SparseRangeList","findrange","first","last","firstRange","lastRange","rangeValue","rangeStart","rangeEnd","expandedValues","rangeIndex","sortedIndices","valueComparer","indices","comparer","sourceStart","sourceEnd","targetStart","iterator","toJSON","fromJSON","unique","at","lastRangeStart","ValueRange","toExcelFormat","cloneFormulaValue","deepClone","cloneFormulaTree","Property","JsonProperty","ValueProperty","set","dst","JSON","stringify","formats","dateToNumber","culture","calendar","patterns","limitPrecision","PropertyBag","specs","sortable","serializable","depends","rowCount","columnCount","defaultValues","cellCount","properties","lists","spec","prop","formula","si","iter","iterators","reduce","ret","addBorder","hBorders","leftBorders","rightBorders","forEachProperty","ALL_PROPERTIES","columnName","colIndex","letter","floor","displaySheet","displayRef","rel","aa","isFinite","Ref","NULL","NameRef","CellRef","RangeRef","UnionRef","hasSheet","_hasSheet","absolute","adjust","toString","intersect","isCell","toRow","toColumn","rangeAt","nextRangeIndex","previousRangeIndex","reference","refs1","refs2","r1","r2","bottomRight","single","replaceAt","forEachColumnIndex","forEachAxisIndex","forEachRowIndex","sorted","method","valid","renameSheet","oldSheetName","newSheetName","display","trow","tcol","abs","arow","acol","forRow","tl","br","endSheet","normalize","_containsRange","_containsCell","contains","Array","that","some","_intersectRange","a_left","a_top","a_right","a_bottom","b_left","b_top","b_right","b_bottom","max","c1","c2","rr1","rc1","rr2","rc2","changes","relTL","relBR","collapse","toCell","startRow","endRow","startCol","endCol","union","topLeftRow","topLeftCol","bottomRightRow","bottomRightCol","modified","num","limit","move","cols","tr","u","empty","theRef","newRefs","NULLREF","SHEETREF","FIRSTREF","AutoFillCalculator","grid","_grid","rectIsVertical","startRect","endRect","autoFillDest","cursor","quadrant","pivot","opposite","cornerResult","expanding","bottomLeft","topRight","lower","further","EdgeNavigator","SheetNavigator","rangeGetter","prevLeft","prevVisible","nextRight","nextVisible","nextLeft","prevRight","boundary","_columns","autoFillCalculator","colEdge","columnRange","rowEdge","_rows","rowRange","_viewPortHeight","unionWithMerged","leftCol","rightCol","selectionIncludesMergedCells","_mergedCells","setSelectionValue","selectAll","mode","addToExisting","refForMode","rowRef","colRef","startSelection","startAutoFill","completeSelection","selectForContextMenu","selectDrawingForContextMenu","modifySelection","action","scrollInto","newSelection","direction","determineDirection","viewPortHeight","originalSelection","currentOriginalSelectionRange","prevPage","nextPage","firstVisible","lastVisible","updateCurrentSelectionRange","moveActiveCell","originalActiveCell","navigateInSelection","setSelection","selTopLeft","selBottomRight","done","currentNavigationRange","nextNavigationRange","previousNavigationRange","shouldSkip","singleCellSelection","extendSelection","resizeAutoFill","isMerged","isHiddenRow","isHiddenColumn","forEachMergedCell","merged","hint","preview","_autoFillOrigin","punch","updateAutoFill","currentSelectionRange","leftMode","rightMode","topMode","bottomMode","originalSelect","selectionRangeIndex","subset","bottomCol","AxisManager","forEachSelectedColumn","forEachSelectedRow","includesHiddenColumns","includesHidden","includesHiddenRows","selectionIncludesHiddenColumns","selectionIncludesHiddenRows","indexes","_saveModifiedFormulas","hasRight","hasLeft","hideColumn","_count","hasBottom","hasTop","hideRow","unhideColumn","unhideRow","preventInsertRow","preventInsertColumn","newState","mergedCells","foreign","origRef","setStateData","stripStyle","borderObject","color","cellState","vBorders","getComputedStyle","borders","fontSize","background","italic","bold","textAlign","verticalAlign","parseHTML","table","ri","ci","td","rowSpan","colSpan","ignoreColspan","dr","dc","Matrix","getAttribute","parseTSV","Clipboard","_externalContent","_internalContent","iframe","className","_uid","guid","intersectsMerged","plain","destination","originActiveCell","rowDelta","colDelta","external","isExternal","_isInternal","doc","contentWindow","write","querySelector","internalHTML","internalPlain","find","partition","predicate","looksLikeANumber","getTextHeight","fontFamily","font-size","font-family","white-space","overflow-wrap","word-wrap","PROPERTIES","skipHiddenRows","skipHiddenCols","_normalize","_set","noTrigger","_get","_resizedRef","existingFormat","t1","t2","existingFormatType","compile","currency","editorChange","isInEditMode","numberToDate","_useCultureDecimals","numberFormat","_","__","setArrayFormulaRange","_forFormulas","arrayFormulaRange","intersection","_validation","_merge","mergedRef","vi","isAutofill","setProp","line","propName","propValue","isFilteredRow","clearAll","contentsOnly","formatOnly","keepBorders","clearFormat","isSortable","mc","primary","secondary","cant","_getMergedCells","hasMerged","_sortBy","isFilterable","clearFilters","_filterBy","_filter","intersectingMerged","propertyName","Formula","Validation","internalClipboard","externalClipboard","textHeight","sum","hasValue","defStyle","_defaultCellStyle","flag","draw","each","CalcError","argmax","sameRef","constructor","compileArgumentChecks","functionName","args","comp","wantNulls","allowError","isArray","arrayArgs","resolve","cond","force","canBeArrayArg","hasArrayArgs","typeCheck","forced","haveForced","forceNum","round","err","main","Function","toPrecision","maybeRoundFloatErrors","withErrorHandling","makeSyncFunction","check","doit","xargs","arrays","getNA","makeAsyncFunction","makeCallback","defineFunction","func","log","console","kendoSpreadsheetArgs","argsAsync","dateToJulianDays","julianDaysToDate","jd","year","month","date","day","ord","ORDINAL_ADD_DAYS","isLeapYear","yr","daysInYear","daysInMonth","mo","DAYS_IN_MONTH","validDate","da","unpackDate","serial","BASE_DATE","packDate","unpackTime","ms","hours","minutes","seconds","frac","MS_IN_DAY","MS_IN_HOUR","MS_IN_MIN","milliseconds","serialToDate","t","packTime","hh","mm","ss","dateToSerial","time","getHours","getMinutes","getSeconds","getMilliseconds","getFullYear","getMonth","getDate","parseDate","makeDateFormat","parseExactDate","binaryCompare","exports","Context","NUMBER_OR_ZERO","ARGS_NUMERIC","ARGS_ANYVALUE","parent","resolveCells","_resolve","error","asMatrix","_arrayArg","onFormula","fetch","context","pending","add","getRefCells","cellValues","getRefData","fetchName","nameValue","ValidationFormulaContext","fname","bool","h","isRange","hiddenInfo","includeEmpty","eachRow","eachCol","mapRow","mapCol","transpose","unit","multiply","s","va","vb","adds","sign","determinant","C","L","k","inverse","imax","augment","printer","absrefs","onReady","forceRefs","lcsheet","parentContext","next","affectedSheet","operation","formulaMoves","formulaRow","formulaCol","newFormulaRow","newFormulaCol","formulaSheet","prevRefs","prevRange","newRef","co","th","comatrix","thmatrix","elmatrix","defineAlias","alias","orig","kendoSpreadsheetAliases","pow","compileValidation","validationHandler","parsedFromDate","parsedToDate","from","dataType","fromIsListValue","TRANSPOSE_FORMAT","DATE_FORMAT","fromIsDateValue","parseFormula","to","toIsDateValue","validationComparers","custom","comparerType","valueToCompare","toValue","to_value","allowNulls","from_value","_getListData","showButton","tooltipMessageTemplate","tooltipTitleTemplate","messageTemplate","titleTemplate","_formatMessages","fromFormula","toFormula","_setMessages","tooltipTitle","tooltipMessage","cube","array","_getOptions","compareValue","compareFormat","getValue","calculateFromCallBack","prevFrom","prevTo","greaterThan","lessThan","between","equalTo","notEqualTo","greaterThanOrEqualTo","lessThanOrEqualTo","notBetween","MODIFIED_FORMULAS","Selection","Sheet","Drawing","_activeCell","currentOriginalNavigationRange","expanded","changeActiveCell","triggerSelect","_reinit","headerHeight","headerWidth","defaultCellStyle","Axis","_filteredRows","_frozenRows","_frozenColumns","_suspendChanges","_showGridLines","_gridLinesColor","Grid","_sorter","Sorter","_viewSelection","_editSelection","_formulaSelections","_selectionState","_inEdit","_navigator","_axisManager","_sheetName","accessor","_field","suspendChanges","setDataSource","dataSourceBinder","SheetDataSourceBinder","columnIndex","unhide","hidden","_copyRange","sourceRangeRef","targetRef","nextRefTopLeft","nextRefBottomRight","nextIndex","nextBottomIndex","targetIndex","wb","sheetByName","cellRefIndex","_adjustReferences","_sheets","_forValidations","adjustNames","selectedHeaders","allRows","allCols","nextRef","isEnabledRow","isEnabledColumn","_filterRow","gridLinesColor","numRows","numColumns","parseReference","cellRef","forEachFilterHeader","columnRef","forEachRange","doIt","startCellIndex","endCellIndex","startResizing","initialPosition","_initialPosition","_resizeInProgress","_autoFillInProgress","_autoFillDest","_autoFillPunch","_autoFillHint","_autoFillDirection","autoFillRef","autoFillPunch","autoFillInProgress","resizingInProgress","draggingInProgress","_draggingInProgress","completeResizing","hintPosition","handlePosition","resizeHintPosition","resizeHandlePosition","_renderComment","comment","_commentRef","_resizeHandlePosition","location","_resizeHintPosition","removeResizeHandle","positionResizeHandle","startDragging","completeDragging","refBox","drag","drawingBoundingBox","indexVisible","refBoundingBox","dragging","_selectionInProgress","operatingRange","selectionInProgress","expandedRef","selectionState","isAxis","trim","trims","maxRow","maxCol","rowSelection","colSelection","rowState","colState","all","isInEdit","_setFormulaSelections","_viewActiveCell","clearDefaultStyle","json","positions","viewSelection","hyperlinks","src","parseColor","toCss","_sort","activeCellRef","_compileFormula","_compileValidation","Filter","_refreshFilter","logToConsole","_refresh","resetFormulas","resetValidations","revalidate","_copyValuesInRange","suspended","sortBy","prepare","matches","filterColumn","filterRef","_clearFilter","ALL_REASONS","currentRef","useCultureDecimals","dot","withDecimalSeparator","Rectangle","drw","outerWidth","DOT","EMPTYCHAR","sheetsBarClassNames","SheetsBar","_outerWidth","sheetsBarWrapper","sheetsBarSheetsWrapper","sheetsBarActive","sheetsBarInactive","sheetsBarAdd","sheetsBarRemove","sheetsBarItems","sheetsBarEditor","sheetsBarScrollable","sheetsBarNext","sheetsBarPrev","sheetsBarKItem","sheetsBarKActive","sheetsBarKTextbox","sheetsBarKLink","sheetsBarKIcon","sheetsBarKFontIcon","sheetsBarKButton","sheetsBarKButtonBare","sheetsBarKArrowW","sheetsBarKArrowE","sheetsBarKReset","sheetsBarKIconX","sheetsBarKSprite","sheetsBarKIconPlus","sheetsBarHintWrapper","sheetsBarKResetItems","_openDialog","_tree","dom","Tree","render","_addButton","_createSheetsWrapper","_toggleScrollEvents","_createSortable","_sortable","_onSheetReorderStart","_onSheetReorderEnd","_onSheetRemove","_onSheetSelect","_createEditor","_onAddSelect","scrollable","_editor","_renderSheets","_selectedIndex","_onEditorKeydown","_onEditorBlur","_destroyEditor","canceled","_onSheetRename","renderSheets","sheets","selectedIndex","wrapperOffsetWidth","sheetsGroupScrollWidth","sheetsWrapper","scrollPrevButton","scrollNextButton","gapWidth","addButton","addButtonWidth","scrollPrevButtonWidth","sheetsGroup","scrollNextButtonRight","_isRtl","isRtl","_renderHtml","_scrollableAllowed","_sheetsWrapper","children","_sheetsGroup","marginLeft","scrollWidth","ceil","parseFloat","_scrollableModeActive","_nowScrollingSheets","marginRight","_toggleScrollButtons","ul","scrollLeft","_scrollSheetsByDelta","renderScrollButtons","isSelectedSheet","elementContent","deleteIcon","sheetElements","maxlength","baseButtonClass","childrenElements","Sortable","container","animation","ignore","draggable","closest","oldIndex","newIndex","closeCallback","removedSheetName","dlg","sender","isConfirmed","confirmation","selectedSheetText","_scrollSheetsToItem","isAddButton","sheetIndex","item","currentScrollOffset","itemWidth","itemOffset","sheetsGroupWidth","sheetsGroupPadding","itemPosition","finish","animate","scrLeft","setDecimalSeparator","sep","SEPARATORS","DEC","ARG","COL","OPERATORS","OPERATORS_COMMA","OPERATORS_STANDARD","getcol","getrow","noThrow","stream","OUT","TokenStream","addReference","allowEOF","peek","parseExpression","commas","maybeBinary","maybeIntersect","parseAtom","parseSymbol","upper","TRUE","FALSE","parseFuncall","fixReference","exp","parseArray","op","maybePercent","my_prec","his_prec","ast","parseNameDefinition","def","defAST","nameRef","makeFormula","makePrinter","prec","withParens","needParens","parenthesize","arg","makeClosure","toCPS","cps","cpsRef","cpsAtom","cpsUnary","cpsBinary","cpsFunc","cpsLambda","cpsMatrix","cpsNameRef","makeContinuation","cpsIf","thenK","gensym","elseK","vars","cpsAnd","cpsOr","cont","elements","isMatrix","GENSYM","js","jsArray","FORMULA_CACHE","identity","readNext","ahead","refRange3D","refCell3D","refSheetRange","refSheetCell","refRange","refCell","funcall","isFirst","forEditor","fixCell","g","space","addPos","RawTokenStream","InputStream","startToken","endToken","isIdStart","isId","isOpChar","isPunc","readNumber","has_dot","number","symbol","getRC","readSymbol","lookingAt","readString","readEscaped","readSheetName","readOperator","readPunc","EOF","forward","escaped","rx","parseSqref","getNumberRegexp","comma","NUMBER_FORMAT_RX","repeat","FORMAT_PARSERS","registerFormatParser","ops","_separators","p","monthFirst","rxnum","rxcur","suffix","has_currency","has_percent","readExcel","deferred","reader","FileReader","onload","zip","JSZip","readWorkbook","readAsArrayBuffer","xl","progress","strings","relationships","theme","items","loading","ERROR_LOG","readStrings","readRelationships","readTheme","byType","readStyles","enter","tag","relId","dim","SEL_SHEET","byId","sheetDimensions","SEL_VIEW","activeTab","integer","localSheetId","SEL_DEFINED_NAME","vbProcedure","withErrorLog","Deferred","notify","recalcSheets","loadSheets","ready","promise","insertSheet","queueSheet","readSheet","defaultColWidth","toColWidth","defaultRowHeight","toRowHeight","SEL_ROW","maximumDigitWidth","fraction","pts","addAutoFilter","filters","formulaRange","isArrayFormula","formula1","formula2","customFilterLogic","customFilterCriteria","valueFilterBlanks","valueFilterValues","commentFile","drawingFile","sharedFormulas","nCols","prevCellRef","relsFile","closed","styleIndex","stop","acRef","SEL_FORMULA","SEL_CELL","applyStyle","SEL_MERGE","SEL_COL","ht","SEL_SELECTION","SEL_PANE","xSplit","ySplit","SEL_SHEET_VIEW","SEL_HYPERLINK","colId","and","getCustomFilter","DynamicFilter","dynamicFilterType","TopFilter","getFilterVal","percent","blank","leave","failed","SEL_VALIDATION","SEL_VALIDATION_INSANE","sqref","showErrorMessage","MAP_EXCEL_OPERATOR","allowBlank","showDropDown","errorTitle","logic","criteria","blanks","SEL_VALUE","SEL_STRING","SEL_VALIDATION_FORMULA1","SEL_VALIDATION_FORMULA1_INSANE","SEL_VALIDATION_FORMULA2","SEL_VALIDATION_FORMULA2_INSANE","SEL_VALIDATION_SQREF_INSANE","comments","relative_file","readComments","readDrawings","getContentType","filename","jpg","jpeg","png","gif","getFileName","cdr","sel_two_cell_anchor","sel_ext","sel_one_cell_anchor","sel_from","sel_to","sel_row","sel_col","sel_row_offset","sel_col_offset","sel_blip","files","asArrayBuffer","edge","Blob","File","excelToPixels","cx","cy","colOffset","rowOffset","brCell","brX","brY","author","authors","SEL_COMMENT","authorId","SEL_AUTHOR","SEL_COMMENT_TEXT","ourOp","equal","notEqual","greaterThanOrEqual","lessThanOrEqual","Q1","Q2","Q3","Q4","M1","M2","M3","M4","M5","M6","M7","M8","M9","M10","M11","M12","setFormat","formatCode","setFill","setFont","setBorder","side","BORDER_WIDTHS","shouldSet","applyName","xf","inlineStyles","xfId","namedStyles","fonts","indent","fills","numFmts","DEFAULT_FORMATS","part","asUint8Array","SEL_SHARED_STRING","SEL_TEXT","entries","Id","Target","Type","getXf","addBool","borderId","fillId","fontId","numFmtId","pivotButton","quotePrefix","getColor","themeColor","tint","rgb","toCSSColor","indexed","INDEXED_COLORS","colorScheme","toHSL","toCssRgba","font","fill","SEL_NUM_FMT","SEL_FONT","SEL_FILL","patternType","SEL_BORDER","SEL_NAMED_STYLE","SEL_INLINE_STYLE","horizontal","vertical","wrapText","swap","arr","scheme","SEL_SCHEME_SYSCLR","SEL_SCHEME_RGBCLR","none","thin","medium","dashed","dotted","thick","double","hair","mediumDashed","dashDot","mediumDashDot","dashDotDot","mediumDashDotDot","slantDashDot","0","11","12","14","15","16","17","18","19","21","22","45","47","48","49","_readSheet","_readStrings","_readStyles","_readTheme","_readWorkbook","loadBinary","url","xhr","XMLHttpRequest","response","getResponseHeader","onerror","responseType","send","sheetParamsFromJSON","or","Workbook","messages","defaultSheetName","_images","_imgID","_sheetsSearchCache","undoRedoStack","_onUndoRedo","_context","FormulaContext","_validationContext","_names","unbind","_sheetChanging","_sheetChange","_sheetInsertRow","_sheetInsertColumn","_sheetDeleteRow","_sheetDeleteColumn","_sheetHideRow","_sheetHideColumn","_sheetUnhideRow","_sheetUnhideColumn","_sheetSelect","_sheetDataBinding","_sheetDataBound","_sheetCommandRequest","_inputForRef","execute","commandOptions","cleanupImages","refresh","moveSheetToIndex","toIndex","fromIndex","sheetSelection","insertIndex","sheetName","getUniqueSheetName","sheetNameSuffix","_bindSheetEvents","sheetByIndex","forEachName","nameref","removeSheet","newSheet","_clearSheets","images","names","localName","saveJSON","ids","readAsDataURL","reject","ooxml","saveAs","dataURI","forceProxy","toDataURL","toBlob","proxyURL","excel","group","nameForRef","imageUrl","URL","createObjectURL","revokeObjectURL","PDFMixin","_drawPDF","exportPDF","exportPDFToBlob","proxyTarget","fail","area","fsheet","frow","fcol","states","arrayRange","tlRow","tlCol","currentFormula","vrow","vcol","_formulaContextRefresh","toActionSelector","selectors","alphaNumRegExp","ACTIONS","ENTRY_ACTIONS","CONTAINER_EVENTS","CLIPBOARD_EVENTS","EDITOR_EVENTS","FORMULABAR_EVENTS","FORMULAINPUT_EVENTS","SELECTION_MODES","COMPOSITE_UNAVAILABLE_ACTION_SELECTORS","UNHIDE_ACTION_SELECTORS","ACTION_KEYS","SHIFT_ACTION_KEYS","ENTRY_ACTION_KEYS","Controller","up","down","ctrl+left","ctrl+right","ctrl+up","ctrl+down","ctrl+home","ctrl+end","pageup","pagedown","tab","shift+tab","shift+enter","delete","backspace","shift+:alphanum","alt+:alphanum",":alphanum","ctrl+:alphanum","alt+ctrl+:alphanum",":edit","wheel","*+mousedown","contextmenu","*+mousedrag","*+mouseup","*+dblclick","mousemove","touchmove","touchend","mouseup","*+cut","*+paste","*+copy","esc","alt+enter","shift+ctrl+enter","rowheader","columnheader","topcorner","autofill","clipboardElement","cellContextMenu","rowHeaderContextMenu","colHeaderContextMenu","drawingContextMenu","scroller","tabstrip","sheetsbar","nameEditor","onNameEditorEnter","onNameEditorCancel","onNameEditorSelect","onNameEditorDelete","editor","onEditorChange","onEditorActivate","onEditorDeactivate","onEditorUpdate","onScroll","listener","_enableEditorEvents","onSheetBarSelect","onSheetBarReorder","onSheetBarRename","onSheetBarRemove","onContextMenuSelect","onCommandRequest","onDialogRequest","keyListener","barKeyListener","barElement","inputKeyListener","cellElement","_execute","editorClose","_preventNavigation","deactivate","showError","activateEditor","_lastEditorValue","_activeTooltip","clientHeight","isEditorDisabled","resetEditorValue","scroll","onWheel","deltaX","deltaY","deltaMode","scrollWith","onTouchMove","forceScrollerStackingOrder","onTouchEnd","onAction","onPageUp","scrollDown","onPageDown","onEntryAction","shouldPrevent","disabled","casual","onShiftAction","appendSelection","onMouseMove","objectAt","onMouseDown","win","pane","originFrame","_startResizingDrawing","stopPropagation","widgetInstance","modal","startBox","onEditorEsc","openCustomEditor","_selectionMode","openFilterMenu","handle","translateCoords","startX","startY","onContextMenu","menu","isComposite","showUnhide","showUnmerge","prevent","constrainResize","resizeHandle","_dragDrawing","onMouseDrag","frame","clientX","clientY","startAutoScroll","selectToLocation","scrollTop","onMouseUp","stopAutoScroll","activeEditor","onDblClick","onCut","detach","append","clipBoardValue","_pasteImage","dataTransferItem","getAsFile","Image","onPaste","hasHTML","hasPlainText","DOMStringList","types","kind","onCopy","scrollRight","getBoundingClientRect","noDrawing","cellLocation","lastKnownCellLocation","autoScroll","_autoScrollTarget","boundaries","scrollStep","finalLocation","viewObject","_scrollInterval","setInterval","clearInterval","filterMenu","createFilterMenu","openFor","_saveEditorValue","onEditorArrayFormula","onEditorBarFocus","rect","activeCellRectangle","onEditorCellFocus","onEditorBlur","isFiltered","onEditorAction","_casualEditing","deactivateEditor","onEditorShiftAction","additionalOptions","pdfExport","excelExport","selectElementContents","selectNodeContents","cellBefore","trs","cellAbove","prevRow","cellBorder","asURL","drawCell","collection","showGrid","maybeLink","textDecoration","href","defaultBorder","shouldDraw","toHSV","outline","backgroundColor","fontStyle","fontWeight","overflowWrap","wordWrap","__dataType","applyIndent","paneClassNames","addCell","sibling","borderRightColor","borderBottomColor","borderLeftColor","borderTopColor","within","drawingResizeHandles","data-direction","RESIZE_HANDLE_WIDTH","EDIT_BUTTON_WIDTH","viewClassNames","HtmlTable","CELL_CONTEXT_MENU","ROW_HEADER_CONTEXT_MENU","COL_HEADER_CONTEXT_MENU","DRAWING_CONTEXT_MENU","VIEW_CONTENTS","View","fixedContainer","editContainer","viewSize","cellEditor","barEditor","topCorner","filterHeadersWrapper","filterRange","filterButton","filterButtonActive","horizontalResize","verticalResize","icon","iconFilterDefault","sheetsBar","nameBox","openUnsupported","shiftingNonblankCells","insertColumnWhenRowIsSelected","insertRowWhenColumnIsSelected","filterRangeContainingMerges","sortRangeContainingMerges","cantSortMultipleSelection","cantSortNullRef","cantSortMixedCells","validationError","cannotModifyDisabled","tabs","menus","bringToFront","sendToBack","addColumn","addRow","Node","toDomTree","offset","ContextMenu","contextMenuConfig","_chrome","_dialogs","_formulaInput","clipboardContents","SheetEditor","_sheetsbar","showOn","enableClipboard","isClipboardDeactivated","_resize","actionBar","formulaBar","parents","outerHeight","_outerHeight","tabstripHeight","formulaBarHeight","sheetsBarHeight","quickAccessAdjust","prependTo","NameEditor","toolbar","_tabstrip","content","TabStrip","dataTextField","dataContentField","toolbarOptions","_executeCommand","cellRectangle","_rectangle","boundingRectangle","isColumnResizer","_headerWidth","frozen","locate","w","isRowResizer","_headerHeight","isFilterIcon","theGrid","filterIconRect","isAutoFill","isEditButton","ed","activeCellCustomEditor","_editorInLastColumn","drawingAt","drx","dry","selecting","clientWidth","paneAt","containingPane","refreshTools","totalHeight","totalWidth","_pane","_destroyFilterMenu","_filterMenu","FilterMenu","selectClipboardContents","scrollIntoView","willScroll","scrollBoundaries","scrollBottom","_destroyDialog","edit","dialog","dialogs","reopenEditor","dialogOptions","errorMessages","focusButton","ESC","onClose","_retry","registered","_filterMenuColumn","resizeDirection","scrollbar","renderResizeHint","renderClipboardContents","resizeHint","resizeHintVertical","resizeHintHandle","resizeHintMarker","selectionView","primaryMergedCells","secondaryMergedCells","rangeDimensions","mergedCell","colspan","rowspan","vaxis","haxis","vborder","hborder","rowHeader","columnHeader","mergedCellsWrapper","selectionWrapper","autoFillWrapper","columnResizeHandle","rowResizeHandle","selectionHighlight","isVisible","paneClasses","_currentView","_currentRect","_selectedHeaders","renderData","renderSelection","renderAutoFill","renderEditorSelection","renderFilterHeaders","hasRowHeader","headerClassName","hasColumnHeader","columnOffset","renderResizeHandle","itemSelection","allHeaders","activeCellRange","doLayout","forScreen","xCoords","borderColor","yCoords","Borders","ttOffset","absRow","absCol","_activeFormulaColor","_directionClasses","vert","rendered","borderWidth","transform","horiz","renderDrawings","toDiv","backgroundImage","_start","BUTTON_SIZE","BUTTON_OFFSET","filtered","classes","_addDiv","selections","selectionClasses","_renderCustomEditorButton","cssClass","autoFillRectangle","_axis","btnClass","isLastColumn","btn","_buttonOutOfVisiblePane","activeFormulaSelection","colorClasses","cellClasses","mergedCellLeft","mergedCellTop","EDITORS","registerEditor","kendoCalendar","kendoPopup","getKendoCalendar","getKendoPopup","setOptions","Calendar","disableDates","kendoStaticList","getKendoStaticList","read","PaneGrid","intersectsRect","total","PaneAxis","rangeRef","headerSize","hasHeader","paneSegment","_viewSize","widthCompensation","defaultValue","heightCompensation","_hidden","scrollBarSize","pageSize","firstHidden","lastHidden","startIndex","endIndex","startSegment","endSegment","lastPage","_pixelValues","quarter","sameYear","today","setFullYear","sameMonth","firstDayOfMonth","setMonth","sameWeek","firstWeek","secondWeek","dayOfWeek","_values","_dates","_blanks","dates","_logic","_criteria","expression","Query","filterExpr","_matches","criterionValue","criterionType","valueType","_predicate","_average","aboveAverage","belowAverage","tomorrow","addDays","isToday","yesterday","nextWeek","thisWeek","lastWeek","nextMonth","thisMonth","lastMonth","nextQuarter","thisQuarter","lastQuarter","nextYear","thisYear","lastYear","yearToDate","cultures","months","_lists","ascendingComparer","descendingComparer","li","typeA","typeB","localeCompare","maybeColor","RX_COLORS","maybeCondition","RX_CONDITION","readFormat","maybeFraction","decimal","decimalPart","am","pm","readSection","sections","haveConditional","sec","printSection","printToken","fmt","padLeft","adjusted","restart","compileFormatPart","checkComma","scaleCount","hasDate","hasTime","hasAmpm","percentCount","separeThousands","declen","intFormat","decFormat","condition","preamble","padRight","digNumber","intpart","decpart","TEXT","section","found","calendars","standard","days","namesAbbr","ampm","fraclen","toFixed","eltime","formatInt","skipMinus","shouldInsertMinus","lastPart","iv","chf","formatDec","decimals","span","textAndColor","_cosh","_sinh","_tanh","_gcd","_lcm","forIFS","chunks","matrix","parseCriteria","_avg","numbers","_var_sp","divisor","avg","_stdev_sp","_percentrank","exc","nlt","ngt","_covariance","ax","ay","_percentile","rank","_percentile_inc","_percentile_exc","fetchValuesForAggregate","opt_ignore_hidden_rows","opt_ignore_errors","opt_use_aggregates","fetchValues","_binom_dist","cumulative","_combinations","weeksInYear","_days_360","d1","d2","Hyperlink","numericPredicate","descending","ARGS_COUNTIFS","ARGS_SUMIFS","ARGS_SUMIF","ARGS_PERCENTRANK","_fact","AGGREGATE_FUNCS","RX_NON_PRINTABLE","PI","rad","deg","cos","sin","atan","tan","mult","prod","coef","seen","m1","sumRange","nth","res","discard","bins","asc","variance","stddev","significance","fact","f1","f2","p1","p2","funcId","ignoreHidden","alpha","s2","approx","resultCol","areanum","colRange","cmp","resultRow","fw","sy","dow","wk","holidays","inc","random","rom","radix","minLen","dec","denomitator","string","noCommas","newText","oldText","valueIfError","makeComparator","lc","compLT","compLTE","compGT","compGTE","compNE","compEQ","RXCACHE","ERF","S","an","f_abs","ERFC","GAMMALN","cof","ser","GAMMA","pi","BETALN","BETA","gamma_inc","g_series","g_contfrac","ap","gln","MAX_IT","EPS","FP_MIN","aj","bj","GAMMA_DIST","GAMMA_INV","M","ab","q","NORM_S_DIST","NORM_S_INV","plow","phigh","NORM_DIST","NORM_INV","betastd_pdf","betastd_cdf","beta_lentz","m2","del","qab","qap","qam","betastd_inv","BETADIST","BETA_DIST","cdf","BETA_INV","chisq_left","cds","chisq_right","chisq_left_inv","chisq_right_inv","chisq_test","obsv","expect","eij","expon","poisson","lnf","Fdist","Fdist_right","Finv_right","Finv","_mean","me","_var_sq","Ftest","arr1","arr2","n1","n2","va1","va2","fisher","fisherinv","e2","Tdist","Tdist_right","Tdist_2tail","Tdist_inv","Tdist_2tail_inv","Tdist_test","gr1","gr2","tail","t_st","df","md","v1","v2","u1","u2","q1","q2","confidence_t","confidence_norm","gauss","z","phi","lognorm_dist","lognorm_inv","prob","x_","p_","lw","slope","y_","mx","my","b1","b2","intercept","pearson","s1","s3","whipNumberArrays","rsq","steyx","forecast","_mat_mean","Mat","_mat_devsq","mean","sq","linest","Y","X","konst","stats","Xt","B","line_1","Y1","y_y1","mp","SSreg","SSresid","line_5","R2","degfre","err_est","line_3","F_sta","line_4","SCP","line_2","logest","trend","W","growth","new_X","root_newton","guess","max_it","eps","f_d","FV","rate","nper","pmt","pv","h1","h2","PV","fv","PMT","NPER","RATE","xfd","IPMT","per","ipmt","PPMT","CUMPRINC","tn","ts","te","monthlyPayment","remainingBalanceAtStart","remainingBalanceAtEnd","CUMIPMT","cip","NPV","flows","npv","IRR","npv1","EFFECT","nominal_rate","npery","NOMINAL","effect_rate","XNPV","XIRR","ISPMT","DB","cost","salvage","life","period","db","DDB","factor","prior","dep","SLN","SYD","VDB","no_switch","_getGDA","gda","oldValue","interest","_interVDB","life1","term","remValue","intEnd","lia","vdb","nowLia","intStart","_edate","_daysBetween","basis","_borderCoupons","settlement","maturity","freq","sett","periods","_borderCoupons_fw","COUPDAYBS","frequency","COUPDAYS","settl","matur","COUPDAYSNC","COUPPCD","COUPNCD","COUPNUM","mat","ACCRINTM","issue","par","year_days","ACCRINT","_numCoupons","annual","brace","prev1","next1","nrc","accr","DISC","pr","redemption","INTRATE","investment","RECEIVED","discount","PRICE","yld","N","beg_settl","settl_end","beg_end","den","yf","PRICEDISC","dsm","COUPS_ARGS","ll","ac","withPreventDefault","BORDER_TYPES","BORDER_PALETTE_MESSAGES","COLOR_PICKER_MESSAGES","ColorChooser","BorderPalette","borderPalette","colorPicker","customColor","cancel","_resetButton","_colorPalette","_customColorPalette","_customColorButton","resetButton","resetColor","customColorButton","colorPalette","flatColorPicker","_change","class","kendoColorPalette","palette","viewModel","kendoWindow","resizable","maximizable","center","one","_hueSlider","kendoFlatColorPicker","observable","_borderTypePalette","_borderColorPalette","_click","colorChooser","buttons","_colorChange","currentTarget","ToolBar","MESSAGES","defaultTools","toolDefaults","SpreadsheetToolBar","DropDownTool","PopupTool","OverflowDialogButton","ColorPicker","ColorPickerButton","FONT_SIZES","DEFAULT_FONT_SIZE","FontSize","FontSizeButton","FONT_FAMILIES","DEFAULT_FONT_FAMILY","FontFamily","FontFamilyButton","defaultFormats","Format","FormatButton","BorderChangeTool","BorderChangeButton","AlignmentTool","AlignmentButton","MergeTool","MergeButton","FreezeTool","FreezeButton","Sort","SortButton","FilterButton","Open","alignment","alignmentButtons","justtifyLeft","justifyCenter","justifyRight","justifyFull","alignTop","alignMiddle","alignBottom","formatTypes","automatic","financial","dateTime","duration","moreFormats","formatDecreaseDecimal","formatIncreaseDecimal","freeze","freezeButtons","freezePanes","freezeRows","freezeColumns","insertComment","insertImage","mergeButtons","mergeCells","mergeHorizontally","mergeVertically","quickAccess","exportAs","toggleGridlines","sortButtons","sortRangeAsc","sortRangeDesc","textColor","textWrap","hyperlink","iconClass","dialogName","togglable","separator","formatCells","handleClick","_expandTools","tools","toolbarName","_addSeparators","tool","_nextTool","activeElement","blur","removeClass","click","activeIndex","groups","before","expandTool","toolName","isPlainObject","spriteCssClass","typeDefaults","showText","toolIcon","attributes","aria-label","menuButtons","commandType","checked","setToggle","hasOwnProperty","update","_tools","isFunction","toArray","_getItem","instance","Item","dropDownList","kendoDropDownList","addUidAttr","addOverflowAttr","_open","data-command","data-property","listWidth","ddl","_listWidth","dataItem","popupName","registerComponent","ToolBarButton","_dialogName","_title","OverflowButton","iconName","comboBox","kendoComboBox","_valueChange","clearButton","fontSizes","sizes","defaultSize","fontFamilies","defaultFont","_revertTitle","dataValuePrimitive","valueTemplate","sample","_borderPalette","_action","_defineButtons","_commandPalette","_reset","_quickAccessButtons","toolbars","contentElements","_toolbar","quickAccessToolBar","buttonTemplate","insertBefore","tabGroup","formattedValue","uniqueBy","inArray","PDF_PAPER_SIZE","basicErrorDialog","register","MessageDialog","messageId","Localizable","path","translate","trans","ObservableObject","registry","SpreadsheetDialog","FormatCellsViewModel","FormatCellsDialog","ConfirmationDialog","ValidationErrorDialog","FontFamilyDialog","FontSizeDialog","BordersDialog","ColorPickerDialog","CustomColorDialog","AlignmentDialog","MergeDialog","FreezeDialog","ValidationViewModel","ValidationDialog","ExportAsDialog","ImportErrorDialog","UseKeyboardDialog","HyperlinkDialog","InsertCommentDialog","InsertImageDialog","retry","revert","okText","formatCellsDialog","categories","fontFamilyDialog","fontSizeDialog","bordersDialog","alignmentDialog","mergeDialog","freezeDialog","confirmationDialog","validationDialog","hintMessage","hintTitle","any","comparers","comparerMessages","labels","onInvalidData","rejectInput","showWarning","showHint","ignoreBlank","showListButton","showCalendarButton","placeholders","typeTitle","typeMessage","exportAsDialog","defaultFileName","xlsx","description","paper","a4","a5","b3","b4","b5","folio","legal","tabloid","executive","margin","normal","narrow","wide","fit","saveAsType","exportArea","paperSize","margins","orientation","guidelines","modifyMergedDialog","errorMessage","rangeDisabledDialog","intersectsArrayDialog","incompatibleRangesDialog","noFillDirectionDialog","duplicateSheetNameDialog","overflowDialog","useKeyboardDialog","forCopy","forCut","forPaste","unsupportedSelectionDialog","linkDialog","removeLink","insertCommentDialog","removeComment","insertImageDialog","info","typeError","dialogClass","autoFocus","_dialog","_onDialogClose","_onDialogActivate","_onDialogDeactivate","useCategory","category","formatCurrency","currencies","allFormats","useFirstFormat","_currency","iso","convert","categoryFilter","pattern","abbr","defaultOptions","_generateFormats","calendarPatterns","currenciesFrom","numberFormats","dateFormats","currencyFilter","roleSelector","getter","confirm","_confirmed","_list","_colorPicker","ValidationCellsViewModel","criterion","setHintMessageTemplate","shouldBuild","buildMessages","hintTitleTemplate","hintMessageTemplate","setComparers","defaultHintTitle","text_comparers","defaultComparers","defaultHintMessage","isAny","isNumber","showToForNumber","showTo","showToForDate","isDate","isText","isList","isCustom","showRemove","fromValidationObject","useCustomMessages","toValidationObject","errorTemplate","validatable","Validator","validateOnBlur","validate","fileFormats","subject","keywords","creator","fitWidth","areas","paperSizes","landscape","hCenter","vCenter","model","okEnabled","hasImage","isHovered","_url","_image","stopEvent","drop","selectFile","dataTransfer","dragEnter","dragLeave","o","_normalizeColumns","_dataSource","_header","_boundRowsCount","_sheetChangeHandler","_sheetDeleteRowHandler","_sheetInsertRowHandler","fields","getters","normalizedRef","_skipRebind","record","valueIndex","colValueIndex","_changeHandler","getterIdx","distinctValues","query","itemVisible","filterSpread","anyVisibleChildren","hasVisibleChildren","HierarchicalDataSource","valuesFilter","uncheckAll","hasChildren","flattenOperators","operators","Details","templates","FilterMenuViewModel","FilterMenuController","details","detailsSummary","detailsContent","iconCollapse","iconExpand","iconSearch","textbox","filterByCondition","filterByValue","valuesTreeViewWrapper","actionButtons","sortAscending","sortDescending","search","addToCurrent","operatorNone","doesnotcontain","startswith","endswith","doesnotmatch","neq","gte","lte","_summary","_toggle","_icon","_container","fx","expand","binders","spreadsheetFilterValue","Binder","bindings","proxy","widget","binding","menuItem","valuesChange","valuesDataSource","lastIndexOf","appendToSearch","valueSelect","hasActiveSearch","filterValues","operatorChange","isNone","isString","valuesTree","filterType","topValue","filterForColumn","allFilters","columnFilters","_filterInit","_filterByCondition","_filterByValue","_actionButtons","valuesTreeView","_active","activeFilter","copyAnchorStyles","dir","kendoMenu","_appendTemplate","compiledTemplate","_detailToggle","not","isExpanded","activeContainer","hasClass","oldRect","newRect","barInput","cellInput","_triggerUpdate","_rect","noChange","inputType","linearRegression","findSeries","findStep","forEachSeries","getType","lst","findStringList","stringLists","strl","ERR_INCOMPATIBLE","ERR_NO_DIRECTION","srcRange","srcIdx","destRange","fillFrom","CLASS_NAMES","comboBoxTitle","comboElement","transport","success","combo","ignoreCase","_on_listChange","noDataTemplate","getKendoComboBox","_on_keyDown","_on_focus","_deleteItem","_prevValue","distributeCoords","heights","pageHeight","maxEmpty","headerRows","headerCoords","curr","header","wholeRect","rowHeights","colWidths","pageWidth","scaleFactor","hyCoords","boxWidth","boxHeight","headerCells","nonEmpty","relrow","relcol","rh","cw","shouldDrawCell","emptyCells","orlast","orderCoords","orderCells","assign","sameBorder","drawLayout","addPage","isInside","endbottom","endright","page","bordersGroup","kdrw","Group","clip","Path","fromRect","geo","Rect","multiplyCopy","moveTo","lineTo","stroke","guideColor","GUIDELINE_WIDTH","ncols","nrows","r2d2","drawText","paddingLeft","paddingRight","vtrans","text_group","CONT","boxSizing","lineHeight","padding","makeFontDef","createTextNode","drawDOM","getPaperOptions","multiPage","Container","pb","addVert","addHoriz","drawTabularData","textWidth","charWidth","mkCell","headerBackground","headerColor","oddBackground","evenBackground","useGridFormat","defineFont","getFontFaces","charWidthFunction","columnTitles","columnWidths","label","CACHE_CHAR_WIDTH","geometry","widths","NS","Spreadsheet","F10","F11","I","U","H","A","DELETE","R","_controller","_autoRefresh","_bindWorkbookEvents","_resizeHandler","_keyDown","redoTool","_workbookChanging","_workbookChange","_workbookCut","_workbookCopy","_workbookPaste","autoRefresh","_workbookExcelExport","_workbookExcelImport","_initProgress","kendoProgressBar","chunkCount","always","_workbookPdfExport","_workbookInsertSheet","_workbookRemoveSheet","_workbookSelectSheet","_workbookRenameSheet","_workbookInsertRow","_workbookInsertColumn","_workbookDeleteRow","_workbookDeleteColumn","_workbookHideRow","_workbookHideColumn","_workbookUnhideRow","_workbookUnhideColumn","_workbookSelect","_workbookChangeFormat","_workbookDataBinding","_workbookDataBound","plugin"],"mappings":"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","file":"kendo.spreadsheet.min.js","sourcesContent":["/*!\n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n\n*/\n(function (f, define) {\n    define('util/undoredostack', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        var UndoRedoStack = kendo.Observable.extend({\n            init: function (options) {\n                kendo.Observable.fn.init.call(this, options);\n                this.clear();\n            },\n            events: [\n                'undo',\n                'redo'\n            ],\n            push: function (command) {\n                this.stack = this.stack.slice(0, this.currentCommandIndex + 1);\n                this.currentCommandIndex = this.stack.push(command) - 1;\n            },\n            undo: function () {\n                if (this.canUndo()) {\n                    var command = this.stack[this.currentCommandIndex--];\n                    command.undo();\n                    this.trigger('undo', { command: command });\n                }\n            },\n            redo: function () {\n                if (this.canRedo()) {\n                    var command = this.stack[++this.currentCommandIndex];\n                    command.redo();\n                    this.trigger('redo', { command: command });\n                }\n            },\n            clear: function () {\n                this.stack = [];\n                this.currentCommandIndex = -1;\n            },\n            canUndo: function () {\n                return this.currentCommandIndex >= 0;\n            },\n            canRedo: function () {\n                return this.currentCommandIndex != this.stack.length - 1;\n            }\n        });\n        kendo.deepExtend(kendo, { util: { UndoRedoStack: UndoRedoStack } });\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('util/text-metrics', ['kendo.core'], f);\n}(function () {\n    (function ($) {\n        window.kendo.util = window.kendo.util || {};\n        var LRUCache = kendo.Class.extend({\n            init: function (size) {\n                this._size = size;\n                this._length = 0;\n                this._map = {};\n            },\n            put: function (key, value) {\n                var map = this._map;\n                var entry = {\n                    key: key,\n                    value: value\n                };\n                map[key] = entry;\n                if (!this._head) {\n                    this._head = this._tail = entry;\n                } else {\n                    this._tail.newer = entry;\n                    entry.older = this._tail;\n                    this._tail = entry;\n                }\n                if (this._length >= this._size) {\n                    map[this._head.key] = null;\n                    this._head = this._head.newer;\n                    this._head.older = null;\n                } else {\n                    this._length++;\n                }\n            },\n            get: function (key) {\n                var entry = this._map[key];\n                if (entry) {\n                    if (entry === this._head && entry !== this._tail) {\n                        this._head = entry.newer;\n                        this._head.older = null;\n                    }\n                    if (entry !== this._tail) {\n                        if (entry.older) {\n                            entry.older.newer = entry.newer;\n                            entry.newer.older = entry.older;\n                        }\n                        entry.older = this._tail;\n                        entry.newer = null;\n                        this._tail.newer = entry;\n                        this._tail = entry;\n                    }\n                    return entry.value;\n                }\n            }\n        });\n        var REPLACE_REGEX = /\\r?\\n|\\r|\\t/g;\n        var SPACE = ' ';\n        function normalizeText(text) {\n            return String(text).replace(REPLACE_REGEX, SPACE);\n        }\n        function objectKey(object) {\n            var parts = [];\n            for (var key in object) {\n                parts.push(key + object[key]);\n            }\n            return parts.sort().join('');\n        }\n        function hashKey(str) {\n            var hash = 2166136261;\n            for (var i = 0; i < str.length; ++i) {\n                hash += (hash << 1) + (hash << 4) + (hash << 7) + (hash << 8) + (hash << 24);\n                hash ^= str.charCodeAt(i);\n            }\n            return hash >>> 0;\n        }\n        function zeroSize() {\n            return {\n                width: 0,\n                height: 0,\n                baseline: 0\n            };\n        }\n        var DEFAULT_OPTIONS = { baselineMarkerSize: 1 };\n        var defaultMeasureBox;\n        if (typeof document !== 'undefined') {\n            defaultMeasureBox = document.createElement('div');\n            defaultMeasureBox.style.cssText = 'position: absolute !important; top: -4000px !important; width: auto !important; height: auto !important;' + 'padding: 0 !important; margin: 0 !important; border: 0 !important;' + 'line-height: normal !important; visibility: hidden !important; white-space: pre!important;';\n        }\n        var TextMetrics = kendo.Class.extend({\n            init: function (options) {\n                this._cache = new LRUCache(1000);\n                this.options = $.extend({}, DEFAULT_OPTIONS, options);\n            },\n            measure: function (text, style, options) {\n                if (options === void 0) {\n                    options = {};\n                }\n                if (!text) {\n                    return zeroSize();\n                }\n                var styleKey = objectKey(style);\n                var cacheKey = hashKey(text + styleKey);\n                var cachedResult = this._cache.get(cacheKey);\n                if (cachedResult) {\n                    return cachedResult;\n                }\n                var size = zeroSize();\n                var measureBox = options.box || defaultMeasureBox;\n                var baselineMarker = this._baselineMarker().cloneNode(false);\n                for (var key in style) {\n                    var value = style[key];\n                    if (typeof value !== 'undefined') {\n                        measureBox.style[key] = value;\n                    }\n                }\n                var textStr = options.normalizeText !== false ? normalizeText(text) : String(text);\n                measureBox.textContent = textStr;\n                measureBox.appendChild(baselineMarker);\n                document.body.appendChild(measureBox);\n                if (textStr.length) {\n                    size.width = measureBox.offsetWidth - this.options.baselineMarkerSize;\n                    size.height = measureBox.offsetHeight;\n                    size.baseline = baselineMarker.offsetTop + this.options.baselineMarkerSize;\n                }\n                if (size.width > 0 && size.height > 0) {\n                    this._cache.put(cacheKey, size);\n                }\n                measureBox.parentNode.removeChild(measureBox);\n                return size;\n            },\n            _baselineMarker: function () {\n                var marker = document.createElement('div');\n                marker.style.cssText = 'display: inline-block; vertical-align: baseline;width: ' + this.options.baselineMarkerSize + 'px; height: ' + this.options.baselineMarkerSize + 'px;overflow: hidden;';\n                return marker;\n            }\n        });\n        TextMetrics.current = new TextMetrics();\n        function measureText(text, style, measureBox) {\n            return TextMetrics.current.measure(text, style, measureBox);\n        }\n        kendo.deepExtend(kendo.util, {\n            LRUCache: LRUCache,\n            TextMetrics: TextMetrics,\n            measureText: measureText,\n            objectKey: objectKey,\n            hashKey: hashKey,\n            normalizeText: normalizeText\n        });\n    }(window.kendo.jQuery));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('util/main', ['kendo.core'], f);\n}(function () {\n    (function () {\n        var kendo = window.kendo, deepExtend = kendo.deepExtend;\n        function sqr(value) {\n            return value * value;\n        }\n        var now = Date.now;\n        if (!now) {\n            now = function () {\n                return new Date().getTime();\n            };\n        }\n        function renderSize(size) {\n            if (typeof size !== 'string') {\n                size += 'px';\n            }\n            return size;\n        }\n        function renderPos(pos) {\n            var result = [];\n            if (pos) {\n                var parts = kendo.toHyphens(pos).split('-');\n                for (var i = 0; i < parts.length; i++) {\n                    result.push('k-pos-' + parts[i]);\n                }\n            }\n            return result.join(' ');\n        }\n        function arabicToRoman(n) {\n            var literals = {\n                1: 'i',\n                10: 'x',\n                100: 'c',\n                2: 'ii',\n                20: 'xx',\n                200: 'cc',\n                3: 'iii',\n                30: 'xxx',\n                300: 'ccc',\n                4: 'iv',\n                40: 'xl',\n                400: 'cd',\n                5: 'v',\n                50: 'l',\n                500: 'd',\n                6: 'vi',\n                60: 'lx',\n                600: 'dc',\n                7: 'vii',\n                70: 'lxx',\n                700: 'dcc',\n                8: 'viii',\n                80: 'lxxx',\n                800: 'dccc',\n                9: 'ix',\n                90: 'xc',\n                900: 'cm',\n                1000: 'm'\n            };\n            var values = [\n                1000,\n                900,\n                800,\n                700,\n                600,\n                500,\n                400,\n                300,\n                200,\n                100,\n                90,\n                80,\n                70,\n                60,\n                50,\n                40,\n                30,\n                20,\n                10,\n                9,\n                8,\n                7,\n                6,\n                5,\n                4,\n                3,\n                2,\n                1\n            ];\n            var roman = '';\n            while (n > 0) {\n                if (n < values[0]) {\n                    values.shift();\n                } else {\n                    roman += literals[values[0]];\n                    n -= values[0];\n                }\n            }\n            return roman;\n        }\n        function romanToArabic(r) {\n            r = r.toLowerCase();\n            var digits = {\n                i: 1,\n                v: 5,\n                x: 10,\n                l: 50,\n                c: 100,\n                d: 500,\n                m: 1000\n            };\n            var value = 0, prev = 0;\n            for (var i = 0; i < r.length; ++i) {\n                var v = digits[r.charAt(i)];\n                if (!v) {\n                    return null;\n                }\n                value += v;\n                if (v > prev) {\n                    value -= 2 * prev;\n                }\n                prev = v;\n            }\n            return value;\n        }\n        function memoize(f) {\n            var cache = Object.create(null);\n            return function () {\n                var id = '';\n                for (var i = arguments.length; --i >= 0;) {\n                    id += ':' + arguments[i];\n                }\n                return id in cache ? cache[id] : cache[id] = f.apply(this, arguments);\n            };\n        }\n        function isUnicodeLetter(ch) {\n            return RX_UNICODE_LETTER.test(ch);\n        }\n        function withExit(f, obj) {\n            try {\n                return f.call(obj, function (value) {\n                    throw new Return(value);\n                });\n            } catch (ex) {\n                if (ex instanceof Return) {\n                    return ex.value;\n                }\n                throw ex;\n            }\n            function Return(value) {\n                this.value = value;\n            }\n        }\n        deepExtend(kendo, {\n            util: {\n                now: now,\n                renderPos: renderPos,\n                renderSize: renderSize,\n                sqr: sqr,\n                romanToArabic: romanToArabic,\n                arabicToRoman: arabicToRoman,\n                memoize: memoize,\n                isUnicodeLetter: isUnicodeLetter,\n                withExit: withExit\n            }\n        });\n        var RX_UNICODE_LETTER = new RegExp('[\\\\u0041-\\\\u005A\\\\u0061-\\\\u007A\\\\u00AA\\\\u00B5\\\\u00BA\\\\u00C0-\\\\u00D6\\\\u00D8-\\\\u00F6\\\\u00F8-\\\\u02C1\\\\u02C6-\\\\u02D1\\\\u02E0-\\\\u02E4\\\\u02EC\\\\u02EE\\\\u0370-\\\\u0374\\\\u0376\\\\u0377\\\\u037A-\\\\u037D\\\\u037F\\\\u0386\\\\u0388-\\\\u038A\\\\u038C\\\\u038E-\\\\u03A1\\\\u03A3-\\\\u03F5\\\\u03F7-\\\\u0481\\\\u048A-\\\\u052F\\\\u0531-\\\\u0556\\\\u0559\\\\u0561-\\\\u0587\\\\u05D0-\\\\u05EA\\\\u05F0-\\\\u05F2\\\\u0620-\\\\u064A\\\\u066E\\\\u066F\\\\u0671-\\\\u06D3\\\\u06D5\\\\u06E5\\\\u06E6\\\\u06EE\\\\u06EF\\\\u06FA-\\\\u06FC\\\\u06FF\\\\u0710\\\\u0712-\\\\u072F\\\\u074D-\\\\u07A5\\\\u07B1\\\\u07CA-\\\\u07EA\\\\u07F4\\\\u07F5\\\\u07FA\\\\u0800-\\\\u0815\\\\u081A\\\\u0824\\\\u0828\\\\u0840-\\\\u0858\\\\u08A0-\\\\u08B2\\\\u0904-\\\\u0939\\\\u093D\\\\u0950\\\\u0958-\\\\u0961\\\\u0971-\\\\u0980\\\\u0985-\\\\u098C\\\\u098F\\\\u0990\\\\u0993-\\\\u09A8\\\\u09AA-\\\\u09B0\\\\u09B2\\\\u09B6-\\\\u09B9\\\\u09BD\\\\u09CE\\\\u09DC\\\\u09DD\\\\u09DF-\\\\u09E1\\\\u09F0\\\\u09F1\\\\u0A05-\\\\u0A0A\\\\u0A0F\\\\u0A10\\\\u0A13-\\\\u0A28\\\\u0A2A-\\\\u0A30\\\\u0A32\\\\u0A33\\\\u0A35\\\\u0A36\\\\u0A38\\\\u0A39\\\\u0A59-\\\\u0A5C\\\\u0A5E\\\\u0A72-\\\\u0A74\\\\u0A85-\\\\u0A8D\\\\u0A8F-\\\\u0A91\\\\u0A93-\\\\u0AA8\\\\u0AAA-\\\\u0AB0\\\\u0AB2\\\\u0AB3\\\\u0AB5-\\\\u0AB9\\\\u0ABD\\\\u0AD0\\\\u0AE0\\\\u0AE1\\\\u0B05-\\\\u0B0C\\\\u0B0F\\\\u0B10\\\\u0B13-\\\\u0B28\\\\u0B2A-\\\\u0B30\\\\u0B32\\\\u0B33\\\\u0B35-\\\\u0B39\\\\u0B3D\\\\u0B5C\\\\u0B5D\\\\u0B5F-\\\\u0B61\\\\u0B71\\\\u0B83\\\\u0B85-\\\\u0B8A\\\\u0B8E-\\\\u0B90\\\\u0B92-\\\\u0B95\\\\u0B99\\\\u0B9A\\\\u0B9C\\\\u0B9E\\\\u0B9F\\\\u0BA3\\\\u0BA4\\\\u0BA8-\\\\u0BAA\\\\u0BAE-\\\\u0BB9\\\\u0BD0\\\\u0C05-\\\\u0C0C\\\\u0C0E-\\\\u0C10\\\\u0C12-\\\\u0C28\\\\u0C2A-\\\\u0C39\\\\u0C3D\\\\u0C58\\\\u0C59\\\\u0C60\\\\u0C61\\\\u0C85-\\\\u0C8C\\\\u0C8E-\\\\u0C90\\\\u0C92-\\\\u0CA8\\\\u0CAA-\\\\u0CB3\\\\u0CB5-\\\\u0CB9\\\\u0CBD\\\\u0CDE\\\\u0CE0\\\\u0CE1\\\\u0CF1\\\\u0CF2\\\\u0D05-\\\\u0D0C\\\\u0D0E-\\\\u0D10\\\\u0D12-\\\\u0D3A\\\\u0D3D\\\\u0D4E\\\\u0D60\\\\u0D61\\\\u0D7A-\\\\u0D7F\\\\u0D85-\\\\u0D96\\\\u0D9A-\\\\u0DB1\\\\u0DB3-\\\\u0DBB\\\\u0DBD\\\\u0DC0-\\\\u0DC6\\\\u0E01-\\\\u0E30\\\\u0E32\\\\u0E33\\\\u0E40-\\\\u0E46\\\\u0E81\\\\u0E82\\\\u0E84\\\\u0E87\\\\u0E88\\\\u0E8A\\\\u0E8D\\\\u0E94-\\\\u0E97\\\\u0E99-\\\\u0E9F\\\\u0EA1-\\\\u0EA3\\\\u0EA5\\\\u0EA7\\\\u0EAA\\\\u0EAB\\\\u0EAD-\\\\u0EB0\\\\u0EB2\\\\u0EB3\\\\u0EBD\\\\u0EC0-\\\\u0EC4\\\\u0EC6\\\\u0EDC-\\\\u0EDF\\\\u0F00\\\\u0F40-\\\\u0F47\\\\u0F49-\\\\u0F6C\\\\u0F88-\\\\u0F8C\\\\u1000-\\\\u102A\\\\u103F\\\\u1050-\\\\u1055\\\\u105A-\\\\u105D\\\\u1061\\\\u1065\\\\u1066\\\\u106E-\\\\u1070\\\\u1075-\\\\u1081\\\\u108E\\\\u10A0-\\\\u10C5\\\\u10C7\\\\u10CD\\\\u10D0-\\\\u10FA\\\\u10FC-\\\\u1248\\\\u124A-\\\\u124D\\\\u1250-\\\\u1256\\\\u1258\\\\u125A-\\\\u125D\\\\u1260-\\\\u1288\\\\u128A-\\\\u128D\\\\u1290-\\\\u12B0\\\\u12B2-\\\\u12B5\\\\u12B8-\\\\u12BE\\\\u12C0\\\\u12C2-\\\\u12C5\\\\u12C8-\\\\u12D6\\\\u12D8-\\\\u1310\\\\u1312-\\\\u1315\\\\u1318-\\\\u135A\\\\u1380-\\\\u138F\\\\u13A0-\\\\u13F4\\\\u1401-\\\\u166C\\\\u166F-\\\\u167F\\\\u1681-\\\\u169A\\\\u16A0-\\\\u16EA\\\\u16EE-\\\\u16F8\\\\u1700-\\\\u170C\\\\u170E-\\\\u1711\\\\u1720-\\\\u1731\\\\u1740-\\\\u1751\\\\u1760-\\\\u176C\\\\u176E-\\\\u1770\\\\u1780-\\\\u17B3\\\\u17D7\\\\u17DC\\\\u1820-\\\\u1877\\\\u1880-\\\\u18A8\\\\u18AA\\\\u18B0-\\\\u18F5\\\\u1900-\\\\u191E\\\\u1950-\\\\u196D\\\\u1970-\\\\u1974\\\\u1980-\\\\u19AB\\\\u19C1-\\\\u19C7\\\\u1A00-\\\\u1A16\\\\u1A20-\\\\u1A54\\\\u1AA7\\\\u1B05-\\\\u1B33\\\\u1B45-\\\\u1B4B\\\\u1B83-\\\\u1BA0\\\\u1BAE\\\\u1BAF\\\\u1BBA-\\\\u1BE5\\\\u1C00-\\\\u1C23\\\\u1C4D-\\\\u1C4F\\\\u1C5A-\\\\u1C7D\\\\u1CE9-\\\\u1CEC\\\\u1CEE-\\\\u1CF1\\\\u1CF5\\\\u1CF6\\\\u1D00-\\\\u1DBF\\\\u1E00-\\\\u1F15\\\\u1F18-\\\\u1F1D\\\\u1F20-\\\\u1F45\\\\u1F48-\\\\u1F4D\\\\u1F50-\\\\u1F57\\\\u1F59\\\\u1F5B\\\\u1F5D\\\\u1F5F-\\\\u1F7D\\\\u1F80-\\\\u1FB4\\\\u1FB6-\\\\u1FBC\\\\u1FBE\\\\u1FC2-\\\\u1FC4\\\\u1FC6-\\\\u1FCC\\\\u1FD0-\\\\u1FD3\\\\u1FD6-\\\\u1FDB\\\\u1FE0-\\\\u1FEC\\\\u1FF2-\\\\u1FF4\\\\u1FF6-\\\\u1FFC\\\\u2071\\\\u207F\\\\u2090-\\\\u209C\\\\u2102\\\\u2107\\\\u210A-\\\\u2113\\\\u2115\\\\u2119-\\\\u211D\\\\u2124\\\\u2126\\\\u2128\\\\u212A-\\\\u212D\\\\u212F-\\\\u2139\\\\u213C-\\\\u213F\\\\u2145-\\\\u2149\\\\u214E\\\\u2160-\\\\u2188\\\\u2C00-\\\\u2C2E\\\\u2C30-\\\\u2C5E\\\\u2C60-\\\\u2CE4\\\\u2CEB-\\\\u2CEE\\\\u2CF2\\\\u2CF3\\\\u2D00-\\\\u2D25\\\\u2D27\\\\u2D2D\\\\u2D30-\\\\u2D67\\\\u2D6F\\\\u2D80-\\\\u2D96\\\\u2DA0-\\\\u2DA6\\\\u2DA8-\\\\u2DAE\\\\u2DB0-\\\\u2DB6\\\\u2DB8-\\\\u2DBE\\\\u2DC0-\\\\u2DC6\\\\u2DC8-\\\\u2DCE\\\\u2DD0-\\\\u2DD6\\\\u2DD8-\\\\u2DDE\\\\u2E2F\\\\u3005-\\\\u3007\\\\u3021-\\\\u3029\\\\u3031-\\\\u3035\\\\u3038-\\\\u303C\\\\u3041-\\\\u3096\\\\u309D-\\\\u309F\\\\u30A1-\\\\u30FA\\\\u30FC-\\\\u30FF\\\\u3105-\\\\u312D\\\\u3131-\\\\u318E\\\\u31A0-\\\\u31BA\\\\u31F0-\\\\u31FF\\\\u3400-\\\\u4DB5\\\\u4E00-\\\\u9FCC\\\\uA000-\\\\uA48C\\\\uA4D0-\\\\uA4FD\\\\uA500-\\\\uA60C\\\\uA610-\\\\uA61F\\\\uA62A\\\\uA62B\\\\uA640-\\\\uA66E\\\\uA67F-\\\\uA69D\\\\uA6A0-\\\\uA6EF\\\\uA717-\\\\uA71F\\\\uA722-\\\\uA788\\\\uA78B-\\\\uA78E\\\\uA790-\\\\uA7AD\\\\uA7B0\\\\uA7B1\\\\uA7F7-\\\\uA801\\\\uA803-\\\\uA805\\\\uA807-\\\\uA80A\\\\uA80C-\\\\uA822\\\\uA840-\\\\uA873\\\\uA882-\\\\uA8B3\\\\uA8F2-\\\\uA8F7\\\\uA8FB\\\\uA90A-\\\\uA925\\\\uA930-\\\\uA946\\\\uA960-\\\\uA97C\\\\uA984-\\\\uA9B2\\\\uA9CF\\\\uA9E0-\\\\uA9E4\\\\uA9E6-\\\\uA9EF\\\\uA9FA-\\\\uA9FE\\\\uAA00-\\\\uAA28\\\\uAA40-\\\\uAA42\\\\uAA44-\\\\uAA4B\\\\uAA60-\\\\uAA76\\\\uAA7A\\\\uAA7E-\\\\uAAAF\\\\uAAB1\\\\uAAB5\\\\uAAB6\\\\uAAB9-\\\\uAABD\\\\uAAC0\\\\uAAC2\\\\uAADB-\\\\uAADD\\\\uAAE0-\\\\uAAEA\\\\uAAF2-\\\\uAAF4\\\\uAB01-\\\\uAB06\\\\uAB09-\\\\uAB0E\\\\uAB11-\\\\uAB16\\\\uAB20-\\\\uAB26\\\\uAB28-\\\\uAB2E\\\\uAB30-\\\\uAB5A\\\\uAB5C-\\\\uAB5F\\\\uAB64\\\\uAB65\\\\uABC0-\\\\uABE2\\\\uAC00-\\\\uD7A3\\\\uD7B0-\\\\uD7C6\\\\uD7CB-\\\\uD7FB\\\\uF900-\\\\uFA6D\\\\uFA70-\\\\uFAD9\\\\uFB00-\\\\uFB06\\\\uFB13-\\\\uFB17\\\\uFB1D\\\\uFB1F-\\\\uFB28\\\\uFB2A-\\\\uFB36\\\\uFB38-\\\\uFB3C\\\\uFB3E\\\\uFB40\\\\uFB41\\\\uFB43\\\\uFB44\\\\uFB46-\\\\uFBB1\\\\uFBD3-\\\\uFD3D\\\\uFD50-\\\\uFD8F\\\\uFD92-\\\\uFDC7\\\\uFDF0-\\\\uFDFB\\\\uFE70-\\\\uFE74\\\\uFE76-\\\\uFEFC\\\\uFF21-\\\\uFF3A\\\\uFF41-\\\\uFF5A\\\\uFF66-\\\\uFFBE\\\\uFFC2-\\\\uFFC7\\\\uFFCA-\\\\uFFCF\\\\uFFD2-\\\\uFFD7\\\\uFFDA-\\\\uFFDC]');\n    }());\n    return window.kendo;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('util/parse-xml', [\n        'kendo.core',\n        'util/main'\n    ], f);\n}(function () {\n    'use strict';\n    var STRING = String.fromCharCode;\n    var ENTITIES = {\n        'amp': 38,\n        'lt': 60,\n        'gt': 62,\n        'quot': 34,\n        'apos': 39,\n        'nbsp': 160\n    };\n    function CODE(str) {\n        var out = [];\n        for (var i = 0; i < str.length; ++i) {\n            out.push(str.charCodeAt(i));\n        }\n        return out;\n    }\n    function UCS2(out, code) {\n        if (code > 65535) {\n            code -= 65536;\n            out.push(code >>> 10 & 1023 | 55296, 56320 | code & 1023);\n        } else {\n            out.push(code);\n        }\n    }\n    var START_CDATA = CODE('<![CDATA[');\n    var END_CDATA = CODE(']]>');\n    var END_COMMENT = CODE('-->');\n    var START_COMMENT = CODE('!--');\n    var END_SHORT_TAG = CODE('/>');\n    var END_TAG = CODE('</');\n    var END_DECLARATION = CODE('?>');\n    var QUESTION_MARK = CODE('?');\n    var LESS_THAN = CODE('<');\n    var GREATER_THAN = CODE('>');\n    var SEMICOLON = CODE(';');\n    var EQUAL = CODE('=');\n    var AMPERSAND = CODE('&');\n    var QUOTE = CODE('\"');\n    var APOSTROPHE = CODE('\\'');\n    var SHARP = CODE('#');\n    var LOWERCASE_X = CODE('x');\n    var UPPERCASE_X = CODE('X');\n    var EXIT = {};\n    function parse(data, callbacks) {\n        var index = 0;\n        var stack = [];\n        var object = {\n            is: function (selector) {\n                var i = stack.length, j = selector.length;\n                while (--i >= 0 && --j >= 0) {\n                    if (stack[i].$tag != selector[j] && selector[j] != '*') {\n                        return false;\n                    }\n                }\n                return j < 0 ? stack[stack.length - 1] : null;\n            },\n            exit: function () {\n                throw EXIT;\n            },\n            stack: stack\n        };\n        function readChar(body) {\n            var code = data[index++];\n            if (!(code & 240 ^ 240)) {\n                UCS2(body, (code & 3) << 18 | (data[index++] & 63) << 12 | (data[index++] & 63) << 6 | data[index++] & 63);\n            } else if (!(code & 224 ^ 224)) {\n                UCS2(body, (code & 15) << 12 | (data[index++] & 63) << 6 | data[index++] & 63);\n            } else if (!(code & 192 ^ 192)) {\n                UCS2(body, (code & 31) << 6 | data[index++] & 63);\n            } else {\n                body.push(code);\n            }\n        }\n        function croak(msg) {\n            throw new Error(msg + ', at ' + index);\n        }\n        function readWhile(pred) {\n            var a = [];\n            while (index < data.length && pred(data[index])) {\n                a.push(data[index++]);\n            }\n            return a;\n        }\n        function readAsciiWhile(pred) {\n            return STRING.apply(0, readWhile(pred));\n        }\n        function skipWhitespace() {\n            readWhile(isWhitespace);\n        }\n        function eat(a) {\n            var save = index;\n            for (var i = 0; i < a.length; ++i) {\n                if (data[index++] != a[i]) {\n                    index = save;\n                    return false;\n                }\n            }\n            return a;\n        }\n        function skip(code) {\n            if (!eat(code)) {\n                croak('Expecting ' + code.join(', '));\n            }\n        }\n        function isWhitespace(code) {\n            return code == 9 || code == 10 || code == 13 || code == 32;\n        }\n        function isDigit(code) {\n            return code >= 48 && code <= 57;\n        }\n        function isHexDigit(code) {\n            return code >= 48 && code <= 57 || (code |= 32) >= 97 && code <= 102;\n        }\n        function isNameStart(code) {\n            return code == 58 || code == 95 || (code |= 32) >= 97 && code <= 122;\n        }\n        function isName(code) {\n            return code == 45 || isDigit(code) || isNameStart(code);\n        }\n        function xmlComment() {\n            var body = [];\n            while (index < data.length) {\n                if (eat(END_COMMENT)) {\n                    return call('comment', STRING.apply(0, body));\n                }\n                readChar(body);\n            }\n        }\n        function xmlTag() {\n            var name, attrs;\n            if (eat(QUESTION_MARK)) {\n                xmlDecl();\n            } else if (eat(START_COMMENT)) {\n                xmlComment();\n            } else {\n                name = xmlName();\n                attrs = xmlAttrs(name);\n                stack.push(attrs);\n                if (eat(END_SHORT_TAG)) {\n                    call('enter', name, attrs, true);\n                } else {\n                    skip(GREATER_THAN);\n                    call('enter', name, attrs);\n                    xmlContent(name);\n                    if (name != xmlName()) {\n                        croak('Bad closing tag');\n                    }\n                    call('leave', name, attrs);\n                    skipWhitespace();\n                    skip(GREATER_THAN);\n                }\n                stack.pop();\n            }\n        }\n        function xmlContent(name) {\n            var body = [];\n            while (index < data.length) {\n                if (eat(END_TAG)) {\n                    return body.length && call('text', STRING.apply(0, body));\n                } else if (eat(START_CDATA)) {\n                    while (index < data.length && !eat(END_CDATA)) {\n                        readChar(body);\n                    }\n                } else if (eat(LESS_THAN)) {\n                    if (body.length) {\n                        call('text', STRING.apply(0, body));\n                    }\n                    xmlTag();\n                    body = [];\n                } else if (eat(AMPERSAND)) {\n                    xmlEntity(body);\n                } else {\n                    readChar(body);\n                }\n            }\n            croak('Unclosed tag ' + name);\n        }\n        function xmlName() {\n            if (!isNameStart(data[index])) {\n                croak('Expecting XML name');\n            }\n            return readAsciiWhile(isName);\n        }\n        function xmlString() {\n            var quote = eat(QUOTE) || eat(APOSTROPHE);\n            if (!quote) {\n                croak('Expecting string');\n            }\n            var body = [];\n            while (index < data.length) {\n                if (eat(quote)) {\n                    return STRING.apply(0, body);\n                } else if (eat(AMPERSAND)) {\n                    xmlEntity(body);\n                } else {\n                    readChar(body);\n                }\n            }\n            croak('Unfinished string');\n        }\n        function xmlEntity(body) {\n            var code;\n            if (eat(SHARP)) {\n                if (eat(LOWERCASE_X) || eat(UPPERCASE_X)) {\n                    code = parseInt(readAsciiWhile(isHexDigit), 16);\n                } else {\n                    code = parseInt(readAsciiWhile(isDigit), 10);\n                }\n                if (isNaN(code)) {\n                    croak('Bad numeric entity');\n                }\n            } else {\n                var name = xmlName();\n                code = ENTITIES[name];\n                if (code === undefined) {\n                    croak('Unknown entity ' + name);\n                }\n            }\n            UCS2(body, code);\n            skip(SEMICOLON);\n        }\n        function xmlDecl() {\n            call('decl', xmlName(), xmlAttrs());\n            skip(END_DECLARATION);\n        }\n        function xmlAttrs(name) {\n            var map = { $tag: name };\n            while (index < data.length) {\n                skipWhitespace();\n                var code = data[index];\n                if (code == 63 || code == 62 || code == 47) {\n                    break;\n                }\n                map[xmlName()] = (skip(EQUAL), xmlString());\n            }\n            return map;\n        }\n        function call(what, thing, arg1, arg2) {\n            var f = callbacks && callbacks[what];\n            if (f) {\n                f.call(object, thing, arg1, arg2);\n            }\n        }\n        var tmp = [];\n        readChar(tmp);\n        if (tmp[0] != 65279) {\n            index = 0;\n        }\n        while (index < data.length) {\n            skipWhitespace();\n            skip(LESS_THAN);\n            xmlTag();\n            skipWhitespace();\n        }\n    }\n    kendo.util.parseXML = function parseXML() {\n        try {\n            return parse.apply(this, arguments);\n        } catch (ex) {\n            if (ex !== EXIT) {\n                throw ex;\n            }\n        }\n    };\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/commands', [\n        'kendo.core',\n        'kendo.binder',\n        'kendo.window',\n        'kendo.list',\n        'kendo.tabstrip'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var COMMAND_TYPES = {\n            AUTO_FILL: 'autoFill',\n            CLEAR: 'clear',\n            CUT: 'cut',\n            EDIT: 'edit',\n            PASTE: 'paste',\n            VALIDATION: 'validation'\n        };\n        var Command = kendo.spreadsheet.Command = kendo.Class.extend({\n            init: function (options) {\n                this.options = options;\n                this._workbook = options.workbook;\n                this._property = options && options.property;\n                this._state = {};\n            },\n            range: function (range) {\n                if (range !== undefined) {\n                    this._setRange(range);\n                }\n                return this._range;\n            },\n            _setRange: function (range) {\n                this._range = range;\n            },\n            redo: function () {\n                this.range().select();\n                this.exec();\n            },\n            undo: function () {\n                this.setState(this._state);\n            },\n            getState: function () {\n                this._state = this.range().getState(this._property);\n            },\n            setState: function (state) {\n                this.range().setState(state);\n            },\n            rejectState: function (validationState) {\n                this.undo();\n                return {\n                    title: validationState.title,\n                    body: validationState.message,\n                    reason: 'error',\n                    type: 'validationError'\n                };\n            },\n            _forEachCell: function (callback) {\n                var range = this.range();\n                var ref = range._ref;\n                ref.forEach(function (ref) {\n                    range.sheet().forEach(ref.toRangeRef(), callback.bind(this));\n                }.bind(this));\n            },\n            usesImage: function () {\n                return false;\n            }\n        });\n        kendo.spreadsheet.DrawingUpdateCommand = Command.extend({\n            init: function (options) {\n                this._sheet = options.sheet;\n                this._drawing = options.drawing;\n                this._orig = this._drawing.clone();\n                this._previous = options.previous;\n            },\n            exec: function () {\n            },\n            undo: function () {\n                this._drawing.reset(this._previous);\n                this._sheet._activeDrawing = this._drawing;\n                this._sheet.triggerChange({ layout: true });\n            },\n            redo: function () {\n                this._drawing.reset(this._orig);\n                this._sheet._activeDrawing = this._drawing;\n                this._sheet.triggerChange({ layout: true });\n            },\n            usesImage: function (img) {\n                return this._drawing.image === img || this._orig.image === img || this._previous.image === img;\n            }\n        });\n        var DrawingCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._drawing = options.drawing;\n            },\n            usesImage: function (img) {\n                return this._drawing.image === img;\n            }\n        });\n        kendo.spreadsheet.InsertImageCommand = DrawingCommand.extend({\n            init: function (options) {\n                DrawingCommand.fn.init.call(this, options);\n                this._blob = options.blob;\n                this._width = options.width;\n                this._height = options.height;\n            },\n            exec: function () {\n                var range = this.range();\n                var sheet = range.sheet();\n                var width = this._width;\n                var height = this._height;\n                var aspect = width / height;\n                if (width > height) {\n                    width = Math.min(width, 300);\n                    height = width / aspect;\n                } else {\n                    height = Math.min(height, 300);\n                    width = height * aspect;\n                }\n                this._drawing = sheet.addDrawing({\n                    topLeftCell: range.topLeft(),\n                    offsetX: 5,\n                    offsetY: 5,\n                    width: width,\n                    height: height,\n                    opacity: 1,\n                    image: this._workbook.addImage(this._blob)\n                }, true);\n                this._blob = null;\n            },\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet._activeDrawing = null;\n                sheet.removeDrawing(this._drawing);\n            },\n            redo: function () {\n                var sheet = this.range().sheet();\n                sheet._activeDrawing = this._drawing;\n                sheet.addDrawing(this._drawing);\n            }\n        });\n        kendo.spreadsheet.DeleteDrawingCommand = DrawingCommand.extend({\n            exec: function () {\n                var sheet = this.range().sheet();\n                sheet._activeDrawing = null;\n                sheet.removeDrawing(this._drawing);\n            },\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet._activeDrawing = this._drawing;\n                sheet.addDrawing(this._drawing);\n            },\n            redo: function () {\n                this.exec();\n            }\n        });\n        var ReorderDrawingsCommand = DrawingCommand.extend({\n            exec: function () {\n                var sheet = this.range().sheet();\n                this._origIndex = sheet._drawings.indexOf(this._drawing);\n                sheet._drawings.splice(this._origIndex, 1);\n                this._newIndex = this._reorder();\n                sheet._drawings.splice(this._newIndex, 0, this._drawing);\n                sheet.triggerChange({ drawings: true });\n            },\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet._drawings.splice(this._newIndex, 1);\n                sheet._drawings.splice(this._origIndex, 0, this._drawing);\n                sheet.triggerChange({ drawings: true });\n            }\n        });\n        kendo.spreadsheet.BringToFrontCommand = ReorderDrawingsCommand.extend({\n            _reorder: function () {\n                return this.range().sheet()._drawings.length;\n            }\n        });\n        kendo.spreadsheet.SendToBackCommand = ReorderDrawingsCommand.extend({\n            _reorder: function () {\n                return 0;\n            }\n        });\n        var TargetValueCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._target = options.target;\n                this._value = options.value;\n            },\n            exec: function () {\n                this.getState();\n                this.setState(this._value);\n            }\n        });\n        kendo.spreadsheet.ColumnWidthCommand = TargetValueCommand.extend({\n            getState: function () {\n                this._state = this.range().sheet().columnWidth(this._target);\n            },\n            setState: function (state) {\n                this.range().sheet().columnWidth(this._target, state);\n            }\n        });\n        kendo.spreadsheet.RowHeightCommand = TargetValueCommand.extend({\n            getState: function () {\n                this._state = this.range().sheet().rowHeight(this._target);\n            },\n            setState: function (state) {\n                this.range().sheet().rowHeight(this._target, state);\n            }\n        });\n        kendo.spreadsheet.HyperlinkCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._link = options.link;\n            },\n            exec: function () {\n                var range = this.range();\n                this._prevLink = range.link();\n                this._prevUnderline = range.underline();\n                range.link(this._link);\n                range.underline(true);\n                if (range.value() == null) {\n                    this._hasSetValue = true;\n                    range.value(this._link);\n                }\n            },\n            undo: function () {\n                var range = this.range();\n                range.link(this._prevLink);\n                range.underline(this._prevUnderline);\n                if (this._hasSetValue) {\n                    range.value(null);\n                }\n            }\n        });\n        kendo.spreadsheet.GridLinesChangeCommand = TargetValueCommand.extend({\n            getState: function () {\n                this._state = this._range.sheet().showGridLines();\n            },\n            setState: function (v) {\n                this._range.sheet().showGridLines(v);\n            }\n        });\n        var PropertyChangeCommand = kendo.spreadsheet.PropertyChangeCommand = Command.extend({\n            _setRange: function (range) {\n                Command.prototype._setRange.call(this, range.skipHiddenCells());\n            },\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._value = options.value;\n            },\n            exec: function () {\n                var range = this.range();\n                if (range.enable()) {\n                    this.getState();\n                    if (this.options.property === 'format') {\n                        this._workbook.trigger('changeFormat', { range: range });\n                    }\n                    range[this._property](this._value);\n                }\n            }\n        });\n        kendo.spreadsheet.ClearContentCommand = Command.extend({\n            exec: function () {\n                var values = [], range, rowValues, nullValues, validationState, currentRange;\n                if (!this.range().enable()) {\n                    return {\n                        reason: 'error',\n                        type: 'cannotModifyDisabled'\n                    };\n                }\n                if (!this.range().canEditArrayFormula()) {\n                    return {\n                        reason: 'error',\n                        type: 'intersectsArray'\n                    };\n                }\n                this.getState();\n                range = this.range().skipHiddenCells();\n                if (range._ref.refs && range._ref.refs.length > 1) {\n                    range._ref.refs.forEach(function (ref) {\n                        currentRange = range.sheet().range(ref);\n                        values = values.concat(currentRange.values());\n                    });\n                } else {\n                    values = range.values();\n                }\n                nullValues = [];\n                values.forEach(function (row) {\n                    rowValues = [];\n                    row.forEach(function () {\n                        rowValues.push(null);\n                    });\n                    nullValues.push(rowValues);\n                });\n                if (range.sheet().trigger('changing', {\n                        data: nullValues,\n                        range: range,\n                        changeType: COMMAND_TYPES.CLEAR\n                    })) {\n                    return;\n                }\n                range.clearContent();\n                validationState = range._getValidationState();\n                if (validationState) {\n                    return this.rejectState(validationState);\n                }\n            },\n            undo: function () {\n                var range = this.range().skipHiddenCells();\n                var sheet = range.sheet();\n                var data = this._state.data;\n                var values = [];\n                var rowValues;\n                data.forEach(function (row) {\n                    rowValues = [];\n                    row.forEach(function (cell) {\n                        rowValues.push(cell.value);\n                    });\n                    values.push(rowValues);\n                });\n                if (sheet.trigger('changing', {\n                        data: values,\n                        range: range,\n                        changeType: COMMAND_TYPES.CLEAR\n                    })) {\n                    return;\n                }\n                this.setState(this._state);\n            }\n        });\n        kendo.spreadsheet.EditCommand = PropertyChangeCommand.extend({\n            init: function (options) {\n                options.property = options.property || 'input';\n                PropertyChangeCommand.fn.init.call(this, options);\n            },\n            _setRange: function (range) {\n                PropertyChangeCommand.prototype._setRange.apply(this, arguments);\n                this._editRange = this.options.arrayFormula ? range : range.sheet().activeCellSelection();\n            },\n            getState: function () {\n                this._state = this.range().getState();\n            },\n            exec: function () {\n                return this.range().sheet().withCultureDecimals(this._exec.bind(this));\n            },\n            undo: function () {\n                var editRange = this._editRange;\n                var state = this._state;\n                if (editRange.sheet().trigger('changing', {\n                        data: state.data[0][0].value,\n                        range: editRange,\n                        changeType: COMMAND_TYPES.EDIT\n                    })) {\n                    return;\n                }\n                this.setState(this._state);\n            },\n            _exec: function () {\n                var arrayFormula = this.options.arrayFormula;\n                var editRange = this._editRange;\n                if (!editRange.enable()) {\n                    return {\n                        reason: 'error',\n                        type: 'rangeDisabled'\n                    };\n                }\n                if (!editRange.canEditArrayFormula()) {\n                    return {\n                        reason: 'error',\n                        type: 'intersectsArray'\n                    };\n                }\n                var value = this._value;\n                this.getState();\n                if (this.range().sheet().trigger('changing', {\n                        data: value,\n                        range: this._editRange,\n                        changeType: COMMAND_TYPES.EDIT\n                    })) {\n                    return;\n                }\n                if (this._property == 'value') {\n                    editRange.value(value);\n                    return;\n                }\n                try {\n                    editRange.link(null);\n                    if (value === '') {\n                        editRange.value(null);\n                    } else {\n                        editRange.input(value, { arrayFormula: arrayFormula });\n                        if (/\\n/.test(editRange.value())) {\n                            editRange.wrap(true);\n                        }\n                    }\n                    editRange._adjustRowHeight();\n                    var validationState = editRange._getValidationState();\n                    if (validationState) {\n                        return this.rejectState(validationState);\n                    }\n                } catch (ex) {\n                    if (ex instanceof kendo.spreadsheet.calc.ParseError) {\n                        return {\n                            title: 'Error in formula',\n                            body: ex + '',\n                            reason: 'error'\n                        };\n                    } else {\n                        throw ex;\n                    }\n                }\n            }\n        });\n        kendo.spreadsheet.InsertCommentCommand = PropertyChangeCommand.extend({\n            init: function (options) {\n                options.property = 'comment';\n                PropertyChangeCommand.fn.init.call(this, options);\n            }\n        });\n        kendo.spreadsheet.TextWrapCommand = PropertyChangeCommand.extend({\n            init: function (options) {\n                options.property = 'wrap';\n                PropertyChangeCommand.fn.init.call(this, options);\n                this._value = options.value;\n            },\n            getState: function () {\n                var rowHeight = {};\n                this.range().forEachRow(function (range) {\n                    var index = range.topLeft().row;\n                    rowHeight[index] = range.sheet().rowHeight(index);\n                });\n                this._state = this.range().getState(this._property);\n                this._rowHeight = rowHeight;\n            },\n            undo: function () {\n                var sheet = this.range().sheet();\n                var rowHeight = this._rowHeight;\n                this.range().setState(this._state);\n                for (var row in rowHeight) {\n                    sheet.rowHeight(row, rowHeight[row]);\n                }\n            }\n        });\n        kendo.spreadsheet.AdjustDecimalsCommand = Command.extend({\n            init: function (options) {\n                this._delta = options.value;\n                options.property = 'format';\n                Command.fn.init.call(this, options);\n            },\n            exec: function () {\n                var sheet = this.range().sheet();\n                var delta = this._delta;\n                var formatting = kendo.spreadsheet.formatting;\n                this.getState();\n                sheet.batch(function () {\n                    this.range().forEachCell(function (row, col, cell) {\n                        var format = cell.format;\n                        if (!format) {\n                            var value = cell.value;\n                            if (typeof value == 'number' && /\\./.test(value)) {\n                                format = '0.' + String(value).split('.')[1].replace(/\\d/g, '0');\n                            }\n                        }\n                        if (format || delta > 0) {\n                            format = formatting.adjustDecimals(format || '0', delta);\n                            sheet.range(row, col).format(format);\n                        }\n                    });\n                }.bind(this));\n            }\n        });\n        kendo.spreadsheet.BorderChangeCommand = Command.extend({\n            init: function (options) {\n                options.property = 'border';\n                Command.fn.init.call(this, options);\n                this._type = options.border;\n                this._style = options.style;\n            },\n            _batch: function (f) {\n                return this.range().sheet().batch(f, {});\n            },\n            exec: function () {\n                var self = this;\n                self.getState();\n                self._batch(function () {\n                    self[self._type](self._style);\n                });\n            },\n            noBorders: function () {\n                this.range().insideBorders(null);\n                this.outsideBorders(null);\n            },\n            allBorders: function (style) {\n                this.range().insideBorders(style);\n                this.outsideBorders(style);\n            },\n            leftBorder: function (style) {\n                this.range().leftColumn().borderLeft(style);\n            },\n            rightBorder: function (style) {\n                this.range().rightColumn().borderRight(style);\n            },\n            topBorder: function (style) {\n                this.range().topRow().borderTop(style);\n            },\n            bottomBorder: function (style) {\n                this.range().bottomRow().borderBottom(style);\n            },\n            outsideBorders: function (style) {\n                var range = this.range();\n                range.leftColumn().borderLeft(style);\n                range.topRow().borderTop(style);\n                range.rightColumn().borderRight(style);\n                range.bottomRow().borderBottom(style);\n            },\n            insideBorders: function (style) {\n                this.range().insideBorders(style);\n                this.outsideBorders(null);\n            },\n            insideHorizontalBorders: function (style) {\n                this.range().insideHorizontalBorders(style);\n            },\n            insideVerticalBorders: function (style) {\n                this.range().insideVerticalBorders(style);\n            }\n        });\n        kendo.spreadsheet.MergeCellCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._type = options.value;\n            },\n            exec: function () {\n                this.getState();\n                this[this._type]();\n            },\n            activate: function (ref) {\n                this.range().sheet().activeCell(ref);\n            },\n            getState: function () {\n                this._state = this.range().getState();\n            },\n            undo: function () {\n                if (this._type !== 'unmerge') {\n                    this.range().unmerge();\n                    this.activate(this.range().topLeft());\n                }\n                this.range().setState(this._state);\n            },\n            cells: function () {\n                var range = this.range();\n                var ref = range._ref;\n                range.merge();\n                this.activate(ref);\n            },\n            horizontally: function () {\n                var ref = this.range().topRow()._ref;\n                this.range().forEachRow(function (range) {\n                    range.merge();\n                });\n                this.activate(ref);\n            },\n            vertically: function () {\n                var ref = this.range().leftColumn()._ref;\n                this.range().forEachColumn(function (range) {\n                    range.merge();\n                });\n                this.activate(ref);\n            },\n            unmerge: function () {\n                var range = this.range();\n                var ref = range._ref.topLeft;\n                range.unmerge();\n                this.activate(ref);\n            }\n        });\n        kendo.spreadsheet.FreezePanesCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._type = options.value;\n            },\n            exec: function () {\n                this.getState();\n                this._topLeft = this.range().topLeft();\n                this[this._type]();\n            },\n            getState: function () {\n                this._state = this.range().sheet().getState();\n            },\n            undo: function () {\n                this.range().sheet().setState(this._state);\n            },\n            panes: function () {\n                var topLeft = this._topLeft;\n                var sheet = this.range().sheet();\n                sheet.frozenColumns(topLeft.col).frozenRows(topLeft.row);\n            },\n            rows: function () {\n                var topLeft = this._topLeft;\n                var sheet = this.range().sheet();\n                sheet.frozenRows(topLeft.row);\n            },\n            columns: function () {\n                var topLeft = this._topLeft;\n                var sheet = this.range().sheet();\n                sheet.frozenColumns(topLeft.col);\n            },\n            unfreeze: function () {\n                var sheet = this.range().sheet();\n                sheet.frozenRows(0).frozenColumns(0);\n            }\n        });\n        kendo.spreadsheet.PasteCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n                this._clipboard.parse();\n                this._event = options.event;\n                this._clipboardContent = this._clipboard._content;\n                this._clipboardPasteRef = this._clipboard.pasteRef();\n                this._sheet = this._workbook.activeSheet();\n                this._range = this._sheet.range(this._clipboard.pasteRef());\n                this._state = this._range.getState();\n            },\n            exec: function () {\n                return this.range().sheet().withCultureDecimals(this._exec.bind(this));\n            },\n            undo: function () {\n                var sheet = this._sheet;\n                var range = sheet.range(this._clipboardPasteRef);\n                if (sheet.trigger('changing', {\n                        data: this._state.data,\n                        range: range,\n                        changeType: COMMAND_TYPES.PASTE\n                    })) {\n                    return;\n                }\n                this.setState(this._state);\n            },\n            _exec: function () {\n                var status = this._clipboard.canPaste();\n                if (!status.canPaste) {\n                    if (status.menuInvoked) {\n                        return {\n                            reason: 'error',\n                            type: 'useKeyboard'\n                        };\n                    }\n                    if (status.pasteOnMerged) {\n                        return {\n                            reason: 'error',\n                            type: 'modifyMerged'\n                        };\n                    }\n                    if (status.overflow) {\n                        return {\n                            reason: 'error',\n                            type: 'overflow'\n                        };\n                    }\n                    if (status.pasteOnDisabled) {\n                        this._event.preventDefault();\n                        return {\n                            reason: 'error',\n                            type: 'cannotModifyDisabled'\n                        };\n                    }\n                    return { reason: 'error' };\n                }\n                var range = this._sheet.range(this._clipboardPasteRef);\n                if (this._workbook.trigger('paste', {\n                        range: range,\n                        clipboardContent: this._clipboardContent\n                    }) || this._sheet.trigger('changing', {\n                        data: this._clipboardContent.data,\n                        range: range,\n                        changeType: COMMAND_TYPES.PASTE\n                    })) {\n                    this._event.preventDefault();\n                    return;\n                } else {\n                    this._sheet.range(this._clipboardPasteRef).setState(this._clipboardContent, this._clipboard);\n                    range._adjustRowHeight();\n                }\n            }\n        });\n        kendo.spreadsheet.AdjustRowHeightCommand = Command.extend({\n            exec: function () {\n                var options = this.options;\n                var sheet = this._workbook.activeSheet();\n                var range = options.range || sheet.range(options.rowIndex);\n                range._adjustRowHeight();\n            }\n        });\n        kendo.spreadsheet.ToolbarPasteCommand = Command.extend({\n            exec: function () {\n                if (kendo.support.clipboard.paste) {\n                    this._workbook._view.clipboard.focus().select();\n                    document.execCommand('paste');\n                } else {\n                    return {\n                        reason: 'error',\n                        type: 'useKeyboard'\n                    };\n                }\n            }\n        });\n        kendo.spreadsheet.CutCommand = Command.extend({\n            _eventType: 'cut',\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n                this._event = options.event;\n            },\n            exec: function () {\n                var status = this._clipboard.canCopy();\n                var data = [], rangeValues, currentRow;\n                if (!status.canCopy) {\n                    if (status.menuInvoked) {\n                        return {\n                            reason: 'error',\n                            type: 'useKeyboard'\n                        };\n                    } else if (status.multiSelection) {\n                        return {\n                            reason: 'error',\n                            type: 'unsupportedSelection'\n                        };\n                    }\n                    return;\n                }\n                var range = this._workbook.activeSheet().selection();\n                if (this._eventType == 'cut') {\n                    if (!range.enable()) {\n                        this._event.preventDefault();\n                        return {\n                            reason: 'error',\n                            type: 'cannotModifyDisabled'\n                        };\n                    }\n                    this.getState();\n                }\n                if (this._workbook.trigger(this._eventType, { range: range })) {\n                    this._event.preventDefault();\n                } else if (this._eventType == 'cut') {\n                    rangeValues = range.values();\n                    rangeValues.forEach(function (row) {\n                        currentRow = [];\n                        row.forEach(function () {\n                            currentRow.push({});\n                        });\n                        data.push(currentRow);\n                    });\n                    if (range.sheet().trigger('changing', {\n                            data: data,\n                            range: range,\n                            changeType: COMMAND_TYPES.CUT\n                        })) {\n                        return;\n                    }\n                    this._clipboard.cut();\n                } else {\n                    this._clipboard.copy();\n                }\n            },\n            undo: function () {\n                var range = this.range();\n                if (range.sheet().trigger('changing', {\n                        data: this._state.data,\n                        range: range,\n                        changeType: COMMAND_TYPES.CUT\n                    })) {\n                    return;\n                }\n                this.setState(this._state);\n            }\n        });\n        kendo.spreadsheet.CopyCommand = kendo.spreadsheet.CutCommand.extend({\n            _eventType: 'copy',\n            undo: $.noop\n        });\n        function copyToClipboard(html) {\n            var textarea = document.createElement('textarea');\n            $(textarea).addClass('k-spreadsheet-clipboard').val(html).appendTo(document.body).focus().select();\n            document.execCommand('copy');\n            $(textarea).remove();\n        }\n        kendo.spreadsheet.ToolbarCopyCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n            },\n            undo: $.noop,\n            exec: function () {\n                if (kendo.support.clipboard.copy) {\n                    var clipboard = this._workbook._view.clipboard;\n                    copyToClipboard(clipboard.html());\n                    clipboard.trigger('copy');\n                } else {\n                    return {\n                        reason: 'error',\n                        type: 'useKeyboard'\n                    };\n                }\n            }\n        });\n        kendo.spreadsheet.AutoFillCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n            },\n            origin: function (origin) {\n                this._origin = origin;\n            },\n            exec: function () {\n                var range = this.range(), autoFillData;\n                if (!range.enable()) {\n                    return {\n                        reason: 'error',\n                        type: 'rangeDisabled'\n                    };\n                }\n                if (range.intersectingArrayFormula()) {\n                    return {\n                        reason: 'error',\n                        type: 'intersectsArray'\n                    };\n                }\n                this.getState();\n                try {\n                    autoFillData = range._previewFillFrom(this._origin);\n                    if (range.sheet().trigger('changing', {\n                            data: autoFillData.props,\n                            range: autoFillData.dest,\n                            changeType: COMMAND_TYPES.AUTO_FILL\n                        })) {\n                        return;\n                    }\n                    autoFillData.dest._properties(autoFillData.props, true);\n                } catch (ex) {\n                    if (ex instanceof kendo.spreadsheet.Range.FillError) {\n                        return {\n                            reason: 'error',\n                            type: ex.code\n                        };\n                    }\n                    throw ex;\n                }\n            },\n            undo: function () {\n                var range = this.range();\n                var state = this._state;\n                if (range.sheet().trigger('changing', {\n                        data: state.data,\n                        range: range,\n                        changeType: COMMAND_TYPES.AUTO_FILL\n                    })) {\n                    return;\n                }\n                this.setState(this._state);\n            }\n        });\n        kendo.spreadsheet.ToolbarCutCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n            },\n            exec: function () {\n                if (kendo.support.clipboard.copy) {\n                    var clipboard = this._workbook._view.clipboard;\n                    copyToClipboard(clipboard.html());\n                    clipboard.trigger('cut');\n                } else {\n                    return {\n                        reason: 'error',\n                        type: 'useKeyboard'\n                    };\n                }\n            }\n        });\n        kendo.spreadsheet.FilterCommand = Command.extend({\n            undo: function () {\n                this.range().filter(this._state);\n            },\n            exec: function () {\n                var range = this.range();\n                this._state = range.hasFilter();\n                range.filter(!this._state);\n            }\n        });\n        kendo.spreadsheet.SortCommand = Command.extend({\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet.setState(this._state);\n            },\n            exec: function () {\n                var range = this.range();\n                var sheet = range.sheet();\n                var activeCell = sheet.activeCell();\n                var col = this.options.sheet ? activeCell.topLeft.col : this.options.column || 0;\n                var ascending = this.options.value === 'asc' ? true : false;\n                this._state = sheet.getState();\n                if (this.options.sheet) {\n                    range = this.expandRange();\n                }\n                var reason = range.cantSort();\n                if (reason) {\n                    return {\n                        reason: 'error',\n                        type: reason.code\n                    };\n                }\n                range.sort({\n                    column: col,\n                    ascending: ascending\n                });\n            },\n            expandRange: function () {\n                var sheet = this.range().sheet();\n                return new kendo.spreadsheet.Range(sheet._sheetRef, sheet);\n            }\n        });\n        var ApplyFilterCommand = kendo.spreadsheet.ApplyFilterCommand = Command.extend({\n            column: function () {\n                return this.options.column || 0;\n            },\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet.clearFilter(this.column());\n                if (this._state.length) {\n                    this.range().filter(this._state);\n                }\n            },\n            getState: function () {\n                var sheet = this.range().sheet();\n                var current = sheet.filter();\n                if (current) {\n                    this._state = current.columns.filter(function (c) {\n                        return c.index == this.column();\n                    }.bind(this));\n                }\n            },\n            exec: function () {\n                var range = this.range();\n                var column = this.column();\n                var current = range.sheet().filter();\n                var options;\n                var filterRule;\n                var exists = false;\n                if (this.options.valueFilter) {\n                    filterRule = {\n                        column: column,\n                        filter: new kendo.spreadsheet.ValueFilter(this.options.valueFilter)\n                    };\n                } else if (this.options.customFilter) {\n                    filterRule = {\n                        column: column,\n                        filter: new kendo.spreadsheet.CustomFilter(this.options.customFilter)\n                    };\n                }\n                this.getState();\n                if (current && current.ref.eq(range._ref) && current.columns.length) {\n                    current.columns.forEach(function (element) {\n                        if (element.index === column) {\n                            exists = true;\n                        }\n                    });\n                    options = current.columns.map(function (element) {\n                        return element.index === column ? filterRule : {\n                            column: element.index,\n                            filter: element.filter\n                        };\n                    });\n                    if (!exists) {\n                        options.push(filterRule);\n                    }\n                } else {\n                    options = filterRule;\n                }\n                range.filter(options);\n            }\n        });\n        kendo.spreadsheet.ClearFilterCommand = ApplyFilterCommand.extend({\n            exec: function () {\n                var range = this.range();\n                var column = this.column();\n                this.getState();\n                range.clearFilter(column);\n            }\n        });\n        kendo.spreadsheet.HideLineCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this.axis = options.axis;\n            },\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet.setAxisState(this._state);\n            },\n            exec: function () {\n                var sheet = this.range().sheet();\n                this._state = sheet.getAxisState();\n                if (this.axis == 'row') {\n                    sheet.axisManager().hideSelectedRows();\n                } else {\n                    sheet.axisManager().hideSelectedColumns();\n                }\n            }\n        });\n        kendo.spreadsheet.UnHideLineCommand = kendo.spreadsheet.HideLineCommand.extend({\n            exec: function () {\n                var sheet = this.range().sheet();\n                this._state = sheet.getAxisState();\n                if (this.axis == 'row') {\n                    sheet.axisManager().unhideSelectedRows();\n                } else {\n                    sheet.axisManager().unhideSelectedColumns();\n                }\n            }\n        });\n        var DeleteCommand = Command.extend({\n            exec: function () {\n                this._expandedRange = this._expand(this.range());\n                this._state = this._expandedRange.getState();\n                this._indexes = this._exec(this._expandedRange.sheet());\n            },\n            undo: function () {\n                var self = this;\n                var range = self._expandedRange;\n                var sheet = range.sheet();\n                sheet.batch(function () {\n                    self._indexes.forEach(function (x) {\n                        self._undoOne(sheet, x);\n                        sheet._restoreModifiedFormulas(x.formulas);\n                    });\n                    range.setState(self._state);\n                }, {\n                    layout: true,\n                    recalc: true,\n                    ref: range._ref\n                });\n            }\n        });\n        kendo.spreadsheet.DeleteRowCommand = DeleteCommand.extend({\n            _expand: function (range) {\n                return range.resize({\n                    left: -Infinity,\n                    right: +Infinity\n                });\n            },\n            _exec: function (sheet) {\n                return sheet.axisManager().deleteSelectedRows();\n            },\n            _undoOne: function (sheet, x) {\n                sheet.insertRow(x.index);\n                sheet.rowHeight(x.index, x.height);\n            }\n        });\n        kendo.spreadsheet.DeleteColumnCommand = DeleteCommand.extend({\n            _expand: function (range) {\n                return range.resize({\n                    top: -Infinity,\n                    bottom: +Infinity\n                });\n            },\n            _exec: function (sheet) {\n                return sheet.axisManager().deleteSelectedColumns();\n            },\n            _undoOne: function (sheet, x) {\n                sheet.insertColumn(x.index);\n                sheet.columnWidth(x.index, x.width);\n            }\n        });\n        var AddCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._value = options.value;\n            },\n            undo: function () {\n                var self = this;\n                var sheet = self.range().sheet();\n                sheet.batch(function () {\n                    for (var i = self._pos.count; --i >= 0;) {\n                        self._undoOne(sheet, self._pos.base);\n                    }\n                }, {\n                    layout: true,\n                    recalc: true\n                });\n            }\n        });\n        kendo.spreadsheet.AddColumnCommand = AddCommand.extend({\n            exec: function () {\n                var sheet = this.range().sheet();\n                var result = sheet.axisManager().preventAddColumn();\n                if (result) {\n                    return result;\n                }\n                if (this._value === 'left') {\n                    this._pos = sheet.axisManager().addColumnLeft();\n                } else {\n                    this._pos = sheet.axisManager().addColumnRight();\n                }\n            },\n            _undoOne: function (sheet, index) {\n                sheet.deleteColumn(index);\n            }\n        });\n        kendo.spreadsheet.AddRowCommand = AddCommand.extend({\n            exec: function () {\n                var sheet = this.range().sheet();\n                var result = sheet.axisManager().preventAddRow();\n                if (result) {\n                    return result;\n                }\n                if (this._value === 'above') {\n                    this._pos = sheet.axisManager().addRowAbove();\n                } else {\n                    this._pos = sheet.axisManager().addRowBelow();\n                }\n            },\n            _undoOne: function (sheet, index) {\n                sheet.deleteRow(index);\n            }\n        });\n        kendo.spreadsheet.EditValidationCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._value = options.value;\n            },\n            exec: function () {\n                var self = this, sheet = self.range().sheet();\n                this.getState();\n                if (sheet.trigger('changing', {\n                        data: self._value,\n                        range: self.range(),\n                        changeType: COMMAND_TYPES.VALIDATION\n                    })) {\n                    return;\n                }\n                sheet.withCultureDecimals(function () {\n                    self.range().validation(self._value);\n                });\n            },\n            undo: function () {\n                var editRange = this.range();\n                var state = this._state;\n                if (editRange.sheet().trigger('changing', {\n                        data: state.data[0][0].validation,\n                        range: editRange,\n                        changeType: COMMAND_TYPES.VALIDATION\n                    })) {\n                    return;\n                }\n                this.setState(this._state);\n            }\n        });\n        kendo.spreadsheet.OpenCommand = Command.extend({\n            cannotUndo: true,\n            exec: function () {\n                var file = this.options.file;\n                if (file.name.match(/.xlsx$/i) === null) {\n                    return {\n                        reason: 'error',\n                        type: 'openUnsupported'\n                    };\n                }\n                var workbook = this.options.workbook;\n                workbook.fromFile(this.options.file).then(function () {\n                    var errors = workbook.excelImportErrors;\n                    if (errors && errors.length) {\n                        workbook._view.openDialog('importError', { errors: errors });\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.SaveAsCommand = Command.extend({\n            exec: function () {\n                var fileName = this.options.name + this.options.extension;\n                if (this.options.extension === '.xlsx') {\n                    this.options.workbook.saveAsExcel({ fileName: fileName });\n                } else if (this.options.extension === '.pdf') {\n                    this.options.workbook.saveAsPDF($.extend(this.options.pdf, {\n                        workbook: this.options.workbook,\n                        fileName: fileName\n                    }));\n                }\n            }\n        });\n        var NameCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._name = options.name;\n                this._value = options.value;\n            },\n            getState: function () {\n                this._state = this._workbook.nameDefinition(this._name);\n            },\n            setState: function () {\n                this._workbook.nameDefinition(this._name, this._state);\n                this._workbook.trigger('change', { recalc: true });\n            }\n        });\n        kendo.spreadsheet.DefineNameCommand = NameCommand.extend({\n            exec: function () {\n                this.getState();\n                try {\n                    this._workbook.defineName(this._name, this._value);\n                    this._workbook.trigger('change', { recalc: true });\n                } catch (ex) {\n                    return {\n                        title: 'Error',\n                        body: ex + '',\n                        reason: 'error'\n                    };\n                }\n            }\n        });\n        kendo.spreadsheet.DeleteNameCommand = NameCommand.extend({\n            exec: function () {\n                this.getState();\n                this._workbook.undefineName(this._name);\n                this._workbook.trigger('change', { recalc: true });\n            }\n        });\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/formulabar', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var classNames = { wrapper: 'k-spreadsheet-formula-bar' };\n        var FormulaBar = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                kendo.ui.Widget.call(this, element, options);\n                element = this.element.addClass(FormulaBar.classNames.wrapper);\n                this.formulaInput = new kendo.spreadsheet.FormulaInput($('<div/>').appendTo(element));\n            },\n            destroy: function () {\n                if (this.formulaInput) {\n                    this.formulaInput.destroy();\n                }\n                this.formulaInput = null;\n            }\n        });\n        kendo.spreadsheet.FormulaBar = FormulaBar;\n        $.extend(true, FormulaBar, { classNames: classNames });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/formulainput', ['kendo.core'], f);\n}(function () {\n    (function (kendo, window) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Widget = kendo.ui.Widget;\n        var ns = '.kendoFormulaInput';\n        var keys = kendo.keys;\n        var classNames = {\n            wrapper: 'k-spreadsheet-formula-input',\n            listWrapper: 'k-spreadsheet-formula-list'\n        };\n        var styles = [\n            'font-family',\n            'font-size',\n            'font-stretch',\n            'font-style',\n            'font-weight',\n            'letter-spacing',\n            'text-transform',\n            'line-height'\n        ];\n        var KEY_NAMES = {\n            27: 'esc',\n            37: 'left',\n            39: 'right',\n            35: 'end',\n            36: 'home',\n            32: 'spacebar'\n        };\n        var PRIVATE_FORMULA_CHECK = /(^_|[^a-z0-9]$)/i;\n        var FormulaInput = Widget.extend({\n            init: function (element, options) {\n                Widget.call(this, element, options);\n                element = this.element;\n                element.addClass(FormulaInput.classNames.wrapper).attr('contenteditable', true).attr('spellcheck', false).css('white-space', 'pre');\n                if (this.options.autoScale) {\n                    element.on('input', this.scale.bind(this));\n                }\n                this._highlightedRefs = [];\n                this._staticTokens = [];\n                this._formulaSource();\n                this._formulaList();\n                this._popup();\n                this._tooltip();\n                element.on('keydown', this._keydown.bind(this)).on('keyup', this._keyup.bind(this)).on('blur', this._blur.bind(this)).on('input click', this._input.bind(this)).on('focus', this._focus.bind(this)).on('paste', this._paste.bind(this));\n            },\n            options: {\n                name: 'FormulaInput',\n                autoScale: false,\n                filterOperator: 'startswith',\n                scalePadding: 30,\n                minLength: 1\n            },\n            events: [\n                'keyup',\n                'focus'\n            ],\n            enable: function (enable) {\n                if (enable === undefined) {\n                    return this.element.attr('contenteditable') === 'true';\n                }\n                if (enable) {\n                    this.element.attr('contenteditable', enable);\n                } else {\n                    this.element.removeAttr('contenteditable');\n                }\n                this.element.toggleClass('k-state-disabled', !enable);\n            },\n            getPos: function () {\n                var div = this.element[0];\n                var sel = window.getSelection();\n                var a = lookup(sel.focusNode, sel.focusOffset);\n                var b = lookup(sel.anchorNode, sel.anchorOffset);\n                if (a != null && b != null) {\n                    if (a > b) {\n                        var tmp = a;\n                        a = b;\n                        b = tmp;\n                    }\n                    return {\n                        begin: a,\n                        end: b,\n                        collapsed: a == b\n                    };\n                }\n                function lookup(lookupNode, pos) {\n                    try {\n                        (function loop(node) {\n                            if (node === lookupNode) {\n                                throw pos;\n                            } else if (node.nodeType == 1) {\n                                for (var i = node.firstChild; i; i = i.nextSibling) {\n                                    loop(i);\n                                }\n                            } else if (node.nodeType == 3) {\n                                pos += node.nodeValue.length;\n                            }\n                        }(div));\n                    } catch (index) {\n                        return index;\n                    }\n                }\n            },\n            setPos: function (begin, end) {\n                var eiv = this.element[0];\n                begin = lookup(eiv, begin);\n                if (end != null) {\n                    end = lookup(eiv, end);\n                } else {\n                    end = begin;\n                }\n                if (begin && end) {\n                    var range = document.createRange();\n                    range.setStart(begin.node, begin.pos);\n                    range.setEnd(end.node, end.pos);\n                    var sel = window.getSelection();\n                    var currentRange = sel.getRangeAt(0);\n                    if (differ(range, currentRange)) {\n                        sel.removeAllRanges();\n                        sel.addRange(range);\n                    }\n                }\n                function differ(a, b) {\n                    return a.startOffset != b.startOffset || a.endOffset != b.endOffset || a.startContainer != b.endContainer || a.endContainer != b.endContainer;\n                }\n                function lookup(node, pos) {\n                    try {\n                        (function loop(node) {\n                            if (node.nodeType == 3) {\n                                var len = node.nodeValue.length;\n                                if (len >= pos) {\n                                    throw node;\n                                }\n                                pos -= len;\n                            } else if (node.nodeType == 1) {\n                                for (var i = node.firstChild; i; i = i.nextSibling) {\n                                    loop(i);\n                                }\n                            }\n                        }(node));\n                    } catch (el) {\n                        return {\n                            node: el,\n                            pos: pos\n                        };\n                    }\n                }\n            },\n            end: function () {\n                this.setPos(this.length());\n            },\n            home: function () {\n                this.setPos(0);\n            },\n            select: function () {\n                this.setPos(0, this.length());\n            },\n            length: function () {\n                return this.value().length;\n            },\n            _formulaSource: function () {\n                var result = [];\n                var value;\n                for (var key in kendo.spreadsheet.calc.runtime.FUNCS) {\n                    if (!PRIVATE_FORMULA_CHECK.test(key)) {\n                        value = key.toUpperCase();\n                        result.push({\n                            value: value,\n                            text: value\n                        });\n                    }\n                }\n                this.formulaSource = new kendo.data.DataSource({ data: result });\n            },\n            _formulaList: function () {\n                this.list = new kendo.ui.StaticList($('<ul />').addClass(FormulaInput.classNames.listWrapper).insertAfter(this.element), {\n                    autoBind: false,\n                    selectable: true,\n                    change: this._formulaListChange.bind(this),\n                    dataSource: this.formulaSource,\n                    dataValueField: 'value',\n                    template: '#:data.value#'\n                });\n                this.list.element.on('mousedown', function (e) {\n                    e.preventDefault();\n                });\n            },\n            _formulaListChange: function () {\n                var tokenCtx = this._tokenContext();\n                if (!tokenCtx || this._mute) {\n                    return;\n                }\n                var activeToken = tokenCtx.token;\n                var completion = this.list.value()[0];\n                var ctx = {\n                    replace: true,\n                    token: activeToken,\n                    end: activeToken.end\n                };\n                if (!tokenCtx.nextToken || tokenCtx.nextToken.value != '(') {\n                    completion += '(';\n                }\n                this._replaceAt(ctx, completion);\n                this.popup.close();\n            },\n            _popup: function () {\n                this.popup = new kendo.ui.Popup(this.list.element, { anchor: this.element });\n            },\n            _blur: function () {\n                this.popup.close();\n                clearTimeout(this._focusId);\n                this.trigger('blur');\n            },\n            _isFormula: function () {\n                return /^=/.test(this.value());\n            },\n            _keydown: function (e) {\n                var key = e.keyCode;\n                if (KEY_NAMES[key]) {\n                    this.popup.close();\n                    this._navigated = true;\n                } else if (this._move(key)) {\n                    this._navigated = true;\n                    e.preventDefault();\n                }\n                this._keyDownTimeout = setTimeout(this._syntaxHighlight.bind(this));\n            },\n            _keyup: function () {\n                var popup = this.popup;\n                var value;\n                if (this._isFormula() && !this._navigated) {\n                    value = ((this._tokenContext() || {}).token || {}).value;\n                    this.filter(value);\n                    if (!value || !this.formulaSource.view().length) {\n                        popup.close();\n                    } else {\n                        popup[popup.visible() ? 'position' : 'open']();\n                        this.list.focusFirst();\n                    }\n                }\n                this._navigated = false;\n                this._syntaxHighlight();\n                this.trigger('keyup');\n            },\n            _input: function () {\n                this._syntaxHighlight();\n            },\n            _focus: function () {\n                setTimeout(this._sync.bind(this));\n                this._focusTimeout = setTimeout(this._syntaxHighlight.bind(this));\n                this.trigger('focus');\n            },\n            _paste: function (ev) {\n                ev.preventDefault();\n                var pos = this.getPos();\n                var text;\n                if (kendo.support.browser.msie) {\n                    text = window.clipboardData.getData('Text');\n                } else {\n                    text = ev.originalEvent.clipboardData.getData('text/plain');\n                }\n                var val = this.value();\n                val = val.substr(0, pos.begin) + text + val.substr(pos.end);\n                this.value(val);\n                this.setPos(pos.begin + text.length);\n                this.scale();\n            },\n            _move: function (key) {\n                var list = this.list;\n                var popup = this.popup;\n                if (popup.visible()) {\n                    if (key === keys.DOWN) {\n                        list.focusNext();\n                        if (!list.focus()) {\n                            list.focusFirst();\n                        }\n                        return true;\n                    }\n                    if (key === keys.UP) {\n                        list.focusPrev();\n                        if (!list.focus()) {\n                            list.focusLast();\n                        }\n                        return true;\n                    }\n                    if (key === keys.ENTER) {\n                        list.select(list.focus());\n                        popup.close();\n                        return true;\n                    }\n                    if (key === keys.TAB) {\n                        list.select(list.focus());\n                        popup.close();\n                        return true;\n                    }\n                    if (key === keys.PAGEUP) {\n                        list.focusFirst();\n                        return true;\n                    }\n                    if (key === keys.PAGEDOWN) {\n                        list.focusLast();\n                        return true;\n                    }\n                }\n                return key === keys.ENTER || key === keys.TAB;\n            },\n            _tokenContext: function () {\n                var point = this.getPos();\n                var value = this.value();\n                if (!value || !point || !point.collapsed) {\n                    return null;\n                }\n                var tokens = kendo.spreadsheet.calc.tokenize(value, this.row(), this.col());\n                var tok;\n                for (var i = 0; i < tokens.length; ++i) {\n                    tok = tokens[i];\n                    if (touches(tok, point) && /^(?:str|sym|func)$/.test(tok.type)) {\n                        return {\n                            token: tok,\n                            nextToken: tokens[i + 1]\n                        };\n                    }\n                }\n                return null;\n            },\n            _sync: function () {\n                if (this._editorToSync && this.isActive()) {\n                    this._editorToSync.value(this.value());\n                }\n            },\n            _textContainer: function () {\n                var computedStyles = kendo.getComputedStyles(this.element[0], styles);\n                computedStyles.position = 'absolute';\n                computedStyles.visibility = 'hidden';\n                computedStyles.whiteSpace = 'pre';\n                computedStyles.top = -3333;\n                computedStyles.left = -3333;\n                this._span = $('<span style=\\'white-space: pre\\'/>').css(computedStyles).insertAfter(this.element);\n            },\n            _tooltip: function () {\n                this._cellTooltip = $('<div class=\"k-widget k-tooltip\" style=\"position:absolute; display:none\">A1</div>').insertAfter(this.element);\n            },\n            tooltip: function (value) {\n                this._cellTooltip.text(value);\n            },\n            toggleTooltip: function (show) {\n                this._cellTooltip.toggle(show);\n            },\n            isActive: function () {\n                return this.element[0] === kendo._activeElement();\n            },\n            filter: function (value) {\n                if (!value || value.length < this.options.minLength) {\n                    return;\n                }\n                this._mute = true;\n                this.list.select(-1);\n                this._mute = false;\n                this.formulaSource.filter({\n                    field: this.list.options.dataValueField,\n                    operator: this.options.filterOperator,\n                    value: value\n                });\n            },\n            hide: function () {\n                this.enable(false);\n                this.element.hide();\n                this._cellTooltip.hide();\n            },\n            show: function () {\n                this.enable(true);\n                this.element.show();\n            },\n            row: function () {\n                if (this.activeCell) {\n                    return this.activeCell.row;\n                }\n            },\n            col: function () {\n                if (this.activeCell) {\n                    return this.activeCell.col;\n                }\n            },\n            position: function (rectangle) {\n                if (!rectangle) {\n                    return;\n                }\n                this.show();\n                this.element.css({\n                    'top': rectangle.top + 1 + 'px',\n                    'left': rectangle.left + 1 + 'px'\n                });\n                this._cellTooltip.css({\n                    'top': rectangle.top - this._cellTooltip.height() - 10 + 'px',\n                    'left': rectangle.left\n                });\n            },\n            resize: function (rectangle) {\n                if (!rectangle) {\n                    return;\n                }\n                this.element.css({\n                    width: rectangle.width - 1,\n                    height: rectangle.height - 1\n                });\n            },\n            canInsertRef: function (isKeyboardAction) {\n                var result = this._canInsertRef(isKeyboardAction);\n                var token = result && result.token;\n                var idx;\n                if (token) {\n                    for (idx = 0; idx < this._staticTokens.length; idx++) {\n                        if (isEqualToken(token, this._staticTokens[idx])) {\n                            return null;\n                        }\n                    }\n                }\n                return result;\n            },\n            _canInsertRef: function (isKeyboardAction) {\n                if (this.popup.visible()) {\n                    return null;\n                }\n                var strictMode = isKeyboardAction;\n                var point = this.getPos();\n                var tokens, tok;\n                if (point && this._isFormula()) {\n                    if (point.begin === 0) {\n                        return null;\n                    }\n                    tokens = kendo.spreadsheet.calc.tokenize(this.value(), this.row(), this.col());\n                    for (var i = 0; i < tokens.length; ++i) {\n                        tok = tokens[i];\n                        if (touches(tok, point)) {\n                            return canReplace(tok);\n                        }\n                        if (afterPoint(tok)) {\n                            return canInsertBetween(tokens[i - 1], tok);\n                        }\n                    }\n                    return canInsertBetween(tok, null);\n                }\n                return null;\n                function afterPoint(tok) {\n                    return tok.begin > point.begin;\n                }\n                function canReplace(tok) {\n                    if (tok) {\n                        if (/^(?:num|str|bool|sym|ref)$/.test(tok.type)) {\n                            return {\n                                replace: true,\n                                token: tok,\n                                end: tok.end\n                            };\n                        }\n                        if (/^(?:op|punc|startexp)$/.test(tok.type)) {\n                            if (tok.end == point.end) {\n                                return canInsertBetween(tok, tokens[i + 1]);\n                            }\n                            return canInsertBetween(tokens[i - 1], tok);\n                        }\n                    }\n                }\n                function canInsertBetween(left, right) {\n                    if (left == null) {\n                        return null;\n                    }\n                    if (right == null) {\n                        if (/^(?:op|startexp)$/.test(left.type) || isOpenParen(left.value)) {\n                            return {\n                                token: left,\n                                end: point.end\n                            };\n                        }\n                        return null;\n                    }\n                    if (strictMode) {\n                        if (left.type == 'op' && /^(?:punc|op)$/.test(right.type)) {\n                            return {\n                                token: left,\n                                end: point.end\n                            };\n                        }\n                    } else {\n                        if (left.type == 'startexp') {\n                            return {\n                                token: left,\n                                end: point.end\n                            };\n                        }\n                        if (/^(?:op|punc)$/.test(left.type) && /^[,;({]$/.test(left.value)) {\n                            return {\n                                token: left,\n                                end: point.end\n                            };\n                        }\n                        if (/^(?:ref|sym)/.test(left.type)) {\n                            return {\n                                token: left,\n                                replace: true,\n                                end: left.end\n                            };\n                        }\n                        if (/^(?:ref|sym)/.test(right.type)) {\n                            return {\n                                token: right,\n                                replace: true,\n                                end: right.end\n                            };\n                        }\n                    }\n                    return false;\n                }\n            },\n            refAtPoint: function (sheet) {\n                var x = this._canInsertRef();\n                if (x) {\n                    var ref = sheet.selection()._ref.simplify().clone().relative(0, 0, 3);\n                    if (sheet !== this.activeSheet) {\n                        ref = ref.setSheet(sheet.name(), true);\n                    }\n                    this._replaceAt(x, ref.print(0, 0));\n                }\n            },\n            _replaceAt: function (ctx, newValue) {\n                var value = this.value();\n                var tok = ctx.token;\n                var rest = value.substr(ctx.end);\n                value = value.substr(0, ctx.replace ? tok.begin : ctx.end) + newValue;\n                var point = value.length;\n                value += rest;\n                this._value(value);\n                this.setPos(point);\n                this.scale();\n                this._syntaxHighlight();\n            },\n            syncWith: function (formulaInput) {\n                var self = this;\n                var eventName = 'input' + ns;\n                var handler = self._sync.bind(self), iehandler;\n                if (kendo.support.browser.msie) {\n                    eventName = 'keydown' + ns;\n                    iehandler = function () {\n                        setTimeout(handler);\n                    };\n                }\n                self._editorToSync = formulaInput;\n                self.element.off(eventName).on(eventName, iehandler || handler);\n            },\n            scale: function () {\n                var element = this.element;\n                var width, height;\n                if (!this._span) {\n                    this._textContainer();\n                }\n                this._span.html(element.html());\n                width = this._span.width() + this.options.scalePadding;\n                height = this._span.height();\n                if (width > element.width()) {\n                    element.width(width);\n                }\n                if (height > element.height()) {\n                    element.height(height);\n                }\n                this._sync();\n            },\n            _value: function (value) {\n                this.element.text(value);\n            },\n            value: function (value) {\n                if (value === undefined) {\n                    var txt = this.element[0].innerText;\n                    return txt.replace(/\\n$/, '');\n                }\n                this._value(value);\n                this._syntaxHighlight();\n            },\n            highlightedRefs: function () {\n                return this._highlightedRefs.slice();\n            },\n            _syntaxHighlight: function () {\n                var pos = this.getPos();\n                var value = this.value();\n                var refClasses = kendo.spreadsheet.Pane.classNames.series;\n                var highlightedRefs = [];\n                var refIndex = 0;\n                var parens = [];\n                var tokens = [];\n                var activeToken;\n                if (pos && !pos.collapsed) {\n                    return;\n                }\n                if (!/^=/.test(value)) {\n                    if (this._staticTokens.length || this._highlightedRefs.length) {\n                        this._staticTokens = [];\n                        this._highlightedRefs = [];\n                        this.element.text(value);\n                    }\n                    if (this.popup) {\n                        this.popup.close();\n                    }\n                    return;\n                } else {\n                    tokens = kendo.spreadsheet.calc.tokenize(value, this.row(), this.col());\n                    tokens.forEach(function (tok) {\n                        tok.active = false;\n                        tok.cls = ['k-syntax-' + tok.type];\n                        if (tok.type == 'ref') {\n                            tok.colorClass = refClasses[refIndex++ % refClasses.length];\n                            tok.cls.push(tok.colorClass);\n                            highlightedRefs.push(tok);\n                        }\n                        if (pos && tok.type == 'punc') {\n                            if (isOpenParen(tok.value)) {\n                                parens.unshift(tok);\n                            } else if (isCloseParen(tok.value)) {\n                                var open = parens.shift();\n                                if (open) {\n                                    if (isMatchingParen(tok.value, open.value)) {\n                                        if (touches(tok, pos) || touches(open, pos)) {\n                                            tok.cls.push('k-syntax-paren-match');\n                                            open.cls.push('k-syntax-paren-match');\n                                        }\n                                    } else {\n                                        tok.cls.push('k-syntax-error');\n                                        open.cls.push('k-syntax-error');\n                                    }\n                                } else {\n                                    tok.cls.push('k-syntax-error');\n                                }\n                            }\n                        }\n                        if (pos && touches(tok, pos)) {\n                            tok.cls.push('k-syntax-at-point');\n                            tok.active = true;\n                            activeToken = tok;\n                        }\n                        if (tok.type == 'func' && !knownFunction(tok.value) && (!pos || !touches(tok, pos))) {\n                            tok.cls.push('k-syntax-error');\n                        }\n                    });\n                    tokens.reverse().forEach(function (tok) {\n                        var begin = tok.begin, end = tok.end;\n                        var text = kendo.htmlEncode(value.substring(begin, end));\n                        value = value.substr(0, begin) + '<span class=\\'' + tok.cls.join(' ') + '\\'>' + text + '</span>' + value.substr(end);\n                    });\n                    this.element.html(value);\n                }\n                if (pos) {\n                    this.setPos(pos.begin, pos.end);\n                }\n                if (activeToken && /^(?:startexp|op|punc)$/.test(activeToken.type)) {\n                    this._setStaticTokens(tokens);\n                }\n                this._highlightedRefs = highlightedRefs;\n            },\n            _setStaticTokens: function (tokens) {\n                var idx, tok;\n                this._staticTokens = [];\n                for (idx = 0; idx < tokens.length; idx++) {\n                    tok = tokens[idx];\n                    if (/^(?:num|str|bool|sym|ref)$/.test(tok.type)) {\n                        this._staticTokens.push(tok);\n                    }\n                }\n            },\n            destroy: function () {\n                this._editorToSync = null;\n                this.element.off(ns);\n                clearTimeout(this._focusTimeout);\n                clearTimeout(this._keyDownTimeout);\n                this._cellTooltip = null;\n                this._span = null;\n                this.popup.destroy();\n                this.popup = null;\n                Widget.fn.destroy.call(this);\n            },\n            insertNewline: function () {\n                var val = this.value();\n                var pos = this.getPos();\n                var eof = pos.end == val.length;\n                val = val.substr(0, pos.begin) + (eof ? '\\n\\n' : '\\n' + val.substr(pos.end));\n                this.value(val);\n                this.setPos(pos.begin + 1);\n            }\n        });\n        function isOpenParen(ch) {\n            return ch == '(' || ch == '[' || ch == '{';\n        }\n        function isCloseParen(ch) {\n            return ch == ')' || ch == ']' || ch == '}';\n        }\n        function isMatchingParen(close, open) {\n            return open == '(' ? close == ')' : open == '[' ? close == ']' : open == '{' ? close == '}' : false;\n        }\n        function touches(pos, target) {\n            return pos.begin <= target.begin && pos.end >= target.end;\n        }\n        function knownFunction(name) {\n            return kendo.spreadsheet.calc.runtime.FUNCS[name.toLowerCase()];\n        }\n        function isEqualToken(tok1, tok2) {\n            if (!tok1 || !tok2) {\n                return false;\n            }\n            if (tok1.type == 'ref' && tok2.type == 'ref') {\n                return tok1.ref.eq(tok2.ref);\n            } else {\n                return tok1.value === tok2.value;\n            }\n        }\n        kendo.spreadsheet.FormulaInput = FormulaInput;\n        $.extend(true, FormulaInput, { classNames: classNames });\n    }(kendo, window));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/eventlistener', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var KEY_NAMES = {\n            8: 'backspace',\n            9: 'tab',\n            13: 'enter',\n            27: 'esc',\n            37: 'left',\n            38: 'up',\n            39: 'right',\n            40: 'down',\n            35: 'end',\n            36: 'home',\n            32: 'spacebar',\n            33: 'pageup',\n            34: 'pagedown',\n            46: 'delete',\n            113: ':edit'\n        };\n        var Mac = navigator.platform.toUpperCase().indexOf('MAC') >= 0;\n        var isAlphaNum = function (keyCode) {\n            if (keyCode > 47 && keyCode < 58 || keyCode > 64 && keyCode < 91 || keyCode > 95 && keyCode < 112 || keyCode > 185 && keyCode < 193 || keyCode > 218 && keyCode < 223 || keyCode === 229) {\n                return true;\n            }\n            return false;\n        };\n        var keyName = function (event) {\n            var keyCode = event.keyCode;\n            var name = KEY_NAMES[keyCode];\n            if (!name && isAlphaNum(keyCode)) {\n                name = ':alphanum';\n            }\n            if (!name && event.key && event.key.length == 1) {\n                name = ':alphanum';\n            }\n            return name;\n        };\n        var EventListener = kendo.Class.extend({\n            init: function (target, observer, handlers) {\n                this._handlers = {};\n                this.target = target;\n                this._observer = observer || window;\n                this.keyDownProxy = this.keyDown.bind(this);\n                this.mouseProxy = this.mouse.bind(this);\n                this.touchProxy = this.touch.bind(this);\n                this.threshold = 5;\n                this._pressLocation = null;\n                target.on('keydown', this.keyDownProxy);\n                target.on('contextmenu mousedown cut copy paste scroll wheel click dblclick focus', this.mouseProxy);\n                target.on('touchmove touchend', this.touchProxy);\n                $(document.documentElement).on('mousemove mouseup', this.mouseProxy);\n                $(document.documentElement).on('touchmove touchend', this.touchProxy);\n                if (handlers) {\n                    for (var key in handlers) {\n                        this.on(key, handlers[key]);\n                    }\n                }\n            },\n            keyDown: function (e) {\n                this.handleEvent(e, keyName(e.originalEvent));\n            },\n            touch: function (e) {\n                this.handleEvent(e, e.type);\n            },\n            mouse: function (e) {\n                var rightClick;\n                if (e.which) {\n                    rightClick = e.which == 3;\n                } else if (e.button) {\n                    rightClick = e.button == 2;\n                }\n                var type = e.type;\n                if (type === 'mousedown') {\n                    if (rightClick) {\n                        type = 'rightmousedown';\n                    } else {\n                        this._pressLocation = {\n                            x: e.pageX,\n                            y: e.pageY\n                        };\n                    }\n                }\n                if (type === 'mouseup') {\n                    if (!rightClick) {\n                        this._pressLocation = null;\n                    }\n                }\n                if (type === 'mousemove' && this._pressLocation) {\n                    var dx = this._pressLocation.x - e.pageX;\n                    var dy = this._pressLocation.y - e.pageY;\n                    var distance = Math.sqrt(dx * dx + dy * dy);\n                    if (distance > this.threshold) {\n                        type = 'mousedrag';\n                    }\n                }\n                this.handleEvent(e, type);\n            },\n            handleEvent: function (e, name) {\n                var eventKey = '';\n                e.mod = Mac ? e.metaKey : e.ctrlKey && !e.altKey;\n                if (e.altKey) {\n                    eventKey += 'alt+';\n                }\n                if (e.shiftKey) {\n                    eventKey += 'shift+';\n                }\n                if (e.ctrlKey) {\n                    eventKey += 'ctrl+';\n                }\n                eventKey += name;\n                var catchAllHandler = this._handlers['*+' + name];\n                if (catchAllHandler) {\n                    catchAllHandler.call(this._observer, e, eventKey);\n                }\n                var handler = this._handlers[eventKey];\n                if (handler) {\n                    handler.call(this._observer, e, eventKey);\n                }\n            },\n            on: function (event, callback) {\n                var handlers = this._handlers;\n                if (typeof callback === 'string') {\n                    callback = this._observer[callback];\n                }\n                if (typeof event === 'string') {\n                    event = event.split(',');\n                }\n                event.forEach(function (e) {\n                    handlers[e] = callback;\n                });\n            },\n            destroy: function () {\n                this.target.off('keydown', this.keyDownProxy);\n                this.target.off('keydown', this.mouseProxy);\n                $(document.documentElement).off('mousemove mouseup', this.mouseProxy);\n            }\n        });\n        kendo.spreadsheet.EventListener = EventListener;\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/rangelist', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var RangeTreeNode = kendo.Class.extend({\n            init: function Node(level, value, left, right) {\n                this.level = level;\n                this.value = value;\n                this.left = left;\n                this.right = right;\n            }\n        });\n        var NilNode = new function NIL() {\n            this.left = this;\n            this.right = this;\n            this.level = 0;\n        }();\n        function skew(node) {\n            if (node.left.level === node.level) {\n                var temp = node;\n                node = node.left;\n                temp.left = node.right;\n                node.right = temp;\n            }\n            return node;\n        }\n        function split(node) {\n            if (node.right.right.level === node.level) {\n                var temp = node;\n                node = node.right;\n                temp.right = node.left;\n                node.left = temp;\n                node.level += 1;\n            }\n            return node;\n        }\n        function insert(node, value) {\n            if (node === NilNode) {\n                return new RangeTreeNode(1, value, NilNode, NilNode);\n            } else if (node.value.start > value.start) {\n                node.left = insert(node.left, value);\n            } else {\n                node.right = insert(node.right, value);\n            }\n            return split(skew(node));\n        }\n        function remove(node, value) {\n            if (node === NilNode) {\n                return node;\n            }\n            var diff = node.value.start - value.start;\n            if (diff === 0) {\n                if (node.left !== NilNode && node.right !== NilNode) {\n                    var heir = node.left;\n                    while (heir.right !== NilNode) {\n                        heir = heir.right;\n                    }\n                    node.value = heir.value;\n                    node.left = remove(node.left, node.value);\n                } else if (node.left === NilNode) {\n                    node = node.right;\n                } else {\n                    node = node.left;\n                }\n            } else if (diff > 0) {\n                node.left = remove(node.left, value);\n            } else {\n                node.right = remove(node.right, value);\n            }\n            if (node.left.level < node.level - 1 || node.right.level < node.level - 1) {\n                node.level -= 1;\n                if (node.right.level > node.level) {\n                    node.right.level = node.level;\n                }\n                node = skew(node);\n                node.right = skew(node.right);\n                node.right.right = skew(node.right.right);\n                node = split(node);\n                node.right = split(node.right);\n            }\n            return node;\n        }\n        var Range = kendo.Class.extend({\n            init: function ValueRange(start, end, value) {\n                this.start = start;\n                this.end = end;\n                this.value = value;\n            },\n            intersects: function (range) {\n                return range.start <= this.end && range.end >= this.start;\n            },\n            clone: function () {\n                return new Range(this.start, this.end, this.value);\n            }\n        });\n        var RangeTree = kendo.Class.extend({\n            init: function () {\n                this.root = NilNode;\n            },\n            insert: function (value) {\n                this.root = insert(this.root, value);\n            },\n            remove: function (value) {\n                this.root = remove(this.root, value);\n            },\n            findrange: function (value) {\n                var node = this.root;\n                while (node != NilNode) {\n                    if (value < node.value.start) {\n                        node = node.left;\n                    } else if (value > node.value.end) {\n                        node = node.right;\n                    } else {\n                        return node.value;\n                    }\n                }\n                return null;\n            },\n            values: function () {\n                var result = [];\n                values(this.root, result);\n                return result;\n            },\n            intersecting: function (start, end) {\n                var ranges = [];\n                intersecting(this.root, new Range(start, end), ranges);\n                return ranges;\n            },\n            map: function (callback) {\n                var tree = new RangeTree();\n                map(tree, this.root, callback);\n                return tree;\n            },\n            clone: function () {\n                return this.map(function (value) {\n                    return value.clone();\n                });\n            },\n            first: function () {\n                var first = this.root;\n                while (first.left != NilNode) {\n                    first = first.left;\n                }\n                return first;\n            },\n            last: function () {\n                var last = this.root;\n                while (last.right != NilNode) {\n                    last = last.right;\n                }\n                return last;\n            }\n        });\n        function values(node, result) {\n            if (node === NilNode) {\n                return;\n            }\n            values(node.left, result);\n            result.push(node.value);\n            values(node.right, result);\n        }\n        function intersecting(node, range, ranges) {\n            if (node === NilNode) {\n                return;\n            }\n            var value = node.value;\n            if (range.start < value.start) {\n                intersecting(node.left, range, ranges);\n            }\n            if (value.intersects(range)) {\n                ranges.push(value);\n            }\n            if (range.end > value.end) {\n                intersecting(node.right, range, ranges);\n            }\n        }\n        function map(tree, root, callback) {\n            if (root === NilNode) {\n                return;\n            }\n            map(tree, root.left, callback);\n            tree.insert(callback(root.value));\n            map(tree, root.right, callback);\n        }\n        var RangeList = kendo.Class.extend({\n            init: function (start, end, value) {\n                if (end === undefined) {\n                    this.tree = start;\n                } else {\n                    this.tree = new RangeTree();\n                    this.tree.insert(new Range(start, end, value));\n                }\n            },\n            values: function () {\n                return this.tree.values();\n            },\n            map: function (callback) {\n                return new RangeList(this.tree.map(callback));\n            },\n            intersecting: function (start, end) {\n                return this.tree.intersecting(start, end);\n            },\n            first: function () {\n                return this.tree.first().value;\n            },\n            last: function () {\n                return this.tree.last().value;\n            },\n            insert: function (start, end, value) {\n                return this.tree.insert(new Range(start, end, value));\n            },\n            value: function (start, end, value) {\n                if (value === undefined) {\n                    if (end === undefined) {\n                        end = start;\n                    }\n                    return this.intersecting(start, end)[0].value;\n                }\n                var ranges = this.tree.intersecting(start - 1, end + 1);\n                if (ranges.length) {\n                    var firstRange = ranges[0], lastRange = ranges[ranges.length - 1];\n                    if (firstRange.end < start) {\n                        if (firstRange.value === value) {\n                            start = firstRange.start;\n                        } else {\n                            ranges.shift();\n                        }\n                    }\n                    if (lastRange.start > end) {\n                        if (lastRange.value === value) {\n                            end = lastRange.end;\n                        } else {\n                            ranges.pop();\n                        }\n                    }\n                    for (var i = 0, length = ranges.length; i < length; i++) {\n                        var range = ranges[i];\n                        var rangeValue = range.value;\n                        var rangeStart = range.start;\n                        var rangeEnd = range.end;\n                        this.tree.remove(range);\n                        if (rangeStart < start) {\n                            if (rangeValue !== value) {\n                                this.insert(rangeStart, start - 1, rangeValue);\n                            } else {\n                                start = rangeStart;\n                            }\n                        }\n                        if (rangeEnd > end) {\n                            if (rangeValue !== value) {\n                                this.insert(end + 1, rangeEnd, rangeValue);\n                            } else {\n                                end = rangeEnd;\n                            }\n                        }\n                    }\n                }\n                this.insert(start, end, value);\n            },\n            expandedValues: function (start, end) {\n                var ranges = this.intersecting(start, end);\n                var result = [];\n                var rangeIndex = 0;\n                for (var i = start; i <= end; i++) {\n                    if (ranges[rangeIndex].end < i) {\n                        rangeIndex++;\n                    }\n                    result.push({\n                        index: i - start,\n                        value: ranges[rangeIndex].value\n                    });\n                }\n                return result;\n            },\n            sortedIndices: function (start, end, valueComparer, indices) {\n                var result = this.expandedValues(start, end);\n                var comparer = function (a, b) {\n                    if (a.value === b.value) {\n                        return a.index - b.index;\n                    }\n                    return valueComparer(a.value, b.value);\n                };\n                if (indices) {\n                    comparer = function (a, b) {\n                        var x = indices[a.index];\n                        var y = indices[b.index];\n                        if (x.value === y.value) {\n                            return valueComparer(a.value, b.value);\n                        }\n                        return a.index - b.index;\n                    };\n                }\n                result.sort(comparer);\n                return result;\n            },\n            sort: function (start, end, indices) {\n                if (this.intersecting(start, end).length === 1) {\n                    return;\n                }\n                var values = this.expandedValues(start, end);\n                for (var i = 0, len = indices.length; i < len; i++) {\n                    this.value(i + start, i + start, values[indices[i].index].value);\n                }\n            },\n            copy: function (sourceStart, sourceEnd, targetStart) {\n                var values = this.intersecting(sourceStart, sourceEnd);\n                var start = targetStart;\n                var end;\n                for (var i = 0, len = values.length; i < len; i++) {\n                    var rangeStart = values[i].start;\n                    if (rangeStart < sourceStart) {\n                        rangeStart = sourceStart;\n                    }\n                    var rangeEnd = values[i].end;\n                    if (rangeEnd > sourceEnd) {\n                        rangeEnd = sourceEnd;\n                    }\n                    end = start + (rangeEnd - rangeStart);\n                    this.value(start, end, values[i].value);\n                    start = ++end;\n                }\n            },\n            iterator: function (start, end) {\n                return new Iterator(start, end, this.intersecting(start, end));\n            },\n            getState: function () {\n                return this.tree.clone();\n            },\n            setState: function (state) {\n                this.tree = state.clone();\n            },\n            toJSON: function () {\n                return this.values();\n            },\n            fromJSON: function (values) {\n                values.forEach(function (v) {\n                    this.value(v.start, v.end, v.value);\n                }, this);\n            }\n        });\n        var Iterator = kendo.Class.extend({\n            init: function (start, end, ranges) {\n                this.start = start;\n                this.end = end;\n                this.index = 0;\n                this.ranges = ranges;\n            },\n            unique: function () {\n                return this.ranges.map(function (range) {\n                    return range.value;\n                });\n            },\n            at: function (index) {\n                while (this.ranges[this.index] && this.ranges[this.index].end < index) {\n                    this.index++;\n                }\n                return this.ranges[this.index] && this.ranges[this.index].value;\n            },\n            forEach: function (callback) {\n                for (var i = this.start; i <= this.end; i++) {\n                    callback(this.at(i), i);\n                }\n                this.index = 0;\n            }\n        });\n        var SparseRangeList = RangeList.extend({\n            init: function (start, end, value) {\n                this.tree = new RangeTree();\n                this.range = new Range(start, end, value);\n            },\n            intersecting: function (start, end) {\n                var ranges = this.tree.intersecting(start, end);\n                var result = [];\n                var range;\n                if (!ranges.length) {\n                    return [this.range];\n                }\n                for (var i = 0, len = ranges.length; i < len; i++) {\n                    range = ranges[i];\n                    if (range.start > start) {\n                        result.push(new Range(start, range.start - 1, this.range.value));\n                    }\n                    result.push(range);\n                    start = range.end + 1;\n                }\n                if (range.end < end) {\n                    result.push(new Range(range.end + 1, end, this.range.value));\n                }\n                return result;\n            },\n            insert: function (start, end, value) {\n                if (value !== this.range.value) {\n                    this.tree.insert(new Range(start, end, value));\n                }\n            },\n            lastRangeStart: function () {\n                var node = this.tree.root;\n                if (node === NilNode) {\n                    return this.range.start;\n                }\n                while (node.right !== NilNode) {\n                    node = node.right;\n                }\n                return node.value.end + 1;\n            }\n        });\n        kendo.spreadsheet.RangeTree = RangeTree;\n        kendo.spreadsheet.RangeList = RangeList;\n        kendo.spreadsheet.SparseRangeList = SparseRangeList;\n        kendo.spreadsheet.ValueRange = Range;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/propertybag', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var Property = kendo.Class.extend({\n            init: function (list) {\n                this.list = list;\n            },\n            get: function (index) {\n                return this.parse(this.list.value(index, index));\n            },\n            set: function (start, end, value) {\n                if (value === undefined) {\n                    value = end;\n                    end = start;\n                }\n                this.list.value(start, end, value);\n            },\n            parse: function (value) {\n                return value;\n            },\n            copy: function (start, end, dst) {\n                this.list.copy(start, end, dst);\n            },\n            iterator: function (start, end) {\n                return this.list.iterator(start, end);\n            }\n        });\n        var JsonProperty = Property.extend({\n            set: function (start, end, value) {\n                this.list.value(start, end, JSON.stringify(value));\n            },\n            parse: function (value) {\n                return JSON.parse(value);\n            }\n        });\n        var ValueProperty = Property.extend({\n            init: function (values, formats) {\n                Property.prototype.init.call(this, values);\n                this.formats = formats;\n            },\n            set: function (start, end, value) {\n                if (value instanceof Date) {\n                    value = kendo.spreadsheet.dateToNumber(value);\n                    if (!this.formats.value(start, end)) {\n                        this.formats.value(start, end, toExcelFormat(kendo.culture().calendar.patterns.d));\n                    }\n                } else if (typeof value == 'number') {\n                    value = kendo.spreadsheet.calc.runtime.limitPrecision(value);\n                }\n                this.list.value(start, end, value);\n            }\n        });\n        function toExcelFormat(format) {\n            return format.replace(/M/g, 'm').replace(/'/g, '\"').replace(/tt/, 'am/pm');\n        }\n        kendo.spreadsheet.PropertyBag = kendo.Class.extend({\n            specs: [\n                {\n                    property: Property,\n                    name: 'format',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: ValueProperty,\n                    name: 'value',\n                    value: null,\n                    sortable: true,\n                    serializable: true,\n                    depends: 'format'\n                },\n                {\n                    property: Property,\n                    name: 'formula',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'background',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: JsonProperty,\n                    name: 'vBorders',\n                    value: null,\n                    sortable: false,\n                    serializable: false\n                },\n                {\n                    property: JsonProperty,\n                    name: 'hBorders',\n                    value: null,\n                    sortable: false,\n                    serializable: false\n                },\n                {\n                    property: Property,\n                    name: 'color',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'fontFamily',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'underline',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'fontSize',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'italic',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'bold',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'textAlign',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'indent',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'verticalAlign',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'wrap',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'validation',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'enable',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'link',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'editor',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'comment',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                }\n            ],\n            init: function (rowCount, columnCount, defaultValues) {\n                defaultValues = defaultValues || {};\n                var cellCount = rowCount * columnCount - 1;\n                this.rowCount = rowCount;\n                this.columnCount = columnCount;\n                this.cellCount = cellCount;\n                this.properties = {};\n                this.lists = {};\n                this.specs.forEach(function (spec) {\n                    var name = spec.name;\n                    var value = defaultValues[name];\n                    if (value === undefined) {\n                        value = spec.value;\n                    }\n                    this.lists[name] = new kendo.spreadsheet.SparseRangeList(0, cellCount, value);\n                    var prop = this.properties[name] = new spec.property(this.lists[name], this.lists[spec.depends]);\n                    prop.spec = spec;\n                }, this);\n                this.lists.formula.tree.clone = cloneFormulaTree;\n                this.lists.validation.tree.clone = cloneFormulaTree;\n            },\n            getState: function () {\n                var state = {};\n                this.specs.forEach(function (spec) {\n                    state[spec.name] = this.lists[spec.name].getState();\n                }, this);\n                return state;\n            },\n            setState: function (state) {\n                this.specs.forEach(function (spec) {\n                    this.lists[spec.name].setState(state[spec.name]);\n                }, this);\n            },\n            get: function (name, index) {\n                if (index === undefined) {\n                    return this.lists[name];\n                }\n                switch (name) {\n                case 'borderRight':\n                    index += this.rowCount;\n                case 'borderLeft':\n                    name = 'vBorders';\n                    break;\n                case 'borderBottom':\n                    index++;\n                case 'borderTop':\n                    name = 'hBorders';\n                    break;\n                }\n                return index > this.cellCount ? null : this.properties[name].get(index);\n            },\n            set: function (name, start, end, value) {\n                switch (name) {\n                case 'borderRight':\n                    start += this.rowCount;\n                    end += this.rowCount;\n                case 'borderLeft':\n                    name = 'vBorders';\n                    break;\n                case 'borderBottom':\n                    start++;\n                    end++;\n                case 'borderTop':\n                    name = 'hBorders';\n                    break;\n                }\n                if (start <= end && end <= this.cellCount) {\n                    this.properties[name].set(start, end, value);\n                }\n            },\n            fromJSON: function (index, value) {\n                for (var si = 0; si < this.specs.length; si++) {\n                    var spec = this.specs[si];\n                    if (spec.serializable) {\n                        if (value[spec.name] !== undefined) {\n                            this.set(spec.name, index, index, value[spec.name], false);\n                        }\n                    }\n                }\n                [\n                    'borderLeft',\n                    'borderRight',\n                    'borderTop',\n                    'borderBottom'\n                ].forEach(function (b) {\n                    if (value[b] !== undefined) {\n                        this.set(b, index, index, value[b]);\n                    }\n                }, this);\n            },\n            copy: function (sourceStart, sourceEnd, targetStart) {\n                this.specs.forEach(function (spec) {\n                    this.properties[spec.name].copy(sourceStart, sourceEnd, targetStart);\n                }, this);\n            },\n            iterator: function (name, start, end) {\n                var prop = this.properties[name];\n                var iter = prop.iterator(start, end), at = iter.at;\n                var cellCount = this.cellCount;\n                iter.at = function (index) {\n                    return index > cellCount ? null : prop.parse(at.call(iter, index));\n                };\n                iter.name = name;\n                iter.value = prop.spec.value;\n                return iter;\n            },\n            sortable: function () {\n                return this.specs.filter(function (spec) {\n                    return spec.sortable;\n                }).map(function (spec) {\n                    return this.lists[spec.name];\n                }, this);\n            },\n            iterators: function (start, end) {\n                return this.specs.reduce(function (ret, spec) {\n                    if (spec.serializable) {\n                        ret.push(this.iterator(spec.name, start, end));\n                    }\n                    return ret;\n                }.bind(this), []);\n            },\n            forEach: function (start, end, callback) {\n                var iterators = this.iterators(start, end);\n                var hBorders = this.iterator('hBorders', start, end + 1);\n                var leftBorders = this.iterator('vBorders', start, end);\n                var rightBorders = this.iterator('vBorders', start + this.rowCount, end + this.rowCount);\n                var values, index;\n                function addBorder(name, iterator, index) {\n                    var val = iterator.at(index);\n                    if (val !== iterator.value) {\n                        values[name] = val;\n                    }\n                }\n                for (index = start; index <= end; index++) {\n                    values = {};\n                    for (var i = 0; i < iterators.length; i++) {\n                        var iterator = iterators[i];\n                        var value = iterator.at(index);\n                        if (value !== iterator.value) {\n                            values[iterator.name] = value;\n                        }\n                    }\n                    addBorder('borderLeft', leftBorders, index);\n                    addBorder('borderRight', rightBorders, index + this.rowCount);\n                    addBorder('borderTop', hBorders, index);\n                    if ((index + 1) % this.rowCount) {\n                        addBorder('borderBottom', hBorders, index + 1);\n                    }\n                    callback(values);\n                }\n            },\n            forEachProperty: function (callback) {\n                for (var name in this.properties) {\n                    callback(this.properties[name]);\n                }\n            }\n        });\n        function cloneFormulaValue(x) {\n            x = x.clone();\n            x.value = x.value.deepClone();\n            return x;\n        }\n        function cloneFormulaTree() {\n            var tree = this.map(cloneFormulaValue);\n            tree.clone = cloneFormulaTree;\n            return tree;\n        }\n        kendo.spreadsheet.ALL_PROPERTIES = kendo.spreadsheet.PropertyBag.prototype.specs.reduce(function (a, spec) {\n            if (spec.serializable) {\n                a.push(spec.name);\n            }\n            return a;\n        }, [\n            'borderTop',\n            'borderRight',\n            'borderBottom',\n            'borderLeft'\n        ]);\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/references', ['kendo.core'], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var Class = kendo.Class;\n    function columnName(colIndex) {\n        var letter = Math.floor(colIndex / 26) - 1;\n        return (letter >= 0 ? columnName(letter) : '') + String.fromCharCode(65 + colIndex % 26);\n    }\n    function displaySheet(sheet) {\n        if (/^[a-z_][a-z0-9_]*$/i.test(sheet)) {\n            return sheet;\n        }\n        return '\\'' + sheet.replace(/\\x27/g, '\\\\\\'') + '\\'';\n    }\n    function displayRef(sheet, row, col, rel) {\n        var aa = '';\n        ++row;\n        if (!isFinite(row)) {\n            row = '';\n        } else if (rel != null && !(rel & 2)) {\n            row = '$' + row;\n        }\n        if (!isFinite(col)) {\n            col = '';\n        } else {\n            aa = columnName(col);\n            if (rel != null && !(rel & 1)) {\n                aa = '$' + aa;\n            }\n        }\n        if (sheet) {\n            return displaySheet(sheet) + '!' + aa + row;\n        } else {\n            return aa + row;\n        }\n    }\n    var Ref = Class.extend({\n        type: 'ref',\n        sheet: '',\n        clone: function () {\n            return this;\n        },\n        hasSheet: function () {\n            return this._hasSheet;\n        },\n        simplify: function () {\n            return this;\n        },\n        setSheet: function (sheet, hasSheet) {\n            this.sheet = sheet;\n            if (hasSheet != null) {\n                this._hasSheet = hasSheet;\n            }\n            return this;\n        },\n        absolute: function () {\n            return this;\n        },\n        relative: function () {\n            return this;\n        },\n        adjust: function () {\n            return this;\n        },\n        toString: function () {\n            return this.relative(0, 0, 3, 3).print(0, 0);\n        },\n        forEach: function (callback, obj) {\n            callback.call(obj, this);\n        },\n        map: function (callback, obj) {\n            return callback.call(obj, this);\n        },\n        intersects: function (ref) {\n            return this.intersect(ref) !== NULL;\n        },\n        isCell: function () {\n            return false;\n        },\n        toRow: function () {\n            return this;\n        },\n        toColumn: function () {\n            return this;\n        },\n        first: function () {\n            return this;\n        },\n        lastRange: function () {\n            return this;\n        },\n        size: function () {\n            return 1;\n        },\n        rangeAt: function () {\n            return this;\n        },\n        nextRangeIndex: function () {\n            return 0;\n        },\n        previousRangeIndex: function () {\n            return 0;\n        },\n        eq: function (reference) {\n            var r1 = this;\n            var r2 = reference;\n            if (r1 === NULL || r2 === NULL) {\n                return r1 === r2;\n            }\n            if (r2 instanceof CellRef || r2 instanceof RangeRef && !(r1 instanceof CellRef)) {\n                r1 = reference;\n                r2 = this;\n            }\n            if (r1 instanceof CellRef) {\n                r2 = r2.simplify();\n                return r2 instanceof CellRef && r1.row == r2.row && r1.col == r2.col && r1.sheet == r2.sheet;\n            } else if (r1 instanceof RangeRef) {\n                if (r2 instanceof RangeRef) {\n                    return r2.topLeft.eq(r1.topLeft) && r2.bottomRight.eq(r1.bottomRight);\n                }\n                if (r2 instanceof UnionRef) {\n                    return r2.single() && r1.eq(r2.refs[0]);\n                }\n            } else if (r1 instanceof UnionRef && r2 instanceof UnionRef) {\n                var refs1 = r1.refs;\n                var refs2 = r2.refs;\n                if (refs1.length != refs2.length) {\n                    return false;\n                }\n                for (var i = 0, len = refs1.length; i < len; i++) {\n                    if (!refs1[i].eq(refs2[i])) {\n                        return false;\n                    }\n                }\n                return true;\n            }\n            return r1 === r2;\n        },\n        concat: function (ref) {\n            return new UnionRef([\n                this,\n                ref\n            ]);\n        },\n        replaceAt: function (index, ref) {\n            return ref;\n        },\n        forEachColumnIndex: function (callback) {\n            this.forEachAxisIndex('col', callback);\n        },\n        forEachRowIndex: function (callback) {\n            this.forEachAxisIndex('row', callback);\n        },\n        forEachAxisIndex: function (axis, callback) {\n            var sorted = [];\n            var method = axis === 'row' ? 'forEachRow' : 'forEachColumn';\n            this[method](function (ref) {\n                var index = ref.first()[axis];\n                if (sorted.indexOf(index) === -1) {\n                    sorted.push(index);\n                }\n            });\n            sorted.sort(function (a, b) {\n                return a > b ? 1 : a < b ? -1 : 0;\n            }).forEach(callback);\n        },\n        valid: function () {\n            return false;\n        },\n        renameSheet: function (oldSheetName, newSheetName) {\n            if (this.sheet && this.sheet.toLowerCase() == oldSheetName.toLowerCase()) {\n                this.sheet = newSheetName;\n                return true;\n            }\n        }\n    });\n    Ref.display = displayRef;\n    var NULL = new (Ref.extend({\n        init: function NullRef() {\n        },\n        print: function () {\n            return '#NULL!';\n        },\n        eq: function (ref) {\n            return ref === this;\n        },\n        forEach: function () {\n        }\n    }))();\n    var NameRef = Ref.extend({\n        ref: 'name',\n        init: function NameRef(name) {\n            this.name = name;\n        },\n        clone: function () {\n            return new NameRef(this.name).setSheet(this.sheet, this.hasSheet());\n        },\n        print: function () {\n            var ret = displaySheet(this.name);\n            if (this.hasSheet()) {\n                ret = displaySheet(this.sheet) + '!' + ret;\n            }\n            return ret;\n        }\n    });\n    var CellRef = Ref.extend({\n        ref: 'cell',\n        init: function CellRef(row, col, rel) {\n            this.row = row;\n            this.col = col;\n            this.rel = rel || 0;\n        },\n        clone: function () {\n            return new CellRef(this.row, this.col, this.rel).setSheet(this.sheet, this.hasSheet());\n        },\n        intersect: function (ref) {\n            if (ref instanceof CellRef) {\n                if (this.eq(ref)) {\n                    return this;\n                } else {\n                    return NULL;\n                }\n            }\n            return ref.intersect(this);\n        },\n        print: function (trow, tcol, mod) {\n            var col = this.col, row = this.row, rel = this.rel, abs;\n            if (trow == null && rel) {\n                var sheet = this.hasSheet() ? displaySheet(this.sheet) + '!' : '';\n                if (isFinite(col)) {\n                    col = rel & 1 ? 'C[' + col + ']' : 'C' + (col + 1);\n                } else {\n                    col = '';\n                }\n                if (isFinite(row)) {\n                    row = rel & 2 ? 'R[' + row + ']' : 'R' + (row + 1);\n                } else {\n                    row = '';\n                }\n                return sheet + row + col;\n            } else {\n                abs = this.absolute(trow, tcol);\n                if (mod) {\n                    row = abs.row % 1048576;\n                    col = abs.col % 16384;\n                    if (row < 0) {\n                        row += 1048576;\n                    }\n                    if (col < 0) {\n                        col += 16384;\n                    }\n                    return displayRef(this._hasSheet && this.sheet, row, col, rel);\n                }\n                return abs.valid() ? displayRef(this._hasSheet && this.sheet, abs.row, abs.col, rel) : '#REF!';\n            }\n        },\n        absolute: function (arow, acol) {\n            var ret = this.clone();\n            if (ret.rel & 3 === 0) {\n                return ret;\n            }\n            if (ret.rel & 1) {\n                ret.col = (ret.col + acol) % 16384;\n            }\n            if (ret.rel & 2) {\n                ret.row = (ret.row + arow) % 1048576;\n            }\n            ret.rel = 0;\n            return ret;\n        },\n        toRangeRef: function () {\n            return new RangeRef(this, this);\n        },\n        relative: function (arow, acol, rel) {\n            if (rel == null) {\n                rel = this.rel;\n            }\n            var row = rel & 2 ? this.row - arow : this.row;\n            var col = rel & 1 ? this.col - acol : this.col;\n            return new CellRef(row, col, rel).setSheet(this.sheet, this.hasSheet());\n        },\n        height: function () {\n            return 1;\n        },\n        width: function () {\n            return 1;\n        },\n        toString: function () {\n            return displayRef(null, this.row, this.col, 3);\n        },\n        isCell: function () {\n            return true;\n        },\n        leftColumn: function () {\n            return this;\n        },\n        rightColumn: function () {\n            return this;\n        },\n        topRow: function () {\n            return this;\n        },\n        bottomRow: function () {\n            return this;\n        },\n        forEachRow: function (callback) {\n            callback(this.toRangeRef());\n        },\n        forEachColumn: function (callback) {\n            callback(this.toRangeRef());\n        },\n        adjust: function (row, col, trow, tcol, forRow, start, delta) {\n            var ref = this.absolute(row, col);\n            if (forRow) {\n                if (ref.row >= start) {\n                    if (delta < 0 && ref.row < start - delta) {\n                        return NULL;\n                    }\n                    ref.row += delta;\n                }\n            } else {\n                if (ref.col >= start) {\n                    if (delta < 0 && ref.col < start - delta) {\n                        return NULL;\n                    }\n                    ref.col += delta;\n                }\n            }\n            if (trow != null && tcol != null) {\n                ref = ref.relative(trow, tcol, this.rel);\n            }\n            return ref;\n        },\n        valid: function () {\n            if (this.rel) {\n                throw new Error('valid() called on relative reference');\n            }\n            var col = this.col, row = this.row;\n            return !(isFinite(col) && col < 0 || isFinite(row) && row < 0);\n        }\n    });\n    var RangeRef = Ref.extend({\n        ref: 'range',\n        init: function RangeRef(tl, br) {\n            if (tl._hasSheet && br._hasSheet && tl.sheet.toLowerCase() != br.sheet.toLowerCase()) {\n                this.endSheet = br.sheet;\n            }\n            this.topLeft = new CellRef(tl.row, tl.col, tl.rel);\n            this.bottomRight = new CellRef(br.row, br.col, br.rel);\n            this.normalize();\n        },\n        clone: function () {\n            return new RangeRef(this.topLeft.clone(), this.bottomRight.clone()).setSheet(this.sheet, this.hasSheet());\n        },\n        _containsRange: function (range) {\n            return this._containsCell(range.topLeft) && this._containsCell(range.bottomRight);\n        },\n        _containsCell: function (cell) {\n            return cell.sheet == this.sheet && cell.row >= this.topLeft.row && cell.col >= this.topLeft.col && cell.row <= this.bottomRight.row && cell.col <= this.bottomRight.col;\n        },\n        contains: function (ref) {\n            if (ref instanceof Array) {\n                var that = this;\n                return ref.some(function (_ref) {\n                    return that.contains(_ref);\n                });\n            }\n            if (ref instanceof CellRef) {\n                return this._containsCell(ref);\n            }\n            if (ref instanceof RangeRef) {\n                return this._containsRange(ref);\n            }\n            return false;\n        },\n        _intersectRange: function (ref) {\n            if (this.sheet != ref.sheet) {\n                return NULL;\n            }\n            var a_left = this.topLeft.col;\n            var a_top = this.topLeft.row;\n            var a_right = this.bottomRight.col;\n            var a_bottom = this.bottomRight.row;\n            var b_left = ref.topLeft.col;\n            var b_top = ref.topLeft.row;\n            var b_right = ref.bottomRight.col;\n            var b_bottom = ref.bottomRight.row;\n            if (a_left <= b_right && b_left <= a_right && a_top <= b_bottom && b_top <= a_bottom) {\n                return new RangeRef(new CellRef(Math.max(a_top, b_top), Math.max(a_left, b_left)), new CellRef(Math.min(a_bottom, b_bottom), Math.min(a_right, b_right))).setSheet(this.sheet, this.hasSheet());\n            } else {\n                return NULL;\n            }\n        },\n        intersect: function (ref) {\n            if (ref instanceof CellRef) {\n                return this._containsCell(ref) ? ref : NULL;\n            }\n            if (ref instanceof RangeRef) {\n                return this._intersectRange(ref).simplify();\n            }\n            if (ref instanceof UnionRef) {\n                return ref.intersect(this);\n            }\n            return NULL;\n        },\n        simplify: function () {\n            if (this.isCell()) {\n                return new CellRef(this.topLeft.row, this.topLeft.col, this.topLeft.rel).setSheet(this.sheet, this.hasSheet());\n            }\n            return this;\n        },\n        normalize: function () {\n            var a = this.topLeft, b = this.bottomRight;\n            var r1 = a.row, c1 = a.col, r2 = b.row, c2 = b.col;\n            var rr1 = a.rel & 2, rc1 = a.rel & 1;\n            var rr2 = b.rel & 2, rc2 = b.rel & 1;\n            var tmp, changes = false;\n            if (rr1 === rr2 && rc1 === rc2) {\n                if (r1 > r2) {\n                    changes = true;\n                    tmp = r1;\n                    r1 = r2;\n                    r2 = tmp;\n                    tmp = rr1;\n                    rr1 = rr2;\n                    rr2 = tmp;\n                }\n                if (c1 > c2) {\n                    changes = true;\n                    tmp = c1;\n                    c1 = c2;\n                    c2 = tmp;\n                    tmp = rc1;\n                    rc1 = rc2;\n                    rc2 = tmp;\n                }\n                if (changes) {\n                    this.topLeft = new CellRef(r1, c1, rc1 | rr1);\n                    this.bottomRight = new CellRef(r2, c2, rc2 | rr2);\n                }\n            }\n            return this;\n        },\n        print: function (trow, tcol, mod) {\n            if (mod || this.absolute(trow, tcol).valid()) {\n                var ret = this.topLeft.print(trow, tcol, mod) + ':' + this.bottomRight.print(trow, tcol, mod);\n                if (this.hasSheet()) {\n                    ret = displaySheet(this.sheet) + (this.endSheet ? ':' + displaySheet(this.endSheet) : '') + '!' + ret;\n                }\n                return ret;\n            }\n            return '#REF!';\n        },\n        absolute: function (arow, acol) {\n            return new RangeRef(this.topLeft.absolute(arow, acol), this.bottomRight.absolute(arow, acol)).setSheet(this.sheet, this.hasSheet());\n        },\n        relative: function (arow, acol, relTL, relBR) {\n            if (relBR == null) {\n                relBR = relTL;\n            }\n            return new RangeRef(this.topLeft.relative(arow, acol, relTL), this.bottomRight.relative(arow, acol, relBR)).setSheet(this.sheet, this.hasSheet());\n        },\n        height: function () {\n            if (this.topLeft.rel != this.bottomRight.rel) {\n                throw new Error('Mixed relative/absolute references');\n            }\n            return this.bottomRight.row - this.topLeft.row + 1;\n        },\n        width: function () {\n            if (this.topLeft.rel != this.bottomRight.rel) {\n                throw new Error('Mixed relative/absolute references');\n            }\n            return this.bottomRight.col - this.topLeft.col + 1;\n        },\n        collapse: function () {\n            return this.topLeft.toRangeRef();\n        },\n        leftColumn: function () {\n            return new RangeRef(this.topLeft, new CellRef(this.bottomRight.row, this.topLeft.col));\n        },\n        rightColumn: function () {\n            return new RangeRef(new CellRef(this.topLeft.row, this.bottomRight.col), this.bottomRight);\n        },\n        topRow: function () {\n            return new RangeRef(this.topLeft, new CellRef(this.topLeft.row, this.bottomRight.col));\n        },\n        bottomRow: function () {\n            return new RangeRef(new CellRef(this.bottomRight.row, this.topLeft.col), this.bottomRight);\n        },\n        toRangeRef: function () {\n            return this;\n        },\n        toRow: function (row) {\n            row += Math.max(0, this.topLeft.row);\n            return new RangeRef(new CellRef(row, this.topLeft.col), new CellRef(row, this.bottomRight.col)).setSheet(this.sheet, this.hasSheet());\n        },\n        toColumn: function (col) {\n            col += Math.max(0, this.topLeft.col);\n            return new RangeRef(new CellRef(this.topLeft.row, col), new CellRef(this.bottomRight.row, col)).setSheet(this.sheet, this.hasSheet());\n        },\n        toCell: function (row, col) {\n            row += Math.max(0, this.topLeft.row);\n            col += Math.max(0, this.topLeft.col);\n            return new CellRef(row, col, 0).setSheet(this.sheet, this.hasSheet());\n        },\n        forEachRow: function (callback) {\n            var startRow = this.topLeft.row;\n            var endRow = this.bottomRight.row;\n            var startCol = this.topLeft.col;\n            var endCol = this.bottomRight.col;\n            for (var i = startRow; i <= endRow; i++) {\n                callback(new RangeRef(new CellRef(i, startCol), new CellRef(i, endCol)));\n            }\n        },\n        forEachColumn: function (callback) {\n            var startRow = this.topLeft.row;\n            var endRow = this.bottomRight.row;\n            var startCol = this.topLeft.col;\n            var endCol = this.bottomRight.col;\n            for (var i = startCol; i <= endCol; i++) {\n                callback(new RangeRef(new CellRef(startRow, i), new CellRef(endRow, i)));\n            }\n        },\n        intersecting: function (refs) {\n            return refs.filter(function (ref) {\n                return ref.toRangeRef().intersects(this);\n            }, this);\n        },\n        union: function (refs, callback) {\n            var intersecting = this.intersecting(refs);\n            var topLeftRow = this.topLeft.row;\n            var topLeftCol = this.topLeft.col;\n            var bottomRightRow = this.bottomRight.row;\n            var bottomRightCol = this.bottomRight.col;\n            var modified = false;\n            intersecting.forEach(function (ref) {\n                ref = ref.toRangeRef();\n                if (ref.topLeft.row < topLeftRow) {\n                    modified = true;\n                    topLeftRow = ref.topLeft.row;\n                }\n                if (ref.topLeft.col < topLeftCol) {\n                    modified = true;\n                    topLeftCol = ref.topLeft.col;\n                }\n                if (ref.bottomRight.row > bottomRightRow) {\n                    modified = true;\n                    bottomRightRow = ref.bottomRight.row;\n                }\n                if (ref.bottomRight.col > bottomRightCol) {\n                    modified = true;\n                    bottomRightCol = ref.bottomRight.col;\n                }\n                if (callback) {\n                    callback(ref);\n                }\n            });\n            var result = new RangeRef(new CellRef(topLeftRow, topLeftCol), new CellRef(bottomRightRow, bottomRightCol));\n            if (modified) {\n                return result.union(refs, callback);\n            } else {\n                return result;\n            }\n        },\n        resize: function (options) {\n            var limit = Math.max.bind(Math, 0);\n            function num(value) {\n                return value || 0;\n            }\n            var top = this.topLeft.row + num(options.top);\n            var left = this.topLeft.col + num(options.left);\n            var bottom = this.bottomRight.row + num(options.bottom);\n            var right = this.bottomRight.col + num(options.right);\n            if (left < 0 && right < 0 || top < 0 && bottom < 0) {\n                return NULL;\n            } else if (top <= bottom && left <= right) {\n                return new RangeRef(new CellRef(limit(top), limit(left)), new CellRef(limit(bottom), limit(right)));\n            } else {\n                return NULL;\n            }\n        },\n        move: function (rows, cols) {\n            return new RangeRef(new CellRef(this.topLeft.row + rows, this.topLeft.col + cols), new CellRef(this.bottomRight.row + rows, this.bottomRight.col + cols));\n        },\n        first: function () {\n            return this.topLeft.clone().setSheet(this.sheet, this.hasSheet());\n        },\n        isCell: function () {\n            return !this.endSheet && this.topLeft.eq(this.bottomRight);\n        },\n        toString: function () {\n            return this.topLeft + ':' + this.bottomRight;\n        },\n        adjust: function (row, col, trow, tcol, forRow, start, delta) {\n            var tl = this.topLeft.adjust(row, col, trow, tcol, forRow, start, delta);\n            var tr = this.bottomRight.adjust(row, col, trow, tcol, forRow, start, delta);\n            if (tl === NULL && tr === NULL) {\n                return NULL;\n            }\n            if (tl === NULL) {\n                tl = this.topLeft.absolute(row, col);\n                if (forRow) {\n                    tl.row = start;\n                } else {\n                    tl.col = start;\n                }\n                if (trow != null && tcol != null) {\n                    tl = tl.relative(trow, tcol, this.topLeft.rel);\n                }\n            } else if (tr === NULL) {\n                tr = this.bottomRight.absolute(row, col);\n                if (forRow) {\n                    tr.row = start - 1;\n                } else {\n                    tr.col = start - 1;\n                }\n                if (trow != null && tcol != null) {\n                    tr = tr.relative(trow, tcol, this.bottomRight.rel);\n                }\n            }\n            return new RangeRef(tl, tr).setSheet(this.sheet, this.hasSheet()).simplify();\n        },\n        valid: function () {\n            return this.topLeft.valid() && this.bottomRight.valid();\n        }\n    });\n    var UnionRef = Ref.extend({\n        init: function UnionRef(refs) {\n            this.refs = refs;\n            this.length = refs.length;\n        },\n        clone: function () {\n            return new UnionRef(this.refs.slice());\n        },\n        intersect: function (ref) {\n            var a = [];\n            for (var i = 0; i < this.length; ++i) {\n                var x = ref.intersect(this.refs[i]);\n                if (x !== NULL) {\n                    a.push(x);\n                }\n            }\n            if (a.length > 0) {\n                return new UnionRef(a).simplify();\n            }\n            return NULL;\n        },\n        simplify: function () {\n            var u = new UnionRef(this.refs.reduce(function (a, ref) {\n                ref = ref.simplify();\n                if (ref !== NULL) {\n                    a.push(ref);\n                }\n                return a;\n            }, []));\n            if (u.empty()) {\n                return NULL;\n            }\n            if (u.single()) {\n                return u.refs[0];\n            }\n            return u;\n        },\n        absolute: function (arow, acol) {\n            return new UnionRef(this.refs.map(function (ref) {\n                return ref.absolute(arow, acol);\n            }));\n        },\n        forEach: function (callback, obj) {\n            this.refs.forEach(function (ref) {\n                if (ref instanceof UnionRef) {\n                    ref.forEach(callback, obj);\n                } else {\n                    callback.call(obj, ref);\n                }\n            }, obj);\n        },\n        toRangeRef: function () {\n            return this.refs[0].toRangeRef();\n        },\n        contains: function (theRef) {\n            return this.refs.some(function (ref) {\n                return ref.contains(theRef);\n            });\n        },\n        map: function (callback, obj) {\n            var refs = [];\n            this.forEach(function (ref) {\n                refs.push(callback.call(obj, ref));\n            });\n            return new UnionRef(refs);\n        },\n        first: function () {\n            return this.refs[0].first();\n        },\n        lastRange: function () {\n            return this.refs[this.length - 1];\n        },\n        size: function () {\n            return this.length;\n        },\n        single: function () {\n            return this.length == 1;\n        },\n        empty: function () {\n            return this.length === 0;\n        },\n        isCell: function () {\n            return this.single() && this.refs[0].isCell();\n        },\n        rangeAt: function (index) {\n            return this.refs[index];\n        },\n        nextRangeIndex: function (index) {\n            if (index === this.length - 1) {\n                return 0;\n            } else {\n                return index + 1;\n            }\n        },\n        previousRangeIndex: function (index) {\n            if (index === 0) {\n                return this.length - 1;\n            } else {\n                return index - 1;\n            }\n        },\n        concat: function (ref) {\n            return new UnionRef(this.refs.concat([ref]));\n        },\n        print: function (row, col, mod) {\n            return this.refs.map(function (ref) {\n                return ref.print(row, col, mod);\n            }).join(',');\n        },\n        replaceAt: function (index, ref) {\n            var newRefs = this.refs.slice();\n            newRefs.splice(index, 1, ref);\n            return new UnionRef(newRefs);\n        },\n        leftColumn: function () {\n            return this.map(function (ref) {\n                return ref.leftColumn();\n            });\n        },\n        rightColumn: function () {\n            return this.map(function (ref) {\n                return ref.rightColumn();\n            });\n        },\n        topRow: function () {\n            return this.map(function (ref) {\n                return ref.topRow();\n            });\n        },\n        bottomRow: function () {\n            return this.map(function (ref) {\n                return ref.bottomRow();\n            });\n        },\n        forEachRow: function (callback) {\n            this.forEach(function (ref) {\n                ref.forEachRow(callback);\n            });\n        },\n        forEachColumn: function (callback) {\n            this.forEach(function (ref) {\n                ref.forEachColumn(callback);\n            });\n        },\n        adjust: function (row, col, trow, tcol, forRow, start, delta) {\n            return this.map(function (ref) {\n                return ref.adjust(row, col, trow, tcol, forRow, start, delta);\n            }).simplify();\n        },\n        toString: function () {\n            return this.refs.map(function (ref) {\n                return ref.toString();\n            }).join(', ');\n        },\n        valid: function () {\n            for (var i = this.refs.length; --i >= 0;) {\n                if (this.refs[i].valid()) {\n                    return false;\n                }\n            }\n            return true;\n        },\n        renameSheet: function (oldSheetName, newSheetName) {\n            this.refs.forEach(function (ref) {\n                ref.renameSheet(oldSheetName, newSheetName);\n            });\n        }\n    });\n    spreadsheet.NULLREF = NULL;\n    spreadsheet.SHEETREF = new RangeRef(new CellRef(0, 0), new CellRef(Infinity, Infinity));\n    spreadsheet.FIRSTREF = new CellRef(0, 0);\n    spreadsheet.Ref = Ref;\n    spreadsheet.NameRef = NameRef;\n    spreadsheet.CellRef = CellRef;\n    spreadsheet.RangeRef = RangeRef;\n    spreadsheet.UnionRef = UnionRef;\n    spreadsheet.SHEETREF.print = function () {\n        return '#SHEET';\n    };\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/autofillcalculator', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var AutoFillCalculator = kendo.Class.extend({\n            init: function (grid) {\n                this._grid = grid;\n            },\n            rectIsVertical: function (start, end, x, y) {\n                var startRect = this._grid.rectangle(start.toRangeRef());\n                var endRect = this._grid.rectangle(end.toRangeRef());\n                return Math.abs(endRect[y] - startRect[y]) > Math.abs(startRect[x] - endRect[x]);\n            },\n            autoFillDest: function (selection, cursor) {\n                var topLeft = selection.topLeft;\n                var bottomRight = selection.bottomRight;\n                var quadrant;\n                var lower = cursor.row >= topLeft.row;\n                var further = cursor.col >= topLeft.col;\n                if (lower) {\n                    quadrant = further ? 4 : 3;\n                } else {\n                    quadrant = further ? 2 : 1;\n                }\n                var pivot, opposite, cornerResult, expanding;\n                if (quadrant === 4) {\n                    pivot = topLeft;\n                    opposite = bottomRight;\n                    expanding = cursor.row > opposite.row || cursor.col > opposite.col;\n                    if (expanding) {\n                        cursor = new CellRef(Math.max(cursor.row, opposite.row), Math.max(cursor.col, opposite.col));\n                    }\n                    if (this.rectIsVertical(opposite, cursor, 'right', 'bottom')) {\n                        cornerResult = new CellRef(cursor.row, opposite.col);\n                    } else {\n                        cornerResult = new CellRef(opposite.row, cursor.col);\n                    }\n                } else if (quadrant === 3) {\n                    var bottomLeft = new CellRef(topLeft.col, bottomRight.row);\n                    if (cursor.row > bottomRight.row && this.rectIsVertical(bottomLeft, cursor, 'left', 'bottom')) {\n                        pivot = topLeft;\n                        cornerResult = new CellRef(cursor.row, bottomRight.col);\n                    } else {\n                        pivot = bottomRight;\n                        cornerResult = new CellRef(topLeft.row, cursor.col);\n                    }\n                } else if (quadrant === 2) {\n                    var topRight = new CellRef(topLeft.row, bottomRight.col);\n                    if (cursor.col > bottomRight.col && !this.rectIsVertical(topRight, cursor, 'right', 'top')) {\n                        pivot = topLeft;\n                        cornerResult = new CellRef(bottomRight.row, cursor.col);\n                    } else {\n                        pivot = bottomRight;\n                        cornerResult = new CellRef(cursor.row, topLeft.col);\n                    }\n                } else {\n                    pivot = bottomRight;\n                    if (this.rectIsVertical(topLeft, cursor, 'left', 'top')) {\n                        cornerResult = new CellRef(cursor.row, topLeft.col);\n                    } else {\n                        cornerResult = new CellRef(topLeft.row, cursor.col);\n                    }\n                }\n                return this._grid.normalize(new RangeRef(pivot, cornerResult));\n            }\n        });\n        kendo.spreadsheet.AutoFillCalculator = AutoFillCalculator;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/navigator', [\n        'kendo.core',\n        'spreadsheet/autofillcalculator'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var EdgeNavigator = kendo.Class.extend({\n            init: function (field, axis, rangeGetter, union) {\n                this.rangeGetter = rangeGetter;\n                this.prevLeft = function (index) {\n                    var current = union(this.range(index));\n                    var range = this.range(axis.prevVisible(current.topLeft[field]));\n                    return union(range).topLeft[field];\n                };\n                this.nextRight = function (index) {\n                    var current = union(this.range(index));\n                    var range = this.range(axis.nextVisible(current.bottomRight[field]));\n                    return union(range).bottomRight[field];\n                };\n                this.nextLeft = function (index) {\n                    var range = union(this.range(index));\n                    return axis.nextVisible(range.bottomRight[field]);\n                };\n                this.prevRight = function (index) {\n                    var range = union(this.range(index));\n                    return axis.prevVisible(range.topLeft[field]);\n                };\n            },\n            boundary: function (top, bottom) {\n                this.top = top;\n                this.bottom = bottom;\n            },\n            range: function (index) {\n                return this.rangeGetter(index, this.top, this.bottom);\n            }\n        });\n        var SheetNavigator = kendo.Class.extend({\n            init: function (sheet) {\n                this._sheet = sheet;\n                this.columns = this._sheet._grid._columns;\n                this.autoFillCalculator = new kendo.spreadsheet.AutoFillCalculator(sheet._grid);\n                this.colEdge = new EdgeNavigator('col', this._sheet._grid._columns, this.columnRange.bind(this), this.union.bind(this));\n                this.rowEdge = new EdgeNavigator('row', this._sheet._grid._rows, this.rowRange.bind(this), this.union.bind(this));\n            },\n            height: function (height) {\n                this._viewPortHeight = height;\n            },\n            union: function (ref) {\n                return this._sheet.unionWithMerged(ref);\n            },\n            columnRange: function (col, topRow, bottomRow) {\n                return this._sheet._ref(topRow, col, bottomRow - topRow, 1);\n            },\n            rowRange: function (row, leftCol, rightCol) {\n                return this._sheet._ref(row, leftCol, 1, rightCol - leftCol);\n            },\n            selectionIncludesMergedCells: function () {\n                return this._sheet.select().contains(this._sheet._mergedCells);\n            },\n            setSelectionValue: function (value) {\n                var selection = this._sheet.selection();\n                setTimeout(function () {\n                    selection.value(value());\n                });\n            },\n            selectAll: function () {\n                this._sheet.select(this._sheet._sheetRef);\n            },\n            select: function (ref, mode, addToExisting) {\n                ref = this.refForMode(ref, mode);\n                if (addToExisting) {\n                    ref = this._sheet.select().concat(ref);\n                }\n                this._sheet.select(ref);\n            },\n            refForMode: function (ref, mode) {\n                var grid = this._sheet._grid;\n                switch (mode) {\n                case 'range':\n                    ref = grid.normalize(ref);\n                    break;\n                case 'row':\n                    ref = grid.rowRef(ref.row);\n                    break;\n                case 'column':\n                    ref = grid.colRef(ref.col);\n                    break;\n                case 'sheet':\n                    ref = this._sheet._sheetRef;\n                    break;\n                }\n                return ref;\n            },\n            startSelection: function (ref, mode, addToExisting, shiftKey) {\n                if (mode == 'autofill') {\n                    this._sheet.startAutoFill();\n                } else if (shiftKey && mode == 'range') {\n                    var range = new RangeRef(this._sheet.activeCell().first(), ref);\n                    this._sheet.select(range, false, false);\n                    this._sheet.startSelection();\n                } else {\n                    this._sheet.startSelection();\n                    this.select(ref, mode, addToExisting);\n                }\n            },\n            completeSelection: function () {\n                this._sheet.completeSelection();\n            },\n            selectForContextMenu: function (ref, mode) {\n                var sheet = this._sheet;\n                sheet._activeDrawing = null;\n                if (!sheet.select().contains(this.refForMode(ref, mode))) {\n                    this.select(ref, mode);\n                }\n            },\n            selectDrawingForContextMenu: function (drawing) {\n                var sheet = this._sheet;\n                sheet._activeDrawing = drawing;\n                sheet.triggerChange({ selection: true });\n            },\n            modifySelection: function (action) {\n                var direction = this.determineDirection(action);\n                var sheet = this._sheet;\n                var viewPortHeight = this._viewPortHeight;\n                var rows = sheet._grid._rows;\n                var columns = sheet._grid._columns;\n                var originalSelection = sheet.currentOriginalSelectionRange();\n                var selection = sheet.select().toRangeRef();\n                var activeCell = sheet.activeCell();\n                var topLeft = originalSelection.topLeft.clone();\n                var bottomRight = originalSelection.bottomRight.clone();\n                var scrollInto;\n                this.colEdge.boundary(selection.topLeft.row, selection.bottomRight.row);\n                this.rowEdge.boundary(selection.topLeft.col, selection.bottomRight.col);\n                switch (direction) {\n                case 'expand-left':\n                    topLeft.col = this.colEdge.prevLeft(topLeft.col);\n                    scrollInto = topLeft;\n                    break;\n                case 'shrink-right':\n                    topLeft.col = this.colEdge.nextLeft(topLeft.col);\n                    scrollInto = topLeft;\n                    break;\n                case 'expand-right':\n                    bottomRight.col = this.colEdge.nextRight(bottomRight.col);\n                    scrollInto = bottomRight;\n                    break;\n                case 'shrink-left':\n                    bottomRight.col = this.colEdge.prevRight(bottomRight.col);\n                    scrollInto = bottomRight;\n                    break;\n                case 'expand-up':\n                    topLeft.row = this.rowEdge.prevLeft(topLeft.row);\n                    scrollInto = topLeft;\n                    break;\n                case 'shrink-down':\n                    topLeft.row = this.rowEdge.nextLeft(topLeft.row);\n                    scrollInto = topLeft;\n                    break;\n                case 'expand-down':\n                    bottomRight.row = this.rowEdge.nextRight(bottomRight.row);\n                    scrollInto = bottomRight;\n                    break;\n                case 'shrink-up':\n                    bottomRight.row = this.rowEdge.prevRight(bottomRight.row);\n                    scrollInto = bottomRight;\n                    break;\n                case 'expand-page-up':\n                    topLeft.row = rows.prevPage(topLeft.row, viewPortHeight);\n                    break;\n                case 'shrink-page-up':\n                    bottomRight.row = rows.prevPage(bottomRight.row, viewPortHeight);\n                    break;\n                case 'expand-page-down':\n                    bottomRight.row = rows.nextPage(bottomRight.row, viewPortHeight);\n                    break;\n                case 'shrink-page-down':\n                    topLeft.row = rows.nextPage(topLeft.row, viewPortHeight);\n                    break;\n                case 'first-col':\n                    topLeft.col = columns.firstVisible();\n                    bottomRight.col = activeCell.bottomRight.col;\n                    scrollInto = topLeft;\n                    break;\n                case 'last-col':\n                    bottomRight.col = columns.lastVisible();\n                    topLeft.col = activeCell.topLeft.col;\n                    scrollInto = bottomRight;\n                    break;\n                case 'first-row':\n                    topLeft.row = rows.firstVisible();\n                    bottomRight.row = activeCell.bottomRight.row;\n                    scrollInto = topLeft;\n                    break;\n                case 'last-row':\n                    bottomRight.row = rows.lastVisible();\n                    topLeft.row = activeCell.topLeft.row;\n                    scrollInto = bottomRight;\n                    break;\n                case 'last':\n                    bottomRight.row = rows.lastVisible();\n                    bottomRight.col = columns.lastVisible();\n                    topLeft = activeCell.topLeft;\n                    scrollInto = bottomRight;\n                    break;\n                case 'first':\n                    topLeft.row = rows.firstVisible();\n                    topLeft.col = columns.firstVisible();\n                    bottomRight = activeCell.bottomRight;\n                    scrollInto = topLeft;\n                    break;\n                }\n                var newSelection = new RangeRef(topLeft, bottomRight);\n                if (!this.union(newSelection).intersects(activeCell)) {\n                    this.modifySelection(direction.replace('shrink', 'expand'));\n                    return;\n                }\n                if (scrollInto) {\n                    sheet.focus(scrollInto);\n                }\n                this.updateCurrentSelectionRange(newSelection);\n            },\n            moveActiveCell: function (direction) {\n                var sheet = this._sheet;\n                var activeCell = sheet.activeCell();\n                var topLeft = activeCell.topLeft;\n                var bottomRight = activeCell.bottomRight;\n                var cell = sheet.originalActiveCell();\n                var rows = sheet._grid._rows;\n                var columns = sheet._grid._columns;\n                var row = cell.row;\n                var column = cell.col;\n                switch (direction) {\n                case 'left':\n                    column = columns.prevVisible(topLeft.col);\n                    break;\n                case 'up':\n                    row = rows.prevVisible(topLeft.row);\n                    break;\n                case 'right':\n                    column = columns.nextVisible(bottomRight.col);\n                    break;\n                case 'down':\n                    row = rows.nextVisible(bottomRight.row);\n                    break;\n                case 'first-col':\n                    column = columns.firstVisible();\n                    break;\n                case 'last-col':\n                    column = columns.lastVisible();\n                    break;\n                case 'first-row':\n                    row = rows.firstVisible();\n                    break;\n                case 'last-row':\n                    row = rows.lastVisible();\n                    break;\n                case 'last':\n                    row = rows.lastVisible();\n                    column = columns.lastVisible();\n                    break;\n                case 'first':\n                    row = rows.firstVisible();\n                    column = columns.firstVisible();\n                    break;\n                case 'next-page':\n                    row = rows.nextPage(bottomRight.row, this._viewPortHeight);\n                    break;\n                case 'prev-page':\n                    row = rows.prevPage(bottomRight.row, this._viewPortHeight);\n                    break;\n                }\n                sheet.select(new CellRef(row, column));\n            },\n            navigateInSelection: function (direction) {\n                var sheet = this._sheet;\n                var activeCell = sheet.activeCell();\n                var topLeft = activeCell.topLeft;\n                var cell = sheet.originalActiveCell();\n                var rows = sheet._grid._rows;\n                var columns = sheet._grid._columns;\n                var row = cell.row;\n                var column = cell.col;\n                var selTopLeft, selBottomRight;\n                var topLeftCol = topLeft.col;\n                var topLeftRow = topLeft.row;\n                var tmp;\n                function setSelection(sel) {\n                    selTopLeft = sel.topLeft;\n                    selBottomRight = sel.bottomRight;\n                }\n                setSelection(sheet.currentNavigationRange());\n                var done = false;\n                while (!done) {\n                    var current = new CellRef(row, column);\n                    switch (direction) {\n                    case 'next':\n                        if (selBottomRight.eq(current)) {\n                            setSelection(sheet.nextNavigationRange());\n                            row = selTopLeft.row;\n                            column = selTopLeft.col;\n                        } else {\n                            column = columns.nextVisible(topLeftCol);\n                            if (column == topLeftCol || column > selBottomRight.col) {\n                                column = selTopLeft.col;\n                                tmp = rows.nextVisible(row);\n                                if (tmp == row || tmp > selBottomRight.row) {\n                                    row = selTopLeft.row;\n                                } else {\n                                    row = tmp;\n                                }\n                            }\n                        }\n                        break;\n                    case 'previous':\n                        if (selTopLeft.eq(current)) {\n                            setSelection(sheet.previousNavigationRange());\n                            row = selBottomRight.row;\n                            column = selBottomRight.col;\n                        } else {\n                            column = columns.prevVisible(topLeftCol);\n                            if (column == topLeftCol || column < selTopLeft.col) {\n                                column = selBottomRight.col;\n                                tmp = rows.prevVisible(row);\n                                if (tmp == row || tmp < selTopLeft.row) {\n                                    row = selBottomRight.row;\n                                } else {\n                                    row = tmp;\n                                }\n                            }\n                        }\n                        break;\n                    case 'lower':\n                        if (selBottomRight.eq(current)) {\n                            setSelection(sheet.nextNavigationRange());\n                            row = selTopLeft.row;\n                            column = selTopLeft.col;\n                        } else {\n                            row = rows.nextVisible(topLeftRow);\n                            if (row == topLeftRow || row > selBottomRight.row) {\n                                row = selTopLeft.row;\n                                tmp = columns.nextVisible(column);\n                                if (tmp == column || tmp > selBottomRight.col) {\n                                    column = selTopLeft.col;\n                                } else {\n                                    column = tmp;\n                                }\n                            }\n                        }\n                        break;\n                    case 'upper':\n                        if (selTopLeft.eq(current)) {\n                            setSelection(sheet.previousNavigationRange());\n                            row = selBottomRight.row;\n                            column = selBottomRight.col;\n                        } else {\n                            row = rows.prevVisible(topLeftRow);\n                            if (row == topLeftRow || row < selTopLeft.row) {\n                                row = selBottomRight.row;\n                                tmp = columns.prevVisible(column);\n                                if (tmp == column || tmp < selTopLeft.col) {\n                                    column = selBottomRight.col;\n                                } else {\n                                    column = tmp;\n                                }\n                            }\n                        }\n                        break;\n                    default:\n                        throw new Error('Unknown entry navigation: ' + direction);\n                    }\n                    done = !this.shouldSkip(row, column);\n                    topLeftCol = column;\n                    topLeftRow = row;\n                }\n                if (sheet.singleCellSelection()) {\n                    sheet.select(new CellRef(row, column));\n                } else {\n                    sheet.activeCell(new CellRef(row, column));\n                }\n            },\n            extendSelection: function (ref, mode) {\n                var sheet = this._sheet;\n                var grid = sheet._grid;\n                if (mode === 'autofill') {\n                    this.resizeAutoFill(ref);\n                    return;\n                }\n                if (mode === 'range') {\n                    ref = grid.normalize(ref);\n                } else if (mode === 'row') {\n                    ref = grid.rowRef(ref.row).bottomRight;\n                } else if (mode === 'column') {\n                    ref = grid.colRef(ref.col).bottomRight;\n                }\n                var activeCell = sheet.originalActiveCell().toRangeRef();\n                this.updateCurrentSelectionRange(new RangeRef(activeCell.topLeft, ref));\n            },\n            shouldSkip: function (row, col) {\n                if (this._sheet.isHiddenRow(row) || this._sheet.isHiddenColumn(col)) {\n                    return true;\n                }\n                var ref = new CellRef(row, col);\n                var isMerged = false;\n                this._sheet.forEachMergedCell(function (merged) {\n                    if (merged.intersects(ref) && !merged.collapse().eq(ref)) {\n                        isMerged = true;\n                    }\n                });\n                return isMerged;\n            },\n            resizeAutoFill: function (ref) {\n                var sheet = this._sheet;\n                var selection = sheet.select();\n                var origin = sheet._autoFillOrigin;\n                var dest = this.autoFillCalculator.autoFillDest(selection, ref);\n                var punch = this.punch(selection, dest);\n                var hint, direction;\n                if (!punch) {\n                    var preview = sheet.range(dest)._previewFillFrom(sheet.range(origin));\n                    if (preview) {\n                        direction = preview.direction;\n                        hint = preview.hint;\n                    }\n                }\n                sheet.updateAutoFill(dest, punch, hint, direction);\n            },\n            determineDirection: function (action) {\n                var selection = this._sheet.currentSelectionRange();\n                var activeCell = this._sheet.activeCell();\n                var leftMode = activeCell.topLeft.col == selection.topLeft.col;\n                var rightMode = activeCell.bottomRight.col == selection.bottomRight.col;\n                var topMode = activeCell.topLeft.row == selection.topLeft.row;\n                var bottomMode = activeCell.bottomRight.row == selection.bottomRight.row;\n                switch (action) {\n                case 'left':\n                    action = rightMode ? 'expand-left' : 'shrink-left';\n                    break;\n                case 'right':\n                    action = leftMode ? 'expand-right' : 'shrink-right';\n                    break;\n                case 'up':\n                    action = bottomMode ? 'expand-up' : 'shrink-up';\n                    break;\n                case 'down':\n                    action = topMode ? 'expand-down' : 'shrink-down';\n                    break;\n                case 'prev-page':\n                    action = bottomMode ? 'expand-page-up' : 'shrink-page-up';\n                    break;\n                case 'next-page':\n                    action = topMode ? 'expand-page-down' : 'shrink-page-down';\n                    break;\n                }\n                return action;\n            },\n            updateCurrentSelectionRange: function (ref) {\n                var sheet = this._sheet;\n                sheet.select(sheet.originalSelect().replaceAt(sheet.selectionRangeIndex(), ref), false);\n            },\n            punch: function (selection, subset) {\n                var punch;\n                if (subset.topLeft.eq(selection.topLeft)) {\n                    if (subset.bottomRight.row < selection.bottomRight.row) {\n                        var bottomRow = this.rowEdge.nextRight(subset.bottomRight.row);\n                        punch = new RangeRef(new CellRef(bottomRow, selection.topLeft.col), selection.bottomRight);\n                    } else if (subset.bottomRight.col < selection.bottomRight.col) {\n                        var bottomCol = this.colEdge.nextRight(subset.bottomRight.col);\n                        punch = new RangeRef(new CellRef(selection.topLeft.row, bottomCol), selection.bottomRight);\n                    }\n                }\n                return punch;\n            }\n        });\n        kendo.spreadsheet.SheetNavigator = SheetNavigator;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/axismanager', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var AxisManager = kendo.Class.extend({\n            init: function (sheet) {\n                this._sheet = sheet;\n            },\n            forEachSelectedColumn: function (callback) {\n                var sheet = this._sheet;\n                sheet.batch(function () {\n                    sheet.select().forEachColumnIndex(function (index, i) {\n                        callback(sheet, index, i);\n                    });\n                }, {\n                    layout: true,\n                    recalc: true\n                });\n            },\n            forEachSelectedRow: function (callback) {\n                var sheet = this._sheet;\n                sheet.batch(function () {\n                    sheet.select().forEachRowIndex(function (index, i) {\n                        callback(sheet, index, i);\n                    });\n                }, {\n                    layout: true,\n                    recalc: true\n                });\n            },\n            includesHiddenColumns: function (ref) {\n                return this._sheet._grid._columns.includesHidden(ref.topLeft.col, ref.bottomRight.col);\n            },\n            includesHiddenRows: function (ref) {\n                return this._sheet._grid._rows.includesHidden(ref.topLeft.row, ref.bottomRight.row);\n            },\n            selectionIncludesHiddenColumns: function () {\n                return this.includesHiddenColumns(this._sheet.select());\n            },\n            selectionIncludesHiddenRows: function () {\n                return this.includesHiddenRows(this._sheet.select());\n            },\n            deleteSelectedColumns: function () {\n                var indexes = [], delta = 0;\n                this.forEachSelectedColumn(function (sheet, index) {\n                    index -= delta;\n                    if (sheet.isHiddenColumn(index)) {\n                        return;\n                    }\n                    delta++;\n                    var formulas = [];\n                    indexes.unshift({\n                        index: index,\n                        formulas: formulas,\n                        width: sheet.columnWidth(index)\n                    });\n                    sheet._saveModifiedFormulas(formulas, function () {\n                        sheet.deleteColumn(index);\n                    });\n                });\n                return indexes;\n            },\n            deleteSelectedRows: function () {\n                var indexes = [], delta = 0;\n                this.forEachSelectedRow(function (sheet, index) {\n                    index -= delta;\n                    if (sheet.isHiddenRow(index)) {\n                        return;\n                    }\n                    delta++;\n                    var formulas = [];\n                    indexes.unshift({\n                        index: index,\n                        formulas: formulas,\n                        height: sheet.rowHeight(index)\n                    });\n                    sheet._saveModifiedFormulas(formulas, function () {\n                        sheet.deleteRow(index);\n                    });\n                });\n                return indexes;\n            },\n            hideSelectedColumns: function () {\n                this.forEachSelectedColumn(function (sheet, index) {\n                    sheet.hideColumn(index);\n                });\n                var sheet = this._sheet;\n                var ref = sheet.select().toRangeRef();\n                var left = ref.topLeft.col;\n                var right = ref.bottomRight.col;\n                var sel = null;\n                while (true) {\n                    var hasRight = right < sheet._columns._count;\n                    var hasLeft = left >= 0;\n                    if (!hasLeft && !hasRight) {\n                        break;\n                    }\n                    if (hasRight && !sheet.isHiddenColumn(right)) {\n                        sel = right;\n                        break;\n                    }\n                    if (hasLeft && !sheet.isHiddenColumn(left)) {\n                        sel = left;\n                        break;\n                    }\n                    left--;\n                    right++;\n                }\n                if (sel !== null) {\n                    ref = new kendo.spreadsheet.RangeRef(new kendo.spreadsheet.CellRef(0, sel), new kendo.spreadsheet.CellRef(sheet._rows._count - 1, sel));\n                    sheet.range(ref).select();\n                }\n            },\n            hideSelectedRows: function () {\n                this.forEachSelectedRow(function (sheet, index) {\n                    sheet.hideRow(index);\n                });\n                var sheet = this._sheet;\n                var ref = sheet.select().toRangeRef();\n                var top = ref.topLeft.row;\n                var bottom = ref.bottomRight.row;\n                var sel = null;\n                while (true) {\n                    var hasBottom = bottom < sheet._rows._count;\n                    var hasTop = top >= 0;\n                    if (!hasTop && !hasBottom) {\n                        break;\n                    }\n                    if (hasBottom && !sheet.isHiddenRow(bottom)) {\n                        sel = bottom;\n                        break;\n                    }\n                    if (hasTop && !sheet.isHiddenRow(top)) {\n                        sel = top;\n                        break;\n                    }\n                    top--;\n                    bottom++;\n                }\n                if (sel !== null) {\n                    ref = new kendo.spreadsheet.RangeRef(new kendo.spreadsheet.CellRef(sel, 0), new kendo.spreadsheet.CellRef(sel, sheet._columns._count - 1));\n                    sheet.range(ref).select();\n                }\n            },\n            unhideSelectedColumns: function () {\n                this.forEachSelectedColumn(function (sheet, index) {\n                    sheet.unhideColumn(index);\n                });\n            },\n            unhideSelectedRows: function () {\n                this.forEachSelectedRow(function (sheet, index) {\n                    sheet.unhideRow(index);\n                });\n            },\n            preventAddRow: function () {\n                var range = this._sheet.select().toRangeRef();\n                var rowCount = range.height();\n                return this._sheet.preventInsertRow(0, rowCount);\n            },\n            preventAddColumn: function () {\n                var range = this._sheet.select().toRangeRef();\n                var columnCount = range.width();\n                return this._sheet.preventInsertColumn(0, columnCount);\n            },\n            addColumnLeft: function () {\n                var sheet = this._sheet;\n                var base, count = 0;\n                sheet.batch(function () {\n                    sheet.select().forEachColumnIndex(function (index) {\n                        if (!base) {\n                            base = index;\n                        }\n                        sheet.insertColumn(base);\n                        ++count;\n                    });\n                }, {\n                    recalc: true,\n                    layout: true\n                });\n                return {\n                    base: base,\n                    count: count\n                };\n            },\n            addColumnRight: function () {\n                var sheet = this._sheet;\n                var base, count = 0;\n                sheet.batch(function () {\n                    sheet.select().forEachColumnIndex(function (index) {\n                        base = index + 1;\n                        ++count;\n                    });\n                    for (var i = 0; i < count; ++i) {\n                        sheet.insertColumn(base);\n                    }\n                }, {\n                    recalc: true,\n                    layout: true\n                });\n                return {\n                    base: base,\n                    count: count\n                };\n            },\n            addRowAbove: function () {\n                var sheet = this._sheet;\n                var base, count = 0;\n                sheet.batch(function () {\n                    sheet.select().forEachRowIndex(function (index) {\n                        if (!base) {\n                            base = index;\n                        }\n                        sheet.insertRow(base);\n                        ++count;\n                    });\n                }, {\n                    recalc: true,\n                    layout: true\n                });\n                return {\n                    base: base,\n                    count: count\n                };\n            },\n            addRowBelow: function () {\n                var sheet = this._sheet;\n                var base, count = 0;\n                sheet.batch(function () {\n                    sheet.select().forEachRowIndex(function (index) {\n                        base = index + 1;\n                        ++count;\n                    });\n                    for (var i = 0; i < count; ++i) {\n                        sheet.insertRow(base);\n                    }\n                }, {\n                    recalc: true,\n                    layout: true\n                });\n                return {\n                    base: base,\n                    count: count\n                };\n            }\n        });\n        kendo.spreadsheet.AxisManager = AxisManager;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/clipboard', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var Clipboard = kendo.Class.extend({\n            init: function (workbook) {\n                this._content = {};\n                this._externalContent = {};\n                this._internalContent = {};\n                this.workbook = workbook;\n                this.origin = kendo.spreadsheet.NULLREF;\n                this.iframe = document.createElement('iframe');\n                this.iframe.className = 'k-spreadsheet-clipboard-paste';\n                this.menuInvoked = false;\n                this._uid = kendo.guid();\n                document.body.appendChild(this.iframe);\n            },\n            destroy: function () {\n                document.body.removeChild(this.iframe);\n            },\n            canCopy: function () {\n                var status = { canCopy: true };\n                var selection = this.workbook.activeSheet().select();\n                if (selection === kendo.spreadsheet.NULLREF) {\n                    status.canCopy = false;\n                }\n                if (selection instanceof kendo.spreadsheet.UnionRef) {\n                    status.canCopy = false;\n                    status.multiSelection = true;\n                }\n                if (this.menuInvoked) {\n                    status.canCopy = false;\n                    status.menuInvoked = true;\n                }\n                return status;\n            },\n            canPaste: function () {\n                var sheet = this.workbook.activeSheet();\n                var ref = this.pasteRef();\n                var range = sheet.range(ref);\n                var status = {\n                    canPaste: true,\n                    pasteOnMerged: false,\n                    pasteOnDisabled: false\n                };\n                if (!range.enable()) {\n                    status.canPaste = false;\n                    status.pasteOnDisabled = true;\n                }\n                if (!ref.eq(sheet.unionWithMerged(ref))) {\n                    status.canPaste = false;\n                    status.pasteOnMerged = true;\n                }\n                if (this.menuInvoked) {\n                    status.canPaste = false;\n                    status.menuInvoked = true;\n                }\n                if (ref.bottomRight.row >= sheet._rows._count || ref.bottomRight.col >= sheet._columns._count) {\n                    status.canPaste = false;\n                    status.overflow = true;\n                }\n                return status;\n            },\n            intersectsMerged: function () {\n                var sheet = this.workbook.activeSheet();\n                this.parse();\n                this.origin = this._content.origRef;\n                var ref = this.pasteRef();\n                return !ref.eq(sheet.unionWithMerged(ref));\n            },\n            copy: function () {\n                var sheet = this.workbook.activeSheet();\n                this.origin = sheet.select();\n                this._internalContent = sheet.selection().getState();\n                delete this._externalContent.html;\n                delete this._externalContent.plain;\n            },\n            cut: function () {\n                var sheet = this.workbook.activeSheet();\n                this.copy();\n                sheet.range(sheet.select()).clear();\n            },\n            pasteRef: function () {\n                var sheet = this.workbook.activeSheet();\n                if (this.origin === kendo.spreadsheet.NULLREF) {\n                    return sheet.select();\n                }\n                var destination = sheet.activeCell().first();\n                var originActiveCell = this.origin.first();\n                var rowDelta = originActiveCell.row - destination.row;\n                var colDelta = originActiveCell.col - destination.col;\n                return this.origin.relative(rowDelta, colDelta, 3);\n            },\n            paste: function () {\n                var sheet = this.workbook.activeSheet();\n                var pasteRef = this.pasteRef();\n                sheet.range(pasteRef).setState(this._content, this);\n                sheet.triggerChange({\n                    recalc: true,\n                    ref: pasteRef\n                });\n            },\n            external: function (data) {\n                if (data && (data.html || data.plain)) {\n                    this._externalContent = data;\n                } else {\n                    return this._externalContent;\n                }\n            },\n            isExternal: function () {\n                return !this._isInternal();\n            },\n            parse: function () {\n                var state = newState();\n                if (this._isInternal()) {\n                    state = this._internalContent;\n                } else {\n                    var data = this._externalContent;\n                    if (data.html) {\n                        var doc = this.iframe.contentWindow.document;\n                        doc.open();\n                        doc.write(data.html);\n                        doc.close();\n                        var table = doc.querySelector('table');\n                        if (table) {\n                            state = parseHTML(table);\n                        } else {\n                            state = parseTSV(data.plain);\n                        }\n                    } else {\n                        state = parseTSV(data.plain);\n                    }\n                    this.origin = state.origRef;\n                }\n                this._content = state;\n            },\n            _isInternal: function () {\n                if (this._externalContent.html === undefined) {\n                    return true;\n                }\n                var internalHTML = $('<div/>').html(this._externalContent.html).find('table.kendo-clipboard-' + this._uid).length ? true : false;\n                var internalPlain = $('<div/>').html(this._externalContent.plain).find('table.kendo-clipboard-' + this._uid).length ? true : false;\n                return internalHTML || internalPlain;\n            }\n        });\n        kendo.spreadsheet.Clipboard = Clipboard;\n        function newState() {\n            var ref = new CellRef(0, 0, 0);\n            return {\n                ref: ref,\n                mergedCells: [],\n                data: [],\n                foreign: true,\n                origRef: ref.toRangeRef()\n            };\n        }\n        function setStateData(state, row, col, value) {\n            var data = state.data || (state.data = []);\n            if (!data[row]) {\n                data[row] = [];\n            }\n            data[row][col] = value;\n            var br = state.origRef.bottomRight;\n            br.row = Math.max(br.row, row);\n            br.col = Math.max(br.col, col);\n        }\n        function stripStyle(style) {\n            return style.replace(/^-(?:ms|moz|webkit)-/, '');\n        }\n        function borderObject(styles) {\n            var obj = {};\n            [\n                'borderBottom',\n                'borderRight',\n                'borderLeft',\n                'borderTop'\n            ].forEach(function (key) {\n                obj[key] = styles[key + 'Style'] == 'none' ? null : {\n                    size: 1,\n                    color: styles[key + 'Color']\n                };\n            });\n            return obj;\n        }\n        function cellState(row, col, element, hBorders, vBorders) {\n            var styles = window.getComputedStyle(element);\n            var text = element.innerText.replace(/\\t$/, '');\n            var borders = borderObject(styles);\n            var state = {\n                value: text === '' ? null : text,\n                borderTop: borders.borderTop || hBorders.get(row, col) || null,\n                borderBottom: borders.borderBottom || hBorders.get(row + 1, col) || null,\n                borderLeft: borders.borderLeft || vBorders.get(row, col) || null,\n                borderRight: borders.borderRight || vBorders.get(row, col + 1) || null,\n                fontSize: parseInt(styles['font-size'], 10)\n            };\n            hBorders.set(row, col, state.borderTop);\n            hBorders.set(row + 1, col, state.borderBottom);\n            vBorders.set(row, col, state.borderLeft);\n            vBorders.set(row, col + 1, state.borderRight);\n            if (styles['background-color'] !== 'rgb(0, 0, 0)' && styles['background-color'] !== 'rgba(0, 0, 0, 0)') {\n                state.background = styles['background-color'];\n            }\n            if (styles.color !== 'rgb(0, 0, 0)' && styles.color !== 'rgba(0, 0, 0, 0)') {\n                state.color = styles.color;\n            }\n            if (styles['text-decoration'] == 'underline') {\n                state.underline = true;\n            }\n            if (styles['font-style'] == 'italic') {\n                state.italic = true;\n            }\n            if (styles['font-weight'] == 'bold') {\n                state.bold = true;\n            }\n            if (stripStyle(styles['text-align']) !== 'right') {\n                state.textAlign = stripStyle(styles['text-align']);\n            }\n            if (styles['vertical-align'] !== 'middle') {\n                state.verticalAlign = styles['vertical-align'];\n            }\n            if (styles['word-wrap'] !== 'normal') {\n                state.wrap = true;\n            }\n            return state;\n        }\n        function parseHTML(table) {\n            var state = newState();\n            var done = [], row = 0, col = 0;\n            for (var i = 0; i < table.rows.length; ++i) {\n                done.push([]);\n            }\n            var hBorders = new kendo.spreadsheet.calc.runtime.Matrix();\n            var vBorders = new kendo.spreadsheet.calc.runtime.Matrix();\n            for (var ri = 0; ri < table.rows.length; ++ri, ++row) {\n                var tr = table.rows[ri];\n                col = 0;\n                for (var ci = 0; ci < tr.cells.length; ++ci) {\n                    var td = tr.cells[ci];\n                    var rowSpan = td.rowSpan;\n                    var colSpan = td.colSpan;\n                    while (done[row][col]) {\n                        col++;\n                    }\n                    var style = td.getAttribute('style');\n                    var ignoreColspan = /mso-ignore:colspan/.test(style);\n                    setStateData(state, row, col, cellState(row, col, td, hBorders, vBorders));\n                    if (rowSpan > 1 || colSpan > 1 && !ignoreColspan) {\n                        state.mergedCells.push(new kendo.spreadsheet.RangeRef(new CellRef(row, col), new CellRef(row + rowSpan - 1, col + colSpan - 1)).toString());\n                    }\n                    for (var dr = row + rowSpan; --dr >= row;) {\n                        for (var dc = col + colSpan; --dc >= col;) {\n                            if (dr < done.length) {\n                                done[dr][dc] = true;\n                                if (!(dr == row && dc == col)) {\n                                    setStateData(state, dr, dc, {});\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n            return state;\n        }\n        function parseTSV(data) {\n            var state = newState();\n            if (data.indexOf('\\t') === -1 && data.indexOf('\\n') == -1) {\n                setStateData(state, 0, 0, { value: data });\n            } else {\n                var rows = data.split('\\n');\n                for (var ri = 0; ri < rows.length; ri++) {\n                    var cols = rows[ri].split('\\t');\n                    for (var ci = 0; ci < cols.length; ci++) {\n                        setStateData(state, ri, ci, { value: cols[ci] });\n                    }\n                }\n            }\n            return state;\n        }\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/range', [\n        'kendo.core',\n        'util/text-metrics',\n        'util/main'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var UnionRef = kendo.spreadsheet.UnionRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var PROPERTIES = [\n            'color',\n            'fontFamily',\n            'underline',\n            'italic',\n            'bold',\n            'textAlign',\n            'indent',\n            'verticalAlign',\n            'background',\n            'format',\n            'link',\n            'editor',\n            'borderTop',\n            'borderRight',\n            'borderBottom',\n            'borderLeft',\n            'comment'\n        ];\n        var Range = kendo.Class.extend({\n            init: function (ref, sheet) {\n                this._sheet = sheet;\n                this._ref = ref;\n            },\n            clone: function () {\n                return new Range(this._ref.clone(), this._sheet);\n            },\n            skipHiddenCells: function () {\n                var refs = [];\n                var self = this, sheet = self._sheet;\n                var skipHiddenRows = sheet.isHiddenRow.bind(sheet);\n                var skipHiddenCols = sheet.isHiddenColumn.bind(sheet);\n                self._ref.forEach(function (ref) {\n                    ref = self._normalize(ref.toRangeRef());\n                    var tl = ref.topLeft, br = ref.bottomRight;\n                    var rows = partition(tl.row, br.row, skipHiddenRows);\n                    var cols = partition(tl.col, br.col, skipHiddenCols);\n                    for (var i = 0; i < rows.length; ++i) {\n                        for (var j = 0; j < cols.length; ++j) {\n                            refs.push(new RangeRef(new CellRef(rows[i].begin, cols[j].begin), new CellRef(rows[i].end, cols[j].end)));\n                        }\n                    }\n                });\n                return sheet.range(refs.length > 1 ? new UnionRef(refs) : refs[0]);\n            },\n            _normalize: function (ref) {\n                return this._sheet._grid.normalize(ref);\n            },\n            _set: function (name, value, noTrigger) {\n                var self = this;\n                var sheet = self._sheet;\n                self._ref.forEach(function (ref) {\n                    sheet._set(ref.toRangeRef(), name, value);\n                });\n                if (!noTrigger) {\n                    sheet.triggerChange({\n                        recalc: name == 'formula' || name == 'value' || name == 'validation',\n                        value: value,\n                        range: self,\n                        ref: self._ref\n                    });\n                }\n                return self;\n            },\n            _get: function (name) {\n                return this._sheet._get(this._ref.toRangeRef(), name);\n            },\n            _property: function (name, value) {\n                if (value === undefined) {\n                    return this._get(name);\n                } else {\n                    return this._set(name, value);\n                }\n            },\n            value: function (value) {\n                if (value !== undefined) {\n                    this._set('formula', null, true);\n                }\n                return this._property('value', value);\n            },\n            resize: function (direction) {\n                var ref = this._resizedRef(direction);\n                return new Range(ref, this._sheet);\n            },\n            _resizedRef: function (direction) {\n                return this._ref.map(function (ref) {\n                    return ref.toRangeRef().resize(direction);\n                });\n            },\n            input: function (value, options) {\n                options = $.extend({ arrayFormula: false }, options);\n                var existingFormat = this._get('format'), x;\n                if (value !== undefined) {\n                    var tl = this._ref.toRangeRef().topLeft;\n                    x = kendo.spreadsheet.calc.parse(this._sheet.name(), tl.row, tl.col, value, existingFormat);\n                    this._sheet.batch(function () {\n                        var formula = null;\n                        if (x.type == 'exp') {\n                            formula = kendo.spreadsheet.calc.compile(x);\n                        } else if (existingFormat != '@') {\n                            var existingFormatType = existingFormat && kendo.spreadsheet.formatting.type(x.value, existingFormat);\n                            if (x.type == 'date' && existingFormatType != 'date') {\n                                this.format(x.format || toExcelFormat(kendo.culture().calendar.patterns.d));\n                            } else if (x.type == 'percent' && existingFormatType != 'percent') {\n                                this.format(x.value * 100 == (x.value * 100 | 0) ? '0%' : '0.00%');\n                            } else if (x.format) {\n                                if (!existingFormat || x.currency || existingFormatType == 'number' && x.type == 'number' && x.format.length > existingFormat.length) {\n                                    this.format(x.format);\n                                }\n                            }\n                        } else if (x.type != 'string') {\n                            x.value = value;\n                        }\n                        this.formula(formula, options.arrayFormula);\n                        if (!formula) {\n                            this.value(x.value);\n                        }\n                    }.bind(this), {\n                        recalc: true,\n                        value: value,\n                        ref: this._ref,\n                        editorChange: this._sheet.isInEditMode()\n                    });\n                    return this;\n                } else {\n                    value = this._get('value');\n                    var formula = this._get('formula');\n                    var type = existingFormat && !formula && kendo.spreadsheet.formatting.type(value, existingFormat);\n                    if (formula) {\n                        value = '=' + formula;\n                    } else\n                        OUT: {\n                            if (existingFormat && type == 'date') {\n                                var t1 = kendo.spreadsheet.formatting.text(value, existingFormat);\n                                x = kendo.spreadsheet.calc.parse(null, null, null, t1, existingFormat);\n                                var t2 = kendo.spreadsheet.formatting.text(x.value, existingFormat);\n                                if (t1 == t2) {\n                                    value = t1;\n                                    break OUT;\n                                }\n                            }\n                            if (type === 'date') {\n                                value = kendo.toString(kendo.spreadsheet.numberToDate(value), kendo.culture().calendar.patterns.d);\n                            } else if (type === 'percent') {\n                                value = kendo.spreadsheet.calc.runtime.limitPrecision(value * 100) + '%';\n                            } else if (typeof value == 'string' && (/^[=']/.test(value) || /^(?:true|false)$/i.test(value) || looksLikeANumber(value))) {\n                                value = '\\'' + value;\n                            } else if (this._sheet._useCultureDecimals() && typeof value == 'number' && value != Math.floor(value)) {\n                                value = String(value).replace('.', kendo.culture().numberFormat['.']);\n                            }\n                        }\n                    return value;\n                }\n            },\n            enable: function (value) {\n                if (value === undefined) {\n                    return !kendo.util.withExit(function (exit) {\n                        this._sheet.forEach(this._ref, function (_, __, data) {\n                            if (data.enable === false) {\n                                exit(true);\n                            }\n                        });\n                    }, this);\n                }\n                return this._property('enable', value);\n            },\n            formula: function (value, arrayFormula) {\n                var self = this;\n                if (value === undefined) {\n                    var f = self._get('formula');\n                    return f ? '' + f : null;\n                }\n                if (arrayFormula) {\n                    var ref = this._ref.toRangeRef();\n                    value = self._sheet.range(ref.topLeft)._set('formula', value)._get('formula');\n                    if (value) {\n                        value.setArrayFormulaRange(ref);\n                    }\n                } else {\n                    self._set('formula', value);\n                }\n                return self;\n            },\n            intersectingArrayFormula: function () {\n                var ref = this._ref.clone().simplify().setSheet(this._sheet.name());\n                return kendo.util.withExit(function (exit) {\n                    this._sheet._forFormulas(function (f) {\n                        var r = f.arrayFormulaRange;\n                        if (r && (r = ref.intersect(r)) !== kendo.spreadsheet.NULLREF) {\n                            exit({\n                                formula: f,\n                                intersection: r\n                            });\n                        }\n                    });\n                }, this);\n            },\n            canEditArrayFormula: function () {\n                var x = this.intersectingArrayFormula();\n                if (x) {\n                    return x.formula.arrayFormulaRange.eq(x.intersection);\n                }\n                return true;\n            },\n            validation: function (value) {\n                if (value === undefined) {\n                    var f = this._get('validation');\n                    return f ? f.toJSON() : null;\n                }\n                return this._property('validation', value);\n            },\n            _getValidationState: function () {\n                var ref = this._ref.toRangeRef();\n                var topLeftRow = ref.topLeft.row;\n                var topLeftCol = ref.topLeft.col;\n                var bottomRightRow = ref.bottomRight.row;\n                var bottomRightCol = ref.bottomRight.col;\n                var ci, ri;\n                for (ci = topLeftCol; ci <= bottomRightCol; ci++) {\n                    for (ri = topLeftRow; ri <= bottomRightRow; ri++) {\n                        var validation = this._sheet._validation(ri, ci);\n                        if (validation && validation.type === 'reject' && validation.value === false) {\n                            return validation;\n                        }\n                    }\n                }\n                return false;\n            },\n            merge: function () {\n                this._ref = this._sheet._merge(this._ref);\n                return this;\n            },\n            unmerge: function () {\n                var mergedCells = this._sheet._mergedCells;\n                this._ref.forEach(function (ref) {\n                    ref.toRangeRef().intersecting(mergedCells).forEach(function (mergedRef) {\n                        mergedCells.splice(mergedCells.indexOf(mergedRef), 1);\n                    });\n                });\n                this._sheet.triggerChange({});\n                return this;\n            },\n            select: function () {\n                this._sheet.select(this._ref);\n                return this;\n            },\n            values: function (values) {\n                if (this._ref instanceof UnionRef) {\n                    throw new Error('Unsupported for multiple ranges.');\n                }\n                if (this._ref === kendo.spreadsheet.NULLREF) {\n                    if (values !== undefined) {\n                        throw new Error('Unsupported for NULLREF.');\n                    } else {\n                        return [];\n                    }\n                }\n                var ref = this._ref.toRangeRef();\n                var topLeftRow = ref.topLeft.row;\n                var topLeftCol = ref.topLeft.col;\n                var bottomRightRow = ref.bottomRight.row;\n                var bottomRightCol = ref.bottomRight.col;\n                var ci, ri;\n                if (values === undefined) {\n                    values = new Array(ref.height());\n                    for (var vi = 0; vi < values.length; vi++) {\n                        values[vi] = new Array(ref.width());\n                    }\n                    for (ci = topLeftCol; ci <= bottomRightCol; ci++) {\n                        for (ri = topLeftRow; ri <= bottomRightRow; ri++) {\n                            values[ri - topLeftRow][ci - topLeftCol] = this._sheet._value(ri, ci);\n                        }\n                    }\n                    return values;\n                } else {\n                    this._sheet._set(ref, 'formula', null);\n                    for (ci = topLeftCol; ci <= bottomRightCol; ci++) {\n                        for (ri = topLeftRow; ri <= bottomRightRow; ri++) {\n                            var row = values[ri - topLeftRow];\n                            if (row) {\n                                var value = row[ci - topLeftCol];\n                                if (value !== undefined) {\n                                    this._sheet._value(ri, ci, value);\n                                }\n                            }\n                        }\n                    }\n                    this._sheet.triggerChange({\n                        recalc: true,\n                        ref: ref\n                    });\n                    return this;\n                }\n            },\n            _properties: function (props, isAutofill) {\n                if (this._ref instanceof UnionRef) {\n                    throw new Error('Unsupported for multiple ranges.');\n                }\n                if (this._ref === kendo.spreadsheet.NULLREF) {\n                    if (props !== undefined) {\n                        throw new Error('Unsupported for NULLREF.');\n                    } else {\n                        return [];\n                    }\n                }\n                var ref = this._ref.toRangeRef();\n                var topLeftRow = ref.topLeft.row;\n                var topLeftCol = ref.topLeft.col;\n                var bottomRightRow = ref.bottomRight.row;\n                var bottomRightCol = ref.bottomRight.col;\n                var ci, ri;\n                var sheet = this._sheet;\n                if (props === undefined) {\n                    props = new Array(ref.height());\n                    sheet.forEach(ref, function (row, col, data) {\n                        row -= topLeftRow;\n                        col -= topLeftCol;\n                        var line = props[row] || (props[row] = []);\n                        line[col] = data;\n                    });\n                    return props;\n                } else {\n                    var data;\n                    ref = ref.clone();\n                    var setProp = function (propName) {\n                        var propValue = data[propName];\n                        ref.topLeft.row = ref.bottomRight.row = ri;\n                        ref.topLeft.col = ref.bottomRight.col = ci;\n                        if (propName == 'value') {\n                            sheet._set(ref, 'formula', null);\n                        }\n                        sheet._set(ref, propName, propValue);\n                    };\n                    for (ci = topLeftCol; ci <= bottomRightCol; ci++) {\n                        if (!isAutofill && sheet.isHiddenColumn(ci)) {\n                            continue;\n                        }\n                        for (ri = topLeftRow; ri <= bottomRightRow; ri++) {\n                            if (!isAutofill && sheet.isHiddenRow(ri)) {\n                                continue;\n                            }\n                            if (isAutofill && sheet.isFilteredRow(ri)) {\n                                continue;\n                            }\n                            var row = props[ri - topLeftRow];\n                            if (row) {\n                                data = row[ci - topLeftCol];\n                                if (data) {\n                                    Object.keys(data).forEach(setProp);\n                                }\n                            }\n                        }\n                    }\n                    sheet.triggerChange({\n                        recalc: true,\n                        ref: this._ref\n                    });\n                    return this;\n                }\n            },\n            clear: function (options) {\n                options = options || {};\n                var clearAll = options.clearAll || !Object.keys(options).length;\n                var sheet = this._sheet;\n                var reason = {\n                    recalc: clearAll || options.contentsOnly,\n                    ref: this._ref\n                };\n                sheet.batch(function () {\n                    if (reason.recalc) {\n                        this.formula(null);\n                    }\n                    if (clearAll) {\n                        this.validation(null);\n                    }\n                    if (clearAll || options.formatOnly) {\n                        PROPERTIES.forEach(function (x) {\n                            if (!(options.keepBorders && /^border/i.test(x))) {\n                                this[x](null);\n                            }\n                        }.bind(this));\n                        this.fontSize(null);\n                        this.wrap(null);\n                        this.unmerge();\n                    }\n                }.bind(this), reason);\n                return this;\n            },\n            clearContent: function () {\n                return this.clear({ contentsOnly: true });\n            },\n            clearFormat: function () {\n                return this.clear({ formatOnly: true });\n            },\n            isSortable: function () {\n                return !this.cantSort();\n            },\n            cantSort: function () {\n                if (this._ref instanceof UnionRef) {\n                    return {\n                        code: 'cantSortMultipleSelection',\n                        message: 'Unsupported for multiple ranges.'\n                    };\n                }\n                if (this._ref === kendo.spreadsheet.NULLREF) {\n                    return {\n                        code: 'cantSortNullRef',\n                        message: 'Unsupported for NULLREF.'\n                    };\n                }\n                var mc = this._sheet._getMergedCells(this._ref.toRangeRef());\n                var primary = mc.primary;\n                var secondary = mc.secondary;\n                var width = null, height = null;\n                var cant = {};\n                try {\n                    this._sheet.forEach(this, function (row, col) {\n                        var id = new CellRef(row, col).print();\n                        var merged = primary[id];\n                        if (merged) {\n                            if (width === null) {\n                                width = merged.width();\n                                height = merged.height();\n                            } else if (!(width == merged.width() && height == merged.height())) {\n                                throw cant;\n                            }\n                        } else if (!secondary[id] && mc.hasMerged) {\n                            throw cant;\n                        }\n                    });\n                } catch (ex) {\n                    if (ex !== cant) {\n                        throw ex;\n                    }\n                    return {\n                        code: 'cantSortMixedCells',\n                        message: 'Unsupported for range containing cells of different shapes.'\n                    };\n                }\n                return false;\n            },\n            sort: function (spec) {\n                var reason = this.cantSort();\n                if (reason) {\n                    throw new Error(reason.message);\n                }\n                if (spec === undefined) {\n                    spec = { column: 0 };\n                }\n                spec = spec instanceof Array ? spec : [spec];\n                this._sheet._sortBy(this._ref.toRangeRef(), spec.map(function (spec, index) {\n                    if (typeof spec === 'number') {\n                        spec = { column: spec };\n                    }\n                    return {\n                        index: spec.column === undefined ? index : spec.column,\n                        ascending: spec.ascending === undefined ? true : spec.ascending\n                    };\n                }));\n                return this;\n            },\n            isFilterable: function () {\n                return !(this._ref instanceof UnionRef);\n            },\n            filter: function (spec) {\n                if (this._ref instanceof UnionRef) {\n                    throw new Error('Unsupported for multiple ranges.');\n                }\n                if (spec === false) {\n                    this.clearFilters();\n                } else {\n                    spec = spec === true ? [] : spec instanceof Array ? spec : [spec];\n                    this._sheet._filterBy(this._ref.toRangeRef(), spec.map(function (spec, index) {\n                        return {\n                            index: spec.column === undefined ? index : spec.column,\n                            filter: spec.filter\n                        };\n                    }));\n                }\n                return this;\n            },\n            clearFilter: function (spec) {\n                this._sheet.clearFilter(spec);\n            },\n            clearFilters: function () {\n                var filter = this._sheet.filter();\n                var spec = [];\n                if (filter) {\n                    for (var i = 0; i < filter.columns.length; i++) {\n                        spec.push(filter.columns[i].index);\n                    }\n                    this._sheet.batch(function () {\n                        this.clearFilter(spec);\n                        this._filter = null;\n                    }, {\n                        layout: true,\n                        filter: true\n                    });\n                }\n            },\n            hasFilter: function () {\n                var filter = this._sheet.filter();\n                return !!filter;\n            },\n            leftColumn: function () {\n                return new Range(this._ref.leftColumn(), this._sheet);\n            },\n            rightColumn: function () {\n                return new Range(this._ref.rightColumn(), this._sheet);\n            },\n            topRow: function () {\n                return new Range(this._ref.topRow(), this._sheet);\n            },\n            bottomRow: function () {\n                return new Range(this._ref.bottomRow(), this._sheet);\n            },\n            column: function (column) {\n                return new Range(this._ref.toColumn(column), this._sheet);\n            },\n            row: function (row) {\n                return new Range(this._ref.toRow(row), this._sheet);\n            },\n            forEachRow: function (callback) {\n                this._ref.forEachRow(function (ref) {\n                    callback(new Range(ref, this._sheet));\n                }.bind(this));\n            },\n            forEachColumn: function (callback) {\n                this._ref.forEachColumn(function (ref) {\n                    callback(new Range(ref, this._sheet));\n                }.bind(this));\n            },\n            sheet: function () {\n                return this._sheet;\n            },\n            topLeft: function () {\n                return this._ref.toRangeRef().topLeft;\n            },\n            intersectingMerged: function () {\n                var sheet = this._sheet;\n                var mergedCells = [];\n                sheet._mergedCells.forEach(function (ref) {\n                    if (ref.intersects(this._ref)) {\n                        mergedCells.push(ref.toString());\n                    }\n                }.bind(this));\n                return mergedCells;\n            },\n            getState: function (propertyName) {\n                var topLeft = this._ref.first();\n                var state = {\n                    ref: topLeft,\n                    data: [],\n                    origRef: this._ref,\n                    rows: this._sheet._rows.getState()\n                };\n                var properties;\n                if (!propertyName) {\n                    properties = kendo.spreadsheet.ALL_PROPERTIES;\n                    state.mergedCells = this.intersectingMerged();\n                } else if (propertyName === 'input') {\n                    properties = [\n                        'value',\n                        'formula'\n                    ];\n                } else if (propertyName === 'border') {\n                    properties = [\n                        'borderLeft',\n                        'borderTop',\n                        'borderRight',\n                        'borderBottom'\n                    ];\n                } else {\n                    properties = [propertyName];\n                }\n                var data = state.data;\n                this.forEachCell(function (row, col, cell) {\n                    var cellState = {};\n                    var dr = row - topLeft.row;\n                    var dc = col - topLeft.col;\n                    if (!data[dr]) {\n                        data[dr] = [];\n                    }\n                    data[dr][dc] = cellState;\n                    properties.forEach(function (property) {\n                        var value = typeof cell[property] == 'undefined' ? null : cell[property];\n                        if (value instanceof kendo.spreadsheet.calc.runtime.Formula || value instanceof kendo.spreadsheet.validation.Validation) {\n                            value = value.deepClone();\n                        }\n                        cellState[property] = value;\n                    });\n                });\n                return state;\n            },\n            setState: function (state, clipboard) {\n                var sheet = this._sheet;\n                var origin = this._ref.first();\n                var rowDelta = state.ref.row - origin.row;\n                var colDelta = state.ref.col - origin.col;\n                var internalClipboard = clipboard && !clipboard.isExternal();\n                var externalClipboard = clipboard && !internalClipboard;\n                sheet.batch(function () {\n                    if (state.mergedCells) {\n                        this.unmerge();\n                    }\n                    if (!clipboard) {\n                        this._sheet._rows.setState(state.rows);\n                    }\n                    var row = origin.row;\n                    var hasFilter = this.hasFilter();\n                    state.data.forEach(function (data, dr) {\n                        if (hasFilter && internalClipboard && sheet.isHiddenRow(state.ref.row + dr)) {\n                            return;\n                        }\n                        var col = origin.col;\n                        data.forEach(function (cellState, dc) {\n                            if (hasFilter && internalClipboard && sheet.isHiddenColumn(state.ref.col + dc)) {\n                                return;\n                            }\n                            var range = clipboard ? sheet.range(row, col) : sheet.range(origin.row + dr, origin.col + dc);\n                            if (range.enable()) {\n                                for (var property in cellState) {\n                                    if (property != 'value') {\n                                        if (!(clipboard && property == 'enable')) {\n                                            range._set(property, cellState[property]);\n                                        }\n                                    }\n                                }\n                                if (!cellState.formula) {\n                                    if (externalClipboard) {\n                                        try {\n                                            if (cellState.value == null) {\n                                                range._set('value', null);\n                                            } else {\n                                                range.input(cellState.value);\n                                            }\n                                        } catch (ex) {\n                                            range._set('value', cellState.value);\n                                        }\n                                    } else {\n                                        range._set('value', cellState.value);\n                                    }\n                                }\n                            }\n                            col++;\n                        });\n                        row++;\n                    });\n                    if (state.mergedCells) {\n                        state.mergedCells.forEach(function (merged) {\n                            merged = sheet._ref(merged).relative(rowDelta, colDelta, 3);\n                            sheet.range(merged).merge();\n                        }, this);\n                    }\n                }.bind(this), {\n                    recalc: true,\n                    ref: this._ref\n                });\n            },\n            _adjustRowHeight: function () {\n                var that = this;\n                var sheet = that._sheet;\n                var mc = sheet._getMergedCells(that._ref.toRangeRef());\n                var primary = mc.primary;\n                var secondary = mc.secondary;\n                sheet.batch(function () {\n                    that.forEachRow(function (rowRange) {\n                        var row = rowRange._ref.topLeft.row;\n                        var height = sheet.rowHeight(row);\n                        rowRange.forEachCell(function (row, col, cell) {\n                            var id = new CellRef(row, col).print();\n                            if (secondary[id]) {\n                                return;\n                            }\n                            var merged = primary[id];\n                            var width;\n                            if (merged) {\n                                width = sheet._columns.sum(merged.topLeft.col, merged.bottomRight.col);\n                            } else {\n                                width = sheet.columnWidth(col);\n                            }\n                            var data = cell.value;\n                            if (cell.format && data != null) {\n                                data = kendo.spreadsheet.formatting.format(data, cell.format);\n                            }\n                            var textHeight = kendo.spreadsheet.util.getTextHeight(data, width, cell.fontFamily, cell.fontSize, cell.wrap);\n                            height = Math.max(height, textHeight);\n                        });\n                        sheet.rowHeight(row, height);\n                    });\n                }, { layout: true });\n            },\n            forEachCell: function (callback) {\n                this._ref.forEach(function (ref) {\n                    this._sheet.forEach(ref.toRangeRef(), callback.bind(this));\n                }.bind(this));\n            },\n            hasValue: function () {\n                var defStyle = this._sheet._defaultCellStyle;\n                return kendo.util.withExit(function (exit) {\n                    this.forEachCell(function (row, col, cell) {\n                        for (var key in cell) {\n                            var val = cell[key];\n                            if (val !== undefined && val !== null && val !== defStyle[key]) {\n                                exit(true);\n                            }\n                        }\n                    });\n                }, this);\n            },\n            wrap: function (flag) {\n                if (flag === undefined) {\n                    return !!this._property('wrap');\n                }\n                this._property('wrap', flag);\n                if (flag !== null) {\n                    this._adjustRowHeight();\n                }\n                return this;\n            },\n            fontSize: function (size) {\n                if (size === undefined) {\n                    return this._property('fontSize');\n                }\n                this._property('fontSize', size);\n                if (size !== null) {\n                    this._adjustRowHeight();\n                }\n                return this;\n            },\n            draw: function (options, callback) {\n                this._sheet.draw(this, options, callback);\n            },\n            insideBorders: function (value) {\n                return this.insideVerticalBorders(value).insideHorizontalBorders(value);\n            },\n            insideVerticalBorders: function (value) {\n                this._ref.forEach(function (ref) {\n                    if (ref instanceof RangeRef && ref.width() > 1) {\n                        ref = ref.clone();\n                        ref.topLeft.col++;\n                        this._sheet.range(ref)._set('vBorders', value);\n                    }\n                }, this);\n                return this;\n            },\n            insideHorizontalBorders: function (value) {\n                this._ref.forEach(function (ref) {\n                    if (ref instanceof RangeRef && ref.height() > 1) {\n                        ref = ref.clone();\n                        ref.topLeft.row++;\n                        this._sheet.range(ref)._set('hBorders', value);\n                    }\n                }, this);\n                return this;\n            }\n        });\n        function partition(begin, end, predicate) {\n            while (begin <= end && predicate(begin)) {\n                begin++;\n            }\n            if (begin > end) {\n                return [];\n            }\n            for (var i = begin + 1; i <= end; ++i) {\n                if (predicate(i)) {\n                    return [{\n                            begin: begin,\n                            end: i - 1\n                        }].concat(partition(i + 1, end, predicate));\n                }\n            }\n            return [{\n                    begin: begin,\n                    end: end\n                }];\n        }\n        $.each(PROPERTIES, function (i, property) {\n            Range.prototype[property] = function (value) {\n                return this._property(property, value);\n            };\n        });\n        function toExcelFormat(format) {\n            return format.replace(/M/g, 'm').replace(/'/g, '\"').replace(/tt/, 'am/pm');\n        }\n        function looksLikeANumber(str) {\n            return !/^=/.test(str) && /number|percent/.test(kendo.spreadsheet.calc.parse(null, 0, 0, str).type);\n        }\n        var measureBox = $('<div style=\"position: absolute !important; top: -4000px !important; height: auto !important;' + 'padding: 1px 3px !important; box-sizing: border-box; margin: 0 !important; border: 1px solid black !important;' + 'line-height: normal !important; visibility: hidden !important;' + 'white-space: pre-wrap;\" />')[0];\n        function getTextHeight(text, width, fontFamily, fontSize, wrap) {\n            var styles = {\n                'baselineMarkerSize': 0,\n                'width': wrap === true ? width + 'px' : 'auto',\n                'font-size': (fontSize || 12) + 'px',\n                'font-family': fontFamily || 'Arial',\n                'white-space': wrap === true ? 'pre-wrap' : 'pre',\n                'overflow-wrap': wrap === true ? 'break-word' : 'normal',\n                'word-wrap': wrap === true ? 'break-word' : 'normal'\n            };\n            return kendo.util.measureText(text, styles, {\n                box: measureBox,\n                normalizeText: false\n            }).height;\n        }\n        kendo.spreadsheet.util = { getTextHeight: getTextHeight };\n        kendo.spreadsheet.Range = Range;\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/runtime', ['spreadsheet/references'], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var calc = {};\n    var spreadsheet = kendo.spreadsheet;\n    spreadsheet.calc = calc;\n    var exports = calc.runtime = {};\n    var Class = kendo.Class;\n    var Ref = spreadsheet.Ref;\n    var CellRef = spreadsheet.CellRef;\n    var RangeRef = spreadsheet.RangeRef;\n    var UnionRef = spreadsheet.UnionRef;\n    var NULL = spreadsheet.NULLREF;\n    function CalcError(code) {\n        if (code instanceof CalcError) {\n            return code;\n        }\n        this.code = code;\n    }\n    CalcError.prototype.toString = function () {\n        return '#' + this.code + (this.code == 'NAME' ? '?' : '!');\n    };\n    var Context = Class.extend({\n        init: function Context(callback, formula, ss, parent) {\n            this.callback = callback;\n            this.formula = formula;\n            this.ss = ss;\n            this.parent = parent;\n        },\n        resolve: function (val) {\n            var self = this;\n            if (val instanceof Ref) {\n                self.resolveCells([val], function () {\n                    self._resolve(val);\n                });\n            } else {\n                self._resolve(val);\n            }\n        },\n        error: function (val) {\n            return new CalcError(val);\n        },\n        _resolve: function (val) {\n            if (val === undefined) {\n                val = null;\n            } else if (Array.isArray(val)) {\n                val = this.asMatrix(val);\n            } else {\n                val = maybeRoundFloatErrors(val);\n            }\n            var f = this.formula;\n            if (f.arrayFormulaRange) {\n                val = this.asMatrix(val) || this.asMatrix([[val]]);\n            } else if (val instanceof RangeRef) {\n                val = this._arrayArg(val);\n            }\n            f.value = val;\n            if (this.ss.onFormula(f) && this.callback) {\n                this.callback.call(f, val);\n            }\n        },\n        resolveCells: function (a, f) {\n            var context = this, formulas = [];\n            (function loop(a) {\n                for (var i = 0; i < a.length; ++i) {\n                    var x = a[i];\n                    if (x instanceof Ref) {\n                        add(context.getRefCells(x));\n                    }\n                    if (Array.isArray(x)) {\n                        loop(x);\n                    }\n                }\n            }(a));\n            if (!formulas.length) {\n                return f.call(context);\n            }\n            for (var pending = formulas.length, i = 0; i < formulas.length; ++i) {\n                fetch(formulas[i]);\n            }\n            function fetch(formula) {\n                formula.exec(context.ss, function () {\n                    if (!--pending) {\n                        f.call(context);\n                    }\n                }, context);\n            }\n            function add(a) {\n                for (var i = 0; i < a.length; ++i) {\n                    var cell = a[i];\n                    if (cell.formula) {\n                        formulas.push(cell.formula);\n                    }\n                }\n                return true;\n            }\n        },\n        cellValues: function (a, wantNulls) {\n            var ret = [];\n            for (var i = 0; i < a.length; ++i) {\n                var val = a[i];\n                if (val instanceof Ref) {\n                    val = this.getRefData(val, wantNulls);\n                    ret = ret.concat(val);\n                } else if (Array.isArray(val)) {\n                    ret = ret.concat(this.cellValues(val, wantNulls));\n                } else if (val instanceof Matrix) {\n                    ret = ret.concat(this.cellValues(val.data, wantNulls));\n                } else {\n                    ret.push(val);\n                }\n            }\n            return ret;\n        },\n        fetchName: function (ref, callback) {\n            var f = this.formula;\n            var val = this.ss.nameValue(ref, f.sheet, f.row, f.col);\n            if (val instanceof Formula) {\n                val = val.clone(f.sheet, f.row, f.col, true);\n                var ss = new spreadsheet.ValidationFormulaContext(this.ss.workbook);\n                val.exec(ss, callback, this);\n            } else {\n                if (val instanceof Ref) {\n                    val = val.absolute(f.row, f.col);\n                    if (!val.sheet) {\n                        val.sheet = f.sheet;\n                    }\n                }\n                callback(val == null ? new CalcError('NAME') : val);\n            }\n        },\n        force: function (val) {\n            if (val instanceof Ref) {\n                return this.getRefData(val);\n            }\n            return val;\n        },\n        func: function (fname, callback, args) {\n            fname = fname.toLowerCase();\n            var f = FUNCS[fname];\n            if (f) {\n                return f.call(this, callback, args);\n            }\n            callback(new CalcError('NAME'));\n        },\n        bool: function (val) {\n            if (val instanceof Ref) {\n                val = this.getRefData(val);\n            }\n            if (typeof val == 'string') {\n                return val.toLowerCase() == 'true';\n            }\n            if (typeof val == 'number') {\n                return val !== 0;\n            }\n            if (typeof val == 'boolean') {\n                return val;\n            }\n            return val != null;\n        },\n        _arrayArg: function (ref) {\n            var f = this.formula;\n            if (!f.arrayFormulaRange && ref instanceof RangeRef) {\n                if (ref.height() == 1 && f.col >= ref.topLeft.col && f.col <= ref.bottomRight.col) {\n                    return this.getRefData(new CellRef(ref.topLeft.row, f.col).setSheet(ref.sheet));\n                }\n                if (ref.width() == 1 && f.row >= ref.topLeft.row && f.row <= ref.bottomRight.row) {\n                    return this.getRefData(new CellRef(f.row, ref.topLeft.col).setSheet(ref.sheet));\n                }\n                return new CalcError('VALUE');\n            } else {\n                return this.asMatrix(ref);\n            }\n        },\n        asMatrix: function (range) {\n            if (range instanceof Matrix) {\n                return range;\n            }\n            var self = this;\n            if (range instanceof RangeRef) {\n                var tl = range.topLeft;\n                var top = tl.row, left = tl.col;\n                var cells = self.getRefCells(range);\n                var m = new Matrix(self);\n                if (isFinite(range.width())) {\n                    m.width = range.width();\n                }\n                if (isFinite(range.height())) {\n                    m.height = range.height();\n                }\n                if (!isFinite(top)) {\n                    top = 0;\n                }\n                if (!isFinite(left)) {\n                    left = 0;\n                }\n                cells.forEach(function (cell) {\n                    m.set(cell.row - top, cell.col - left, cell.value);\n                });\n                return m;\n            }\n            if (Array.isArray(range) && range.length > 0) {\n                var m = new Matrix(self), row = 0;\n                range.forEach(function (line) {\n                    var col = 0;\n                    var h = 1;\n                    line.forEach(function (el) {\n                        var isRange = el instanceof RangeRef;\n                        if (el instanceof Ref && !isRange) {\n                            el = self.getRefData(el);\n                        }\n                        if (isRange || Array.isArray(el)) {\n                            el = self.asMatrix(el);\n                        }\n                        if (el instanceof Matrix) {\n                            el.each(function (el, r, c) {\n                                m.set(row + r, col + c, el);\n                            });\n                            h = Math.max(h, el.height);\n                            col += el.width;\n                        } else {\n                            m.set(row, col++, el);\n                        }\n                    });\n                    row += h;\n                });\n                return m;\n            }\n        },\n        getRefCells: function (refs, hiddenInfo, wantNulls) {\n            var f = this.formula;\n            return this.ss.getRefCells(refs, hiddenInfo, f.sheet, f.row, f.col, wantNulls);\n        },\n        getRefData: function (ref, wantNulls) {\n            var f = this.formula;\n            return this.ss.getData(ref, f.sheet, f.row, f.col, wantNulls);\n        },\n        workbook: function () {\n            return this.ss.workbook;\n        }\n    });\n    var Matrix = Class.extend({\n        init: function Matrix(context) {\n            this.context = context;\n            this.height = 0;\n            this.width = 0;\n            this.data = [];\n        },\n        clone: function () {\n            var m = new Matrix(this.context);\n            m.height = this.height;\n            m.width = this.width;\n            m.data = this.data.map(function (row) {\n                return row.slice();\n            });\n            return m;\n        },\n        get: function (row, col) {\n            var line = this.data[row];\n            var val = line ? line[col] : null;\n            return val instanceof Ref ? this.context.getRefData(val) : val;\n        },\n        getNA: function (row, col) {\n            if (row < this.height && col < this.width) {\n                return this.get(row, col);\n            }\n            return new CalcError('N/A');\n        },\n        set: function (row, col, data) {\n            var line = this.data[row];\n            if (line == null) {\n                line = this.data[row] = [];\n            }\n            line[col] = data;\n            if (row >= this.height) {\n                this.height = row + 1;\n            }\n            if (col >= this.width) {\n                this.width = col + 1;\n            }\n        },\n        each: function (f, includeEmpty) {\n            for (var row = 0; row < this.height; ++row) {\n                for (var col = 0; col < this.width; ++col) {\n                    var val = this.get(row, col);\n                    if (includeEmpty || val != null) {\n                        val = f.call(this.context, val, row, col);\n                        if (val !== undefined) {\n                            return val;\n                        }\n                    }\n                }\n            }\n        },\n        map: function (f, includeEmpty) {\n            var m = new Matrix(this.context);\n            this.each(function (el, row, col) {\n                m.set(row, col, f.call(this, el, row, col));\n            }, includeEmpty);\n            return m;\n        },\n        eachRow: function (f) {\n            for (var row = 0; row < this.height; ++row) {\n                var val = f.call(this.context, row);\n                if (val !== undefined) {\n                    return val;\n                }\n            }\n        },\n        eachCol: function (f) {\n            for (var col = 0; col < this.width; ++col) {\n                var val = f.call(this.context, col);\n                if (val !== undefined) {\n                    return val;\n                }\n            }\n        },\n        mapRow: function (f) {\n            var m = new Matrix(this.context);\n            this.eachRow(function (row) {\n                m.set(row, 0, f.call(this.context, row));\n            });\n            return m;\n        },\n        mapCol: function (f) {\n            var m = new Matrix(this.context);\n            this.eachCol(function (col) {\n                m.set(0, col, f.call(this.context, col));\n            });\n            return m;\n        },\n        toString: function () {\n            return JSON.stringify(this.data);\n        },\n        transpose: function () {\n            var m = new Matrix(this.context);\n            this.each(function (el, row, col) {\n                m.set(col, row, el);\n            });\n            return m;\n        },\n        unit: function (n) {\n            this.width = this.height = n;\n            var a = this.data = new Array(n);\n            for (var i = n; --i >= 0;) {\n                var row = a[i] = new Array(n);\n                for (var j = n; --j >= 0;) {\n                    row[j] = i == j ? 1 : 0;\n                }\n            }\n            return this;\n        },\n        multiply: function (b) {\n            var a = this, m = new Matrix(a.context);\n            for (var row = 0; row < a.height; ++row) {\n                for (var col = 0; col < b.width; ++col) {\n                    var s = 0;\n                    for (var i = 0; i < a.width; ++i) {\n                        var va = a.get(row, i);\n                        var vb = b.get(i, col);\n                        if (typeof va != 'number' || typeof vb != 'number') {\n                            throw new CalcError('VALUE');\n                        }\n                        s += va * vb;\n                    }\n                    m.set(row, col, s);\n                }\n            }\n            return m;\n        },\n        adds: function (b, s) {\n            var a = this, m = new Matrix(a.context);\n            var sign = s ? -1 : 1;\n            for (var row = 0; row < a.height; ++row) {\n                for (var col = 0; col < a.width; ++col) {\n                    var x = a.get(row, col), y = b.get(row, col);\n                    m.set(row, col, x + sign * y);\n                }\n            }\n            return m;\n        },\n        determinant: function () {\n            var a = this.clone().data;\n            var n = a.length;\n            var d = 1, C, L, i, k;\n            for (C = 0; C < n; C++) {\n                for (L = C; L < n && !a[L][C]; L++) {\n                }\n                if (L == n) {\n                    return 0;\n                }\n                if (L != C) {\n                    d = -d;\n                    for (k = C; k < n; k++) {\n                        var t = a[C][k];\n                        a[C][k] = a[L][k];\n                        a[L][k] = t;\n                    }\n                }\n                for (i = C + 1; i < n; i++) {\n                    for (k = C + 1; k < n; k++) {\n                        a[i][k] -= a[C][k] * a[i][C] / a[C][C];\n                    }\n                }\n                d *= a[C][C];\n            }\n            return d;\n        },\n        inverse: function () {\n            var n = this.width;\n            var m = this.augment(new Matrix(this.context).unit(n));\n            var a = m.data;\n            var tmp;\n            for (var k = 0; k < n; ++k) {\n                var imax = argmax(k, n, function (i) {\n                    return a[i][k];\n                });\n                if (!a[imax][k]) {\n                    return null;\n                }\n                if (k != imax) {\n                    tmp = a[k];\n                    a[k] = a[imax];\n                    a[imax] = tmp;\n                }\n                for (var i = k + 1; i < n; ++i) {\n                    for (var j = k + 1; j < 2 * n; ++j) {\n                        a[i][j] -= a[k][j] * a[i][k] / a[k][k];\n                    }\n                    a[i][k] = 0;\n                }\n            }\n            for (var i = 0; i < n; ++i) {\n                for (var f = a[i][i], j = 0; j < 2 * n; ++j) {\n                    a[i][j] /= f;\n                }\n            }\n            for (var k = n; --k >= 0;) {\n                for (var i = k; --i >= 0;) {\n                    if (a[i][k]) {\n                        for (var j = 2 * n; --j >= n;) {\n                            a[i][j] -= a[k][j] * a[i][k];\n                        }\n                    }\n                }\n            }\n            return m.slice(0, n, n, n);\n        },\n        augment: function (m) {\n            var ret = this.clone(), n = ret.width;\n            m.each(function (val, row, col) {\n                ret.set(row, col + n, val);\n            });\n            return ret;\n        },\n        slice: function (row, col, height, width) {\n            var m = new Matrix(this.context);\n            for (var i = 0; i < height; ++i) {\n                for (var j = 0; j < width; ++j) {\n                    m.set(i, j, this.get(row + i, col + j));\n                }\n            }\n            return m;\n        }\n    });\n    function argmax(i, end, f) {\n        var max = f(i), pos = i;\n        while (++i < end) {\n            var v = f(i);\n            if (v > max) {\n                max = v;\n                pos = i;\n            }\n        }\n        return pos;\n    }\n    var Formula = Class.extend({\n        init: function Formula(refs, handler, printer, sheet, row, col, arrayFormulaRange) {\n            this.refs = refs;\n            this.handler = handler;\n            this.print = printer;\n            this.absrefs = null;\n            this.sheet = sheet;\n            this.row = row;\n            this.col = col;\n            this.onReady = [];\n            this.pending = false;\n            this.arrayFormulaRange = arrayFormulaRange;\n        },\n        setArrayFormulaRange: function (ref) {\n            this.arrayFormulaRange = ref.clone().setSheet(this.sheet);\n        },\n        clone: function (sheet, row, col, forceRefs) {\n            var lcsheet = sheet.toLowerCase();\n            var refs = this.refs;\n            var range = this.arrayFormulaRange;\n            if (forceRefs || lcsheet != this.sheet.toLowerCase()) {\n                refs = refs.map(function (ref) {\n                    if (!ref.hasSheet() && (!ref.sheet || ref.sheet.toLowerCase() != lcsheet)) {\n                        ref = ref.clone().setSheet(sheet);\n                    }\n                    return ref;\n                });\n                if (range) {\n                    range = range.clone().setSheet(sheet);\n                }\n            }\n            return new Formula(refs, this.handler, this.print, sheet, row, col, range);\n        },\n        deepClone: function () {\n            var refs = this.refs.map(function (ref) {\n                return ref.clone();\n            });\n            return new Formula(refs, this.handler, this.print, this.sheet, this.row, this.col, this.arrayFormulaRange);\n        },\n        resolve: function (val) {\n            this.pending = false;\n            this.onReady.forEach(function (callback) {\n                callback(val);\n            });\n        },\n        exec: function (ss, callback, parentContext) {\n            if ('value' in this) {\n                if (callback) {\n                    callback(this.value);\n                }\n            } else {\n                if (callback) {\n                    this.onReady.push(callback);\n                }\n                var ctx = new Context(this.resolve, this, ss, parentContext);\n                var level = 0;\n                while (parentContext) {\n                    if (parentContext.formula === this) {\n                        this.pending = false;\n                        ctx.resolve(new CalcError('CIRCULAR'));\n                        return;\n                    }\n                    parentContext = parentContext.parent;\n                    ++level;\n                }\n                if (this.pending) {\n                    return;\n                }\n                this.pending = true;\n                var next = function () {\n                    if (!this.absrefs) {\n                        this.absrefs = this.refs.map(function (ref) {\n                            return ref.absolute(this.row, this.col);\n                        }, this);\n                    }\n                    this.handler.call(ctx);\n                }.bind(this);\n                if (level < 20) {\n                    next();\n                } else {\n                    setTimeout(next, 0);\n                }\n            }\n        },\n        reset: function () {\n            this.onReady = [];\n            this.pending = false;\n            delete this.value;\n        },\n        renameSheet: function (oldSheetName, newSheetName) {\n            oldSheetName = oldSheetName.toLowerCase();\n            this.absrefs = null;\n            if (this.sheet.toLowerCase() == oldSheetName) {\n                this.sheet = newSheetName;\n            }\n            this.refs.forEach(function (ref) {\n                ref.renameSheet(oldSheetName, newSheetName);\n            });\n        },\n        adjust: function (affectedSheet, operation, start, delta) {\n            affectedSheet = affectedSheet.toLowerCase();\n            var formulaRow = this.row;\n            var formulaCol = this.col;\n            var formulaSheet = this.sheet.toLowerCase();\n            var formulaMoves = false;\n            if (formulaSheet == affectedSheet) {\n                if (operation == 'row' && formulaRow >= start) {\n                    this.row += delta;\n                    formulaMoves = true;\n                }\n                if (operation == 'col' && formulaCol >= start) {\n                    this.col += delta;\n                    formulaMoves = true;\n                }\n            }\n            var newFormulaRow = this.row;\n            var newFormulaCol = this.col;\n            this.absrefs = null;\n            var prevRefs = this.refs;\n            var modified = formulaMoves;\n            this.refs = prevRefs.map(function (ref) {\n                var newRef = adjust(ref);\n                if (!modified && !sameRef(newRef, ref)) {\n                    modified = true;\n                }\n                return newRef;\n            });\n            var prevRange = this.arrayFormulaRange;\n            if (prevRange) {\n                this.arrayFormulaRange = adjust(prevRange);\n                if (!modified && !sameRef(prevRange, this.arrayFormulaRange)) {\n                    modified = true;\n                }\n            }\n            if (modified) {\n                return new Formula(prevRefs, this.handler, this.print, this.sheet, formulaRow, formulaCol, prevRange);\n            }\n            function adjust(ref) {\n                if (ref === NULL) {\n                    return ref;\n                }\n                if (ref.sheet.toLowerCase() != affectedSheet) {\n                    if (formulaMoves) {\n                        if (operation == 'row' && formulaRow >= start) {\n                            ref = ref.relative(delta, 0);\n                        }\n                        if (operation == 'col' && formulaCol >= start) {\n                            ref = ref.relative(0, delta);\n                        }\n                    }\n                    return ref;\n                }\n                return ref.adjust(formulaRow, formulaCol, newFormulaRow, newFormulaCol, operation == 'row', start, delta);\n            }\n        },\n        toString: function () {\n            return this.print(this.row, this.col);\n        }\n    });\n    function sameRef(r1, r2) {\n        if (r1.constructor !== r2.constructor) {\n            return false;\n        }\n        if (r1 instanceof CellRef) {\n            return r1.sheet == r2.sheet && r1.row == r2.row && r1.col == r2.col && r1.rel == r2.rel;\n        }\n        if (r1 instanceof RangeRef) {\n            return sameRef(r1.topLeft, r2.topLeft) && sameRef(r1.bottomRight, r2.bottomRight) && r1.endSheet == r2.endSheet;\n        }\n        if (r1 instanceof UnionRef) {\n            var i = r1.refs.length;\n            if (i != r2.refs.length) {\n                return false;\n            }\n            while (--i >= 0) {\n                if (!sameRef(r1.refs[i], r2.refs[i])) {\n                    return false;\n                }\n            }\n        }\n        return true;\n    }\n    var FUNCS = Object.create(null);\n    FUNCS['if'] = function (callback, args) {\n        var self = this;\n        var co = args[0], th = args[1], el = args[2];\n        this.resolveCells([co], function () {\n            var comatrix = self.asMatrix(co);\n            if (comatrix) {\n                th(function (th) {\n                    el(function (el) {\n                        var thmatrix = self.asMatrix(th);\n                        var elmatrix = self.asMatrix(el);\n                        callback(comatrix.map(function (val, row, col) {\n                            if (val instanceof CalcError) {\n                                return val;\n                            } else if (self.bool(val)) {\n                                return thmatrix ? thmatrix.get(row, col) : th;\n                            } else {\n                                return elmatrix ? elmatrix.get(row, col) : el;\n                            }\n                        }));\n                    });\n                });\n            } else {\n                co = this.force(co);\n                if (co instanceof CalcError) {\n                    callback(co);\n                } else if (self.bool(co)) {\n                    th(callback);\n                } else {\n                    el(callback);\n                }\n            }\n        });\n    };\n    FUNCS['φ'] = function (callback) {\n        callback((1 + Math.sqrt(5)) / 2);\n    };\n    function compileArgumentChecks(functionName, args) {\n        var arrayArgs = 'function arrayArgs(args) { var xargs = [], width = 0, height = 0, arrays = [], i = 0; ';\n        var resolve = 'function resolve(args, callback) { var toResolve = [], i = 0; ';\n        var name, forced, main = '\\'use strict\\'; function check(args) { var stack = [], tmp, xargs = [], i = 0, m, err = \\'VALUE\\'; ', haveForced = false;\n        var canBeArrayArg = false, hasArrayArgs = false;\n        main += args.map(comp).join('');\n        main += 'if (i < args.length) return new CalcError(\\'N/A\\'); ';\n        main += 'return xargs; } ';\n        arrayArgs += 'return { args: xargs, width: width, height: height, arrays: arrays }; } ';\n        var f;\n        if (haveForced) {\n            resolve += 'this.resolveCells(toResolve, callback); } ';\n            f = new Function('CalcError', 'round', main + resolve + arrayArgs + ' return { resolve: resolve, check: check, arrayArgs: arrayArgs };');\n        } else {\n            f = new Function('CalcError', 'round', main + ' return { check: check };');\n        }\n        f = f(CalcError, limitPrecision);\n        if (!hasArrayArgs) {\n            delete f.arrayArgs;\n        }\n        return f;\n        function comp(x) {\n            name = x[0];\n            var code = '{ ';\n            if (Array.isArray(name)) {\n                arrayArgs += 'while (i < args.length) { ';\n                resolve += 'while (i < args.length) { ';\n                code += 'xargs.push(tmp = []); stack.push(xargs); xargs = tmp; ';\n                code += 'while (i < args.length) { ';\n                code += x.map(comp).join('');\n                code += '} ';\n                code += 'xargs = stack.pop(); ';\n                resolve += '} ';\n                arrayArgs += '} ';\n            } else if (name == '+') {\n                arrayArgs += 'while (i < args.length) { ';\n                resolve += 'while (i < args.length) { ';\n                code += 'if (i >= args.length) return new CalcError(\\'N/A\\'); ';\n                code += 'xargs.push(tmp = []); stack.push(xargs); xargs = tmp; ';\n                code += 'do { ';\n                code += x.slice(1).map(comp).join('');\n                code += '} while (i < args.length); ';\n                code += 'xargs = stack.pop(); ';\n                resolve += '} ';\n                arrayArgs += '} ';\n            } else if (name == '?') {\n                code += 'if (!(' + cond(x[1]) + ')) return new CalcError(err); ';\n            } else {\n                var type = x[1];\n                if (Array.isArray(type) && /^#?collect/.test(type[0])) {\n                    var wantNulls = /!$/.test(type[0]);\n                    var n = type[2];\n                    force();\n                    code += 'try {' + 'var $' + name + ' = this.cellValues(args.slice(i';\n                    if (n) {\n                        code += ', i + ' + n;\n                    }\n                    code += ')' + (wantNulls ? ',true' : '') + ').reduce(function(ret, $' + name + '){ ';\n                    if (type[0].charAt(0) != '#') {\n                        code += 'if ($' + name + ' instanceof CalcError) throw $' + name + '; ';\n                    }\n                    code += 'if (' + cond(type[1]) + ') ret.push($' + name + '); ';\n                    code += 'return ret; ';\n                    code += '}.bind(this), []); ';\n                    if (n) {\n                        code += 'i += ' + n + '; ';\n                    } else {\n                        code += 'i = args.length; ';\n                    }\n                    code += 'xargs.push($' + name + ')' + '} catch(ex) { if (ex instanceof CalcError) return ex; throw ex; } ';\n                    resolve += 'toResolve.push(args.slice(i)); ';\n                } else if (type == 'rest') {\n                    code += 'xargs.push(args.slice(i)); i = args.length; ';\n                } else {\n                    if (canBeArrayArg = /^\\*/.test(name)) {\n                        hasArrayArgs = true;\n                        name = name.substr(1);\n                    }\n                    code += 'var $' + name + ' = args[i++]; ';\n                    var allowError = false;\n                    if (/!$/.test(type)) {\n                        type = type.substr(0, type.length - 1);\n                        allowError = true;\n                    } else {\n                        code += 'if ($' + name + ' instanceof CalcError) return $' + name + '; ';\n                    }\n                    code += typeCheck(type, allowError) + 'xargs.push($' + name + '); ';\n                }\n            }\n            code += '} ';\n            return code;\n        }\n        function force() {\n            if (forced) {\n                return '$' + name + '';\n            }\n            haveForced = true;\n            forced = true;\n            resolve += 'toResolve.push(args[i++]); ';\n            return '($' + name + ' = this.force($' + name + '))';\n        }\n        function forceNum(round) {\n            return '(' + (round ? '(typeof ' + force() + ' == \\'number\\' ? ($' + name + ' = round($' + name + '), true) : false) || ' : '(typeof ' + force() + ' == \\'number\\') || ') + '(typeof $' + name + ' == \\'boolean\\' ? ($' + name + ' = +$' + name + ', true) : false) || ' + '(typeof $' + name + ' == \\'string\\' && !/^(?:=|true|false)/i.test($' + name + ') ? (' + 'tmp = kendo.spreadsheet.calc.parse(0, 0, 0, $' + name + '), ' + '/^date|number|percent$/.test(tmp.type) ? ($' + name + ' = +tmp.value, true) : false' + ') : false)' + ')';\n        }\n        function typeCheck(type, allowError) {\n            forced = false;\n            var ret = 'if (!(' + cond(type) + ')) { ';\n            if (forced && !allowError) {\n                ret += ' if ($' + name + ' instanceof CalcError) return $' + name + '; ';\n            }\n            ret += 'return new CalcError(err); } ';\n            if (!forced) {\n                resolve += 'i++; ';\n            }\n            if (canBeArrayArg) {\n                arrayArgs += 'var $' + name + ' = this._arrayArg(args[i]); ' + 'if ($' + name + ') { ' + 'xargs.push($' + name + '); ' + 'width = Math.max(width, $' + name + '.width); ' + 'height = Math.max(height, $' + name + '.height); ' + 'arrays.push(true) } else { ' + 'xargs.push(args[i]); ' + 'arrays.push(false); } i++; ';\n            } else {\n                arrayArgs += 'xargs.push(args[i++]); arrays.push(false); ';\n            }\n            return ret;\n        }\n        function cond(type) {\n            if (Array.isArray(type)) {\n                if (type[0] == 'or') {\n                    return '(' + type.slice(1).map(cond).join(') || (') + ')';\n                }\n                if (type[0] == 'and') {\n                    return '(' + type.slice(1).map(cond).join(') && (') + ')';\n                }\n                if (type[0] == 'values') {\n                    return '(' + type.slice(1).map(function (val) {\n                        return force() + ' === ' + val;\n                    }).join(') || (') + ')';\n                }\n                if (type[0] == 'null') {\n                    return '(' + cond('null') + ' ? (($' + name + ' = ' + type[1] + '), true) : false)';\n                }\n                if (type[0] == 'between' || type[0] == '[between]') {\n                    return '(' + force() + ' >= ' + type[1] + ' && ' + '$' + name + ' <= ' + type[2] + ' ? true : ((err = \\'NUM\\'), false))';\n                }\n                if (type[0] == '(between)') {\n                    return '(' + force() + ' > ' + type[1] + ' && ' + '$' + name + ' < ' + type[2] + ' ? true : ((err = \\'NUM\\'), false))';\n                }\n                if (type[0] == '(between]') {\n                    return '(' + force() + ' > ' + type[1] + ' && ' + '$' + name + ' <= ' + type[2] + ' ? true : ((err = \\'NUM\\'), false))';\n                }\n                if (type[0] == '[between)') {\n                    return '(' + force() + ' >= ' + type[1] + ' && ' + '$' + name + ' < ' + type[2] + ' ? true : ((err = \\'NUM\\'), false))';\n                }\n                if (type[0] == 'assert') {\n                    var err = type[2] || 'N/A';\n                    return '((' + type[1] + ') ? true : (err = ' + JSON.stringify(err) + ', false))';\n                }\n                if (type[0] == 'not') {\n                    return '!(' + cond(type[1]) + ')';\n                }\n                throw new Error('Unknown array type condition: ' + type[0]);\n            }\n            if (type == 'number' || type == 'datetime') {\n                return forceNum(true);\n            }\n            if (type == 'number!') {\n                return '(typeof ' + force() + ' == \\'number\\' ? ($' + name + ' = round($' + name + '), true) : false)';\n            }\n            if (type == 'integer' || type == 'date') {\n                return '(' + forceNum() + ' && (($' + name + ' |= 0), true))';\n            }\n            if (type == 'divisor') {\n                return '(' + forceNum(true) + ' && ($' + name + ' == 0 ? ((err = \\'DIV/0\\'), false) : true))';\n            }\n            if (type == 'number+') {\n                return '(' + forceNum(true) + ' && ($' + name + ' >= 0 ? true : ((err = \\'NUM\\'), false)))';\n            }\n            if (type == 'integer+') {\n                return '(' + forceNum() + ' && (($' + name + ' |= 0) >= 0 ? true : ((err = \\'NUM\\'), false)))';\n            }\n            if (type == 'number++') {\n                return '(' + forceNum(true) + ' && ($' + name + ' > 0 ? true : ((err = \\'NUM\\'), false)))';\n            }\n            if (type == 'integer++') {\n                return '(' + forceNum() + ' && (($' + name + ' |= 0) > 0 ? true : ((err = \\'NUM\\'), false)))';\n            }\n            if (type == 'string') {\n                return '((typeof ' + force() + ' == \\'string\\' || typeof $' + name + ' == \\'boolean\\' || typeof $' + name + ' == \\'number\\') ? ($' + name + ' += \\'\\', true) : ($' + name + ' === undefined ? (($' + name + ' = \\'\\'), true) : false))';\n            }\n            if (type == 'boolean') {\n                return '(typeof ' + force() + ' == \\'boolean\\')';\n            }\n            if (type == 'logical') {\n                return '(typeof ' + force() + ' == \\'boolean\\' || (typeof $' + name + ' == \\'number\\' ? ($' + name + ' = !!$' + name + ', true) : false))';\n            }\n            if (type == 'matrix') {\n                force();\n                return '((m = this.asMatrix($' + name + ')) ? ($' + name + ' = m) : false)';\n            }\n            if (type == '#matrix') {\n                return '((m = this.asMatrix($' + name + ')) ? ($' + name + ' = m) : false)';\n            }\n            if (type == 'ref') {\n                return '($' + name + ' instanceof kendo.spreadsheet.Ref)';\n            }\n            if (type == 'area') {\n                return '($' + name + ' instanceof kendo.spreadsheet.CellRef || $' + name + ' instanceof kendo.spreadsheet.RangeRef)';\n            }\n            if (type == 'cell') {\n                return '($' + name + ' instanceof kendo.spreadsheet.CellRef)';\n            }\n            if (type == 'null') {\n                return '(' + force() + ' == null)';\n            }\n            if (type == 'anyvalue') {\n                return '(' + force() + ' != null && i <= args.length)';\n            }\n            if (type == 'forced') {\n                return '(' + force() + ', i <= args.length)';\n            }\n            if (type == 'anything') {\n                return '(i <= args.length)';\n            }\n            if (type == 'blank') {\n                return '(' + force() + ' == null || $' + name + ' === \\'\\')';\n            }\n            throw new Error('Can\\'t check for type: ' + type);\n        }\n    }\n    function limitPrecision(num) {\n        return num === parseInt(num, 10) ? num : +num.toPrecision(14);\n    }\n    function maybeRoundFloatErrors(num) {\n        if (typeof num == 'number') {\n            return limitPrecision(num);\n        } else {\n            return num;\n        }\n    }\n    function withErrorHandling(obj, f, args) {\n        if (args instanceof CalcError) {\n            return args;\n        }\n        try {\n            return f.apply(obj, args);\n        } catch (ex) {\n            if (ex instanceof CalcError) {\n                return ex;\n            } else {\n                throw ex;\n            }\n        }\n    }\n    function makeSyncFunction(handler, resolve, check, arrayArgs) {\n        return function (callback, args) {\n            function doit() {\n                if (arrayArgs) {\n                    var x = arrayArgs.call(this, args);\n                    args = x.args;\n                    if (x.width > 0 && x.height > 0) {\n                        var result = new Matrix(this);\n                        for (var row = 0; row < x.height; ++row) {\n                            for (var col = 0; col < x.width; ++col) {\n                                var xargs = [];\n                                for (var i = 0; i < args.length; ++i) {\n                                    if (x.arrays[i]) {\n                                        xargs[i] = args[i].getNA(row, col);\n                                    } else {\n                                        xargs[i] = args[i];\n                                    }\n                                }\n                                xargs = check.call(this, xargs);\n                                result.set(row, col, withErrorHandling(this, handler, xargs));\n                            }\n                        }\n                        return callback(result);\n                    }\n                }\n                var xargs = check.call(this, args);\n                callback(withErrorHandling(this, handler, xargs));\n            }\n            if (resolve) {\n                resolve.call(this, args, doit);\n            } else {\n                doit.call(this);\n            }\n        };\n    }\n    function makeAsyncFunction(handler, resolve, check, arrayArgs) {\n        return function (callback, args) {\n            function doit() {\n                if (arrayArgs) {\n                    var x = arrayArgs.call(this, args);\n                    args = x.args;\n                    if (x.width > 0 && x.height > 0) {\n                        var result = new Matrix(this);\n                        var count = x.width * x.height;\n                        var makeCallback = function (row, col) {\n                            return function (value) {\n                                result.set(row, col, value);\n                                --count;\n                                if (count === 0) {\n                                    return callback(result);\n                                }\n                            };\n                        };\n                        for (var row = 0; row < x.height && count > 0; ++row) {\n                            for (var col = 0; col < x.width && count > 0; ++col) {\n                                var xargs = [];\n                                for (var i = 0; i < args.length; ++i) {\n                                    if (x.arrays[i]) {\n                                        xargs[i] = args[i].getNA(row, col);\n                                    } else {\n                                        xargs[i] = args[i];\n                                    }\n                                }\n                                xargs = check.call(this, xargs);\n                                if (xargs instanceof CalcError) {\n                                    result.set(row, col, xargs);\n                                    --count;\n                                    if (count === 0) {\n                                        return callback(result);\n                                    }\n                                } else {\n                                    xargs.unshift(makeCallback(row, col));\n                                    handler.apply(this, xargs);\n                                }\n                            }\n                        }\n                        return;\n                    }\n                }\n                var x = check.call(this, args);\n                if (x instanceof CalcError) {\n                    callback(x);\n                } else {\n                    x.unshift(callback);\n                    handler.apply(this, x);\n                }\n            }\n            if (resolve) {\n                resolve.call(this, args, doit);\n            } else {\n                doit.call(this);\n            }\n        };\n    }\n    function defineFunction(name, func) {\n        name = name.toLowerCase();\n        FUNCS[name] = func;\n        return {\n            args: function (args, log) {\n                var code = compileArgumentChecks(name, args);\n                if (log) {\n                    if (code.arrayArgs) {\n                        console.log(code.arrayArgs.toString());\n                    }\n                    if (code.resolve) {\n                        console.log(code.resolve.toString());\n                    }\n                    if (code.check) {\n                        console.log(code.check.toString());\n                    }\n                }\n                var f = FUNCS[name] = makeSyncFunction(func, code.resolve, code.check, code.arrayArgs);\n                f.kendoSpreadsheetArgs = args;\n                return this;\n            },\n            argsAsync: function (args, log) {\n                var code = compileArgumentChecks(name, args);\n                if (log) {\n                    if (code.arrayArgs) {\n                        console.log(code.arrayArgs.toString());\n                    }\n                    if (code.resolve) {\n                        console.log(code.resolve.toString());\n                    }\n                    if (code.check) {\n                        console.log(code.check.toString());\n                    }\n                }\n                var f = FUNCS[name] = makeAsyncFunction(func, code.resolve, code.check, code.arrayArgs);\n                f.kendoSpreadsheetArgs = args;\n                return this;\n            }\n        };\n    }\n    function dateToJulianDays(y, m, d) {\n        m++;\n        return (1461 * (y + 4800 + ((m - 14) / 12 | 0)) / 4 | 0) + (367 * (m - 2 - 12 * ((m - 14) / 12 | 0)) / 12 | 0) - (3 * ((y + 4900 + ((m - 14) / 12 | 0)) / 100 | 0) / 4 | 0) + d - 32075;\n    }\n    function julianDaysToDate(jd) {\n        var l, n, j, i, m, d, y;\n        l = jd + 68569;\n        n = 4 * l / 146097 | 0;\n        l = l - ((146097 * n + 3) / 4 | 0);\n        i = 4000 * (l + 1) / 1461001 | 0;\n        l = l - (1461 * i / 4 | 0) + 31;\n        j = 80 * l / 2447 | 0;\n        d = l - (2447 * j / 80 | 0);\n        l = j / 11 | 0;\n        m = j + 2 - 12 * l;\n        y = 100 * (n - 49) + i + l;\n        m--;\n        return {\n            year: y,\n            month: m,\n            date: d,\n            day: (jd + 1) % 7,\n            ord: ORDINAL_ADD_DAYS[isLeapYear(y)][m] + d\n        };\n    }\n    var BASE_DATE = dateToJulianDays(1900, 0, -1);\n    var DAYS_IN_MONTH = [\n        31,\n        28,\n        31,\n        30,\n        31,\n        30,\n        31,\n        31,\n        30,\n        31,\n        30,\n        31\n    ];\n    var ORDINAL_ADD_DAYS = [\n        [\n            0,\n            31,\n            59,\n            90,\n            120,\n            151,\n            181,\n            212,\n            243,\n            273,\n            304,\n            334\n        ],\n        [\n            0,\n            31,\n            60,\n            91,\n            121,\n            152,\n            182,\n            213,\n            244,\n            274,\n            305,\n            335\n        ]\n    ];\n    function isLeapYear(yr) {\n        if (yr % 4) {\n            return 0;\n        }\n        if (yr % 100) {\n            return 1;\n        }\n        if (yr % 400) {\n            return 0;\n        }\n        return 1;\n    }\n    function daysInYear(yr) {\n        return isLeapYear(yr) ? 366 : 365;\n    }\n    function daysInMonth(yr, mo) {\n        return isLeapYear(yr) && mo == 1 ? 29 : DAYS_IN_MONTH[mo];\n    }\n    function validDate(yr, mo, da) {\n        return mo >= 1 && mo <= 12 && da >= 1 && da <= daysInMonth(yr, mo - 1);\n    }\n    function unpackDate(serial) {\n        return julianDaysToDate((serial | 0) + BASE_DATE);\n    }\n    function packDate(year, month, date) {\n        return dateToJulianDays(year, month, date) - BASE_DATE;\n    }\n    var MS_IN_MIN = 60 * 1000;\n    var MS_IN_HOUR = 60 * MS_IN_MIN;\n    var MS_IN_DAY = 24 * MS_IN_HOUR;\n    function unpackTime(serial) {\n        var frac = serial - (serial | 0);\n        if (frac < 0) {\n            frac++;\n        }\n        var ms = Math.round(MS_IN_DAY * frac);\n        var hours = Math.floor(ms / MS_IN_HOUR);\n        ms -= hours * MS_IN_HOUR;\n        var minutes = Math.floor(ms / MS_IN_MIN);\n        ms -= minutes * MS_IN_MIN;\n        var seconds = Math.floor(ms / 1000);\n        ms -= seconds * 1000;\n        return {\n            hours: hours,\n            minutes: minutes,\n            seconds: seconds,\n            milliseconds: ms\n        };\n    }\n    function serialToDate(serial) {\n        var d = unpackDate(serial), t = unpackTime(serial);\n        return new Date(d.year, d.month, d.date, t.hours, t.minutes, t.seconds, t.milliseconds);\n    }\n    function packTime(hh, mm, ss, ms) {\n        return (hh + (mm + (ss + ms / 1000) / 60) / 60) / 24;\n    }\n    function dateToSerial(date) {\n        var time = packTime(date.getHours(), date.getMinutes(), date.getSeconds(), date.getMilliseconds());\n        date = packDate(date.getFullYear(), date.getMonth(), date.getDate());\n        if (date < 0) {\n            return date - 1 + time;\n        } else {\n            return date + time;\n        }\n    }\n    function parseDate(str, format) {\n        if (format) {\n            format = kendo.spreadsheet.formatting.makeDateFormat(format);\n        }\n        return kendo.parseExactDate(str, format) || kendo.parseExactDate(str) || kendo.parseExactDate(str, [\n            'MMMM dd yyyy',\n            'MMMM dd yy',\n            'MMM dd yyyy',\n            'MMM dd yy',\n            'dd MMMM yyyy',\n            'dd MMMM yy',\n            'dd MMM yyyy',\n            'dd MMM yy',\n            'MMMM dd, yyyy',\n            'MMMM dd, yy',\n            'MMM dd, yyyy',\n            'MMM dd, yy',\n            'MMMM dd',\n            'MMM dd',\n            'MMMM yyyy',\n            'MMM yyyy',\n            'dd MMMM',\n            'dd MMM'\n        ]);\n    }\n    exports.CalcError = CalcError;\n    exports.Formula = Formula;\n    exports.Matrix = Matrix;\n    exports.packDate = packDate;\n    exports.unpackDate = unpackDate;\n    exports.packTime = packTime;\n    exports.unpackTime = unpackTime;\n    exports.serialToDate = serialToDate;\n    exports.dateToSerial = dateToSerial;\n    exports.daysInMonth = daysInMonth;\n    exports.validDate = validDate;\n    exports.isLeapYear = isLeapYear;\n    exports.daysInYear = daysInYear;\n    exports.parseDate = parseDate;\n    exports.limitPrecision = limitPrecision;\n    spreadsheet.dateToNumber = dateToSerial;\n    spreadsheet.numberToDate = serialToDate;\n    spreadsheet.defineFunction = defineFunction;\n    spreadsheet.CalcError = CalcError;\n    exports.defineFunction = defineFunction;\n    exports.defineAlias = function (alias, name) {\n        var orig = FUNCS[name];\n        if (!orig) {\n            throw new Error('Function ' + name + ' is not yet defined');\n        }\n        if (!orig.kendoSpreadsheetAliases) {\n            orig.kendoSpreadsheetAliases = [name];\n        }\n        orig.kendoSpreadsheetAliases.push(alias);\n        FUNCS[alias] = orig;\n    };\n    exports.FUNCS = FUNCS;\n    var NUMBER_OR_ZERO = [\n        'or',\n        'number',\n        [\n            'null',\n            0\n        ]\n    ];\n    var ARGS_NUMERIC = [\n        [\n            '*a',\n            NUMBER_OR_ZERO\n        ],\n        [\n            '*b',\n            NUMBER_OR_ZERO\n        ]\n    ];\n    var ARGS_ANYVALUE = [\n        [\n            '*a',\n            [\n                'or',\n                'anyvalue',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '*b',\n            [\n                'or',\n                'anyvalue',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ];\n    defineFunction('binary+', function (a, b) {\n        return a + b;\n    }).args(ARGS_NUMERIC);\n    defineFunction('binary-', function (a, b) {\n        return a - b;\n    }).args(ARGS_NUMERIC);\n    defineFunction('binary*', function (a, b) {\n        return a * b;\n    }).args(ARGS_NUMERIC);\n    defineFunction('binary/', function (a, b) {\n        return a / b;\n    }).args([\n        [\n            '*a',\n            NUMBER_OR_ZERO\n        ],\n        [\n            '*b',\n            'divisor'\n        ]\n    ]);\n    defineFunction('binary^', function (a, b) {\n        return Math.pow(a, b);\n    }).args(ARGS_NUMERIC);\n    defineFunction('binary&', function (a, b) {\n        if (a == null) {\n            a = '';\n        }\n        if (b == null) {\n            b = '';\n        }\n        return '' + a + b;\n    }).args([\n        [\n            '*a',\n            [\n                'or',\n                'number',\n                'string',\n                'boolean',\n                'null'\n            ]\n        ],\n        [\n            '*b',\n            [\n                'or',\n                'number',\n                'string',\n                'boolean',\n                'null'\n            ]\n        ]\n    ]);\n    defineFunction('binary=', function (a, b) {\n        a = typeof a === 'string' ? a.toLowerCase() : a;\n        b = typeof b === 'string' ? b.toLowerCase() : b;\n        return a === b;\n    }).args(ARGS_ANYVALUE);\n    defineFunction('binary<>', function (a, b) {\n        return a !== b;\n    }).args(ARGS_ANYVALUE);\n    defineFunction('binary<', binaryCompare(function (a, b) {\n        return a < b;\n    })).args(ARGS_ANYVALUE);\n    defineFunction('binary<=', binaryCompare(function (a, b) {\n        return a <= b;\n    })).args(ARGS_ANYVALUE);\n    defineFunction('binary>', binaryCompare(function (a, b) {\n        return a > b;\n    })).args(ARGS_ANYVALUE);\n    defineFunction('binary>=', binaryCompare(function (a, b) {\n        return a >= b;\n    })).args(ARGS_ANYVALUE);\n    defineFunction('unary+', function (a) {\n        return a;\n    }).args([[\n            '*a',\n            NUMBER_OR_ZERO\n        ]]);\n    defineFunction('unary-', function (a) {\n        return -a;\n    }).args([[\n            '*a',\n            NUMBER_OR_ZERO\n        ]]);\n    defineFunction('unary%', function (a) {\n        return a / 100;\n    }).args([[\n            '*a',\n            NUMBER_OR_ZERO\n        ]]);\n    defineFunction('binary:', function (a, b) {\n        return new RangeRef(a, b).setSheet(a.sheet || this.formula.sheet, a.hasSheet());\n    }).args([\n        [\n            'a',\n            'cell'\n        ],\n        [\n            'b',\n            'cell'\n        ]\n    ]);\n    defineFunction('binary,', function (a, b) {\n        return new UnionRef([\n            a,\n            b\n        ]);\n    }).args([\n        [\n            'a',\n            'ref'\n        ],\n        [\n            'b',\n            'ref'\n        ]\n    ]);\n    defineFunction('binary ', function (a, b) {\n        return a.intersect(b);\n    }).args([\n        [\n            'a',\n            'ref'\n        ],\n        [\n            'b',\n            'ref'\n        ]\n    ]);\n    defineFunction('not', function (a) {\n        return !this.bool(a);\n    }).args([[\n            '*a',\n            [\n                'or',\n                'anyvalue',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]]);\n    defineFunction('isblank', function (val) {\n        if (val instanceof CellRef) {\n            val = this.getRefData(val);\n            return val == null;\n        }\n        return false;\n    }).args([[\n            '*value',\n            'anything!'\n        ]]);\n    defineFunction('iserror', function (val) {\n        return val instanceof CalcError;\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('iserr', function (val) {\n        return val instanceof CalcError && val.code != 'N/A';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('isna', function (val) {\n        return val instanceof CalcError && val.code == 'N/A';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('islogical', function (val) {\n        return typeof val == 'boolean';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('isnontext', function (val) {\n        return typeof val != 'string';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('istext', function (val) {\n        return typeof val == 'string';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('isnumber', function (val) {\n        return typeof val == 'number';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('isref', function (val) {\n        return val instanceof CellRef || val instanceof RangeRef;\n    }).args([[\n            '*value',\n            'anything!'\n        ]]);\n    FUNCS[',getname'] = function (callback, args) {\n        this.fetchName(args[0], callback);\n    };\n    function binaryCompare(func) {\n        return function (left, right) {\n            if (typeof left == 'string' && typeof right != 'string') {\n                right = right == null ? '' : right + '';\n            }\n            if (typeof left != 'string' && typeof right == 'string') {\n                left = left == null ? '' : left + '';\n            }\n            if (typeof left == 'number' && right == null) {\n                right = 0;\n            }\n            if (typeof right == 'number' && left == null) {\n                left = 0;\n            }\n            if (typeof left == 'string' && typeof right == 'string') {\n                left = left.toLowerCase();\n                right = right.toLowerCase();\n            }\n            if (typeof right == typeof left) {\n                return func(left, right);\n            } else {\n                return new CalcError('VALUE');\n            }\n        };\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/validation', ['spreadsheet/runtime'], f);\n}(function () {\n    'use strict';\n    var $ = kendo.jQuery;\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var exports = {};\n    spreadsheet.validation = exports;\n    var calc = spreadsheet.calc;\n    var Class = kendo.Class;\n    var TRANSPOSE_FORMAT = '_matrix({0})';\n    var DATE_FORMAT = 'DATEVALUE(\"{0}\")';\n    calc.runtime.defineFunction('_matrix', function (m) {\n        if (typeof m == 'string') {\n            m = this.asMatrix([m.split(/\\s*,\\s*/)]);\n        }\n        return m;\n    }).args([[\n            'm',\n            [\n                'or',\n                'matrix',\n                'string'\n            ]\n        ]]);\n    function compileValidation(sheet, row, col, validation) {\n        var validationHandler;\n        var comparer;\n        var parsedFromDate;\n        var parsedToDate;\n        if (typeof validation === 'string') {\n            validation = JSON.parse(validation);\n        }\n        if (validation.from) {\n            if (validation.dataType === 'list' && !validation.fromIsListValue) {\n                validation.from = kendo.format(TRANSPOSE_FORMAT, validation.from);\n                validation.fromIsListValue = true;\n            }\n            if (validation.dataType === 'date') {\n                parsedFromDate = calc.runtime.parseDate(validation.from);\n                if (parsedFromDate) {\n                    validation.from = kendo.format(DATE_FORMAT, validation.from);\n                    validation.fromIsDateValue = true;\n                }\n            }\n            validation.from = calc.compile(calc.parseFormula(sheet, row, col, validation.from));\n        }\n        if (validation.to) {\n            if (validation.dataType === 'date') {\n                parsedToDate = calc.runtime.parseDate(validation.to);\n                if (parsedToDate) {\n                    validation.to = kendo.format(DATE_FORMAT, validation.to);\n                    validation.toIsDateValue = true;\n                }\n            }\n            validation.to = calc.compile(calc.parseFormula(sheet, row, col, validation.to));\n        }\n        if (validation.dataType == 'custom') {\n            comparer = exports.validationComparers.custom;\n        } else if (validation.dataType == 'list') {\n            comparer = exports.validationComparers.list;\n        } else {\n            comparer = exports.validationComparers[validation.comparerType];\n        }\n        if (!comparer) {\n            throw kendo.format('\\'{0}\\' comparer is not implemented.', validation.comparerType);\n        }\n        validationHandler = function (valueToCompare) {\n            var toValue = this.to && (this.to_value || this.to_value === 0) ? this.to_value : undefined;\n            if (valueToCompare === null || valueToCompare === '') {\n                if (this.allowNulls) {\n                    this.value = true;\n                } else {\n                    this.value = false;\n                }\n            } else if (this.dataType == 'custom') {\n                this.value = comparer(valueToCompare, this.from_value, toValue);\n            } else if (this.dataType == 'list') {\n                var data = this._getListData();\n                this.value = comparer(valueToCompare, data, toValue);\n            } else {\n                this.value = comparer(valueToCompare, this.from_value, toValue);\n            }\n            return this.value;\n        };\n        return new kendo.spreadsheet.validation.Validation($.extend(validation, {\n            handler: validationHandler,\n            sheet: sheet,\n            row: row,\n            col: col\n        }));\n    }\n    var Validation = Class.extend({\n        init: function Validation(options) {\n            this.handler = options.handler;\n            this.from = options.from;\n            this.to = options.to;\n            this.dataType = options.dataType;\n            this.comparerType = options.comparerType;\n            this.type = options.type ? options.type : 'warning';\n            this.allowNulls = options.allowNulls ? true : false;\n            this.fromIsDateValue = options.fromIsDateValue ? true : false;\n            this.toIsDateValue = options.toIsDateValue ? true : false;\n            this.showButton = options.showButton;\n            this.fromIsListValue = options.fromIsListValue ? true : false;\n            this.sheet = options.sheet;\n            this.row = options.row;\n            this.col = options.col;\n            if (options.tooltipMessageTemplate) {\n                this.tooltipMessageTemplate = options.tooltipMessageTemplate;\n            }\n            if (options.tooltipTitleTemplate) {\n                this.tooltipTitleTemplate = options.tooltipTitleTemplate;\n            }\n            if (options.messageTemplate) {\n                this.messageTemplate = options.messageTemplate;\n            }\n            if (options.titleTemplate) {\n                this.titleTemplate = options.titleTemplate;\n            }\n        },\n        _formatMessages: function (format) {\n            var from = this.from ? this.from_value : '';\n            var to = this.to ? this.to_value : '';\n            var fromFormula = this.from ? this.from.toString() : '';\n            var toFormula = this.to ? this.to.toString() : '';\n            var dataType = this.dataType;\n            var type = this.type;\n            var comparerType = this.comparerType;\n            return kendo.format(format, from, to, fromFormula, toFormula, dataType, type, comparerType);\n        },\n        _setMessages: function () {\n            this.title = '';\n            this.message = '';\n            if (this.tooltipTitleTemplate) {\n                this.tooltipTitle = this._formatMessages(this.tooltipTitleTemplate);\n            }\n            if (this.tooltipMessageTemplate) {\n                this.tooltipMessage = this._formatMessages(this.tooltipMessageTemplate);\n            }\n            if (this.titleTemplate) {\n                this.title = this._formatMessages(this.titleTemplate);\n            }\n            if (this.messageTemplate) {\n                this.message = this._formatMessages(this.messageTemplate);\n            }\n        },\n        _getListData: function () {\n            if (!this.from_value || !this.from_value.data) {\n                return [];\n            }\n            var cube = this.from_value.data;\n            var i;\n            var y;\n            var data = [];\n            for (i = 0; i < cube.length; i++) {\n                var array = cube[i];\n                if (array) {\n                    for (y = 0; y < array.length; y++) {\n                        data.push(array[y]);\n                    }\n                }\n            }\n            return data;\n        },\n        clone: function (sheet, row, col) {\n            var options = this._getOptions();\n            if (options.from) {\n                options.from = options.from.clone(sheet, row, col);\n            }\n            if (options.to) {\n                options.to = options.to.clone(sheet, row, col);\n            }\n            return new Validation($.extend(options, { handler: this.handler }, {\n                sheet: sheet,\n                row: row,\n                col: col\n            }));\n        },\n        deepClone: function () {\n            var v = new Validation(this);\n            v.from = v.from.deepClone();\n            if (v.to) {\n                v.to = v.to.deepClone();\n            }\n            return v;\n        },\n        exec: function (ss, compareValue, compareFormat, callback) {\n            var self = this;\n            function getValue(val) {\n                if (val instanceof kendo.spreadsheet.Ref) {\n                    val = ss.getData(val);\n                    if (Array.isArray(val)) {\n                        val = val[0];\n                    }\n                }\n                return val;\n            }\n            var calculateFromCallBack = function (val) {\n                self.from_value = getValue(val);\n                self.value = self.handler.call(self, compareValue, compareFormat);\n                self._setMessages();\n                if (callback) {\n                    callback(self.value);\n                }\n            };\n            if (self.to) {\n                self.to.exec(ss, function (val) {\n                    self.to_value = getValue(val);\n                    self.from.exec(ss, calculateFromCallBack);\n                });\n            } else {\n                self.from.exec(ss, calculateFromCallBack);\n            }\n        },\n        reset: function () {\n            if (this.from) {\n                this.from.reset();\n            }\n            if (this.to) {\n                this.to.reset();\n            }\n            delete this.value;\n        },\n        adjust: function (affectedSheet, operation, start, delta) {\n            var prevFrom, prevTo, modified;\n            var formulaRow = this.row;\n            var formulaCol = this.col;\n            if (this.from) {\n                prevFrom = this.from.adjust(affectedSheet, operation, start, delta);\n            }\n            if (this.to) {\n                prevTo = this.to.adjust(affectedSheet, operation, start, delta);\n            }\n            if (this.sheet.toLowerCase() == affectedSheet.toLowerCase()) {\n                switch (operation) {\n                case 'row':\n                    if (formulaRow >= start) {\n                        modified = true;\n                        this.row += delta;\n                    }\n                    break;\n                case 'col':\n                    if (formulaCol >= start) {\n                        modified = true;\n                        this.col += delta;\n                    }\n                    break;\n                }\n            }\n            if (modified || prevFrom || prevTo) {\n                var v = new Validation(this);\n                v.from = prevFrom;\n                v.to = prevTo;\n                v.row = formulaRow;\n                v.col = formulaCol;\n                return v;\n            }\n        },\n        toJSON: function () {\n            var options = this._getOptions();\n            if (options.from) {\n                options.from = options.from.toString();\n                if (options.dataType === 'list') {\n                    options.from = options.from.replace(/^_matrix\\((.*)\\)$/i, '$1');\n                    delete options.fromIsListValue;\n                }\n                if (options.dataType === 'date') {\n                    if (this.fromIsDateValue) {\n                        options.from = options.from.replace(/^DATEVALUE\\(\"(.*)\"\\)$/i, '$1');\n                        delete options.fromIsDateValue;\n                    }\n                }\n            }\n            if (options.to) {\n                options.to = options.to.toString();\n                if (options.dataType === 'date') {\n                    if (this.toIsDateValue) {\n                        options.to = options.to.replace(/^DATEVALUE\\(\"(.*)\"\\)$/i, '$1');\n                        delete options.toIsDateValue;\n                    }\n                }\n            }\n            return options;\n        },\n        _getOptions: function () {\n            return {\n                from: this.from,\n                to: this.to,\n                dataType: this.dataType,\n                type: this.type,\n                comparerType: this.comparerType,\n                row: this.row,\n                col: this.col,\n                sheet: this.sheet,\n                allowNulls: this.allowNulls,\n                fromIsListValue: this.fromIsListValue,\n                fromIsDateValue: this.fromIsDateValue,\n                toIsDateValue: this.toIsDateValue,\n                tooltipMessageTemplate: this.tooltipMessageTemplate,\n                tooltipTitleTemplate: this.tooltipTitleTemplate,\n                messageTemplate: this.messageTemplate,\n                titleTemplate: this.titleTemplate,\n                showButton: this.showButton\n            };\n        }\n    });\n    exports.compile = compileValidation;\n    exports.validationComparers = {\n        greaterThan: function (valueToCompare, from) {\n            return valueToCompare > from;\n        },\n        lessThan: function (valueToCompare, from) {\n            return valueToCompare < from;\n        },\n        between: function (valueToCompare, from, to) {\n            return valueToCompare >= from && valueToCompare <= to;\n        },\n        equalTo: function (valueToCompare, from) {\n            return valueToCompare == from;\n        },\n        notEqualTo: function (valueToCompare, from) {\n            return valueToCompare != from;\n        },\n        greaterThanOrEqualTo: function (valueToCompare, from) {\n            return valueToCompare >= from;\n        },\n        lessThanOrEqualTo: function (valueToCompare, from) {\n            return valueToCompare <= from;\n        },\n        notBetween: function (valueToCompare, from, to) {\n            return valueToCompare < from || valueToCompare > to;\n        },\n        custom: function (valueToCompare, from) {\n            return from;\n        },\n        list: function (valueToCompare, data) {\n            return data.indexOf(valueToCompare) > -1;\n        }\n    };\n    exports.Validation = Validation;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/sheet', [\n        'kendo.core',\n        'kendo.color',\n        'spreadsheet/runtime',\n        'spreadsheet/validation',\n        'spreadsheet/references'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var UnionRef = kendo.spreadsheet.UnionRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var Range = kendo.spreadsheet.Range;\n        var MODIFIED_FORMULAS;\n        var Selection = kendo.Class.extend({\n            init: function (sheet) {\n                this._sheet = sheet;\n                this.selection = kendo.spreadsheet.FIRSTREF.toRangeRef();\n                this.originalSelection = kendo.spreadsheet.FIRSTREF.toRangeRef();\n                this._activeCell = kendo.spreadsheet.FIRSTREF.toRangeRef();\n                this.originalActiveCell = kendo.spreadsheet.FIRSTREF;\n            },\n            currentSelectionRange: function () {\n                return this.selection.rangeAt(this.selectionRangeIndex).toRangeRef();\n            },\n            currentOriginalNavigationRange: function () {\n                return this.originalSelection.rangeAt(this.selectionRangeIndex).toRangeRef();\n            },\n            currentNavigationRange: function () {\n                if (this.singleCellSelection()) {\n                    return this._sheet._sheetRef;\n                } else {\n                    return this.selection.rangeAt(this.selectionRangeIndex).toRangeRef();\n                }\n            },\n            nextNavigationRange: function () {\n                if (!this.singleCellSelection()) {\n                    this.selectionRangeIndex = this.selection.nextRangeIndex(this.selectionRangeIndex);\n                }\n                return this.currentNavigationRange();\n            },\n            previousNavigationRange: function () {\n                if (!this.singleCellSelection()) {\n                    this.selectionRangeIndex = this.selection.previousRangeIndex(this.selectionRangeIndex);\n                }\n                return this.currentNavigationRange();\n            },\n            activeCell: function (ref) {\n                if (ref) {\n                    this.originalActiveCell = ref.first();\n                    this._activeCell = this._sheet.unionWithMerged(ref.toRangeRef());\n                    this._sheet.focus(ref);\n                    this._sheet.triggerChange({\n                        activeCell: true,\n                        selection: true\n                    });\n                }\n                return this._activeCell;\n            },\n            select: function (ref, expanded, changeActiveCell) {\n                if (ref) {\n                    if (ref.eq(this.originalSelection)) {\n                        return;\n                    }\n                    this._sheet.triggerSelect(new Range(ref, this._sheet));\n                    this.originalSelection = ref;\n                    this.selection = expanded;\n                    if (changeActiveCell !== false) {\n                        if (ref.isCell()) {\n                            this._sheet.forEachMergedCell(ref, function (merged) {\n                                ref = merged.topLeft;\n                            });\n                            this.activeCell(ref);\n                        } else {\n                            this.activeCell(this.selection.lastRange().first());\n                        }\n                        this.selectionRangeIndex = this.selection.size() - 1;\n                    } else {\n                        this._sheet.triggerChange({ selection: true });\n                    }\n                }\n                return this.selection;\n            },\n            singleCellSelection: function () {\n                return this._activeCell.eq(this.selection);\n            }\n        });\n        var Sheet = kendo.Observable.extend({\n            init: function () {\n                kendo.Observable.prototype.init.call(this);\n                this._reinit.apply(this, arguments);\n            },\n            events: [\n                'changing',\n                'commandRequest',\n                'afterInsertRow',\n                'afterDeleteRow',\n                'insertRow',\n                'insertColumn',\n                'deleteRow',\n                'deleteColumn',\n                'hideRow',\n                'hideColumn',\n                'unhideRow',\n                'unhideColumn',\n                'select',\n                'dataBinding',\n                'dataBound'\n            ],\n            _reinit: function (rowCount, columnCount, rowHeight, columnWidth, headerHeight, headerWidth, defaultCellStyle) {\n                defaultCellStyle = defaultCellStyle || {};\n                this._defaultCellStyle = {\n                    background: defaultCellStyle.background,\n                    color: defaultCellStyle.color,\n                    fontFamily: defaultCellStyle.fontFamily,\n                    fontSize: defaultCellStyle.fontSize,\n                    italic: defaultCellStyle.italic,\n                    bold: defaultCellStyle.bold,\n                    underline: defaultCellStyle.underline,\n                    wrap: defaultCellStyle.wrap,\n                    verticalAlign: defaultCellStyle.verticalAlign,\n                    textAlign: defaultCellStyle.textAlign\n                };\n                this._rows = new kendo.spreadsheet.Axis(rowCount, rowHeight);\n                this._columns = new kendo.spreadsheet.Axis(columnCount, columnWidth);\n                this._filteredRows = new kendo.spreadsheet.RangeList(0, rowCount - 1, false);\n                this._mergedCells = [];\n                this._frozenRows = 0;\n                this._frozenColumns = 0;\n                this._suspendChanges = false;\n                this._filter = null;\n                this._showGridLines = true;\n                this._gridLinesColor = null;\n                this._grid = new kendo.spreadsheet.Grid(this._rows, this._columns, rowCount, columnCount, headerHeight, headerWidth);\n                this._sheetRef = this._grid.normalize(kendo.spreadsheet.SHEETREF);\n                this._properties = new kendo.spreadsheet.PropertyBag(rowCount, columnCount, this._defaultCellStyle);\n                this._sorter = new kendo.spreadsheet.Sorter(this._grid, this._properties.sortable());\n                this._viewSelection = new Selection(this);\n                this._editSelection = new Selection(this);\n                this._formulaSelections = [];\n                this._drawings = [];\n            },\n            _selectionState: function () {\n                return this._inEdit ? this._editSelection : this._viewSelection;\n            },\n            navigator: function () {\n                if (!this._navigator) {\n                    this._navigator = new kendo.spreadsheet.SheetNavigator(this);\n                }\n                return this._navigator;\n            },\n            axisManager: function () {\n                if (!this._axisManager) {\n                    this._axisManager = new kendo.spreadsheet.AxisManager(this);\n                }\n                return this._axisManager;\n            },\n            _name: function (value) {\n                if (!value) {\n                    return this._sheetName;\n                }\n                this._sheetName = value;\n                return this;\n            },\n            name: function () {\n                return this._name();\n            },\n            _property: function (accessor, value, reason) {\n                if (value === undefined) {\n                    return accessor();\n                } else {\n                    accessor(value);\n                    return this.triggerChange(reason);\n                }\n            },\n            _field: function (name, value, reason) {\n                if (value === undefined) {\n                    return this[name];\n                } else {\n                    this[name] = value;\n                    return this.triggerChange(reason);\n                }\n            },\n            suspendChanges: function (value) {\n                if (value === undefined) {\n                    return this._suspendChanges;\n                }\n                this._suspendChanges = value;\n                return this;\n            },\n            triggerChange: function (reason) {\n                if (!this._suspendChanges) {\n                    this.trigger('change', reason);\n                }\n                return this;\n            },\n            triggerSelect: function (range) {\n                this.trigger('select', { range: range });\n            },\n            setDataSource: function (dataSource, columns) {\n                if (this.dataSourceBinder) {\n                    this.dataSourceBinder.destroy();\n                }\n                this.dataSourceBinder = new kendo.spreadsheet.SheetDataSourceBinder({\n                    dataSource: dataSource,\n                    sheet: this,\n                    columns: columns\n                });\n                this.dataSource = this.dataSourceBinder.dataSource;\n            },\n            hideColumn: function (columnIndex) {\n                if (this.trigger('hideColumn', { index: columnIndex })) {\n                    return;\n                }\n                return this._property(this._columns.hide.bind(this._columns), columnIndex, { layout: true });\n            },\n            unhideColumn: function (columnIndex) {\n                if (this.trigger('unhideColumn', { index: columnIndex })) {\n                    return;\n                }\n                return this._property(this._columns.unhide.bind(this._columns), columnIndex, { layout: true });\n            },\n            isHiddenColumn: function (columnIndex) {\n                return this._grid._columns.hidden(columnIndex);\n            },\n            _copyRange: function (sourceRangeRef, targetRef) {\n                var grid = this._grid;\n                var rowCount = grid.rowCount;\n                var nextRefTopLeft = grid.normalize(sourceRangeRef.topLeft);\n                var nextRefBottomRight = grid.normalize(sourceRangeRef.bottomRight);\n                var nextIndex = nextRefTopLeft.col * rowCount + nextRefTopLeft.row;\n                var nextBottomIndex = nextRefBottomRight.col * rowCount + nextRefBottomRight.row;\n                var targetIndex = targetRef.col * rowCount + targetRef.row;\n                this._properties.copy(nextIndex, nextBottomIndex, targetIndex);\n            },\n            _saveModifiedFormulas: function (array, callback) {\n                var save = MODIFIED_FORMULAS;\n                MODIFIED_FORMULAS = array;\n                var ret = callback();\n                MODIFIED_FORMULAS = save;\n                return ret;\n            },\n            _restoreModifiedFormulas: function (array) {\n                var wb = this._workbook;\n                array.forEach(function (f) {\n                    var sheet = wb.sheetByName(f.sheet), index;\n                    if (f instanceof kendo.spreadsheet.calc.runtime.Formula) {\n                        index = sheet._grid.cellRefIndex(f);\n                        sheet._properties.set('formula', index, index, f);\n                    }\n                    if (f instanceof kendo.spreadsheet.validation.Validation) {\n                        index = sheet._grid.cellRefIndex(f);\n                        sheet._properties.set('validation', index, index, f);\n                    }\n                });\n            },\n            _adjustReferences: function (operation, start, delta, mergedCells) {\n                this._mergedCells = mergedCells.reduce(function (a, ref) {\n                    ref = ref.adjust(null, null, null, null, operation == 'row', start, delta);\n                    if (ref instanceof RangeRef) {\n                        a.push(ref);\n                    }\n                    return a;\n                }, []);\n                if (this._workbook) {\n                    var affectedSheet = this._name();\n                    this._workbook._sheets.forEach(function (sheet) {\n                        sheet._forFormulas(function (formula) {\n                            var prev = formula.adjust(affectedSheet, operation, start, delta);\n                            if (prev && MODIFIED_FORMULAS) {\n                                MODIFIED_FORMULAS.push(prev);\n                            }\n                        });\n                        sheet._forValidations(function (validation) {\n                            var prev = validation.adjust(affectedSheet, operation, start, delta);\n                            if (prev && MODIFIED_FORMULAS) {\n                                MODIFIED_FORMULAS.push(prev);\n                            }\n                        });\n                    });\n                    this._workbook.adjustNames(affectedSheet, operation == 'row', start, delta);\n                }\n                var selection = this.select();\n                selection = selection.adjust(null, null, null, null, operation == 'row', start, delta);\n                if (selection !== kendo.spreadsheet.NULLREF) {\n                    this.select(selection);\n                }\n                var axis = operation == 'col' ? this._columns : this._rows;\n                axis.adjust(start, delta);\n                if (operation == 'row') {\n                    if (delta < 0) {\n                        this._filteredRows.copy(start - delta, this._rows._count - 1, start);\n                    } else {\n                        this._filteredRows.copy(start, this._rows._count, start + delta);\n                        this._filteredRows.value(start, start + delta - 1, false);\n                    }\n                }\n                this._drawings.forEach(function (drawing) {\n                    if (drawing.topLeftCell) {\n                        drawing.topLeftCell = drawing.topLeftCell.adjust(null, null, null, null, operation == 'row', start, delta);\n                    }\n                });\n            },\n            _forFormulas: function (callback) {\n                var props = this._properties;\n                var formulas = props.get('formula').values();\n                var n = formulas.length;\n                formulas.forEach(function (f, i) {\n                    callback.call(this, f.value, i, n);\n                }, this);\n            },\n            _forValidations: function (callback) {\n                var props = this._properties;\n                props.get('validation').values().forEach(function (v) {\n                    callback.call(this, v.value);\n                }, this);\n            },\n            preventInsertRow: function (rowIndex, count) {\n                if (this.selectedHeaders().allRows) {\n                    return {\n                        reason: 'error',\n                        type: 'insertRowWhenColumnIsSelected'\n                    };\n                }\n                count = count || 1;\n                var grid = this._grid;\n                var range = this.range(grid.rowCount - count, 0, count, grid.columnCount);\n                if (range.hasValue()) {\n                    return {\n                        reason: 'error',\n                        type: 'shiftingNonblankCells'\n                    };\n                }\n                return false;\n            },\n            preventInsertColumn: function (colIndex, count) {\n                if (this.selectedHeaders().allCols) {\n                    return {\n                        reason: 'error',\n                        type: 'insertColumnWhenRowIsSelected'\n                    };\n                }\n                count = count || 1;\n                var grid = this._grid;\n                var range = this.range(0, grid.columnCount - count, grid.rowCount, count);\n                if (range.hasValue()) {\n                    return {\n                        reason: 'error',\n                        type: 'shiftingNonblankCells'\n                    };\n                }\n                return false;\n            },\n            insertRow: function (rowIndex) {\n                var result = this.preventInsertRow(rowIndex);\n                if (result) {\n                    throw new Error('Shifting nonblank cells off the worksheet is not supported!');\n                }\n                if (this.trigger('insertRow', { index: rowIndex })) {\n                    return;\n                }\n                this.batch(function () {\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n                    var rowCount = grid.rowCount;\n                    var frozenRows = this.frozenRows();\n                    if (rowIndex < frozenRows) {\n                        this.frozenRows(frozenRows + 1);\n                    }\n                    var mergedCells = this._mergedCells.slice();\n                    for (var ci = 0; ci < columnCount; ci++) {\n                        var ref = new RangeRef(new CellRef(rowIndex, ci), new CellRef(rowIndex, ci));\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n                        var nextRef = new RangeRef(new CellRef(topLeft.row, topLeft.col), new CellRef(rowCount - 2, bottomRight.col));\n                        this._copyRange(nextRef, new CellRef(topLeft.row + 1, topLeft.col));\n                        new Range(ref, this).clear({\n                            clearAll: true,\n                            keepBorders: true\n                        });\n                    }\n                    this._adjustReferences('row', rowIndex, 1, mergedCells);\n                }, {\n                    recalc: true,\n                    layout: true,\n                    insertRow: { index: rowIndex },\n                    ref: new RangeRef(new CellRef(rowIndex, 0), new CellRef(Infinity, Infinity))\n                });\n                this.trigger('afterInsertRow', { index: rowIndex });\n                return this;\n            },\n            isEnabledRow: function (rowIndex) {\n                var ref = new RangeRef(new CellRef(rowIndex, 0), new CellRef(rowIndex, this._grid.columnCount));\n                return new Range(ref, this).enable();\n            },\n            deleteRow: function (rowIndex) {\n                if (!this.isEnabledRow(rowIndex)) {\n                    return this;\n                }\n                if (this.trigger('deleteRow', { index: rowIndex })) {\n                    return;\n                }\n                this.batch(function () {\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n                    var frozenRows = this.frozenRows();\n                    if (rowIndex < frozenRows) {\n                        this.frozenRows(frozenRows - 1);\n                    }\n                    var mergedCells = this._mergedCells.slice();\n                    for (var ci = 0; ci < columnCount; ci++) {\n                        var ref = new RangeRef(new CellRef(rowIndex, ci), new CellRef(rowIndex, ci));\n                        new Range(ref, this).clear({\n                            clearAll: true,\n                            keepBorders: true\n                        });\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n                        var nextRef = new RangeRef(new CellRef(topLeft.row + 1, topLeft.col), new CellRef(Infinity, bottomRight.col));\n                        this._copyRange(nextRef, topLeft);\n                        var nextRefBottomRight = grid.normalize(nextRef.bottomRight);\n                        new Range(new RangeRef(nextRefBottomRight, nextRefBottomRight), this).clear();\n                    }\n                    this._adjustReferences('row', rowIndex, -1, mergedCells);\n                }, {\n                    recalc: true,\n                    layout: true,\n                    deleteRow: { index: rowIndex },\n                    ref: new RangeRef(new CellRef(rowIndex, 0), new CellRef(Infinity, Infinity))\n                });\n                this.trigger('afterDeleteRow', { index: rowIndex });\n                return this;\n            },\n            insertColumn: function (columnIndex) {\n                if (this.trigger('insertColumn', { index: columnIndex })) {\n                    return;\n                }\n                this.batch(function () {\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n                    var frozenColumns = this.frozenColumns();\n                    if (columnIndex < frozenColumns) {\n                        this.frozenColumns(frozenColumns + 1);\n                    }\n                    var mergedCells = this._mergedCells.slice();\n                    for (var ci = columnCount; ci >= columnIndex; ci--) {\n                        var ref = new RangeRef(new CellRef(0, ci), new CellRef(Infinity, ci));\n                        new Range(ref, this).clear({\n                            clearAll: true,\n                            keepBorders: true\n                        });\n                        if (ci == columnIndex) {\n                            break;\n                        }\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n                        var nextRef = new RangeRef(new CellRef(topLeft.row, topLeft.col - 1), new CellRef(bottomRight.row, bottomRight.col - 1));\n                        this._copyRange(nextRef, topLeft);\n                    }\n                    this._adjustReferences('col', columnIndex, 1, mergedCells);\n                }, {\n                    recalc: true,\n                    layout: true,\n                    insertColumn: { index: columnIndex },\n                    ref: new RangeRef(new CellRef(0, columnIndex), new CellRef(Infinity, Infinity))\n                });\n                return this;\n            },\n            isEnabledColumn: function (columnIndex) {\n                var ref = new RangeRef(new CellRef(0, columnIndex), new CellRef(Infinity, columnIndex));\n                return new Range(ref, this).enable();\n            },\n            deleteColumn: function (columnIndex) {\n                if (!this.isEnabledColumn(columnIndex)) {\n                    return this;\n                }\n                if (this.trigger('deleteColumn', { index: columnIndex })) {\n                    return;\n                }\n                this.batch(function () {\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n                    var frozenColumns = this.frozenColumns();\n                    if (columnIndex < frozenColumns) {\n                        this.frozenColumns(frozenColumns - 1);\n                    }\n                    var mergedCells = this._mergedCells.slice();\n                    for (var ci = columnIndex; ci < columnCount; ci++) {\n                        var ref = new RangeRef(new CellRef(0, ci), new CellRef(Infinity, ci));\n                        new Range(ref, this).clear({\n                            clearAll: true,\n                            keepBorders: true\n                        });\n                        if (ci == columnCount - 1) {\n                            break;\n                        }\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n                        var nextRef = new RangeRef(new CellRef(topLeft.row, topLeft.col + 1), new CellRef(bottomRight.row, bottomRight.col + 1));\n                        this._copyRange(nextRef, topLeft);\n                    }\n                    this._adjustReferences('col', columnIndex, -1, mergedCells);\n                }, {\n                    recalc: true,\n                    layout: true,\n                    deleteColumn: { index: columnIndex },\n                    ref: new RangeRef(new CellRef(0, columnIndex), new CellRef(Infinity, Infinity))\n                });\n                return this;\n            },\n            _filterRow: function (rowIndex) {\n                this._rows.hide(rowIndex);\n                this._filteredRows.value(rowIndex, rowIndex, true);\n                this.triggerChange({ layout: true });\n            },\n            hideRow: function (rowIndex) {\n                if (this.trigger('hideRow', { index: rowIndex })) {\n                    return;\n                }\n                return this._property(this._rows.hide.bind(this._rows), rowIndex, { layout: true });\n            },\n            unhideRow: function (rowIndex) {\n                if (this.trigger('unhideRow', { index: rowIndex })) {\n                    return;\n                }\n                return this._property(this._rows.unhide.bind(this._rows), rowIndex, { layout: true });\n            },\n            isHiddenRow: function (rowIndex) {\n                return this._grid._rows.hidden(rowIndex);\n            },\n            isFilteredRow: function (rowIndex) {\n                return this._filteredRows.value(rowIndex);\n            },\n            columnWidth: function (columnIndex, width) {\n                return this._property(this._columns.value.bind(this._columns, columnIndex, columnIndex), width, { layout: true });\n            },\n            rowHeight: function (rowIndex, height) {\n                return this._property(this._rows.value.bind(this._rows, rowIndex, rowIndex), height, { layout: true });\n            },\n            frozenRows: function (value) {\n                return this._field('_frozenRows', value, { layout: true });\n            },\n            frozenColumns: function (value) {\n                return this._field('_frozenColumns', value, { layout: true });\n            },\n            showGridLines: function (value) {\n                return this._field('_showGridLines', value, { layout: true });\n            },\n            gridLinesColor: function (value) {\n                return this._field('_gridLinesColor', value, { layout: true });\n            },\n            _ref: function (row, column, numRows, numColumns) {\n                var ref = null;\n                if (row instanceof kendo.spreadsheet.Ref) {\n                    return row;\n                }\n                if (row instanceof kendo.spreadsheet.Range) {\n                    return row._ref.toRangeRef();\n                }\n                if (typeof row === 'string') {\n                    ref = kendo.spreadsheet.calc.parseReference(row);\n                } else {\n                    if (!numRows) {\n                        numRows = 1;\n                    }\n                    if (!numColumns) {\n                        numColumns = 1;\n                    }\n                    ref = new RangeRef(new CellRef(row, column), new CellRef(row + numRows - 1, column + numColumns - 1));\n                }\n                return ref;\n            },\n            range: function (row, column, numRows, numColumns) {\n                return new Range(this._ref(row, column, numRows, numColumns), this);\n            },\n            _getMergedCells: function (range) {\n                var grid = this._grid;\n                var primary = {};\n                var secondary = {};\n                var hasMerged = false;\n                this.forEachMergedCell(range, function (ref) {\n                    var topLeft = ref.topLeft;\n                    grid.forEach(ref, function (cellRef) {\n                        if (topLeft.eq(cellRef)) {\n                            primary[cellRef.print()] = ref;\n                            hasMerged = true;\n                        } else if (range.contains(cellRef)) {\n                            secondary[cellRef.print()] = topLeft;\n                            hasMerged = true;\n                        }\n                    });\n                });\n                return {\n                    primary: primary,\n                    secondary: secondary,\n                    hasMerged: hasMerged\n                };\n            },\n            forEachMergedCell: function (ref, callback) {\n                var selectAll = false;\n                if (typeof callback === 'undefined') {\n                    callback = ref;\n                    selectAll = true;\n                }\n                this._mergedCells.forEach(function (merged) {\n                    if (selectAll || merged.intersects(ref)) {\n                        callback(merged);\n                    }\n                });\n            },\n            forEachFilterHeader: function (ref, callback) {\n                var selectAll = false;\n                if (typeof callback === 'undefined') {\n                    callback = ref;\n                    selectAll = true;\n                }\n                if (this._filter) {\n                    var refs = [];\n                    this._filter.ref.forEachColumn(function (columnRef) {\n                        if (selectAll || columnRef.intersects(ref)) {\n                            refs.push(columnRef.topLeft);\n                        }\n                    });\n                    this._mergedCells.forEach(function (merged) {\n                        refs = refs.map(function (ref) {\n                            if (merged.intersects(ref)) {\n                                return merged;\n                            }\n                            return ref;\n                        });\n                    });\n                    refs.reduce(function unique(result, element) {\n                        if (result.indexOf(element) < 0) {\n                            result.push(element);\n                        }\n                        return result;\n                    }, []).forEach(callback);\n                }\n            },\n            forEach: function (ref, callback) {\n                var self = this;\n                function forEachRange(ref) {\n                    if (!(ref instanceof RangeRef)) {\n                        ref = ref.toRangeRef();\n                    }\n                    var topLeft = self._grid.normalize(ref.topLeft);\n                    var bottomRight = self._grid.normalize(ref.bottomRight);\n                    var ci, ri;\n                    function doIt(value) {\n                        callback(ri++, ci, value);\n                    }\n                    for (ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                        ri = topLeft.row;\n                        var startCellIndex = self._grid.index(ri, ci);\n                        var endCellIndex = self._grid.index(bottomRight.row, ci);\n                        self._properties.forEach(startCellIndex, endCellIndex, doIt);\n                    }\n                }\n                if (!(ref instanceof RangeRef)) {\n                    ref = self._ref(ref);\n                }\n                if (ref instanceof UnionRef) {\n                    ref.forEach(forEachRange);\n                } else {\n                    forEachRange(ref);\n                }\n            },\n            startResizing: function (initialPosition) {\n                this._initialPosition = initialPosition;\n                this._resizeInProgress = true;\n            },\n            startAutoFill: function () {\n                this._autoFillInProgress = true;\n                var selection = this.select();\n                this._autoFillOrigin = selection;\n                this._autoFillDest = selection;\n                this.triggerChange({ selection: true });\n            },\n            updateAutoFill: function (dest, punch, hint, direction) {\n                this._autoFillDest = dest;\n                this._autoFillPunch = punch;\n                this._autoFillHint = hint;\n                this._autoFillDirection = direction;\n                this.triggerChange({ selection: true });\n            },\n            autoFillRef: function () {\n                return this._autoFillDest;\n            },\n            autoFillPunch: function () {\n                return this._autoFillPunch;\n            },\n            autoFillInProgress: function () {\n                return this._autoFillInProgress;\n            },\n            resizingInProgress: function () {\n                return this._resizeInProgress;\n            },\n            draggingInProgress: function () {\n                return this._draggingInProgress;\n            },\n            completeResizing: function () {\n                if (this._resizeInProgress) {\n                    this._resizeInProgress = false;\n                    var hintPosition = this.resizeHintPosition();\n                    if (this._initialPosition && hintPosition) {\n                        var handlePosition = this.resizeHandlePosition();\n                        if (handlePosition.col !== -Infinity) {\n                            this.trigger('commandRequest', {\n                                command: 'ColumnWidthCommand',\n                                options: {\n                                    target: handlePosition.col,\n                                    value: this.columnWidth(handlePosition.col) - (this._initialPosition.x - hintPosition.x)\n                                }\n                            });\n                        } else {\n                            this.trigger('commandRequest', {\n                                command: 'RowHeightCommand',\n                                options: {\n                                    target: handlePosition.row,\n                                    value: this.rowHeight(handlePosition.row) - (this._initialPosition.y - hintPosition.y)\n                                }\n                            });\n                        }\n                    } else {\n                        this.trigger('change', { resize: true });\n                    }\n                }\n            },\n            _renderComment: function (ref) {\n                var comment = ref ? this.range(ref).comment() : null;\n                if (comment) {\n                    if (!this._commentRef || !ref.eq(this._commentRef)) {\n                        this._commentRef = ref;\n                        this.trigger('change', { comment: true });\n                    }\n                } else {\n                    if (this._commentRef) {\n                        this._commentRef = null;\n                        this.trigger('change', { comment: true });\n                    }\n                }\n            },\n            resizeHandlePosition: function () {\n                return this._resizeHandlePosition;\n            },\n            resizeHintPosition: function (location) {\n                if (location !== undefined) {\n                    this._resizeHintPosition = location;\n                    this.trigger('change', { resize: true });\n                }\n                return this._resizeHintPosition;\n            },\n            removeResizeHandle: function () {\n                if (this._resizeHandlePosition) {\n                    this._resizeHintPosition = undefined;\n                    this._resizeHandlePosition = undefined;\n                    this._initialPosition = undefined;\n                    this.trigger('change', { resize: true });\n                }\n            },\n            positionResizeHandle: function (ref) {\n                this._resizeHandlePosition = ref;\n                this.trigger('change', { resize: true });\n            },\n            startDragging: function (data) {\n                this._draggingInProgress = data;\n            },\n            completeDragging: function () {\n                var drag = this._draggingInProgress;\n                if (drag) {\n                    this._draggingInProgress = null;\n                    var drawing = drag.drawing;\n                    if (drawing.eq(drag.copy)) {\n                        return;\n                    }\n                    if (drawing.topLeftCell) {\n                        var box = this.drawingBoundingBox(drawing);\n                        var row = this._rows.indexVisible(box.top);\n                        var col = this._columns.indexVisible(box.left);\n                        var ref = new CellRef(row, col);\n                        var refBox = this.refBoundingBox(ref);\n                        drawing.offsetX = box.left - refBox.left;\n                        drawing.offsetY = box.top - refBox.top;\n                        drawing.topLeftCell = ref;\n                        this.triggerChange({ dragging: true });\n                    }\n                    this.trigger('commandRequest', {\n                        command: 'DrawingUpdateCommand',\n                        options: {\n                            sheet: this,\n                            drawing: drawing,\n                            previous: drag.copy\n                        }\n                    });\n                }\n            },\n            startSelection: function () {\n                this._selectionInProgress = true;\n            },\n            completeSelection: function () {\n                if (this._selectionInProgress) {\n                    this._selectionInProgress = false;\n                    this._resizeHintPosition = undefined;\n                    this.trigger('change', { selection: true });\n                }\n                if (this._autoFillInProgress) {\n                    this._autoFillInProgress = false;\n                    var dest = this._autoFillDest;\n                    var origin = this._autoFillOrigin;\n                    if (this._autoFillPunch) {\n                        this.trigger('commandRequest', {\n                            command: 'ClearContentCommand',\n                            options: { operatingRange: this.range(this._autoFillPunch) }\n                        });\n                    } else {\n                        if (!dest.eq(origin)) {\n                            this.trigger('commandRequest', {\n                                command: 'AutoFillCommand',\n                                options: {\n                                    operatingRange: this.range(dest),\n                                    origin: this.range(origin)\n                                }\n                            });\n                        } else {\n                            this.triggerChange({ selection: true });\n                        }\n                    }\n                    this._autoFillDest = null;\n                    this._autoFillPunch = null;\n                    this._autoFillOrigin = null;\n                    this.select(dest);\n                }\n            },\n            selectionInProgress: function () {\n                return this._selectionInProgress;\n            },\n            select: function (ref, changeActiveCell) {\n                var selectionState = this._selectionState();\n                var expandedRef;\n                if (ref) {\n                    ref = this._ref(ref);\n                    ref = this._grid.normalize(ref);\n                    expandedRef = this._grid.isAxis(ref) ? ref : this.unionWithMerged(ref);\n                }\n                return selectionState.select(ref, expandedRef, changeActiveCell);\n            },\n            originalSelect: function () {\n                return this._selectionState().originalSelection;\n            },\n            currentSelectionRange: function () {\n                return this._selectionState().currentSelectionRange();\n            },\n            currentOriginalSelectionRange: function () {\n                return this._selectionState().currentOriginalNavigationRange();\n            },\n            currentNavigationRange: function () {\n                return this._selectionState().currentNavigationRange();\n            },\n            nextNavigationRange: function () {\n                return this._selectionState().nextNavigationRange();\n            },\n            previousNavigationRange: function () {\n                return this._selectionState().previousNavigationRange();\n            },\n            selectionRangeIndex: function () {\n                return this._selectionState().selectionRangeIndex;\n            },\n            activeCell: function (ref) {\n                return this._selectionState().activeCell(ref);\n            },\n            originalActiveCell: function () {\n                return this._selectionState().originalActiveCell;\n            },\n            singleCellSelection: function () {\n                return this._selectionState().singleCellSelection();\n            },\n            unionWithMerged: function (ref) {\n                var mergedCells = this._mergedCells;\n                return ref.map(function (ref) {\n                    return ref.toRangeRef().union(mergedCells);\n                });\n            },\n            trim: function (ref) {\n                var trims = [];\n                var grid = this._grid;\n                this._properties.forEachProperty(function (property) {\n                    trims.push(grid.trim(ref, property.list));\n                });\n                return this.unionWithMerged(ref.topLeft.toRangeRef().union(trims));\n            },\n            focus: function (ref) {\n                if (ref) {\n                    this._focus = ref.toRangeRef();\n                } else {\n                    var focus = this._focus;\n                    this._focus = null;\n                    return focus;\n                }\n            },\n            activeCellSelection: function () {\n                return new Range(this._grid.normalize(this.activeCell()), this);\n            },\n            selection: function () {\n                return new Range(this._grid.normalize(this._selectionState().selection), this);\n            },\n            selectedHeaders: function () {\n                var selection = this.select();\n                var rows = {};\n                var cols = {};\n                var allCols = false;\n                var allRows = false;\n                var maxRow = this._grid.rowCount - 1;\n                var maxCol = this._grid.columnCount - 1;\n                selection.forEach(function (ref) {\n                    var i;\n                    var rowState = 'partial';\n                    var colState = 'partial';\n                    ref = ref.toRangeRef();\n                    var bottomRight = ref.bottomRight;\n                    var topLeft = ref.topLeft;\n                    var rowSelection = topLeft.col <= 0 && bottomRight.col >= maxCol;\n                    var colSelection = topLeft.row <= 0 && bottomRight.row >= maxRow;\n                    if (colSelection) {\n                        allRows = true;\n                        colState = 'full';\n                    }\n                    if (rowSelection) {\n                        allCols = true;\n                        rowState = 'full';\n                    }\n                    if (!colSelection) {\n                        for (i = topLeft.row; i <= bottomRight.row; i++) {\n                            if (rows[i] !== 'full') {\n                                rows[i] = rowState;\n                            }\n                        }\n                    }\n                    if (!rowSelection) {\n                        for (i = topLeft.col; i <= bottomRight.col; i++) {\n                            if (cols[i] !== 'full') {\n                                cols[i] = colState;\n                            }\n                        }\n                    }\n                });\n                return {\n                    rows: rows,\n                    cols: cols,\n                    allRows: allRows,\n                    allCols: allCols,\n                    all: allRows && allCols\n                };\n            },\n            isInEditMode: function (isInEdit) {\n                if (isInEdit === undefined) {\n                    return this._inEdit;\n                }\n                this._inEdit = isInEdit;\n                if (isInEdit) {\n                    this._editSelection.selection = this._viewSelection.selection.clone();\n                    this._editSelection.originalSelection = this._viewSelection.originalSelection.clone();\n                    this._editSelection._activeCell = this._viewSelection._activeCell.clone();\n                    this._editSelection.originalActiveCell = this._viewSelection.originalActiveCell.clone();\n                }\n            },\n            _setFormulaSelections: function (selection) {\n                this._formulaSelections = (selection || []).slice();\n                this.triggerChange({ selection: true });\n            },\n            _viewActiveCell: function () {\n                return this._viewSelection._activeCell.toRangeRef();\n            },\n            toJSON: function () {\n                var positions = {};\n                var rows = this._rows.toJSON('height', positions);\n                var columns = this._columns.toJSON('width', {});\n                var viewSelection = this._viewSelection;\n                var hyperlinks = [];\n                var defaultCellStyle = this._defaultCellStyle || {};\n                function clearDefaultStyle(cell) {\n                    Object.keys(defaultCellStyle).forEach(function (key) {\n                        if (cell[key] === defaultCellStyle[key]) {\n                            delete cell[key];\n                        }\n                    });\n                }\n                this.forEach(kendo.spreadsheet.SHEETREF, function (row, col, cell) {\n                    clearDefaultStyle(cell);\n                    if (Object.keys(cell).length === 0) {\n                        return;\n                    }\n                    if (cell.link) {\n                        hyperlinks.push({\n                            ref: kendo.spreadsheet.Ref.display(null, row, col),\n                            target: cell.link\n                        });\n                    }\n                    var position = positions[row];\n                    if (position === undefined) {\n                        position = rows.length;\n                        rows.push({ index: row });\n                        positions[row] = position;\n                    }\n                    row = rows[position];\n                    cell.index = col;\n                    if (row.cells === undefined) {\n                        row.cells = [];\n                    }\n                    if (cell.formula) {\n                        if (cell.formula.arrayFormulaRange) {\n                            cell.formula = {\n                                src: cell.formula.toString(),\n                                ref: cell.formula.arrayFormulaRange.toString()\n                            };\n                        } else {\n                            cell.formula = cell.formula.toString();\n                        }\n                    }\n                    if (cell.validation) {\n                        cell.validation = cell.validation.toJSON();\n                    }\n                    if (cell.color) {\n                        cell.color = kendo.parseColor(cell.color).toCss();\n                    }\n                    if (cell.background) {\n                        cell.background = kendo.parseColor(cell.background).toCss();\n                    }\n                    if (cell.borderTop && cell.borderTop.color) {\n                        cell.borderTop.color = kendo.parseColor(cell.borderTop.color).toCss();\n                    }\n                    if (cell.borderBottom && cell.borderBottom.color) {\n                        cell.borderBottom.color = kendo.parseColor(cell.borderBottom.color).toCss();\n                    }\n                    if (cell.borderRight && cell.borderRight.color) {\n                        cell.borderRight.color = kendo.parseColor(cell.borderRight.color).toCss();\n                    }\n                    if (cell.borderLeft && cell.borderLeft.color) {\n                        cell.borderLeft.color = kendo.parseColor(cell.borderLeft.color).toCss();\n                    }\n                    row.cells.push(cell);\n                });\n                var json = {\n                    name: this._name(),\n                    rows: rows,\n                    columns: columns,\n                    selection: viewSelection.selection.toString(),\n                    activeCell: viewSelection.activeCell().toString(),\n                    frozenRows: this.frozenRows(),\n                    frozenColumns: this.frozenColumns(),\n                    showGridLines: this.showGridLines(),\n                    gridLinesColor: this.gridLinesColor(),\n                    mergedCells: this._mergedCells.map(function (ref) {\n                        return ref.toString();\n                    }),\n                    hyperlinks: hyperlinks,\n                    defaultCellStyle: defaultCellStyle,\n                    drawings: this._drawings.map(function (dr) {\n                        return dr.toJSON();\n                    })\n                };\n                if (this._sort) {\n                    json.sort = {\n                        ref: this._sort.ref.toString(),\n                        columns: this._sort.columns.map(function (column) {\n                            return {\n                                index: column.index,\n                                ascending: column.ascending\n                            };\n                        })\n                    };\n                }\n                if (this._filter) {\n                    json.filter = {\n                        ref: this._filter.ref.toString(),\n                        columns: this._filter.columns.map(function (column) {\n                            var filter = column.filter.toJSON();\n                            filter.index = column.index;\n                            return filter;\n                        })\n                    };\n                }\n                return json;\n            },\n            fromJSON: function (json) {\n                this.batch(function () {\n                    if (json.name !== undefined) {\n                        this._name(json.name);\n                    }\n                    if (json.frozenColumns !== undefined) {\n                        this.frozenColumns(json.frozenColumns);\n                    }\n                    if (json.frozenRows !== undefined) {\n                        this.frozenRows(json.frozenRows);\n                    }\n                    if (json.columns !== undefined) {\n                        this._columns.fromJSON('width', json.columns);\n                    }\n                    if (json.rows !== undefined) {\n                        this._rows.fromJSON('height', json.rows);\n                        for (var ri = 0; ri < json.rows.length; ri++) {\n                            var row = json.rows[ri];\n                            var rowIndex = row.index;\n                            if (rowIndex === undefined) {\n                                rowIndex = ri;\n                            }\n                            if (row.cells) {\n                                for (var ci = 0; ci < row.cells.length; ci++) {\n                                    var cell = row.cells[ci];\n                                    var columnIndex = cell.index;\n                                    if (columnIndex === undefined) {\n                                        columnIndex = ci;\n                                    }\n                                    if (cell.formula) {\n                                        var isArray = typeof cell.formula != 'string';\n                                        var src = isArray ? cell.formula.src : cell.formula;\n                                        var formula = this._compileFormula(rowIndex, columnIndex, src);\n                                        if (isArray) {\n                                            formula.setArrayFormulaRange(kendo.spreadsheet.calc.parseReference(cell.formula.ref));\n                                        }\n                                        cell.formula = formula;\n                                    }\n                                    if (cell.validation) {\n                                        cell.validation = this._compileValidation(rowIndex, columnIndex, cell.validation);\n                                    }\n                                    this._properties.fromJSON(this._grid.index(rowIndex, columnIndex), cell);\n                                }\n                            }\n                        }\n                    }\n                    if (json.drawings) {\n                        this._drawings = json.drawings.map(Drawing.fromJSON);\n                    }\n                    if (json.selection) {\n                        this._viewSelection.selection = this._viewSelection.originalSelection = this._ref(json.selection);\n                    }\n                    if (json.activeCell) {\n                        var activeCellRef = this._ref(json.activeCell);\n                        this._viewSelection._activeCell = activeCellRef.toRangeRef();\n                        this._viewSelection.originalActiveCell = activeCellRef.first();\n                    }\n                    if (json.mergedCells) {\n                        json.mergedCells.forEach(function (ref) {\n                            this.range(ref).merge();\n                        }, this);\n                    }\n                    if (json.sort) {\n                        this._sort = {\n                            ref: this._ref(json.sort.ref),\n                            columns: json.sort.columns.slice(0)\n                        };\n                    }\n                    if (json.filter) {\n                        var ref = json.filter.ref;\n                        var columns = json.filter.columns === undefined ? [] : json.filter.columns;\n                        if (!ref) {\n                            kendo.logToConsole('Dropping filter for sheet \\'' + json.name + '\\' due to missing ref');\n                        } else {\n                            this._filter = {\n                                ref: this._ref(ref),\n                                columns: columns.map(function (column) {\n                                    return {\n                                        index: column.index,\n                                        filter: kendo.spreadsheet.Filter.create(column)\n                                    };\n                                })\n                            };\n                            this._refreshFilter();\n                        }\n                    }\n                    if (json.showGridLines !== undefined) {\n                        this._showGridLines = json.showGridLines;\n                    }\n                    this._gridLinesColor = json.gridLinesColor;\n                });\n                this._rows._refresh();\n                this._columns._refresh();\n            },\n            formula: function (ref) {\n                return this._properties.get('formula', this._grid.cellRefIndex(ref));\n            },\n            validation: function (ref) {\n                return this._properties.get('validation', this._grid.cellRefIndex(ref));\n            },\n            resetFormulas: function () {\n                this._forFormulas(function (formula) {\n                    formula.reset();\n                });\n            },\n            resetValidations: function () {\n                this._forValidations(function (validation) {\n                    validation.reset();\n                });\n            },\n            recalc: function (context, callback) {\n                var formulas = this._properties.get('formula').values();\n                var count = formulas.length, pending = 0, i = 0;\n                if (!count && callback) {\n                    return callback();\n                }\n                function next() {\n                    pending--;\n                    if (i == count && !pending) {\n                        callback();\n                    }\n                }\n                while (i < count) {\n                    pending++;\n                    formulas[i++].value.exec(context, callback ? next : null);\n                }\n            },\n            revalidate: function (context) {\n                var self = this;\n                this._forValidations(function (validation) {\n                    var cellRef = new CellRef(validation.row, validation.col);\n                    var ref = new RangeRef(cellRef, cellRef);\n                    validation.exec(context, self._get(ref, 'value'), self._get(ref, 'format'));\n                });\n            },\n            _value: function (row, col, value) {\n                var index = this._grid.index(row, col);\n                if (value !== undefined) {\n                    this._properties.set('value', index, index, value);\n                } else {\n                    return this._properties.get('value', index);\n                }\n            },\n            _validation: function (row, col) {\n                var index = this._grid.index(row, col);\n                return this._properties.get('validation', index);\n            },\n            _compileValidation: function (row, col, validation) {\n                if (validation instanceof kendo.spreadsheet.validation.Validation) {\n                    return validation.clone(this._name(), row, col);\n                }\n                if (validation.from != null) {\n                    validation.from = (validation.from + '').replace(/^=/, '');\n                }\n                if (validation.to != null) {\n                    validation.to = (validation.to + '').replace(/^=/, '');\n                }\n                return kendo.spreadsheet.validation.compile(this._name(), row, col, validation);\n            },\n            _compileFormula: function (row, col, f) {\n                f = f.replace(/^=/, '');\n                f = kendo.spreadsheet.calc.parseFormula(this._name(), row, col, f);\n                return kendo.spreadsheet.calc.compile(f);\n            },\n            _copyValuesInRange: function (topLeft, bottomRight, value, property) {\n                var ci, start, end;\n                for (ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                    start = this._grid.index(topLeft.row, ci);\n                    end = this._grid.index(bottomRight.row, ci);\n                    for (var index = start, row = topLeft.row; index <= end; ++index, ++row) {\n                        value = value.clone(this._name(), row, ci);\n                        this._properties.set(property, index, index, value);\n                    }\n                }\n                return value;\n            },\n            _set: function (ref, name, value) {\n                var topLeft = this._grid.normalize(ref.topLeft);\n                var bottomRight = this._grid.normalize(ref.bottomRight);\n                var ci, start, end;\n                if (typeof value == 'number') {\n                    value = kendo.spreadsheet.calc.runtime.limitPrecision(value);\n                }\n                if (value && name == 'formula') {\n                    if (typeof value == 'string') {\n                        value = this._compileFormula(topLeft.row, topLeft.col, value);\n                    }\n                    value = this._copyValuesInRange(topLeft, bottomRight, value, 'formula');\n                } else if (value && name == 'validation') {\n                    value = this._compileValidation(topLeft.row, topLeft.col, value);\n                    value = this._copyValuesInRange(topLeft, bottomRight, value, 'validation');\n                } else {\n                    for (ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                        start = this._grid.index(topLeft.row, ci);\n                        end = this._grid.index(bottomRight.row, ci);\n                        this._properties.set(name, start, end, value);\n                        if (name == 'formula') {\n                            this._properties.set('value', start, end, null);\n                        }\n                    }\n                }\n            },\n            _get: function (ref, name) {\n                var topLeft = this._grid.normalize(ref.topLeft);\n                var index = this._grid.index(topLeft.row, topLeft.col);\n                return this._properties.get(name, index);\n            },\n            batch: function (callback, reason) {\n                var suspended = this.suspendChanges();\n                this.suspendChanges(true);\n                callback.call(this);\n                return this.suspendChanges(suspended).triggerChange(reason || { recalc: true });\n            },\n            _sortBy: function (ref, columns) {\n                var indices = null;\n                columns.forEach(function (column) {\n                    indices = this._sorter.sortBy(ref, column.index, this._properties.get('value'), column.ascending, indices);\n                }, this);\n                this._sort = {\n                    ref: ref,\n                    columns: columns\n                };\n                this._refreshFilter();\n                this.forEach(ref, function (row, col, props) {\n                    var formula = props.formula;\n                    if (formula) {\n                        var diff = row - formula.row;\n                        if (diff !== 0) {\n                            var start = diff > 0 ? formula.row : formula.row + diff;\n                            formula.adjust(this.name(), 'row', start, diff);\n                        }\n                    }\n                }.bind(this));\n                this.triggerChange({ recalc: true });\n            },\n            _refreshFilter: function () {\n                if (this._filter) {\n                    this._filterBy(this._filter.ref, this._filter.columns);\n                }\n            },\n            _filterBy: function (ref, columns) {\n                this.batch(function () {\n                    for (var ri = ref.topLeft.row; ri <= ref.bottomRight.row; ri++) {\n                        if (this.isFilteredRow(ri)) {\n                            this._filteredRows.value(ri, ri, false);\n                            this._rows.unhide(ri);\n                        }\n                    }\n                    columns.forEach(function (column) {\n                        var columnRef = ref.resize({ top: 1 }).toColumn(column.index);\n                        var cells = [];\n                        if (columnRef === kendo.spreadsheet.NULLREF) {\n                            return;\n                        }\n                        this.forEach(columnRef, function (row, col, cell) {\n                            cell.row = row;\n                            cells.push(cell);\n                        });\n                        column.filter.prepare(cells);\n                        for (var ci = 0; ci < cells.length; ci++) {\n                            var cell = cells[ci];\n                            var value = column.filter.value(cell);\n                            if (column.filter.matches(value) === false) {\n                                this._filterRow(cell.row);\n                            }\n                        }\n                    }, this);\n                    this._filter = {\n                        ref: ref,\n                        columns: columns\n                    };\n                }, {\n                    recalc: true,\n                    layout: true,\n                    filter: true\n                });\n            },\n            filterColumn: function (ref) {\n                var filterRef = this.filter().ref;\n                return ref.toRangeRef().topLeft.col - filterRef.topLeft.col;\n            },\n            filter: function () {\n                return this._filter;\n            },\n            clearFilter: function (spec) {\n                this._clearFilter(spec instanceof Array ? spec : [spec]);\n            },\n            _clearFilter: function (indices) {\n                if (this._filter) {\n                    this.batch(function () {\n                        this._filter.columns = this._filter.columns.filter(function (column) {\n                            return indices.indexOf(column.index) < 0;\n                        });\n                        this._refreshFilter();\n                    }, {\n                        recalc: true,\n                        layout: true,\n                        filter: true\n                    });\n                }\n            },\n            getAxisState: function () {\n                return {\n                    rows: this._rows.getState(),\n                    columns: this._columns.getState()\n                };\n            },\n            setAxisState: function (state) {\n                this._rows.setState(state.rows);\n                this._columns.setState(state.columns);\n                this.triggerChange({ layout: true });\n            },\n            getState: function () {\n                return {\n                    rows: this._rows.getState(),\n                    columns: this._columns.getState(),\n                    mergedCells: this._mergedCells.map(function (cell) {\n                        return cell.clone();\n                    }),\n                    properties: this._properties.getState()\n                };\n            },\n            setState: function (state) {\n                this._rows.setState(state.rows);\n                this._columns.setState(state.columns);\n                this._mergedCells = state.mergedCells;\n                this._properties.setState(state.properties);\n                this.triggerChange(kendo.spreadsheet.ALL_REASONS);\n            },\n            _merge: function (ref) {\n                var mergedCells = this._mergedCells;\n                var sheet = this;\n                var mergedRef;\n                this.batch(function () {\n                    mergedRef = ref.map(function (ref) {\n                        if (ref instanceof kendo.spreadsheet.CellRef) {\n                            return ref;\n                        }\n                        var currentRef = ref.toRangeRef().union(mergedCells, function (ref) {\n                            mergedCells.splice(mergedCells.indexOf(ref), 1);\n                        });\n                        var range = new Range(currentRef, sheet);\n                        var formula = range._get('formula');\n                        var value = range.value();\n                        var format = range.format();\n                        var background = range.background();\n                        range.value(null);\n                        range.format(null);\n                        range.background(null);\n                        var topLeft = new Range(currentRef.collapse(), sheet);\n                        if (formula) {\n                            topLeft._set('formula', formula);\n                        } else {\n                            topLeft.value(value);\n                        }\n                        topLeft.format(format);\n                        topLeft.background(background);\n                        mergedCells.push(currentRef);\n                        return currentRef;\n                    });\n                    var viewSelection = sheet._viewSelection;\n                    viewSelection.selection = sheet.unionWithMerged(viewSelection.originalSelection);\n                    viewSelection._activeCell = sheet.unionWithMerged(viewSelection.originalActiveCell);\n                }, {\n                    activeCell: true,\n                    selection: true\n                });\n                return mergedRef;\n            },\n            _useCultureDecimals: function () {\n                return this._workbook && this._workbook.options.useCultureDecimals;\n            },\n            withCultureDecimals: function (f) {\n                var dot = '.';\n                if (this._useCultureDecimals()) {\n                    dot = kendo.culture().numberFormat['.'];\n                }\n                return kendo.spreadsheet.calc.withDecimalSeparator(dot, f);\n            },\n            drawingBoundingBox: function (drawing) {\n                var left = drawing.offsetX;\n                var top = drawing.offsetY;\n                if (drawing.topLeftCell) {\n                    left += this._columns.sum(0, drawing.topLeftCell.col - 1);\n                    top += this._rows.sum(0, drawing.topLeftCell.row - 1);\n                }\n                return new kendo.spreadsheet.Rectangle(left, top, drawing.width, drawing.height);\n            },\n            refBoundingBox: function (ref) {\n                return this._grid.rectangle(ref.toRangeRef());\n            },\n            addDrawing: function (drw, activate) {\n                if (!(drw instanceof Drawing)) {\n                    drw = new Drawing(drw);\n                }\n                this._drawings.push(drw);\n                if (activate) {\n                    this._activeDrawing = drw;\n                }\n                this.triggerChange({ layout: true });\n                return drw;\n            },\n            removeDrawing: function (drawing) {\n                var pos = this._drawings.indexOf(drawing);\n                if (pos >= 0) {\n                    this._drawings.splice(pos, 1);\n                    this.triggerChange({ layout: true });\n                }\n            },\n            usesImage: function (img) {\n                for (var i = this._drawings.length; --i >= 0;) {\n                    if (this._drawings[i].image === img) {\n                        return true;\n                    }\n                }\n                return false;\n            }\n        });\n        var Drawing = kendo.Class.extend({\n            init: function Drawing(args) {\n                this.reset(args);\n            },\n            toJSON: function () {\n                return {\n                    topLeftCell: this.topLeftCell.toString(),\n                    offsetX: this.offsetX,\n                    offsetY: this.offsetY,\n                    width: this.width,\n                    height: this.height,\n                    image: this.image,\n                    opacity: this.opacity\n                };\n            },\n            clone: function () {\n                return new Drawing(this);\n            },\n            reset: function (dr) {\n                var anchor = dr.topLeftCell;\n                if (typeof anchor == 'string') {\n                    anchor = kendo.spreadsheet.calc.parseReference(anchor);\n                }\n                this.topLeftCell = anchor;\n                this.offsetX = dr.offsetX || 0;\n                this.offsetY = dr.offsetY || 0;\n                this.width = dr.width;\n                this.height = dr.height;\n                this.image = dr.image;\n                this.opacity = dr.opacity != null ? dr.opacity : 1;\n            },\n            eq: function (dr) {\n                return (!this.topLeftCell && !dr.topLeftCell || this.topLeftCell && dr.topLeftCell && this.topLeftCell.eq(dr.topLeftCell)) && this.offsetX === dr.offsetX && this.offsetY === dr.offsetY && this.width === dr.width && this.height === dr.height && this.image === dr.image && this.opacity === dr.opacity;\n            }\n        });\n        Drawing.fromJSON = function (args) {\n            return new Drawing(args);\n        };\n        kendo.spreadsheet.Sheet = Sheet;\n        kendo.spreadsheet.Drawing = Drawing;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/sheetsbar', [\n        'kendo.core',\n        'kendo.sortable'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var outerWidth = kendo._outerWidth;\n        var DOT = '.';\n        var EMPTYCHAR = ' ';\n        var sheetsBarClassNames = {\n            sheetsBarWrapper: 'k-widget k-header',\n            sheetsBarSheetsWrapper: 'k-tabstrip k-floatwrap k-tabstrip-bottom',\n            sheetsBarActive: 'k-spreadsheet-sheets-bar-active',\n            sheetsBarInactive: 'k-spreadsheet-sheets-bar-inactive',\n            sheetsBarAdd: 'k-spreadsheet-sheets-bar-add',\n            sheetsBarRemove: 'k-spreadsheet-sheets-remove',\n            sheetsBarItems: 'k-spreadsheet-sheets-items',\n            sheetsBarEditor: 'k-spreadsheet-sheets-editor',\n            sheetsBarScrollable: 'k-tabstrip-scrollable',\n            sheetsBarNext: 'k-tabstrip-next',\n            sheetsBarPrev: 'k-tabstrip-prev',\n            sheetsBarKItem: 'k-item k-state-default',\n            sheetsBarKActive: 'k-state-active k-state-tab-on-top',\n            sheetsBarKTextbox: 'k-textbox',\n            sheetsBarKLink: 'k-link',\n            sheetsBarKIcon: 'k-icon',\n            sheetsBarKFontIcon: 'k-icon',\n            sheetsBarKButton: 'k-button k-button-icon',\n            sheetsBarKButtonBare: 'k-bare',\n            sheetsBarKArrowW: 'k-i-arrow-60-left',\n            sheetsBarKArrowE: 'k-i-arrow-60-right',\n            sheetsBarKReset: 'k-reset k-tabstrip-items',\n            sheetsBarKIconX: 'k-i-close',\n            sheetsBarKSprite: 'k-sprite',\n            sheetsBarKIconPlus: 'k-i-plus',\n            sheetsBarHintWrapper: 'k-widget k-tabstrip k-tabstrip-bottom k-spreadsheet-sheets-items-hint',\n            sheetsBarKResetItems: 'k-reset k-tabstrip-items'\n        };\n        var SheetsBar = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                var classNames = SheetsBar.classNames;\n                kendo.ui.Widget.call(this, element, options);\n                element = this.element;\n                element.addClass(classNames.sheetsBarWrapper);\n                this._openDialog = options.openDialog;\n                this._tree = new kendo.dom.Tree(element[0]);\n                this._tree.render([\n                    this._addButton(),\n                    this._createSheetsWrapper([])\n                ]);\n                this._toggleScrollEvents(true);\n                this._createSortable();\n                this._sortable.bind('start', this._onSheetReorderStart.bind(this));\n                this._sortable.bind('end', this._onSheetReorderEnd.bind(this));\n                element.on('click', DOT + classNames.sheetsBarRemove, this._onSheetRemove.bind(this));\n                element.on('click', 'li', this._onSheetSelect.bind(this));\n                element.on('dblclick', 'li' + DOT + classNames.sheetsBarActive, this._createEditor.bind(this));\n                element.on('click', DOT + classNames.sheetsBarAdd, this._onAddSelect.bind(this));\n            },\n            options: {\n                name: 'SheetsBar',\n                scrollable: { distance: 200 }\n            },\n            events: [\n                'select',\n                'reorder',\n                'rename'\n            ],\n            _createEditor: function () {\n                if (this._editor) {\n                    return;\n                }\n                this._renderSheets(this._sheets, this._selectedIndex, true);\n                this._editor = this.element.find(kendo.format('input{0}{1}', DOT, SheetsBar.classNames.sheetsBarEditor)).focus().on('keydown', this._onEditorKeydown.bind(this)).on('blur', this._onEditorBlur.bind(this));\n            },\n            _destroyEditor: function (canceled) {\n                var newSheetName = canceled ? null : this._editor.val();\n                this._editor.off();\n                this._editor = null;\n                this._renderSheets(this._sheets, this._selectedIndex, false);\n                this._onSheetRename(newSheetName);\n            },\n            renderSheets: function (sheets, selectedIndex) {\n                if (!sheets || selectedIndex < 0) {\n                    return;\n                }\n                this._renderSheets(sheets, selectedIndex, false);\n            },\n            _renderSheets: function (sheets, selectedIndex, isInEditMode) {\n                var that = this;\n                var wrapperOffsetWidth;\n                var sheetsGroupScrollWidth;\n                var classNames = SheetsBar.classNames;\n                that._isRtl = kendo.support.isRtl(that.element);\n                that._sheets = sheets;\n                that._selectedIndex = selectedIndex;\n                that._renderHtml(isInEditMode, true);\n                if (!that._scrollableAllowed()) {\n                    return;\n                }\n                var sheetsWrapper = that._sheetsWrapper();\n                var scrollPrevButton = sheetsWrapper.children(DOT + classNames.sheetsBarPrev);\n                var scrollNextButton = sheetsWrapper.children(DOT + classNames.sheetsBarNext);\n                var gapWidth = 2;\n                var addButton = that.element.find(DOT + classNames.sheetsBarAdd);\n                var addButtonWidth = outerWidth(addButton) + addButton.position().left + gapWidth;\n                var scrollPrevButtonWidth = outerWidth(scrollPrevButton) + gapWidth;\n                var sheetsGroup = that._sheetsGroup();\n                scrollPrevButton.css({ left: addButtonWidth });\n                sheetsWrapper.addClass(classNames.sheetsBarScrollable + EMPTYCHAR + classNames.sheetsBarSheetsWrapper);\n                sheetsGroup.css({ marginLeft: addButtonWidth });\n                wrapperOffsetWidth = sheetsWrapper[0].offsetWidth;\n                sheetsGroupScrollWidth = sheetsGroup[0].scrollWidth;\n                if (sheetsGroupScrollWidth + addButtonWidth > wrapperOffsetWidth) {\n                    var scrollNextButtonRight = Math.ceil(kendo.parseFloat(scrollNextButton.css('right')));\n                    if (!that._scrollableModeActive) {\n                        that._nowScrollingSheets = false;\n                        that._scrollableModeActive = true;\n                    }\n                    sheetsGroup.css({\n                        marginLeft: scrollPrevButtonWidth + addButtonWidth,\n                        marginRight: outerWidth(scrollNextButton) + scrollNextButtonRight + gapWidth\n                    });\n                } else {\n                    if (that._scrollableModeActive && sheetsGroupScrollWidth <= wrapperOffsetWidth) {\n                        that._scrollableModeActive = false;\n                        sheetsGroup.css({\n                            marginLeft: addButtonWidth,\n                            marginRight: ''\n                        });\n                    } else {\n                        sheetsGroup.css({ marginLeft: addButtonWidth });\n                    }\n                }\n                that._toggleScrollButtons();\n            },\n            _toggleScrollButtons: function (toggle) {\n                var that = this;\n                var ul = that._sheetsGroup();\n                var wrapper = that._sheetsWrapper();\n                var scrollLeft = ul.scrollLeft();\n                var prev = wrapper.find(DOT + SheetsBar.classNames.sheetsBarPrev);\n                var next = wrapper.find(DOT + SheetsBar.classNames.sheetsBarNext);\n                if (toggle === false) {\n                    prev.toggle(false);\n                    next.toggle(false);\n                } else {\n                    prev.toggle(that._isRtl ? scrollLeft < ul[0].scrollWidth - ul[0].offsetWidth - 1 : scrollLeft !== 0);\n                    next.toggle(that._isRtl ? scrollLeft !== 0 : scrollLeft < ul[0].scrollWidth - ul[0].offsetWidth - 1);\n                }\n            },\n            _toggleScrollEvents: function (toggle) {\n                var that = this;\n                var classNames = SheetsBar.classNames;\n                var options = that.options;\n                var scrollPrevButton;\n                var scrollNextButton;\n                var sheetsWrapper = that._sheetsWrapper();\n                scrollPrevButton = sheetsWrapper.children(DOT + classNames.sheetsBarPrev);\n                scrollNextButton = sheetsWrapper.children(DOT + classNames.sheetsBarNext);\n                if (toggle) {\n                    scrollPrevButton.on('mousedown', function () {\n                        that._nowScrollingSheets = true;\n                        that._scrollSheetsByDelta(options.scrollable.distance * (that._isRtl ? 1 : -1));\n                    });\n                    scrollNextButton.on('mousedown', function () {\n                        that._nowScrollingSheets = true;\n                        that._scrollSheetsByDelta(options.scrollable.distance * (that._isRtl ? -1 : 1));\n                    });\n                    scrollPrevButton.add(scrollNextButton).on('mouseup', function () {\n                        that._nowScrollingSheets = false;\n                    });\n                } else {\n                    scrollPrevButton.off();\n                    scrollNextButton.off();\n                }\n            },\n            _renderHtml: function (isInEditMode, renderScrollButtons) {\n                var idx;\n                var sheetElements = [];\n                var dom = kendo.dom;\n                var element = dom.element;\n                var sheets = this._sheets;\n                var selectedIndex = this._selectedIndex;\n                var classNames = SheetsBar.classNames;\n                for (idx = 0; idx < sheets.length; idx++) {\n                    var sheet = sheets[idx];\n                    var isSelectedSheet = idx === selectedIndex;\n                    var attr = { className: classNames.sheetsBarKItem + EMPTYCHAR };\n                    var elementContent = [];\n                    if (isSelectedSheet) {\n                        attr.className += classNames.sheetsBarKActive + EMPTYCHAR + classNames.sheetsBarActive;\n                    } else {\n                        attr.className += classNames.sheetsBarInactive;\n                    }\n                    if (isSelectedSheet && isInEditMode) {\n                        elementContent.push(element('input', {\n                            type: 'text',\n                            value: sheet.name(),\n                            className: classNames.sheetsBarKTextbox + EMPTYCHAR + classNames.sheetsBarEditor,\n                            maxlength: 50\n                        }, []));\n                    } else {\n                        elementContent.push(element('span', {\n                            className: classNames.sheetsBarKLink,\n                            title: sheet.name()\n                        }, [dom.text(sheet.name())]));\n                        if (sheets.length > 1) {\n                            var deleteIcon = element('span', { className: classNames.sheetsBarKIcon + EMPTYCHAR + classNames.sheetsBarKFontIcon + EMPTYCHAR + classNames.sheetsBarKIconX }, []);\n                            elementContent.push(element('span', { className: classNames.sheetsBarKLink + EMPTYCHAR + classNames.sheetsBarRemove }, [deleteIcon]));\n                        }\n                    }\n                    sheetElements.push(element('li', attr, elementContent));\n                }\n                this._tree.render([\n                    this._addButton(),\n                    this._createSheetsWrapper(sheetElements, renderScrollButtons)\n                ]);\n            },\n            _createSheetsWrapper: function (sheetElements, renderScrollButtons) {\n                var element = kendo.dom.element;\n                var classNames = SheetsBar.classNames;\n                var childrenElements = [element('ul', { className: classNames.sheetsBarKReset }, sheetElements)];\n                renderScrollButtons = true;\n                if (renderScrollButtons) {\n                    var baseButtonClass = classNames.sheetsBarKButton + EMPTYCHAR + classNames.sheetsBarKButtonBare + EMPTYCHAR;\n                    childrenElements.push(element('span', { className: baseButtonClass + classNames.sheetsBarPrev }, [element('span', { className: classNames.sheetsBarKIcon + EMPTYCHAR + classNames.sheetsBarKArrowW }, [])]));\n                    childrenElements.push(element('span', { className: baseButtonClass + classNames.sheetsBarNext }, [element('span', { className: classNames.sheetsBarKIcon + EMPTYCHAR + classNames.sheetsBarKArrowE }, [])]));\n                }\n                return element('div', { className: classNames.sheetsBarItems }, childrenElements);\n            },\n            _createSortable: function () {\n                var classNames = SheetsBar.classNames;\n                this._sortable = new kendo.ui.Sortable(this.element, {\n                    filter: kendo.format('ul li.{0},ul li.{1}', classNames.sheetsBarActive, classNames.sheetsBarInactive),\n                    container: DOT + classNames.sheetsBarItems,\n                    axis: 'x',\n                    animation: false,\n                    ignore: 'input',\n                    end: function () {\n                        if (this.draggable.hint) {\n                            this.draggable.hint.remove();\n                        }\n                    },\n                    hint: function (element) {\n                        var hint = $(element).clone();\n                        return hint.wrap('<div class=\\'' + classNames.sheetsBarHintWrapper + '\\'><ul class=\\'' + classNames.sheetsBarKResetItems + '\\'></ul></div>').closest('div');\n                    }\n                });\n            },\n            _onEditorKeydown: function (e) {\n                if (this._editor) {\n                    if (e.which === 13) {\n                        this._destroyEditor();\n                    }\n                    if (e.which === 27) {\n                        this._destroyEditor(true);\n                    }\n                }\n            },\n            _onEditorBlur: function () {\n                if (this._editor) {\n                    this._destroyEditor();\n                }\n            },\n            _onSheetReorderEnd: function (e) {\n                e.preventDefault();\n                this.trigger('reorder', {\n                    oldIndex: e.oldIndex,\n                    newIndex: e.newIndex\n                });\n            },\n            _onSheetReorderStart: function (e) {\n                if (this._editor) {\n                    e.preventDefault();\n                }\n            },\n            _onSheetRemove: function (e) {\n                var removedSheetName = $(e.target).closest('li').text();\n                if (this._editor) {\n                    this._destroyEditor();\n                }\n                var closeCallback = function (e) {\n                    var dlg = e.sender;\n                    if (dlg.isConfirmed()) {\n                        this.trigger('remove', {\n                            name: removedSheetName,\n                            confirmation: true\n                        });\n                    }\n                }.bind(this);\n                this._openDialog('confirmation', { close: closeCallback });\n            },\n            _onSheetSelect: function (e) {\n                var selectedSheetText = $(e.target).text();\n                if ($(e.target).is(DOT + SheetsBar.classNames.sheetsBarEditor) || !selectedSheetText) {\n                    e.preventDefault();\n                    return;\n                }\n                if (this._editor) {\n                    this._destroyEditor();\n                }\n                this._scrollSheetsToItem($(e.target).closest('li'));\n                this.trigger('select', {\n                    name: selectedSheetText,\n                    isAddButton: false\n                });\n            },\n            _onSheetRename: function (newSheetName) {\n                if (this._sheets[this._selectedIndex].name() === newSheetName || newSheetName === null) {\n                    return;\n                }\n                this.trigger('rename', {\n                    name: newSheetName,\n                    sheetIndex: this._selectedIndex\n                });\n            },\n            _onAddSelect: function () {\n                this.trigger('select', { isAddButton: true });\n            },\n            _addButton: function () {\n                var element = kendo.dom.element;\n                var classNames = SheetsBar.classNames;\n                return element('a', { className: classNames.sheetsBarAdd + EMPTYCHAR + classNames.sheetsBarKButton }, [element('span', { className: classNames.sheetsBarKIcon + EMPTYCHAR + classNames.sheetsBarKFontIcon + EMPTYCHAR + classNames.sheetsBarKIconPlus }, [])]);\n            },\n            destroy: function () {\n                this._sortable.destroy();\n            },\n            _scrollableAllowed: function () {\n                var options = this.options;\n                return options.scrollable && !isNaN(options.scrollable.distance);\n            },\n            _scrollSheetsToItem: function (item) {\n                var that = this;\n                if (!that._scrollableModeActive) {\n                    return;\n                }\n                var sheetsGroup = that._sheetsGroup();\n                var currentScrollOffset = sheetsGroup.scrollLeft();\n                var itemWidth = outerWidth(item);\n                var itemOffset = that._isRtl ? item.position().left : item.position().left - sheetsGroup.children().first().position().left;\n                var sheetsGroupWidth = sheetsGroup[0].offsetWidth;\n                var sheetsGroupPadding = Math.ceil(parseFloat(sheetsGroup.css('padding-left')));\n                var itemPosition;\n                if (that._isRtl) {\n                    if (itemOffset < 0) {\n                        itemPosition = currentScrollOffset + itemOffset - (sheetsGroupWidth - currentScrollOffset) - sheetsGroupPadding;\n                    } else if (itemOffset + itemWidth > sheetsGroupWidth) {\n                        itemPosition = currentScrollOffset + itemOffset - itemWidth + sheetsGroupPadding * 2;\n                    }\n                } else {\n                    if (currentScrollOffset + sheetsGroupWidth < itemOffset + itemWidth) {\n                        itemPosition = itemOffset + itemWidth - sheetsGroupWidth + sheetsGroupPadding * 2;\n                    } else if (currentScrollOffset > itemOffset) {\n                        itemPosition = itemOffset - sheetsGroupPadding;\n                    }\n                }\n                sheetsGroup.finish().animate({ 'scrollLeft': itemPosition }, 'fast', 'linear', function () {\n                    that._toggleScrollButtons();\n                });\n            },\n            _sheetsGroup: function () {\n                return this._sheetsWrapper().children('ul');\n            },\n            _sheetsWrapper: function () {\n                return this.element.find(DOT + SheetsBar.classNames.sheetsBarItems);\n            },\n            _scrollSheetsByDelta: function (delta) {\n                var that = this;\n                var sheetsGroup = that._sheetsGroup();\n                var scrLeft = sheetsGroup.scrollLeft();\n                sheetsGroup.finish().animate({ 'scrollLeft': scrLeft + delta }, 'fast', 'linear', function () {\n                    if (that._nowScrollingSheets) {\n                        that._scrollSheetsByDelta(delta);\n                    } else {\n                        that._toggleScrollButtons();\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.SheetsBar = SheetsBar;\n        $.extend(true, SheetsBar, { classNames: sheetsBarClassNames });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/calc', ['spreadsheet/runtime'], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var util = kendo.util;\n    var spreadsheet = kendo.spreadsheet;\n    var Ref = spreadsheet.Ref;\n    var RangeRef = spreadsheet.RangeRef;\n    var CellRef = spreadsheet.CellRef;\n    var NameRef = spreadsheet.NameRef;\n    var exports = spreadsheet.calc;\n    var runtime = exports.runtime;\n    var OPERATORS_STANDARD = Object.create(null);\n    var OPERATORS_COMMA = Object.create(null);\n    (function (ops) {\n        ops.forEach(function (cls, i) {\n            cls.forEach(function (op) {\n                OPERATORS_STANDARD[op] = ops.length - i;\n                OPERATORS_COMMA[op == ',' ? ';' : op] = ops.length - i;\n            });\n        });\n    }([\n        [':'],\n        [' '],\n        [','],\n        ['%'],\n        ['^'],\n        [\n            '*',\n            '/'\n        ],\n        [\n            '+',\n            '-'\n        ],\n        ['&'],\n        [\n            '=',\n            '<',\n            '>',\n            '<=',\n            '>=',\n            '<>'\n        ]\n    ]));\n    var OPERATORS = OPERATORS_STANDARD;\n    var SEPARATORS = {\n        DEC: '.',\n        ARG: ',',\n        COL: ','\n    };\n    function setDecimalSeparator(sep) {\n        SEPARATORS.DEC = sep;\n        SEPARATORS.ARG = sep == ',' ? ';' : ',';\n        SEPARATORS.COL = sep == ',' ? '\\\\' : ',';\n        OPERATORS = sep == ',' ? OPERATORS_COMMA : OPERATORS_STANDARD;\n    }\n    exports.withDecimalSeparator = function (sep, f) {\n        if (SEPARATORS.DEC == sep) {\n            return f();\n        }\n        var save = SEPARATORS.DEC;\n        setDecimalSeparator(sep);\n        try {\n            return f();\n        } finally {\n            setDecimalSeparator(save);\n        }\n    };\n    exports._separators = SEPARATORS;\n    var ParseError = kendo.Class.extend({\n        init: function ParseError(message, pos) {\n            this.message = message;\n            this.pos = pos;\n        },\n        toString: function () {\n            return this.message;\n        }\n    });\n    var TRUE = {\n        type: 'bool',\n        value: true\n    };\n    var FALSE = {\n        type: 'bool',\n        value: false\n    };\n    function getcol(str) {\n        str = str.toUpperCase();\n        for (var col = 0, i = 0; i < str.length; ++i) {\n            col = col * 26 + str.charCodeAt(i) - 64;\n        }\n        return col - 1;\n    }\n    function getrow(str) {\n        return parseInt(str, 10) - 1;\n    }\n    function parseReference(name, noThrow) {\n        if (name.toLowerCase() == '#sheet') {\n            return spreadsheet.SHEETREF;\n        }\n        OUT: {\n            var m;\n            if (m = /^(\\$)?([a-z]+)(\\$)?(\\d+)$/i.exec(name)) {\n                var row = getrow(m[4]), col = getcol(m[2]);\n                if (row < 1048576 && col < 16384) {\n                    return new CellRef(getrow(m[4]), getcol(m[2]));\n                }\n                break OUT;\n            }\n            var stream = TokenStream(name, {});\n            var a = [];\n            while (true) {\n                var ref = stream.next();\n                if (ref instanceof CellRef) {\n                    ref.rel = 0;\n                } else if (ref instanceof RangeRef) {\n                    ref.topLeft.rel = 0;\n                    ref.bottomRight.rel = 0;\n                } else {\n                    break OUT;\n                }\n                a.push(ref);\n                if (stream.eof()) {\n                    break;\n                }\n                if (!stream.is('op', SEPARATORS.ARG)) {\n                    break OUT;\n                }\n                stream.next();\n            }\n            return a.length == 1 ? a[0] : new spreadsheet.UnionRef(a);\n        }\n        if (!noThrow) {\n            throw new Error('Cannot parse reference: ' + name);\n        }\n    }\n    function parseFormula(sheet, row, col, input) {\n        var refs = [];\n        input = TokenStream(input, {\n            row: row,\n            col: col\n        });\n        var is = input.is;\n        return {\n            type: 'exp',\n            ast: parseExpression(true),\n            refs: refs,\n            sheet: sheet,\n            row: row,\n            col: col\n        };\n        function addReference(ref) {\n            ref.index = refs.length;\n            refs.push(ref);\n            return ref;\n        }\n        function skip(type, value, allowEOF) {\n            if (is(type, value)) {\n                return input.next();\n            } else {\n                var tok = input.peek();\n                if (tok) {\n                    input.croak('Expected ' + type + ' \\xAB' + value + '\\xBB but found ' + tok.type + ' \\xAB' + tok.value + '\\xBB');\n                } else if (!allowEOF) {\n                    input.croak('Expected ' + type + ' \\xAB' + value + '\\xBB');\n                }\n            }\n        }\n        function parseExpression(commas) {\n            return maybeBinary(maybeIntersect(parseAtom()), 0, commas);\n        }\n        function parseSymbol(tok) {\n            if (tok.upper == 'TRUE' || tok.upper == 'FALSE') {\n                return tok.upper == 'TRUE' ? TRUE : FALSE;\n            }\n            return addReference(new NameRef(tok.value));\n        }\n        function parseFuncall() {\n            var fname = input.next();\n            fname = fname.value;\n            skip('punc', '(');\n            var args = [];\n            while (1) {\n                if (is('punc', ')')) {\n                    break;\n                }\n                if (is('op', SEPARATORS.ARG)) {\n                    args.push({ type: 'null' });\n                    input.next();\n                    continue;\n                }\n                args.push(parseExpression(false));\n                if (input.eof() || is('punc', ')')) {\n                    break;\n                }\n                skip('op', SEPARATORS.ARG);\n            }\n            skip('punc', ')', true);\n            return {\n                type: 'func',\n                func: fname,\n                args: args\n            };\n        }\n        function fixReference(ref) {\n            if (!ref.hasSheet()) {\n                ref.setSheet(sheet);\n            }\n            return addReference(ref);\n        }\n        function parseAtom() {\n            var exp;\n            if (is('ref')) {\n                exp = fixReference(input.next());\n            } else if (is('func')) {\n                exp = parseFuncall();\n            } else if (is('punc', '(')) {\n                input.next();\n                exp = parseExpression(true);\n                skip('punc', ')', true);\n            } else if (is('punc', '{')) {\n                input.next();\n                exp = parseArray();\n                skip('punc', '}', true);\n            } else if (is('num') || is('str') || is('error')) {\n                exp = input.next();\n            } else if (is('sym')) {\n                exp = parseSymbol(input.next());\n            } else if (is('op', '+') || is('op', '-')) {\n                exp = {\n                    type: 'prefix',\n                    op: input.next().value,\n                    exp: parseAtom()\n                };\n            } else if (!input.peek()) {\n                input.croak('Incomplete expression');\n            } else if (is('punc', '[')) {\n                input.croak('External reference not supported');\n            } else {\n                input.croak('Parse error');\n            }\n            return maybePercent(exp);\n        }\n        function parseArray() {\n            var row = [], value = [row], first = true;\n            while (!input.eof() && !is('punc', '}')) {\n                if (first) {\n                    first = false;\n                } else if (is(null, ';')) {\n                    value.push(row = []);\n                    input.next();\n                } else {\n                    skip(null, SEPARATORS.COL);\n                }\n                row.push(parseExpression(false));\n            }\n            return {\n                type: 'matrix',\n                value: value\n            };\n        }\n        function maybeIntersect(exp) {\n            if (is('punc', '(') || is('ref') || is('num') || is('func')) {\n                return {\n                    type: 'binary',\n                    op: ' ',\n                    left: exp,\n                    right: parseExpression(false)\n                };\n            } else {\n                return exp;\n            }\n        }\n        function maybePercent(exp) {\n            if (is('op', '%')) {\n                input.next();\n                return maybePercent({\n                    type: 'postfix',\n                    op: '%',\n                    exp: exp\n                });\n            } else {\n                return exp;\n            }\n        }\n        function maybeBinary(left, my_prec, commas) {\n            var tok = is('op');\n            if (tok && (commas || tok.value != SEPARATORS.ARG)) {\n                var his_prec = OPERATORS[tok.value];\n                if (his_prec > my_prec) {\n                    input.next();\n                    var right = maybeBinary(parseAtom(), his_prec, commas);\n                    return maybeBinary({\n                        type: 'binary',\n                        op: tok.value == ';' ? ',' : tok.value,\n                        left: left,\n                        right: right\n                    }, my_prec, commas);\n                }\n            }\n            return left;\n        }\n    }\n    function parseNameDefinition(name, def) {\n        var nameRef = parseFormula(null, 0, 0, name);\n        if (!(nameRef.ast instanceof NameRef)) {\n            throw new ParseError('Invalid name: ' + name);\n        }\n        nameRef = nameRef.ast;\n        if (!(def instanceof Ref)) {\n            var defAST = parseFormula(nameRef.sheet, 0, 0, def);\n            if (defAST.ast instanceof Ref) {\n                def = defAST.ast;\n            } else if (/^(?:str|num|bool|error)$/.test(defAST.ast.type)) {\n                def = defAST.ast.value;\n            } else {\n                def = makeFormula(defAST);\n            }\n        }\n        return {\n            name: nameRef,\n            value: def\n        };\n    }\n    var makeClosure = function (cache) {\n        return function (code) {\n            var f = cache[code];\n            if (!f) {\n                f = cache[code] = new Function('\\'use strict\\';return(' + code + ')')();\n            }\n            return f;\n        };\n    }(Object.create(null));\n    function makePrinter(exp) {\n        return makeClosure('function(row, col, mod){return(' + print(exp.ast, exp, 0) + ')}');\n        function print(node, parent, prec) {\n            switch (node.type) {\n            case 'num':\n                return '(kendo.spreadsheet.calc._separators.DEC == \\'.\\' ? ' + JSON.stringify(JSON.stringify(node.value)) + ' : ' + JSON.stringify(JSON.stringify(node.value)) + '.replace(\\'.\\' , kendo.spreadsheet.calc._separators.DEC))';\n            case 'bool':\n                return JSON.stringify(node.value);\n            case 'error':\n                return JSON.stringify('#' + node.value);\n            case 'str':\n                return JSON.stringify(JSON.stringify(node.value));\n            case 'ref':\n                return 'this.refs[' + node.index + '].print(row, col, mod)';\n            case 'prefix':\n                return withParens(function () {\n                    return JSON.stringify(node.op) + ' + ' + print(node.exp, node, OPERATORS[node.op]);\n                });\n            case 'postfix':\n                return withParens(function () {\n                    return print(node.exp, node, OPERATORS[node.op]) + ' + ' + JSON.stringify(node.op);\n                });\n            case 'binary':\n                return withParens(function () {\n                    var left = parenthesize(print(node.left, node, OPERATORS[node.op]), node.left instanceof NameRef && node.op == ':');\n                    var right = parenthesize(print(node.right, node, OPERATORS[node.op]), node.right instanceof NameRef && node.op == ':');\n                    if (/^[,;]/.test(node.op)) {\n                        return left + ' + kendo.spreadsheet.calc._separators.ARG + ' + right;\n                    } else {\n                        return left + ' + ' + JSON.stringify(node.op) + ' + ' + right;\n                    }\n                });\n            case 'func':\n                return JSON.stringify(node.func + '(') + ' + ' + (node.args.length > 0 ? node.args.map(function (arg) {\n                    return print(arg, node, 0);\n                }).join(' + kendo.spreadsheet.calc._separators.ARG + \\' \\' + ') : '\\'\\'') + ' + \\')\\'';\n            case 'matrix':\n                return '\\'{ \\' + ' + node.value.map(function (el) {\n                    return el.map(function (el) {\n                        return print(el, node, 0);\n                    }).join(' + kendo.spreadsheet.calc._separators.COL + \\' \\' + ');\n                }).join(' + \\'; \\' + ') + '+ \\' }\\'';\n            case 'null':\n                return '\\'\\'';\n            }\n            throw new Error('Cannot make printer for node ' + node.type);\n            function withParens(f) {\n                var op = node.op;\n                var needParens = OPERATORS[op] < prec || !prec && op == ',' || parent.type == 'prefix' && prec == OPERATORS[op] && parent.op == '-' || parent.type == 'binary' && prec == OPERATORS[op] && node === parent.right;\n                return parenthesize(f(), needParens);\n            }\n        }\n        function parenthesize(code, cond) {\n            return cond ? '\\'(\\' + ' + code + ' + \\')\\'' : code;\n        }\n    }\n    function toCPS(ast, k) {\n        var GENSYM = 0;\n        return cps(ast, k);\n        function cps(node, k) {\n            switch (node.type) {\n            case 'ref':\n                return cpsRef(node, k);\n            case 'num':\n            case 'str':\n            case 'null':\n            case 'error':\n            case 'bool':\n                return cpsAtom(node, k);\n            case 'prefix':\n            case 'postfix':\n                return cpsUnary(node, k);\n            case 'binary':\n                return cpsBinary(node, k);\n            case 'func':\n                return cpsFunc(node, k);\n            case 'lambda':\n                return cpsLambda(node, k);\n            case 'matrix':\n                return cpsMatrix(node.value, k, true);\n            }\n            throw new Error('Cannot CPS ' + node.type);\n        }\n        function cpsRef(node, k) {\n            return node.ref == 'name' ? cpsNameRef(node, k) : cpsAtom(node, k);\n        }\n        function cpsAtom(node, k) {\n            return k(node);\n        }\n        function cpsNameRef(node, k) {\n            return {\n                type: 'func',\n                func: ',getname',\n                args: [\n                    makeContinuation(k),\n                    node\n                ]\n            };\n        }\n        function cpsUnary(node, k) {\n            return cps({\n                type: 'func',\n                func: 'unary' + node.op,\n                args: [node.exp]\n            }, k);\n        }\n        function cpsBinary(node, k) {\n            return cps({\n                type: 'func',\n                func: 'binary' + node.op,\n                args: [\n                    node.left,\n                    node.right\n                ]\n            }, k);\n        }\n        function cpsIf(co, th, el, k) {\n            return cps(co, function (co) {\n                var rest = makeContinuation(k);\n                var thenK = gensym('T');\n                var elseK = gensym('E');\n                return {\n                    type: 'func',\n                    func: 'if',\n                    args: [\n                        rest,\n                        co,\n                        {\n                            type: 'lambda',\n                            vars: [thenK],\n                            body: cps(th || TRUE, function (th) {\n                                return {\n                                    type: 'call',\n                                    func: {\n                                        type: 'var',\n                                        name: thenK\n                                    },\n                                    args: [th]\n                                };\n                            })\n                        },\n                        {\n                            type: 'lambda',\n                            vars: [elseK],\n                            body: cps(el || FALSE, function (el) {\n                                return {\n                                    type: 'call',\n                                    func: {\n                                        type: 'var',\n                                        name: elseK\n                                    },\n                                    args: [el]\n                                };\n                            })\n                        }\n                    ]\n                };\n            });\n        }\n        function cpsAnd(args, k) {\n            if (args.length === 0) {\n                return cpsAtom(TRUE, k);\n            }\n            return cps({\n                type: 'func',\n                func: 'IF',\n                args: [\n                    args[0],\n                    {\n                        type: 'func',\n                        func: 'AND',\n                        args: args.slice(1)\n                    },\n                    FALSE\n                ]\n            }, k);\n        }\n        function cpsOr(args, k) {\n            if (args.length === 0) {\n                return cpsAtom(FALSE, k);\n            }\n            return cps({\n                type: 'func',\n                func: 'IF',\n                args: [\n                    args[0],\n                    TRUE,\n                    {\n                        type: 'func',\n                        func: 'OR',\n                        args: args.slice(1)\n                    }\n                ]\n            }, k);\n        }\n        function cpsFunc(node, k) {\n            switch (node.func.toLowerCase()) {\n            case 'if':\n                return cpsIf(node.args[0], node.args[1], node.args[2], k);\n            case 'and':\n                return cpsAnd(node.args, k);\n            case 'or':\n                return cpsOr(node.args, k);\n            case 'true':\n                return k(TRUE);\n            case 'false':\n                return k(FALSE);\n            }\n            return function loop(args, i) {\n                if (i == node.args.length) {\n                    return {\n                        type: 'func',\n                        func: node.func,\n                        args: args\n                    };\n                } else {\n                    return cps(node.args[i], function (value) {\n                        return loop(args.concat([value]), i + 1);\n                    });\n                }\n            }([makeContinuation(k)], 0);\n        }\n        function cpsLambda(node, k) {\n            var cont = gensym('K');\n            var body = cps(node.body, function (body) {\n                return {\n                    type: 'call',\n                    func: {\n                        type: 'var',\n                        value: cont\n                    },\n                    args: [body]\n                };\n            });\n            return k({\n                type: 'lambda',\n                vars: [cont].concat(node.vars),\n                body: body\n            });\n        }\n        function cpsMatrix(elements, k, isMatrix) {\n            var a = [];\n            return function loop(i) {\n                if (i == elements.length) {\n                    return k({\n                        type: 'matrix',\n                        value: a\n                    });\n                } else {\n                    return (isMatrix ? cpsMatrix : cps)(elements[i], function (val) {\n                        a[i] = val;\n                        return loop(i + 1);\n                    });\n                }\n            }(0);\n        }\n        function makeContinuation(k) {\n            var cont = gensym('R');\n            return {\n                type: 'lambda',\n                vars: [cont],\n                body: k({\n                    type: 'var',\n                    name: cont\n                })\n            };\n        }\n        function gensym(name) {\n            if (!name) {\n                name = '';\n            }\n            name = '_' + name;\n            return name + ++GENSYM;\n        }\n    }\n    var FORMULA_CACHE = Object.create(null);\n    function makeFormula(exp) {\n        var printer = makePrinter(exp);\n        var hash = printer.call(exp);\n        var formula = FORMULA_CACHE[hash];\n        if (formula) {\n            return formula.clone(exp.sheet, exp.row, exp.col);\n        }\n        var code = js(toCPS(exp.ast, function (ret) {\n            return {\n                type: 'return',\n                value: ret\n            };\n        }));\n        code = [\n            'function(){',\n            'var context = this, refs = context.formula.absrefs',\n            code,\n            '}'\n        ].join(';\\n');\n        formula = new runtime.Formula(exp.refs, makeClosure(code), printer, exp.sheet, exp.row, exp.col);\n        FORMULA_CACHE[hash] = formula.clone(exp.sheet, exp.row, exp.col);\n        return formula;\n        function js(node) {\n            var type = node.type;\n            if (type == 'num') {\n                return node.value + '';\n            } else if (type == 'str') {\n                return JSON.stringify(node.value);\n            } else if (type == 'error') {\n                return 'context.error(' + JSON.stringify(node.value) + ')';\n            } else if (type == 'return') {\n                return 'context.resolve(' + js(node.value) + ')';\n            } else if (type == 'func') {\n                return 'context.func(' + JSON.stringify(node.func) + ', ' + js(node.args[0]) + ', ' + jsArray(node.args.slice(1)) + ')';\n            } else if (type == 'call') {\n                return js(node.func) + '(' + node.args.map(js).join(', ') + ')';\n            } else if (type == 'ref') {\n                return 'refs[' + node.index + ']';\n            } else if (type == 'bool') {\n                return '' + node.value;\n            } else if (type == 'if') {\n                return '(context.bool(' + js(node.co) + ') ? ' + js(node.th) + ' : ' + js(node.el) + ')';\n            } else if (type == 'lambda') {\n                return '(function(' + node.vars.join(', ') + '){ return(' + js(node.body) + ') })';\n            } else if (type == 'var') {\n                return node.name;\n            } else if (type == 'matrix') {\n                return jsArray(node.value);\n            } else if (type == 'null') {\n                return 'null';\n            } else {\n                throw new Error('Cannot compile expression ' + type);\n            }\n        }\n        function jsArray(a) {\n            return '[ ' + a.map(js).join(', ') + ' ]';\n        }\n    }\n    function identity(x) {\n        return x;\n    }\n    function TokenStream(input, options) {\n        input = RawTokenStream(InputStream(input), options);\n        var ahead = input.ahead;\n        var skip = input.skip;\n        var token = null;\n        var fixCell = options.row != null && options.col != null ? function (cell) {\n            if (cell.rel & 1) {\n                cell.col -= options.col;\n            }\n            if (cell.rel & 2) {\n                cell.row -= options.row;\n            }\n            return cell;\n        } : identity;\n        var addPos = options.forEditor ? function (thing, startToken, endToken) {\n            thing.begin = startToken.begin;\n            thing.end = endToken.end;\n            return thing;\n        } : identity;\n        return {\n            peek: peek,\n            next: next,\n            croak: input.croak,\n            eof: input.eof,\n            is: is\n        };\n        function is(type, value) {\n            var tok = peek();\n            return tok != null && (type == null || tok.type === type) && (value == null || tok.value === value) ? tok : null;\n        }\n        function peek() {\n            if (token == null) {\n                token = readNext();\n            }\n            return token;\n        }\n        function next() {\n            if (token != null) {\n                var tmp = token;\n                token = null;\n                return tmp;\n            }\n            return readNext();\n        }\n        function readNext() {\n            var ret;\n            var t = input.peek();\n            if (t) {\n                if (t.type == 'sym' || t.type == 'rc' || t.type == 'num') {\n                    ret = ahead(8, refRange3D) || ahead(6, refCell3D) || ahead(6, refSheetRange) || ahead(4, refSheetCell) || ahead(4, refRange) || ahead(2, refCell) || ahead(2, funcall);\n                }\n                if (!ret) {\n                    ret = input.next();\n                }\n            }\n            return ret;\n        }\n        function toCell(tok, isFirst) {\n            if (tok.type == 'rc') {\n                if (tok.rel && !options.forEditor && (options.row == null || options.col == null)) {\n                    input.croak('Cannot read relative cell in RC notation');\n                }\n                return new CellRef(tok.row, tok.col, tok.rel);\n            }\n            if (tok.type == 'num') {\n                if (tok.value <= 1048577) {\n                    return fixCell(new CellRef(getrow(tok.value), isFirst ? -Infinity : +Infinity, 2));\n                } else {\n                    return null;\n                }\n            }\n            var name = tok.value;\n            var m = /^(\\$)?([a-z]+)(\\$)?(\\d+)$/i.exec(name);\n            if (m) {\n                var row = getrow(m[4]), col = getcol(m[2]);\n                if (row <= 1048576 && col <= 16383) {\n                    return fixCell(new CellRef(getrow(m[4]), getcol(m[2]), (m[1] ? 0 : 1) | (m[3] ? 0 : 2)));\n                } else {\n                    return null;\n                }\n            }\n            var abs = name.charAt(0) == '$';\n            if (abs) {\n                name = name.substr(1);\n            }\n            if (/^\\d+$/.test(name)) {\n                var row = getrow(name);\n                if (row <= 1048576) {\n                    return fixCell(new CellRef(getrow(name), isFirst ? -Infinity : +Infinity, abs ? 0 : 2));\n                }\n            } else {\n                var col = getcol(name);\n                if (col <= 16383) {\n                    return fixCell(new CellRef(isFirst ? -Infinity : +Infinity, getcol(name), abs ? 0 : 1));\n                }\n            }\n        }\n        function refRange3D(a, b, c, d, e, f, g, h) {\n            if (a.type == 'sym' && b.type == 'op' && b.value == ':' && c.type == 'sym' && d.type == 'punc' && d.value == '!' && (e.type == 'sym' || e.type == 'rc' || e.type == 'num' && e.value == e.value | 0) && f.type == 'op' && f.value == ':' && (g.type == 'sym' || g.type == 'rc' || g.type == 'num' && g.value == g.value | 0) && g.type == e.type && !(h.type == 'punc' && h.value == '(' && !g.space)) {\n                var tl = toCell(e, true), br = toCell(g, false);\n                if (tl && br) {\n                    skip(7);\n                    return addPos(new RangeRef(tl.setSheet(a.value, true), br.setSheet(c.value, true)).setSheet(a.value, true), a, g);\n                }\n            }\n        }\n        function refCell3D(a, b, c, d, e, f) {\n            if (a.type == 'sym' && b.type == 'op' && b.value == ':' && c.type == 'sym' && d.type == 'punc' && d.value == '!' && (e.type == 'sym' || e.type == 'rc' || e.type == 'num' && e.value == e.value | 0) && !(f.type == 'punc' && f.value == '(' && !e.space)) {\n                var tl = toCell(e);\n                if (tl) {\n                    skip(5);\n                    var br = tl.clone();\n                    return addPos(new RangeRef(tl.setSheet(a.value, true), br.setSheet(c.value, true)).setSheet(a.value, true), a, e);\n                }\n            }\n        }\n        function refSheetRange(a, b, c, d, e, f) {\n            if (a.type == 'sym' && b.type == 'punc' && b.value == '!' && (c.type == 'sym' || c.type == 'rc' || c.type == 'num' && c.value == c.value | 0) && d.type == 'op' && d.value == ':' && (e.type == 'sym' || e.type == 'rc' || e.type == 'num' && e.value == e.value | 0) && !(f.type == 'punc' && f.value == '(' && !e.space)) {\n                var tl = toCell(c, true), br = toCell(e, false);\n                if (tl && br) {\n                    skip(5);\n                    return addPos(new RangeRef(tl, br).setSheet(a.value, true), a, e);\n                }\n            }\n        }\n        function refSheetCell(a, b, c, d) {\n            if (a.type == 'sym' && b.type == 'punc' && b.value == '!' && (c.type == 'sym' || c.type == 'rc' || c.type == 'num' && c.value == c.value | 0) && !(d.type == 'punc' && d.value == '(' && !c.space)) {\n                skip(3);\n                var x = toCell(c);\n                if (!x || !isFinite(x.row)) {\n                    x = new NameRef(c.value);\n                }\n                return addPos(x.setSheet(a.value, true), a, c);\n            }\n        }\n        function refRange(a, b, c, d) {\n            if ((a.type == 'sym' || a.type == 'rc' || a.type == 'num' && a.value == a.value | 0) && (b.type == 'op' && b.value == ':') && (c.type == 'sym' || c.type == 'rc' || c.type == 'num' && c.value == c.value | 0) && !(d.type == 'punc' && d.value == '(' && !c.space)) {\n                var tl = toCell(a, true), br = toCell(c, false);\n                if (tl && br) {\n                    skip(3);\n                    return addPos(new RangeRef(tl, br), a, c);\n                }\n            }\n        }\n        function refCell(a, b) {\n            if ((a.type == 'sym' || a.type == 'rc') && !(b.type == 'punc' && b.value == '(' && !a.space)) {\n                var x = toCell(a);\n                if (x && isFinite(x.row) && isFinite(x.col)) {\n                    skip(1);\n                    return addPos(x, a, a);\n                }\n            }\n        }\n        function funcall(a, b) {\n            if (a.type == 'sym' && b.type == 'punc' && b.value == '(' && !a.space) {\n                a.type = 'func';\n                skip(1);\n                return a;\n            }\n        }\n    }\n    function isWhitespace(ch) {\n        return ' \\t\\r\\n\\xA0\\u200B'.indexOf(ch) >= 0;\n    }\n    var EOF = { type: 'eof' };\n    function RawTokenStream(input, options) {\n        var tokens = [], index = 0;\n        var readWhile = input.readWhile;\n        return {\n            next: next,\n            peek: peek,\n            eof: eof,\n            croak: input.croak,\n            ahead: ahead,\n            skip: skip\n        };\n        function isDigit(ch) {\n            return /[0-9]/i.test(ch);\n        }\n        function isIdStart(ch) {\n            return /[a-z$_]/i.test(ch) || util.isUnicodeLetter(ch);\n        }\n        function isId(ch) {\n            return isIdStart(ch) || isDigit(ch) || ch == '.';\n        }\n        function isOpChar(ch) {\n            return ch in OPERATORS;\n        }\n        function isPunc(ch) {\n            return '\\\\!;(){}[]'.indexOf(ch) >= 0;\n        }\n        function readNumber() {\n            var has_dot = false;\n            var number = readWhile(function (ch) {\n                if (ch == SEPARATORS.DEC) {\n                    if (has_dot) {\n                        return false;\n                    }\n                    has_dot = true;\n                    return true;\n                }\n                return isDigit(ch);\n            });\n            if (number == SEPARATORS.DEC) {\n                return {\n                    type: 'punc',\n                    value: SEPARATORS.DEC\n                };\n            } else {\n                return {\n                    type: 'num',\n                    value: parseFloat(number.replace(SEPARATORS.DEC, '.'))\n                };\n            }\n        }\n        function symbol(id, quote) {\n            return {\n                type: 'sym',\n                value: id,\n                upper: id.toUpperCase(),\n                space: isWhitespace(input.peek()),\n                quote: quote\n            };\n        }\n        function getRC(a, b, c) {\n            if (!a && !b && !c) {\n                return null;\n            }\n            if (!a && !c || a && c) {\n                var num = b ? parseInt(b, 10) : 0;\n                return a ? num : num - 1;\n            }\n        }\n        function readSymbol() {\n            var m = input.lookingAt(/^R(\\[)?(-?[0-9]+)?(\\])?C(\\[)?(-?[0-9]+)?(\\])?/i);\n            if (m) {\n                var row = getRC(m[1], m[2], m[3]);\n                var col = getRC(m[4], m[5], m[6]);\n                if (row != null && col != null) {\n                    input.skip(m);\n                    return {\n                        type: 'rc',\n                        row: row,\n                        col: col,\n                        rel: (m[4] || !(m[4] || m[5] || m[6]) ? 1 : 0) | (m[1] || !(m[1] || m[2] || m[3]) ? 2 : 0)\n                    };\n                }\n            }\n            return symbol(readWhile(isId));\n        }\n        function readString() {\n            input.next();\n            return {\n                type: 'str',\n                value: input.readEscaped('\"')\n            };\n        }\n        function readSheetName() {\n            input.next();\n            return symbol(input.readEscaped('\\''), true);\n        }\n        function readOperator() {\n            return {\n                type: 'op',\n                value: readWhile(function (ch, op) {\n                    return op + ch in OPERATORS;\n                })\n            };\n        }\n        function readPunc() {\n            return {\n                type: 'punc',\n                value: input.next()\n            };\n        }\n        function readNext() {\n            if (input.eof()) {\n                return null;\n            }\n            var ch = input.peek(), m;\n            if (ch == '\"') {\n                return readString();\n            }\n            if (ch == '\\'') {\n                return readSheetName();\n            }\n            if (isDigit(ch) || ch == SEPARATORS.DEC) {\n                return readNumber();\n            }\n            if (isIdStart(ch)) {\n                return readSymbol();\n            }\n            if (isOpChar(ch)) {\n                return readOperator();\n            }\n            if (isPunc(ch)) {\n                return readPunc();\n            }\n            if (m = input.lookingAt(/^#([a-z\\/]+)[?!]?/i)) {\n                input.skip(m);\n                return {\n                    type: 'error',\n                    value: m[1]\n                };\n            }\n            if (!options.forEditor) {\n                input.croak('Can\\'t handle character with code: ' + ch.charCodeAt(0));\n            }\n            return {\n                type: 'error',\n                value: input.next()\n            };\n        }\n        function peek() {\n            while (tokens.length <= index) {\n                readWhile(isWhitespace);\n                var begin = input.pos();\n                var tok = readNext();\n                if (options.forEditor && tok) {\n                    tok.begin = begin;\n                    tok.end = input.pos();\n                }\n                tokens.push(tok);\n            }\n            return tokens[index];\n        }\n        function next() {\n            var tok = peek();\n            if (tok) {\n                index++;\n            }\n            return tok;\n        }\n        function ahead(n, f) {\n            var pos = index, a = [];\n            while (n-- > 0) {\n                a.push(next() || EOF);\n            }\n            index = pos;\n            return f.apply(a, a);\n        }\n        function skip(n) {\n            index += n;\n        }\n        function eof() {\n            return peek() == null;\n        }\n    }\n    function InputStream(input) {\n        var pos = 0, line = 1, col = 0;\n        return {\n            next: next,\n            peek: peek,\n            eof: eof,\n            croak: croak,\n            readWhile: readWhile,\n            readEscaped: readEscaped,\n            lookingAt: lookingAt,\n            skip: skip,\n            forward: forward,\n            pos: location\n        };\n        function location() {\n            return pos;\n        }\n        function next() {\n            var ch = input.charAt(pos++);\n            if (ch == '\\n') {\n                line++;\n                col = 0;\n            } else {\n                col++;\n            }\n            return ch;\n        }\n        function peek() {\n            return input.charAt(pos);\n        }\n        function eof() {\n            return peek() === '';\n        }\n        function croak(msg) {\n            throw new ParseError(msg + ' (input: ' + input + ')', pos);\n        }\n        function skip(ch) {\n            if (typeof ch == 'string') {\n                if (input.substr(pos, ch.length) != ch) {\n                    croak('Expected ' + ch);\n                }\n                forward(ch.length);\n            } else if (ch instanceof RegExp) {\n                var m = ch.exec(input.substr(pos));\n                if (m) {\n                    forward(m[0].length);\n                    return m;\n                }\n            } else {\n                forward(ch[0].length);\n            }\n        }\n        function forward(n) {\n            while (n-- > 0) {\n                next();\n            }\n        }\n        function readEscaped(end) {\n            var escaped = false, str = '';\n            while (!eof()) {\n                var ch = next();\n                if (escaped) {\n                    str += ch;\n                    escaped = false;\n                } else if (ch == '\\\\') {\n                    escaped = true;\n                } else if (ch == end) {\n                    break;\n                } else {\n                    str += ch;\n                }\n            }\n            return str;\n        }\n        function readWhile(predicate) {\n            var str = '';\n            while (!eof() && predicate(peek(), str)) {\n                str += next();\n            }\n            return str;\n        }\n        function lookingAt(rx) {\n            return rx.exec(input.substr(pos));\n        }\n    }\n    var FORMAT_PARSERS = [];\n    var registerFormatParser = exports.registerFormatParser = function (p) {\n        FORMAT_PARSERS.push(p);\n    };\n    exports.parse = function (sheet, row, col, input, format) {\n        if (input instanceof Date) {\n            return {\n                type: 'date',\n                value: runtime.dateToSerial(input)\n            };\n        }\n        if (typeof input == 'number') {\n            return {\n                type: 'number',\n                value: input\n            };\n        }\n        if (typeof input == 'boolean') {\n            return {\n                type: 'boolean',\n                value: input\n            };\n        }\n        input += '';\n        if (/^'/.test(input)) {\n            return {\n                type: 'string',\n                value: input.substr(1)\n            };\n        }\n        if (/^-?[0-9]+%$/.test(input)) {\n            var str = input.substr(0, input.length - 1);\n            var num = parseFloat(str);\n            if (!isNaN(num) && num == str) {\n                return {\n                    type: 'percent',\n                    value: num / 100\n                };\n            }\n        }\n        if (/^=/.test(input)) {\n            input = input.substr(1);\n            if (/\\S/.test(input)) {\n                return parseFormula(sheet, row, col, input);\n            } else {\n                return {\n                    type: 'string',\n                    value: '=' + input\n                };\n            }\n        }\n        for (var i = 0; i < FORMAT_PARSERS.length; ++i) {\n            var result = FORMAT_PARSERS[i](input);\n            if (result) {\n                return result;\n            }\n        }\n        if (input.toLowerCase() == 'true') {\n            return {\n                type: 'boolean',\n                value: true\n            };\n        }\n        if (input.toLowerCase() == 'false') {\n            return {\n                type: 'boolean',\n                value: false\n            };\n        }\n        var date = runtime.parseDate(input, format);\n        if (date) {\n            return {\n                type: 'date',\n                value: runtime.dateToSerial(date)\n            };\n        }\n        var num = parseFloat(input);\n        if (!isNaN(num) && input.length > 0 && num == input) {\n            format = null;\n            if (num != Math.floor(num)) {\n                format = '0.' + String(num).split('.')[1].replace(/\\d/g, '0');\n            }\n            return {\n                type: 'number',\n                value: num,\n                format: format\n            };\n        }\n        return {\n            type: 'string',\n            value: input\n        };\n    };\n    function tokenize(input, row, col) {\n        var tokens = [];\n        input = TokenStream(input, {\n            forEditor: true,\n            row: row,\n            col: col\n        });\n        while (!input.eof()) {\n            tokens.push(next());\n        }\n        var tok = tokens[0];\n        if (tok.type == 'op' && tok.value == '=') {\n            tok.type = 'startexp';\n        }\n        return tokens;\n        function next() {\n            var tok = input.next();\n            if (tok.type == 'sym') {\n                if (tok.upper == 'TRUE') {\n                    tok.type = 'bool';\n                    tok.value = true;\n                } else if (tok.upper == 'FALSE') {\n                    tok.type = 'bool';\n                    tok.value = false;\n                }\n            } else if (tok.type == 'ref') {\n                tok = {\n                    type: 'ref',\n                    ref: row != null && col != null ? tok.absolute(row, col) : tok,\n                    begin: tok.begin,\n                    end: tok.end\n                };\n            }\n            return tok;\n        }\n    }\n    function parseSqref(input, row, col) {\n        row = row || 0;\n        col = col || 0;\n        input = TokenStream(input, {\n            row: row,\n            col: col\n        });\n        var refs = [];\n        while (!input.eof()) {\n            var ref = input.next();\n            if (ref.type != 'ref') {\n                throw new ParseError('Expecting a reference but got: ' + JSON.stringify(ref));\n            }\n            refs.push(ref.absolute(row, col));\n        }\n        return refs;\n    }\n    exports.parseNameDefinition = parseNameDefinition;\n    exports.parseFormula = parseFormula;\n    exports.parseReference = parseReference;\n    exports.compile = makeFormula;\n    exports.parseSqref = parseSqref;\n    exports.InputStream = InputStream;\n    exports.ParseError = ParseError;\n    exports.tokenize = tokenize;\n    registerFormatParser(function (input) {\n        var m, date = 0, format = '';\n        if (m = /^(\\d+)([-\\/.])(\\d+)\\2(\\d{2}(?:\\d{2})?)(\\s*)/.exec(input)) {\n            var mo = parseInt(m[1], 10);\n            var sep = m[2];\n            var da = parseInt(m[3], 10);\n            var yr = parseInt(m[4], 10);\n            if (yr < 30) {\n                yr += 2000;\n            } else if (yr < 100) {\n                yr += 1900;\n            }\n            var monthFirst = true;\n            if (mo > 12) {\n                var tmp = mo;\n                mo = da;\n                da = tmp;\n                monthFirst = false;\n            }\n            if (!runtime.validDate(yr, mo, da)) {\n                return null;\n            }\n            date = runtime.packDate(yr, mo - 1, da);\n            if (date < 0) {\n                date--;\n            }\n            if (monthFirst) {\n                format = [\n                    'mm',\n                    'dd',\n                    'yyyy'\n                ].join(sep);\n            } else {\n                format = [\n                    'dd',\n                    'mm',\n                    'yyyy'\n                ].join(sep);\n            }\n            format += m[5];\n            input = input.substr(m[0].length);\n        }\n        if (m = /^(\\d+):(\\d+)$/.exec(input)) {\n            var hh = parseInt(m[1], 10);\n            var mm = parseInt(m[2], 10);\n            return {\n                type: 'date',\n                format: format + 'hh:mm',\n                value: date + runtime.packTime(hh, mm, 0, 0)\n            };\n        }\n        if (m = /^(\\d+):(\\d+)(\\.\\d+)$/.exec(input)) {\n            var mm = parseInt(m[1], 10);\n            var ss = parseInt(m[2], 10);\n            var ms = parseFloat(m[3]) * 1000;\n            return {\n                type: 'date',\n                format: format + 'mm:ss.00',\n                value: date + runtime.packTime(0, mm, ss, ms)\n            };\n        }\n        if (m = /^(\\d+):(\\d+):(\\d+)$/.exec(input)) {\n            var hh = parseInt(m[1], 10);\n            var mm = parseInt(m[2], 10);\n            var ss = parseInt(m[3], 10);\n            return {\n                type: 'date',\n                format: format + 'hh:mm:ss',\n                value: date + runtime.packTime(hh, mm, ss, 0)\n            };\n        }\n        if (m = /^(\\d+):(\\d+):(\\d+)(\\.\\d+)$/.exec(input)) {\n            var hh = parseInt(m[1], 10);\n            var mm = parseInt(m[2], 10);\n            var ss = parseInt(m[3], 10);\n            var ms = parseFloat(m[4]) * 1000;\n            return {\n                type: 'date',\n                format: format + 'hh:mm:ss.00',\n                value: date + runtime.packTime(hh, mm, ss, ms)\n            };\n        }\n    });\n    registerFormatParser(function (input) {\n        var m, n;\n        var culture = kendo.culture();\n        var comma = culture.numberFormat[','];\n        var dot = culture.numberFormat['.'];\n        var currency = culture.numberFormat.currency.symbol;\n        var rxnum = getNumberRegexp(comma, dot);\n        var rxcur = new RegExp('^\\\\s*\\\\' + currency + '\\\\s*');\n        var sign = 1;\n        var format = '';\n        var suffix = '';\n        var has_currency = false;\n        var has_percent = false;\n        input = InputStream(input.replace(/^\\s+|\\s+$/g, ''));\n        if (input.skip(/^-\\s*/)) {\n            sign = -1;\n        }\n        if (m = input.skip(rxcur)) {\n            has_currency = true;\n            format += '\"' + m[0] + '\"';\n        }\n        if (input.skip(/^-\\s*/)) {\n            if (sign < 0) {\n                return null;\n            }\n            sign = -1;\n        }\n        if (!(n = input.skip(rxnum))) {\n            return null;\n        }\n        format += '0';\n        if (m = input.skip(rxcur)) {\n            if (has_currency) {\n                return null;\n            }\n            has_currency = true;\n            suffix = '\"' + m[0] + '\"';\n        }\n        if (!has_currency && (m = input.skip(/^\\s*%\\s*/))) {\n            has_percent = true;\n            suffix = m[0];\n        }\n        if (!input.eof()) {\n            return null;\n        }\n        if (n[2] || has_currency) {\n            format = format.replace('0', '#');\n            format += ',0';\n        }\n        if (n[3]) {\n            format += '.' + repeat('0', n[3].length - 1);\n        }\n        var value = n[0].replace(new RegExp('\\\\' + comma, 'g'), '').replace(new RegExp('\\\\' + dot, 'g'), '.');\n        value = parseFloat(value);\n        if (has_percent) {\n            value /= 100;\n        }\n        format += suffix;\n        if (has_currency) {\n            format += ';-' + format;\n        }\n        return {\n            type: 'number',\n            currency: has_currency,\n            format: format,\n            value: sign * value\n        };\n    });\n    registerFormatParser(function (input) {\n        var m;\n        if (m = /^([0-9]*)\\.([0-9]+)(\\s*%)$/.exec(input)) {\n            return {\n                type: 'number',\n                value: parseFloat(input) / 100,\n                format: '0.' + repeat('0', m[2].length) + m[3]\n            };\n        }\n    });\n    var NUMBER_FORMAT_RX = {};\n    function getNumberRegexp(comma, dot) {\n        var id = comma + dot;\n        var rx = NUMBER_FORMAT_RX[id];\n        if (!rx) {\n            rx = '^(\\\\d+(COM\\\\d{3})*(DOT\\\\d+)?)';\n            rx = rx.replace(/DOT/g, '\\\\' + dot).replace(/COM/g, '\\\\' + comma);\n            rx = new RegExp(rx);\n            NUMBER_FORMAT_RX[id] = rx;\n        }\n        return rx;\n    }\n    function repeat(str, len) {\n        var out = '';\n        while (len-- > 0) {\n            out += str;\n        }\n        return out;\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/excel-reader', [\n        'kendo.core',\n        'kendo.color',\n        'util/parse-xml',\n        'spreadsheet/calc'\n    ], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var $ = kendo.jQuery;\n    var parseXML = kendo.util.parseXML;\n    var parseReference = kendo.spreadsheet.calc.parseReference;\n    var MAP_EXCEL_OPERATOR = {\n        greaterThanOrEqual: 'greaterThanOrEqualTo',\n        lessThanOrEqual: 'lessThanOrEqualTo'\n    };\n    var ERROR_LOG = null;\n    function readExcel(file, workbook, deferred) {\n        var reader = new FileReader();\n        reader.onload = function (e) {\n            var zip = new JSZip(e.target.result);\n            readWorkbook(zip, workbook, deferred);\n        };\n        reader.readAsArrayBuffer(file);\n    }\n    var SEL_CELL = [\n        'sheetData',\n        'row',\n        'c'\n    ];\n    var SEL_COL = [\n        'cols',\n        'col'\n    ];\n    var SEL_DEFINED_NAME = [\n        'definedNames',\n        'definedName'\n    ];\n    var SEL_FORMULA = [\n        'sheetData',\n        'row',\n        'c',\n        'f'\n    ];\n    var SEL_MERGE = [\n        'mergeCells',\n        'mergeCell'\n    ];\n    var SEL_PANE = [\n        'sheetViews',\n        'sheetView',\n        'pane'\n    ];\n    var SEL_ROW = [\n        'sheetData',\n        'row'\n    ];\n    var SEL_SELECTION = [\n        'sheetViews',\n        'sheetView',\n        'selection'\n    ];\n    var SEL_SHEET = [\n        'sheets',\n        'sheet'\n    ];\n    var SEL_STRING = [\n        'sheetData',\n        'row',\n        'c',\n        'is'\n    ];\n    var SEL_TEXT = ['t'];\n    var SEL_SHARED_STRING = ['si'];\n    var SEL_VALUE = [\n        'sheetData',\n        'row',\n        'c',\n        'v'\n    ];\n    var SEL_VIEW = [\n        'bookViews',\n        'workbookView'\n    ];\n    var SEL_SHEET_VIEW = [\n        'sheetViews',\n        'sheetView'\n    ];\n    var SEL_HYPERLINK = [\n        'hyperlinks',\n        'hyperlink'\n    ];\n    var SEL_VALIDATION = [\n        'dataValidations',\n        'dataValidation'\n    ];\n    var SEL_VALIDATION_FORMULA1 = [\n        'dataValidations',\n        'dataValidation',\n        'formula1'\n    ];\n    var SEL_VALIDATION_FORMULA2 = [\n        'dataValidations',\n        'dataValidation',\n        'formula2'\n    ];\n    var SEL_VALIDATION_INSANE = [\n        'x14:dataValidations',\n        'x14:dataValidation'\n    ];\n    var SEL_VALIDATION_SQREF_INSANE = [\n        'x14:dataValidations',\n        'x14:dataValidation',\n        'xm:sqref'\n    ];\n    var SEL_VALIDATION_FORMULA1_INSANE = [\n        'x14:dataValidations',\n        'x14:dataValidation',\n        'x14:formula1',\n        'xm:f'\n    ];\n    var SEL_VALIDATION_FORMULA2_INSANE = [\n        'x14:dataValidations',\n        'x14:dataValidation',\n        'x14:formula2',\n        'xm:f'\n    ];\n    var SEL_COMMENT = [\n        'commentList',\n        'comment'\n    ];\n    var SEL_AUTHOR = [\n        'authors',\n        'author'\n    ];\n    var SEL_COMMENT_TEXT = ['t'];\n    function xl(file) {\n        if (!/^\\//.test(file)) {\n            if (!/^xl\\//.test(file)) {\n                file = 'xl/' + file;\n            }\n        } else {\n            file = file.substr(1);\n        }\n        return file;\n    }\n    function readWorkbook(zip, workbook, progress) {\n        ERROR_LOG = workbook.excelImportErrors = [];\n        var strings = readStrings(zip);\n        var relationships = readRelationships(zip, '_rels/workbook.xml');\n        var theme = readTheme(zip, relationships.byType.theme[0]);\n        var styles = readStyles(zip, theme);\n        var items = [];\n        var activeSheet = 0;\n        parse(zip, 'xl/workbook.xml', {\n            enter: function (tag, attrs) {\n                if (this.is(SEL_SHEET)) {\n                    var relId = attrs['r:id'];\n                    var file = relationships.byId[relId];\n                    var name = attrs.name;\n                    var dim = sheetDimensions(zip, file);\n                    workbook.options.columnWidth = dim.columnWidth || workbook.options.columnWidth;\n                    workbook.options.rowHeight = dim.rowHeight || workbook.options.rowHeight;\n                    items.push({\n                        workbook: workbook,\n                        zip: zip,\n                        strings: strings,\n                        styles: styles,\n                        file: file,\n                        options: {\n                            name: name,\n                            rows: Math.max(workbook.options.rows || 0, dim.rows),\n                            columns: Math.max(workbook.options.columns || 0, dim.cols),\n                            columnWidth: dim.columnWidth,\n                            rowHeight: dim.rowHeight\n                        }\n                    });\n                } else if (this.is(SEL_VIEW)) {\n                    if (attrs.activeTab) {\n                        activeSheet = integer(attrs.activeTab);\n                    }\n                }\n            },\n            text: function (text) {\n                var attrs = this.is(SEL_DEFINED_NAME);\n                if (attrs && !(bool(attrs['function']) || bool(attrs.vbProcedure))) {\n                    var localSheetId = attrs.localSheetId;\n                    var sheet = null;\n                    if (localSheetId != null) {\n                        sheet = items[localSheetId].options.name;\n                    }\n                    var name = attrs.name;\n                    if (name != '_xlnm._FilterDatabase') {\n                        if (sheet) {\n                            name = '\\'' + sheet.replace(/\\'/g, '\\\\\\'') + '\\'!' + name;\n                        }\n                        withErrorLog(sheet, null, function () {\n                            workbook.defineName(name, text, bool(attrs.hidden));\n                        }, 'reading user-defined name: ' + name);\n                    }\n                }\n            }\n        });\n        var loading = new $.Deferred();\n        loading.progress(function (args) {\n            if (progress) {\n                progress.notify(args);\n            }\n        }).then(function () {\n            var sheets = workbook.sheets();\n            recalcSheets(sheets);\n            workbook.activeSheet(sheets[activeSheet]);\n            if (progress) {\n                progress.resolve();\n            }\n        });\n        loadSheets(items, workbook, loading);\n    }\n    function loadSheets(items, workbook, progress) {\n        var ready = new $.Deferred().resolve();\n        for (var i = 0; i < items.length; i++) {\n            (function (entry, i) {\n                ready = ready.then(function () {\n                    var sheet = workbook.insertSheet(entry.options);\n                    sheet.suspendChanges(true);\n                    var promise = queueSheet(sheet, entry);\n                    var args = {\n                        sheet: sheet,\n                        progress: i / (items.length - 1)\n                    };\n                    promise.then(function () {\n                        progress.notify(args);\n                    });\n                    return promise;\n                });\n            }(items[i], i));\n        }\n        ready.then(function () {\n            progress.resolve();\n        });\n    }\n    function queueSheet(sheet, ctx) {\n        var deferred = new $.Deferred();\n        setTimeout(function () {\n            readSheet(ctx.zip, ctx.file, sheet, ctx.strings, ctx.styles);\n            deferred.resolve();\n        }, 0);\n        return deferred;\n    }\n    function recalcSheets(sheets) {\n        for (var i = 0; i < sheets.length; i++) {\n            sheets[i].suspendChanges(false).triggerChange({ recalc: true });\n        }\n    }\n    function sheetDimensions(zip, file) {\n        var dim = {\n            rows: 0,\n            cols: 0\n        };\n        parse(zip, xl(file), {\n            enter: function (tag, attrs) {\n                if (tag == 'dimension') {\n                    var ref = parseReference(attrs.ref);\n                    if (ref.bottomRight) {\n                        dim.cols = ref.bottomRight.col + 1;\n                        dim.rows = ref.bottomRight.row + 1;\n                    }\n                } else if (tag === 'sheetFormatPr') {\n                    if (attrs.defaultColWidth) {\n                        dim.columnWidth = toColWidth(parseFloat(attrs.defaultColWidth));\n                    }\n                    if (attrs.defaultRowHeight) {\n                        dim.rowHeight = toRowHeight(parseFloat(attrs.defaultRowHeight));\n                    }\n                } else if (this.is(SEL_ROW)) {\n                    this.exit();\n                }\n            }\n        });\n        return dim;\n    }\n    function toColWidth(size) {\n        var maximumDigitWidth = 7;\n        var fraction = (256 * size + Math.floor(128 / maximumDigitWidth)) / 256;\n        return fraction * maximumDigitWidth;\n    }\n    function toRowHeight(pts) {\n        return pts * (4 / 3);\n    }\n    function readSheet(zip, file, sheet, strings, styles) {\n        var sharedFormulas = {};\n        var ref, type, value, formula, formulaRange, isArrayFormula;\n        var nCols = sheet._columns._count;\n        var prevCellRef = null;\n        var relsFile = file.replace(/worksheets\\//, 'worksheets/_rels/');\n        var relationships = readRelationships(zip, relsFile);\n        var formula1, formula2;\n        var filterRef;\n        var filterColumn;\n        var customFilterLogic;\n        var customFilterCriteria;\n        var valueFilterBlanks;\n        var valueFilterValues;\n        var filters = [];\n        ERROR_LOG = sheet._workbook.excelImportErrors;\n        file = xl(file);\n        parse(zip, file, {\n            enter: function (tag, attrs, closed) {\n                var tmp;\n                if (this.is(SEL_FORMULA)) {\n                    if (closed) {\n                        if (attrs.t == 'shared' && attrs.si != null) {\n                            formula = sheet.range(sharedFormulas[attrs.si])._get('formula');\n                        }\n                    }\n                } else if (this.is(SEL_CELL)) {\n                    value = null;\n                    formula = null;\n                    ref = attrs.r;\n                    formulaRange = null;\n                    if (ref == null) {\n                        ref = parseReference(prevCellRef);\n                        ref.col++;\n                        ref = ref.toString();\n                    }\n                    prevCellRef = ref;\n                    type = attrs.t;\n                    var styleIndex = attrs.s;\n                    if (styleIndex != null) {\n                        applyStyle(sheet, ref, styles, styleIndex);\n                    }\n                } else if (this.is(SEL_MERGE)) {\n                    sheet.range(attrs.ref).merge();\n                } else if (this.is(SEL_COL)) {\n                    var start = integer(attrs.min) - 1;\n                    var stop = Math.min(nCols, integer(attrs.max)) - 1;\n                    var width;\n                    if (attrs.width) {\n                        width = toColWidth(parseFloat(attrs.width));\n                        if (width !== 0) {\n                            sheet._columns.values.value(start, stop, width);\n                        }\n                    }\n                    if (attrs.hidden === '1' || width === 0) {\n                        for (var ci = start; ci <= stop; ci++) {\n                            sheet.hideColumn(ci);\n                        }\n                    }\n                    if (attrs.style != null) {\n                        applyStyle(sheet, new kendo.spreadsheet.RangeRef(new kendo.spreadsheet.CellRef(-Infinity, start), new kendo.spreadsheet.CellRef(+Infinity, stop)), styles, attrs.style);\n                    }\n                } else if (this.is(SEL_ROW)) {\n                    var row = integer(attrs.r) - 1;\n                    var height;\n                    if (attrs.ht) {\n                        height = toRowHeight(parseFloat(attrs.ht));\n                        if (height !== 0) {\n                            sheet._rows.values.value(row, row, height);\n                        }\n                    }\n                    if (attrs.hidden === '1' || height === 0) {\n                        sheet.hideRow(row);\n                    }\n                } else if (this.is(SEL_SELECTION)) {\n                    if (attrs.activeCell) {\n                        var acRef = parseReference(attrs.activeCell);\n                        sheet.select(acRef, true);\n                    }\n                } else if (this.is(SEL_PANE)) {\n                    if (attrs.state == 'frozen') {\n                        if (attrs.xSplit) {\n                            sheet.frozenColumns(integer(attrs.xSplit));\n                        }\n                        if (attrs.ySplit) {\n                            sheet.frozenRows(integer(attrs.ySplit));\n                        }\n                    }\n                } else if (this.is(SEL_SHEET_VIEW)) {\n                    sheet.showGridLines(bool(attrs.showGridLines, true));\n                } else if (this.is(SEL_HYPERLINK)) {\n                    var relId = attrs['r:id'];\n                    var target = relationships.byId[relId];\n                    if (target) {\n                        sheet.range(attrs.ref).link(target);\n                    }\n                } else if (this.is(['autoFilter'])) {\n                    filterRef = attrs.ref;\n                    if (closed) {\n                        addAutoFilter();\n                    }\n                } else if (filterRef) {\n                    if (this.is(['filterColumn'])) {\n                        filterColumn = parseInt(attrs.colId, 10);\n                    } else if (this.is(['customFilters'])) {\n                        customFilterLogic = bool(attrs.and) ? 'and' : 'or';\n                        customFilterCriteria = [];\n                    } else if (this.is(['customFilter'])) {\n                        tmp = getCustomFilter(attrs.operator, attrs.val);\n                        if (tmp) {\n                            customFilterCriteria.push({\n                                operator: tmp.operator,\n                                value: tmp.value\n                            });\n                        }\n                    } else if (this.is(['dynamicFilter'])) {\n                        filters.push({\n                            column: filterColumn,\n                            filter: new kendo.spreadsheet.DynamicFilter({ type: dynamicFilterType(attrs.type) })\n                        });\n                    } else if (this.is(['top10'])) {\n                        filters.push({\n                            column: filterColumn,\n                            filter: new kendo.spreadsheet.TopFilter({\n                                value: getFilterVal(attrs.val),\n                                type: function (percent, top) {\n                                    return percent && top ? 'topPercent' : top ? 'topNumber' : percent ? 'bottomPercent' : 'bottomNumber';\n                                }(bool(attrs.percent), bool(attrs.top))\n                            })\n                        });\n                    } else if (this.is(['filters'])) {\n                        valueFilterBlanks = bool(attrs.blank);\n                        valueFilterValues = [];\n                    } else if (this.is(['filter'])) {\n                        valueFilterValues.push(getFilterVal(attrs.val));\n                    }\n                }\n            },\n            leave: function (tag, attrs) {\n                if (this.is(SEL_FORMULA)) {\n                    if (!formula && attrs.t == 'shared' && attrs.si != null) {\n                        formula = sheet.range(sharedFormulas[attrs.si])._get('formula');\n                    }\n                } else if (this.is(SEL_CELL)) {\n                    if (formula != null) {\n                        var failed = withErrorLog(sheet, formulaRange || ref, function () {\n                            sheet.range(formulaRange || ref).formula(formula, isArrayFormula);\n                        }, 'parsing formula');\n                        if (failed) {\n                            sheet.range(formulaRange || ref).value(formula).background('#ffaaaa');\n                        }\n                    } else if (value != null) {\n                        var range = sheet.range(ref);\n                        if (!range._get('formula')) {\n                            if (!type || type == 'n') {\n                                value = parseFloat(value);\n                            } else if (type == 's') {\n                                value = strings[integer(value)];\n                            } else if (type == 'b') {\n                                value = value === '1';\n                            } else if (type == 'd') {\n                                value = kendo.parseDate(value);\n                            }\n                            if (value != null) {\n                                range.value(value);\n                            }\n                        }\n                    }\n                } else if (this.is(SEL_VALIDATION) || this.is(SEL_VALIDATION_INSANE)) {\n                    (function () {\n                        var refs = kendo.spreadsheet.calc.parseSqref(attrs.sqref);\n                        var type = attrs.type.toLowerCase();\n                        var operator = attrs.operator;\n                        if (/^(?:whole|decimal)$/.test(type)) {\n                            type = 'number';\n                        } else if (type == 'list') {\n                            operator = 'list';\n                        }\n                        if (!operator && /^(?:number|date)$/.test(type)) {\n                            operator = 'between';\n                        }\n                        refs.forEach(function (ref) {\n                            withErrorLog(sheet, ref, function () {\n                                sheet.range(ref).validation({\n                                    type: bool(attrs.showErrorMessage, true) ? 'reject' : 'warning',\n                                    from: formula1,\n                                    to: formula2,\n                                    dataType: type,\n                                    comparerType: MAP_EXCEL_OPERATOR[operator] || operator,\n                                    allowNulls: bool(attrs.allowBlank),\n                                    showButton: bool(attrs.showDropDown) || type == 'date' || type == 'list',\n                                    messageTemplate: attrs.error,\n                                    titleTemplate: attrs.errorTitle\n                                });\n                            }, 'parsing validation');\n                        });\n                    }());\n                } else if (tag == 'cols') {\n                    sheet._columns._refresh();\n                } else if (tag == 'sheetData') {\n                    sheet._rows._refresh();\n                } else if (tag == 'autoFilter') {\n                    addAutoFilter();\n                } else if (filterRef) {\n                    if (tag == 'customFilters') {\n                        filters.push({\n                            column: filterColumn,\n                            filter: new kendo.spreadsheet.CustomFilter({\n                                logic: customFilterLogic,\n                                criteria: customFilterCriteria\n                            })\n                        });\n                    } else if (tag == 'filters') {\n                        filters.push({\n                            column: filterColumn,\n                            filter: new kendo.spreadsheet.ValueFilter({\n                                values: valueFilterValues,\n                                blanks: valueFilterBlanks\n                            })\n                        });\n                    }\n                }\n            },\n            text: function (text) {\n                var attrs;\n                if (this.is(SEL_VALUE) || this.is(SEL_STRING)) {\n                    value = text;\n                } else if (attrs = this.is(SEL_FORMULA)) {\n                    formula = text;\n                    isArrayFormula = attrs.t == 'array';\n                    if (isArrayFormula) {\n                        formulaRange = attrs.ref;\n                    } else if (attrs.t == 'shared') {\n                        sharedFormulas[attrs.si] = ref;\n                    }\n                } else if (this.is(SEL_VALIDATION_FORMULA1) || this.is(SEL_VALIDATION_FORMULA1_INSANE)) {\n                    formula1 = text;\n                } else if (this.is(SEL_VALIDATION_FORMULA2) || this.is(SEL_VALIDATION_FORMULA2_INSANE)) {\n                    formula2 = text;\n                } else if (this.is(SEL_VALIDATION_SQREF_INSANE)) {\n                    this.stack[this.stack.length - 2].sqref = text;\n                }\n            }\n        });\n        if (relationships.byType.comments) {\n            var commentFile = relative_file(file, relationships.byType.comments[0]);\n            readComments(zip, commentFile, sheet);\n        }\n        if (relationships.byType.drawing) {\n            var drawingFile = relative_file(file, relationships.byType.drawing[0]);\n            readDrawings(zip, drawingFile, sheet);\n        }\n        function addAutoFilter() {\n            sheet.range(filterRef).filter(filters);\n            filterRef = null;\n        }\n    }\n    function getContentType(filename) {\n        var m = /\\.([^.]+)$/.exec(filename);\n        if (m && m[1]) {\n            return {\n                jpg: 'image/jpeg',\n                jpeg: 'image/jpeg',\n                png: 'image/png',\n                gif: 'image/gif'\n            }[m[1].toLowerCase()];\n        }\n    }\n    function getFileName(filename) {\n        var m = /[^\\/]+$/.exec(filename);\n        return m && m[0];\n    }\n    function readDrawings(zip, file, sheet) {\n        var sel_two_cell_anchor = ['xdr:twoCellAnchor'];\n        var sel_ext = ['xdr:ext'];\n        var sel_one_cell_anchor = ['xdr:oneCellAnchor'];\n        var sel_from = ['xdr:from'];\n        var sel_to = ['xdr:to'];\n        var sel_row = ['xdr:row'];\n        var sel_col = ['xdr:col'];\n        var sel_row_offset = ['xdr:rowOff'];\n        var sel_col_offset = ['xdr:colOff'];\n        var sel_blip = [\n            'xdr:blipFill',\n            'a:blip'\n        ];\n        var relsFile = file.replace(/drawings\\//, 'drawings/_rels/');\n        var relationships = readRelationships(zip, relsFile);\n        if (relationships.byType.image) {\n            Object.keys(relationships.byId).forEach(function (id) {\n                var img = relative_file(file, relationships.byId[id]);\n                var type = getContentType(img);\n                if (type) {\n                    var data = zip.files[img].asArrayBuffer();\n                    var name = getFileName(img);\n                    var blob = name && !(kendo.support.browser.msie || kendo.support.browser.edge) ? new window.File([data], name, { type: type }) : new window.Blob([data], { type: type });\n                    relationships.byId[id] = sheet._workbook.addImage(blob);\n                }\n            });\n        }\n        var cdr, ref, width, height;\n        parse(zip, file, {\n            enter: function (tag, attrs) {\n                if (this.is(sel_two_cell_anchor) || this.is(sel_one_cell_anchor)) {\n                    cdr = {};\n                } else if (this.is(sel_from) || this.is(sel_to)) {\n                    ref = {};\n                } else if (this.is(sel_blip)) {\n                    var id = attrs['r:embed'];\n                    cdr.image = relationships.byId[id];\n                } else if (this.is(sel_ext)) {\n                    width = excelToPixels(parseFloat(attrs.cx));\n                    height = excelToPixels(parseFloat(attrs.cy));\n                }\n            },\n            leave: function () {\n                if (this.is(sel_from)) {\n                    cdr.topLeftCell = new kendo.spreadsheet.CellRef(ref.row, ref.col);\n                    cdr.offsetX = excelToPixels(ref.colOffset);\n                    cdr.offsetY = excelToPixels(ref.rowOffset);\n                } else if (this.is(sel_to)) {\n                    cdr.brCell = new kendo.spreadsheet.CellRef(ref.row, ref.col);\n                    cdr.brX = excelToPixels(ref.colOffset);\n                    cdr.brY = excelToPixels(ref.rowOffset);\n                } else if (this.is(sel_two_cell_anchor)) {\n                    var left = sheet._columns.sum(0, cdr.topLeftCell.col - 1) + cdr.offsetX;\n                    var top = sheet._rows.sum(0, cdr.topLeftCell.row - 1) + cdr.offsetY;\n                    var right = sheet._columns.sum(0, cdr.brCell.col - 1) + cdr.brX;\n                    var bottom = sheet._rows.sum(0, cdr.brCell.row - 1) + cdr.brY;\n                    sheet.addDrawing({\n                        topLeftCell: cdr.topLeftCell,\n                        offsetX: cdr.offsetX,\n                        offsetY: cdr.offsetY,\n                        width: width != null ? width : right - left,\n                        height: height != null ? height : bottom - top,\n                        image: cdr.image,\n                        opacity: 1\n                    });\n                } else if (this.is(sel_one_cell_anchor)) {\n                    sheet.addDrawing({\n                        topLeftCell: cdr.topLeftCell,\n                        offsetX: cdr.offsetX,\n                        offsetY: cdr.offsetY,\n                        width: width,\n                        height: height,\n                        image: cdr.image,\n                        opacity: 1\n                    });\n                }\n            },\n            text: function (text) {\n                if (this.is(sel_row)) {\n                    ref.row = parseFloat(text);\n                } else if (this.is(sel_col)) {\n                    ref.col = parseFloat(text);\n                } else if (this.is(sel_row_offset)) {\n                    ref.rowOffset = parseFloat(text);\n                } else if (this.is(sel_col_offset)) {\n                    ref.colOffset = parseFloat(text);\n                }\n            }\n        });\n    }\n    function readComments(zip, file, sheet) {\n        var authors = [];\n        var author;\n        var comment;\n        parse(zip, file, {\n            enter: function (tag, attrs) {\n                if (this.is(SEL_COMMENT)) {\n                    comment = {\n                        author: authors[attrs.authorId],\n                        ref: attrs.ref,\n                        text: ''\n                    };\n                } else if (this.is(SEL_AUTHOR)) {\n                    author = '';\n                }\n            },\n            leave: function () {\n                if (this.is(SEL_COMMENT)) {\n                    sheet.range(comment.ref).comment(comment.text);\n                } else if (this.is(SEL_AUTHOR)) {\n                    authors.push(author);\n                }\n            },\n            text: function (text) {\n                if (this.is(SEL_COMMENT_TEXT)) {\n                    comment.text += text;\n                } else if (this.is(SEL_AUTHOR)) {\n                    author += text;\n                }\n            }\n        });\n    }\n    function getCustomFilter(op, value) {\n        var ourOp = {\n            equal: 'eq',\n            notEqual: 'ne',\n            greaterThan: 'gt',\n            greaterThanOrEqual: 'gte',\n            lessThan: 'lt',\n            lessThanOrEqual: 'lte'\n        }[op];\n        value = getFilterVal(value);\n        if (ourOp && typeof value == 'number') {\n            return {\n                operator: ourOp,\n                value: value\n            };\n        }\n        if ((op == 'notEqual' || !op) && typeof value == 'string') {\n            return {\n                operator: op ? 'doesnotmatch' : 'matches',\n                value: value\n            };\n        }\n    }\n    function dynamicFilterType(type) {\n        return {\n            Q1: 'quarter1',\n            Q2: 'quarter2',\n            Q3: 'quarter3',\n            Q4: 'quarter4',\n            M1: 'january',\n            M2: 'february',\n            M3: 'march',\n            M4: 'april',\n            M5: 'may',\n            M6: 'june',\n            M7: 'july',\n            M8: 'august',\n            M9: 'september',\n            M10: 'october',\n            M11: 'november',\n            M12: 'december'\n        }[type.toUpperCase()] || type;\n    }\n    function getFilterVal(val) {\n        var tmp = parseFloat(val);\n        if (!isNaN(tmp) && tmp == val) {\n            return tmp;\n        }\n        return val;\n    }\n    function withErrorLog(sheet, ref, func, context) {\n        try {\n            func();\n            return false;\n        } catch (ex) {\n            var err = {\n                context: context,\n                error: String(ex)\n            };\n            if (sheet) {\n                err.sheet = sheet.name();\n            }\n            if (ref) {\n                err.location = String(ref);\n            }\n            ERROR_LOG.push(err);\n            return true;\n        }\n    }\n    var BORDER_WIDTHS = {\n        'none': 0,\n        'thin': 1,\n        'medium': 2,\n        'dashed': 1,\n        'dotted': 1,\n        'thick': 3,\n        'double': 3,\n        'hair': 1,\n        'mediumDashed': 2,\n        'dashDot': 1,\n        'mediumDashDot': 2,\n        'dashDotDot': 1,\n        'mediumDashDotDot': 2,\n        'slantDashDot': 1\n    };\n    var DEFAULT_FORMATS = {\n        0: 'General',\n        1: '0',\n        2: '0.00',\n        3: '#,##0',\n        4: '#,##0.00',\n        9: '0%',\n        10: '0.00%',\n        11: '0.00E+00',\n        12: '# ?/?',\n        13: '# ??/??',\n        14: 'mm-dd-yy',\n        15: 'd-mmm-yy',\n        16: 'd-mmm',\n        17: 'mmm-yy',\n        18: 'h:mm AM/PM',\n        19: 'h:mm:ss AM/PM',\n        20: 'h:mm',\n        21: 'h:mm:ss',\n        22: 'm/d/yy h:mm',\n        37: '#,##0 ;(#,##0)',\n        38: '#,##0 ;[Red](#,##0)',\n        39: '#,##0.00;(#,##0.00)',\n        40: '#,##0.00;[Red](#,##0.00)',\n        45: 'mm:ss',\n        46: '[h]:mm:ss',\n        47: 'mmss.0',\n        48: '##0.0E+0',\n        49: '@'\n    };\n    function applyStyle(sheet, ref, styles, styleIndex) {\n        var range = sheet.range(ref);\n        var xf = styles.inlineStyles[styleIndex], base, value;\n        if (xf.xfId) {\n            base = styles.namedStyles[xf.xfId];\n        }\n        if (shouldSet('applyBorder', 'borderId')) {\n            setBorder(styles.borders[value]);\n        }\n        if (shouldSet('applyFont', 'fontId')) {\n            setFont(styles.fonts[value]);\n        }\n        if (shouldSet('applyAlignment', 'textAlign')) {\n            range.textAlign(value);\n        }\n        if (shouldSet('applyAlignment', 'verticalAlign')) {\n            range.verticalAlign(value);\n        }\n        if (shouldSet('applyAlignment', 'indent')) {\n            range.indent(value);\n        }\n        if (shouldSet('applyAlignment', 'wrapText')) {\n            range._property('wrap', value);\n        }\n        if (shouldSet('applyFill', 'fillId')) {\n            setFill(styles.fills[value]);\n        }\n        if (shouldSet('applyNumberFormat', 'numFmtId')) {\n            setFormat(styles.numFmts[value] || DEFAULT_FORMATS[value]);\n        }\n        function setFormat(f) {\n            var format = typeof f == 'string' ? f : f.formatCode;\n            if (format != null && !/^general$/i.test(format)) {\n                format = format.replace(/^\\[\\$-[0-9]+\\]/, '');\n                range.format(format);\n            }\n        }\n        function setFill(f) {\n            if (f.type == 'solid') {\n                range.background(f.color);\n            }\n        }\n        function setFont(f) {\n            range.fontFamily(f.name);\n            if (f.size) {\n                range._property('fontSize', f.size * 4 / 3);\n            }\n            if (f.bold) {\n                range.bold(true);\n            }\n            if (f.italic) {\n                range.italic(true);\n            }\n            if (f.underline) {\n                range.underline(true);\n            }\n            if (f.color) {\n                range.color(f.color);\n            }\n        }\n        function setBorder(b) {\n            function set(side, prop) {\n                var border = b[side];\n                if (!border) {\n                    return;\n                }\n                var width = BORDER_WIDTHS[border.style];\n                if (width === 0) {\n                    return;\n                }\n                var color = border.color;\n                if (color == null) {\n                    color = '#000';\n                }\n                range._property(prop, {\n                    size: width,\n                    color: color\n                });\n            }\n            set('left', 'borderLeft');\n            set('top', 'borderTop');\n            set('right', 'borderRight');\n            set('bottom', 'borderBottom');\n        }\n        function shouldSet(applyName, propName) {\n            var t = xf[applyName];\n            if (t != null && !t) {\n                return false;\n            }\n            value = xf[propName];\n            if (base && value == null) {\n                t = base[applyName];\n                if (t != null && !t) {\n                    return false;\n                }\n                value = base[propName];\n            }\n            return value != null;\n        }\n    }\n    function parse(zip, file, callbacks) {\n        var part = zip.files[file];\n        if (part) {\n            parseXML(part.asUint8Array(), callbacks);\n        }\n    }\n    function readStrings(zip) {\n        var strings = [];\n        var current = null;\n        parse(zip, 'xl/sharedStrings.xml', {\n            leave: function () {\n                if (this.is(SEL_SHARED_STRING)) {\n                    strings.push(current);\n                    current = null;\n                }\n            },\n            text: function (text) {\n                if (this.is(SEL_TEXT)) {\n                    if (current == null) {\n                        current = '';\n                    }\n                    current += text;\n                }\n            }\n        });\n        return strings;\n    }\n    function readRelationships(zip, file) {\n        var map = {\n            byId: {},\n            byType: { theme: [] }\n        };\n        parse(zip, xl(file) + '.rels', {\n            enter: function (tag, attrs) {\n                if (tag == 'Relationship') {\n                    map.byId[attrs.Id] = attrs.Target;\n                    var type = attrs.Type.match(/\\w+$/)[0];\n                    var entries = map.byType[type] || [];\n                    entries.push(attrs.Target);\n                    map.byType[type] = entries;\n                }\n            }\n        });\n        return map;\n    }\n    var SEL_BORDER = [\n        'borders',\n        'border'\n    ];\n    var SEL_FILL = [\n        'fills',\n        'fill'\n    ];\n    var SEL_FONT = [\n        'fonts',\n        'font'\n    ];\n    var SEL_INLINE_STYLE = [\n        'cellXfs',\n        'xf'\n    ];\n    var SEL_NAMED_STYLE = [\n        'cellStyleXfs',\n        'xf'\n    ];\n    var SEL_NUM_FMT = [\n        'numFmts',\n        'numFmt'\n    ];\n    var INDEXED_COLORS = [\n        toCSSColor('FF000000'),\n        toCSSColor('FFFFFFFF'),\n        toCSSColor('FFFF0000'),\n        toCSSColor('FF00FF00'),\n        toCSSColor('FF0000FF'),\n        toCSSColor('FFFFFF00'),\n        toCSSColor('FFFF00FF'),\n        toCSSColor('FF00FFFF'),\n        toCSSColor('FF000000'),\n        toCSSColor('FFFFFFFF'),\n        toCSSColor('FFFF0000'),\n        toCSSColor('FF00FF00'),\n        toCSSColor('FF0000FF'),\n        toCSSColor('FFFFFF00'),\n        toCSSColor('FFFF00FF'),\n        toCSSColor('FF00FFFF'),\n        toCSSColor('FF800000'),\n        toCSSColor('FF008000'),\n        toCSSColor('FF000080'),\n        toCSSColor('FF808000'),\n        toCSSColor('FF800080'),\n        toCSSColor('FF008080'),\n        toCSSColor('FFC0C0C0'),\n        toCSSColor('FF808080'),\n        toCSSColor('FF9999FF'),\n        toCSSColor('FF993366'),\n        toCSSColor('FFFFFFCC'),\n        toCSSColor('FFCCFFFF'),\n        toCSSColor('FF660066'),\n        toCSSColor('FFFF8080'),\n        toCSSColor('FF0066CC'),\n        toCSSColor('FFCCCCFF'),\n        toCSSColor('FF000080'),\n        toCSSColor('FFFF00FF'),\n        toCSSColor('FFFFFF00'),\n        toCSSColor('FF00FFFF'),\n        toCSSColor('FF800080'),\n        toCSSColor('FF800000'),\n        toCSSColor('FF008080'),\n        toCSSColor('FF0000FF'),\n        toCSSColor('FF00CCFF'),\n        toCSSColor('FFCCFFFF'),\n        toCSSColor('FFCCFFCC'),\n        toCSSColor('FFFFFF99'),\n        toCSSColor('FF99CCFF'),\n        toCSSColor('FFFF99CC'),\n        toCSSColor('FFCC99FF'),\n        toCSSColor('FFFFCC99'),\n        toCSSColor('FF3366FF'),\n        toCSSColor('FF33CCCC'),\n        toCSSColor('FF99CC00'),\n        toCSSColor('FFFFCC00'),\n        toCSSColor('FFFF9900'),\n        toCSSColor('FFFF6600'),\n        toCSSColor('FF666699'),\n        toCSSColor('FF969696'),\n        toCSSColor('FF003366'),\n        toCSSColor('FF339966'),\n        toCSSColor('FF003300'),\n        toCSSColor('FF333300'),\n        toCSSColor('FF993300'),\n        toCSSColor('FF993366'),\n        toCSSColor('FF333399'),\n        toCSSColor('FF333333'),\n        toCSSColor('FF000000'),\n        toCSSColor('FFFFFFFF')\n    ];\n    function readStyles(zip, theme) {\n        var styles = {\n            fonts: [],\n            numFmts: {},\n            fills: [],\n            borders: [],\n            namedStyles: [],\n            inlineStyles: []\n        };\n        var font = null;\n        var fill = null;\n        var border = null;\n        var xf = null;\n        parse(zip, 'xl/styles.xml', {\n            enter: function (tag, attrs, closed) {\n                if (this.is(SEL_NUM_FMT)) {\n                    styles.numFmts[attrs.numFmtId] = attrs;\n                } else if (this.is(SEL_FONT)) {\n                    styles.fonts.push(font = {});\n                } else if (font) {\n                    if (tag == 'sz') {\n                        font.size = parseFloat(attrs.val);\n                    } else if (tag == 'name') {\n                        font.name = attrs.val;\n                    } else if (tag == 'b') {\n                        font.bold = bool(attrs.val, true);\n                    } else if (tag == 'i') {\n                        font.italic = bool(attrs.val, true);\n                    } else if (tag == 'u') {\n                        font.underline = attrs.val == null || attrs.val == 'single';\n                    } else if (tag == 'color') {\n                        font.color = getColor(attrs);\n                    }\n                } else if (this.is(SEL_FILL)) {\n                    styles.fills.push(fill = {});\n                } else if (fill) {\n                    if (tag == 'patternFill') {\n                        fill.type = attrs.patternType;\n                    } else if (tag == 'fgColor' && fill.type === 'solid') {\n                        fill.color = getColor(attrs);\n                    } else if (tag == 'bgColor' && fill.type !== 'solid') {\n                        fill.color = getColor(attrs);\n                    }\n                } else if (this.is(SEL_BORDER)) {\n                    styles.borders.push(border = {});\n                } else if (border) {\n                    if (/^(?:left|top|right|bottom)$/.test(tag)) {\n                        border[tag] = { style: attrs.style || 'none' };\n                    }\n                    if (tag == 'color') {\n                        var side = this.stack[this.stack.length - 2].$tag;\n                        border[side].color = getColor(attrs);\n                    }\n                } else if (this.is(SEL_NAMED_STYLE)) {\n                    xf = getXf(attrs);\n                    styles.namedStyles.push(xf);\n                    if (closed) {\n                        xf = null;\n                    }\n                } else if (this.is(SEL_INLINE_STYLE)) {\n                    xf = getXf(attrs);\n                    styles.inlineStyles.push(xf);\n                    if (closed) {\n                        xf = null;\n                    }\n                } else if (xf) {\n                    if (tag == 'alignment') {\n                        if (/^(?:left|center|right|justify)$/.test(attrs.horizontal)) {\n                            xf.textAlign = attrs.horizontal;\n                        }\n                        if (/^(?:top|center|bottom)$/.test(attrs.vertical)) {\n                            xf.verticalAlign = attrs.vertical;\n                        }\n                        if (attrs.wrapText != null) {\n                            xf.wrapText = bool(attrs.wrapText);\n                        }\n                        if (attrs.indent != null) {\n                            xf.indent = integer(attrs.indent);\n                        }\n                    }\n                }\n            },\n            leave: function (tag) {\n                if (this.is(SEL_FONT)) {\n                    font = null;\n                } else if (this.is(SEL_FILL)) {\n                    fill = null;\n                } else if (this.is(SEL_BORDER)) {\n                    border = null;\n                } else if (tag == 'xf') {\n                    xf = null;\n                }\n            }\n        });\n        function getXf(attrs) {\n            var xf = {\n                borderId: integer(attrs.borderId),\n                fillId: integer(attrs.fillId),\n                fontId: integer(attrs.fontId),\n                numFmtId: integer(attrs.numFmtId),\n                pivotButton: bool(attrs.pivotButton),\n                quotePrefix: bool(attrs.quotePrefix),\n                xfId: integer(attrs.xfId)\n            };\n            addBool('applyAlignment');\n            addBool('applyBorder');\n            addBool('applyFill');\n            addBool('applyFont');\n            addBool('applyNumberFormat');\n            addBool('applyProtection');\n            function addBool(name) {\n                if (attrs[name] != null) {\n                    xf[name] = bool(attrs[name]);\n                }\n            }\n            return xf;\n        }\n        function getColor(attrs) {\n            if (attrs.rgb) {\n                return toCSSColor(attrs.rgb);\n            } else if (attrs.indexed) {\n                return INDEXED_COLORS[integer(attrs.indexed)];\n            } else if (attrs.theme) {\n                var themeColor = theme.colorScheme[integer(attrs.theme)];\n                if (!themeColor) {\n                    return INDEXED_COLORS[0];\n                }\n                var color = kendo.parseColor(themeColor);\n                if (attrs.tint) {\n                    color = color.toHSL();\n                    var tint = parseFloat(attrs.tint);\n                    if (tint < 0) {\n                        color.l = color.l * (1 + tint);\n                    } else {\n                        color.l = color.l * (1 - tint) + (100 - 100 * (1 - tint));\n                    }\n                }\n                return color.toCssRgba();\n            }\n        }\n        return styles;\n    }\n    var SEL_SCHEME_RGBCLR = [\n        'a:clrScheme',\n        '*',\n        'a:srgbClr'\n    ];\n    var SEL_SCHEME_SYSCLR = [\n        'a:clrScheme',\n        '*',\n        'a:sysClr'\n    ];\n    function readTheme(zip, rel) {\n        var scheme = [];\n        var theme = { colorScheme: scheme };\n        var file = xl(rel);\n        if (zip.files[file]) {\n            parse(zip, file, {\n                enter: function (tag, attrs) {\n                    if (this.is(SEL_SCHEME_SYSCLR)) {\n                        scheme.push(toCSSColor(attrs.val == 'window' ? 'FFFFFFFF' : 'FF000000'));\n                    } else if (this.is(SEL_SCHEME_RGBCLR)) {\n                        scheme.push(toCSSColor('FF' + attrs.val));\n                    }\n                }\n            });\n            if (scheme.length > 3) {\n                swap(scheme, 0, 1);\n                swap(scheme, 2, 3);\n            }\n        }\n        function swap(arr, a, b) {\n            var tmp = arr[a];\n            arr[a] = arr[b];\n            arr[b] = tmp;\n        }\n        return theme;\n    }\n    function integer(val) {\n        return val == null ? null : parseInt(val, 10);\n    }\n    function bool(val, def) {\n        if (val == null) {\n            return def;\n        }\n        return val == 'true' || val === true || val == 1;\n    }\n    function toCSSColor(rgb) {\n        var m = /^([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(rgb);\n        return 'rgba(' + parseInt(m[2], 16) + ', ' + parseInt(m[3], 16) + ', ' + parseInt(m[4], 16) + ', ' + parseInt(m[1], 16) / 255 + ')';\n    }\n    function relative_file(base, name) {\n        base = base.split(/\\/+/);\n        name = name.split(/\\/+/);\n        base.pop();\n        while (name.length) {\n            var part = name.shift();\n            if (part === '') {\n                base = [];\n            } else if (part === '.') {\n                continue;\n            } else if (part === '..') {\n                base.pop();\n            } else {\n                base.push(part);\n            }\n        }\n        return base.join('/');\n    }\n    function excelToPixels(val) {\n        return val / 9525;\n    }\n    kendo.spreadsheet.readExcel = readExcel;\n    kendo.spreadsheet._readSheet = readSheet;\n    kendo.spreadsheet._readStrings = readStrings;\n    kendo.spreadsheet._readStyles = readStyles;\n    kendo.spreadsheet._readTheme = readTheme;\n    kendo.spreadsheet._readWorkbook = readWorkbook;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/workbook', [\n        'kendo.core',\n        'spreadsheet/runtime',\n        'spreadsheet/references',\n        'spreadsheet/excel-reader'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Formula = kendo.spreadsheet.calc.runtime.Formula;\n        var Ref = kendo.spreadsheet.Ref;\n        var CalcError = kendo.spreadsheet.CalcError;\n        kendo.spreadsheet.messages.workbook = { defaultSheetName: 'Sheet' };\n        function loadBinary(url, callback) {\n            var xhr = new XMLHttpRequest();\n            xhr.onload = function () {\n                callback(xhr.response, xhr.getResponseHeader('Content-Type'));\n            };\n            xhr.onerror = function () {\n                callback(null);\n            };\n            xhr.open('GET', url);\n            xhr.responseType = 'arraybuffer';\n            xhr.send();\n        }\n        var Workbook = kendo.Observable.extend({\n            options: {},\n            init: function (options, view) {\n                kendo.Observable.fn.init.call(this);\n                this.options = options;\n                this._view = view;\n                this._sheets = [];\n                this._images = {};\n                this._imgID = 0;\n                this._sheetsSearchCache = {};\n                this._sheet = this.insertSheet({\n                    rows: this.options.rows,\n                    columns: this.options.columns,\n                    rowHeight: this.options.rowHeight,\n                    columnWidth: this.options.columnWidth,\n                    headerHeight: this.options.headerHeight,\n                    headerWidth: this.options.headerWidth,\n                    dataSource: this.options.dataSource\n                });\n                this.undoRedoStack = new kendo.util.UndoRedoStack();\n                this.undoRedoStack.bind([\n                    'undo',\n                    'redo'\n                ], this._onUndoRedo.bind(this));\n                this._context = new kendo.spreadsheet.FormulaContext(this);\n                this._validationContext = new kendo.spreadsheet.ValidationFormulaContext(this);\n                this._names = Object.create(null);\n                this.fromJSON(this.options);\n            },\n            clipboard: function () {\n                if (!this._clipboard) {\n                    this._clipboard = new kendo.spreadsheet.Clipboard(this);\n                }\n                return this._clipboard;\n            },\n            destroy: function () {\n                this.unbind();\n                if (this._clipboard) {\n                    this._clipboard.destroy();\n                }\n            },\n            events: [\n                'cut',\n                'copy',\n                'paste',\n                'changing',\n                'change',\n                'excelImport',\n                'excelExport',\n                'insertSheet',\n                'removeSheet',\n                'selectSheet',\n                'renameSheet',\n                'insertRow',\n                'insertColumn',\n                'deleteRow',\n                'deleteColumn',\n                'hideRow',\n                'hideColumn',\n                'unhideRow',\n                'unhideColumn',\n                'select',\n                'changeFormat',\n                'dataBinding',\n                'dataBound'\n            ],\n            _sheetChanging: function (e) {\n                if (this.trigger('changing', e)) {\n                    e.preventDefault();\n                }\n            },\n            _sheetChange: function (e) {\n                this.trigger('change', e);\n            },\n            _sheetInsertRow: function (e) {\n                if (this.trigger('insertRow', {\n                        sheet: e.sender,\n                        index: e.index\n                    })) {\n                    e.preventDefault();\n                }\n            },\n            _sheetInsertColumn: function (e) {\n                if (this.trigger('insertColumn', {\n                        sheet: e.sender,\n                        index: e.index\n                    })) {\n                    e.preventDefault();\n                }\n            },\n            _sheetDeleteRow: function (e) {\n                if (this.trigger('deleteRow', {\n                        sheet: e.sender,\n                        index: e.index\n                    })) {\n                    e.preventDefault();\n                }\n            },\n            _sheetDeleteColumn: function (e) {\n                if (this.trigger('deleteColumn', {\n                        sheet: e.sender,\n                        index: e.index\n                    })) {\n                    e.preventDefault();\n                }\n            },\n            _sheetHideRow: function (e) {\n                if (this.trigger('hideRow', {\n                        sheet: e.sender,\n                        index: e.index\n                    })) {\n                    e.preventDefault();\n                }\n            },\n            _sheetHideColumn: function (e) {\n                if (this.trigger('hideColumn', {\n                        sheet: e.sender,\n                        index: e.index\n                    })) {\n                    e.preventDefault();\n                }\n            },\n            _sheetUnhideRow: function (e) {\n                if (this.trigger('unhideRow', {\n                        sheet: e.sender,\n                        index: e.index\n                    })) {\n                    e.preventDefault();\n                }\n            },\n            _sheetUnhideColumn: function (e) {\n                if (this.trigger('unhideColumn', {\n                        sheet: e.sender,\n                        index: e.index\n                    })) {\n                    e.preventDefault();\n                }\n            },\n            _sheetSelect: function (e) {\n                this.trigger('select', e);\n            },\n            _sheetDataBinding: function (e) {\n                if (this.trigger('dataBinding', { sheet: e.sender })) {\n                    e.preventDefault();\n                }\n            },\n            _sheetDataBound: function (e) {\n                this.trigger('dataBound', { sheet: e.sender });\n            },\n            _sheetCommandRequest: function (e) {\n                this.trigger('commandRequest', e);\n            },\n            _inputForRef: function (ref) {\n                var self = this;\n                return self._sheet.withCultureDecimals(function () {\n                    return new kendo.spreadsheet.Range(ref, self._sheet).input();\n                });\n            },\n            _onUndoRedo: function (e) {\n                e.command.range().select();\n            },\n            execute: function (options) {\n                var commandOptions = $.extend({ workbook: this }, options.options);\n                var command = new kendo.spreadsheet[options.command](commandOptions);\n                var sheet = this.activeSheet();\n                if (commandOptions.origin) {\n                    command.origin(commandOptions.origin);\n                }\n                if (commandOptions.operatingRange) {\n                    command.range(commandOptions.operatingRange);\n                } else {\n                    command.range(sheet.selection());\n                }\n                var result = command.exec();\n                if (!result || result.reason !== 'error') {\n                    if (command.cannotUndo) {\n                        this.undoRedoStack.clear();\n                    } else {\n                        this.undoRedoStack.push(command);\n                    }\n                }\n                this.cleanupImages();\n                return result;\n            },\n            resetFormulas: function () {\n                this._sheets.forEach(function (sheet) {\n                    sheet.resetFormulas();\n                });\n            },\n            resetValidations: function () {\n                this._sheets.forEach(function (sheet) {\n                    sheet.resetValidations();\n                });\n            },\n            refresh: function (reason) {\n                if (reason.recalc) {\n                    this.resetFormulas();\n                    this.resetValidations();\n                    this._sheet.recalc(this._context);\n                    this._sheet.revalidate(this._validationContext);\n                }\n            },\n            activeSheet: function (sheet) {\n                if (sheet === undefined) {\n                    return this._sheet;\n                }\n                if (!this.sheetByName(sheet.name())) {\n                    return;\n                }\n                this._sheet = sheet;\n                sheet.triggerChange(kendo.spreadsheet.ALL_REASONS);\n            },\n            moveSheetToIndex: function (sheet, toIndex) {\n                var fromIndex = this.sheetIndex(sheet);\n                var sheets = this._sheets;\n                if (fromIndex === -1) {\n                    return;\n                }\n                this._sheetsSearchCache = {};\n                sheets.splice(toIndex, 0, sheets.splice(fromIndex, 1)[0]);\n                this.trigger('change', { sheetSelection: true });\n            },\n            insertSheet: function (options) {\n                options = options || {};\n                var that = this;\n                var insertIndex = typeof options.index === 'number' ? options.index : that._sheets.length;\n                var sheetName;\n                var sheets = that._sheets;\n                var getUniqueSheetName = function (sheetNameSuffix) {\n                    sheetNameSuffix = sheetNameSuffix ? sheetNameSuffix : 1;\n                    var name = kendo.spreadsheet.messages.workbook.defaultSheetName + sheetNameSuffix;\n                    if (!that.sheetByName(name)) {\n                        return name;\n                    }\n                    return getUniqueSheetName(sheetNameSuffix + 1);\n                };\n                if (options.name && that.sheetByName(options.name)) {\n                    return;\n                }\n                this._sheetsSearchCache = {};\n                sheetName = options.name || getUniqueSheetName();\n                var sheet = new kendo.spreadsheet.Sheet(options.rows || this.options.rows, options.columns || this.options.columns, options.rowHeight || this.options.rowHeight, options.columnWidth || this.options.columnWidth, options.headerHeight || this.options.headerHeight, options.headerWidth || this.options.headerWidth, options.defaultCellStyle || this.options.defaultCellStyle);\n                sheet._workbook = this;\n                sheet._name(sheetName);\n                this._bindSheetEvents(sheet);\n                sheets.splice(insertIndex, 0, sheet);\n                if (options.data) {\n                    sheet.fromJSON(options.data);\n                }\n                if (options.dataSource) {\n                    sheet.setDataSource(options.dataSource);\n                }\n                this.trigger('change', { sheetSelection: true });\n                return sheet;\n            },\n            _bindSheetEvents: function (sheet) {\n                sheet.bind('changing', this._sheetChanging.bind(this));\n                sheet.bind('change', this._sheetChange.bind(this));\n                sheet.bind('insertRow', this._sheetInsertRow.bind(this));\n                sheet.bind('insertColumn', this._sheetInsertColumn.bind(this));\n                sheet.bind('deleteRow', this._sheetDeleteRow.bind(this));\n                sheet.bind('deleteColumn', this._sheetDeleteColumn.bind(this));\n                sheet.bind('hideRow', this._sheetHideRow.bind(this));\n                sheet.bind('hideColumn', this._sheetHideColumn.bind(this));\n                sheet.bind('unhideRow', this._sheetUnhideRow.bind(this));\n                sheet.bind('unhideColumn', this._sheetUnhideColumn.bind(this));\n                sheet.bind('select', this._sheetSelect.bind(this));\n                sheet.bind('commandRequest', this._sheetCommandRequest.bind(this));\n                sheet.bind('dataBinding', this._sheetDataBinding.bind(this));\n                sheet.bind('dataBound', this._sheetDataBound.bind(this));\n            },\n            sheets: function () {\n                return this._sheets.slice();\n            },\n            sheetByName: function (sheetName) {\n                return this._sheets[this.sheetIndex(sheetName)];\n            },\n            sheetByIndex: function (index) {\n                return this._sheets[index];\n            },\n            sheetIndex: function (sheet) {\n                var sheets = this._sheets;\n                var sheetName = (typeof sheet == 'string' ? sheet : sheet.name()).toLowerCase();\n                var idx = this._sheetsSearchCache[sheetName];\n                if (idx >= 0) {\n                    return idx;\n                }\n                for (idx = 0; idx < sheets.length; idx++) {\n                    var name = sheets[idx].name().toLowerCase();\n                    this._sheetsSearchCache[name] = idx;\n                    if (name === sheetName) {\n                        return idx;\n                    }\n                }\n                return -1;\n            },\n            renameSheet: function (sheet, newSheetName) {\n                var oldSheetName = sheet.name().toLowerCase();\n                if (!newSheetName || oldSheetName === newSheetName.toLowerCase() || this.sheetByName(newSheetName)) {\n                    return;\n                }\n                sheet = this.sheetByName(oldSheetName);\n                if (!sheet) {\n                    return;\n                }\n                this._sheetsSearchCache = {};\n                if (this.trigger('renameSheet', {\n                        sheet: sheet,\n                        newSheetName: newSheetName\n                    })) {\n                    return;\n                }\n                this._sheets.forEach(function (sheet) {\n                    sheet._forFormulas(function (formula) {\n                        formula.renameSheet(oldSheetName, newSheetName);\n                    });\n                });\n                this.forEachName(function (def, name) {\n                    if (def.nameref.renameSheet(oldSheetName, newSheetName)) {\n                        this.undefineName(name);\n                        def.name = def.nameref.print();\n                        this.nameDefinition(def.name, def);\n                    }\n                    if (def.value instanceof Ref || def.value instanceof Formula) {\n                        def.value.renameSheet(oldSheetName, newSheetName);\n                    }\n                }.bind(this));\n                sheet._name(newSheetName);\n                this.trigger('change', { sheetSelection: true });\n                return sheet;\n            },\n            removeSheet: function (sheet) {\n                var that = this;\n                var sheets = that._sheets;\n                var name = sheet.name();\n                var index = that.sheetIndex(sheet);\n                if (sheets.length === 1) {\n                    return;\n                }\n                if (this.trigger('removeSheet', { sheet: sheet })) {\n                    return;\n                }\n                this._sheetsSearchCache = {};\n                if (index > -1) {\n                    sheet.unbind();\n                    sheets.splice(index, 1);\n                    if (that.activeSheet().name() === name) {\n                        var newSheet = sheets[index === sheets.length ? index - 1 : index];\n                        that.activeSheet(newSheet);\n                    } else {\n                        this.trigger('change', {\n                            recalc: true,\n                            sheetSelection: true\n                        });\n                    }\n                }\n            },\n            _clearSheets: function () {\n                for (var i = 0; i < this._sheets.length; i++) {\n                    this._sheets[i]._activeDrawing = [];\n                    this._sheets[i]._drawings = [];\n                    this._sheets[i].unbind();\n                }\n                this._sheets = [];\n                this._sheetsSearchCache = {};\n                this._names = {};\n                this._images = {};\n                this._imgID = 0;\n            },\n            fromJSON: function (json) {\n                if (json.sheets) {\n                    this._clearSheets();\n                    if (json.images) {\n                        this._imgID = 0;\n                        this._images = {};\n                        Object.keys(json.images).forEach(function (id) {\n                            if (!isNaN(id)) {\n                                var num = parseFloat(id);\n                                if (isFinite(num)) {\n                                    this._imgID = Math.max(this._imgID, num);\n                                }\n                            }\n                            this._images[id] = { url: json.images[id] };\n                        }, this);\n                    }\n                    for (var idx = 0; idx < json.sheets.length; idx++) {\n                        var data = json.sheets[idx];\n                        var args = sheetParamsFromJSON(data, this.options);\n                        var sheet = this.insertSheet({\n                            rows: args.rowCount,\n                            columns: args.columnCount,\n                            rowHeight: args.rowHeight,\n                            columnWidth: args.columnWidth,\n                            headerHeight: args.headerHeight,\n                            headerWidth: args.headerWidth,\n                            data: data\n                        });\n                        if (data.dataSource) {\n                            sheet.setDataSource(data.dataSource);\n                        }\n                    }\n                }\n                if (json.activeSheet) {\n                    this.activeSheet(this.sheetByName(json.activeSheet));\n                } else {\n                    this.activeSheet(this._sheets[0]);\n                }\n                if (json.names) {\n                    json.names.forEach(function (def) {\n                        this.defineName(def.name, def.value, def.hidden);\n                    }, this);\n                }\n            },\n            toJSON: function () {\n                this.resetFormulas();\n                this.resetValidations();\n                var names = Object.keys(this._names).map(function (name) {\n                    var def = this._names[name];\n                    var val = def.value;\n                    if (val instanceof Ref || val instanceof Formula) {\n                        val = val.print(0, 0, true);\n                    } else if (val instanceof CalcError) {\n                        val = val + '';\n                    } else {\n                        val = JSON.stringify(val);\n                    }\n                    return {\n                        value: val,\n                        hidden: def.hidden,\n                        name: def.name,\n                        sheet: def.nameref.sheet,\n                        localName: def.nameref.name\n                    };\n                }, this);\n                return {\n                    activeSheet: this.activeSheet().name(),\n                    sheets: this._sheets.map(function (sheet) {\n                        sheet.recalc(this._context);\n                        sheet.revalidate(this._validationContext);\n                        return sheet.toJSON();\n                    }, this),\n                    names: names,\n                    columnWidth: this.options.columnWidth,\n                    rowHeight: this.options.rowHeight\n                };\n            },\n            saveJSON: function () {\n                var self = this;\n                var deferred = new $.Deferred();\n                var data = self.toJSON();\n                var ids = Object.keys(self._images).filter(function (id) {\n                    return self.usesImage(id) === 1;\n                });\n                var count = ids.length;\n                data.images = {};\n                if (count) {\n                    ids.forEach(function (id) {\n                        var img = self._images[id];\n                        if (img.blob) {\n                            var reader = new FileReader();\n                            reader.onload = function () {\n                                data.images[id] = reader.result;\n                                next();\n                            };\n                            reader.readAsDataURL(img.blob);\n                        } else {\n                            data.images[id] = img.url;\n                            next();\n                        }\n                    });\n                } else {\n                    next();\n                }\n                return deferred.promise();\n                function next() {\n                    if (--count <= 0) {\n                        deferred.resolve(data);\n                    }\n                }\n            },\n            fromFile: function (file) {\n                var deferred = new $.Deferred();\n                var promise = deferred.promise();\n                var args = {\n                    file: file,\n                    promise: promise\n                };\n                if (file && !this.trigger('excelImport', args)) {\n                    this._clearSheets();\n                    kendo.spreadsheet.readExcel(file, this, deferred);\n                } else {\n                    deferred.reject();\n                }\n                return promise;\n            },\n            saveAsExcel: function (options) {\n                var self = this;\n                options = $.extend({}, self.options.excel, options);\n                var data = self.toJSON();\n                if (self.trigger('excelExport', { workbook: data })) {\n                    return;\n                }\n                var ids = Object.keys(self._images).filter(function (id) {\n                    return self.usesImage(id) === 1;\n                });\n                var count = ids.length;\n                var images = count ? {} : null;\n                if (count) {\n                    ids.forEach(function (id) {\n                        var img = self._images[id];\n                        if (img.blob) {\n                            var reader = new FileReader();\n                            reader.onload = function () {\n                                images[id] = {\n                                    type: img.blob.type,\n                                    name: img.blob.name,\n                                    data: reader.result\n                                };\n                                next();\n                            };\n                            reader.readAsArrayBuffer(img.blob);\n                        } else {\n                            loadBinary(img.url, function (data, type) {\n                                images[id] = {\n                                    type: type,\n                                    data: data\n                                };\n                                next();\n                            });\n                        }\n                    });\n                } else {\n                    next();\n                }\n                function next() {\n                    if (--count <= 0) {\n                        data.images = images;\n                        var workbook = new kendo.ooxml.Workbook(data);\n                        kendo.saveAs({\n                            dataURI: options.forceProxy ? workbook.toDataURL() : workbook.toBlob(),\n                            fileName: data.fileName || options.fileName,\n                            proxyURL: options.proxyURL,\n                            forceProxy: options.forceProxy\n                        });\n                    }\n                }\n            },\n            draw: function (options, callback) {\n                if (typeof options == 'function' && !callback) {\n                    callback = options;\n                    options = {};\n                }\n                var parts = [], sheets = this._sheets;\n                (function loop(i) {\n                    if (i < sheets.length) {\n                        sheets[i].draw(kendo.spreadsheet.SHEETREF, options, function (group) {\n                            parts.push(group);\n                            loop(i + 1);\n                        });\n                    } else {\n                        var group = parts[0];\n                        for (i = 1; i < parts.length; ++i) {\n                            group.children = group.children.concat(parts[i].children);\n                        }\n                        callback(group);\n                    }\n                }(0));\n            },\n            nameForRef: function (ref, sheet) {\n                if (sheet === undefined) {\n                    sheet = ref.sheet;\n                }\n                sheet = sheet.toLowerCase();\n                var str = ref + '';\n                for (var name in this._names) {\n                    var def = this._names[name];\n                    var val = def.value;\n                    if (val instanceof Ref) {\n                        if (!val.sheet || val.sheet && sheet == val.sheet.toLowerCase()) {\n                            if (val + '' == str) {\n                                return def;\n                            }\n                        }\n                    }\n                }\n                return { name: str };\n            },\n            defineName: function (name, value, hidden) {\n                var x = kendo.spreadsheet.calc.parseNameDefinition(name, value);\n                name = x.name.print();\n                this._names[name.toLowerCase()] = {\n                    value: x.value,\n                    hidden: hidden,\n                    name: name,\n                    nameref: x.name\n                };\n            },\n            undefineName: function (name) {\n                delete this._names[name.toLowerCase()];\n            },\n            nameValue: function (name) {\n                name = name.toLowerCase();\n                if (name in this._names) {\n                    return this._names[name].value;\n                }\n                return null;\n            },\n            nameDefinition: function (name, def) {\n                name = name.toLowerCase();\n                if (arguments.length > 1) {\n                    if (def === undefined) {\n                        delete this._names[name];\n                    } else {\n                        this._names[name] = def;\n                    }\n                }\n                return this._names[name];\n            },\n            forEachName: function (func) {\n                Object.keys(this._names).forEach(function (name) {\n                    func(this._names[name], name);\n                }, this);\n            },\n            adjustNames: function (affectedSheet, forRow, start, delta) {\n                affectedSheet = affectedSheet.toLowerCase();\n                Object.keys(this._names).forEach(function (name) {\n                    var def = this._names[name];\n                    var x = def.value;\n                    if (x instanceof Ref && x.sheet.toLowerCase() == affectedSheet) {\n                        def.value = x.adjust(null, null, null, null, forRow, start, delta);\n                    } else if (x instanceof Formula) {\n                        x.adjust(affectedSheet, forRow ? 'row' : 'col', start, delta);\n                    }\n                }, this);\n            },\n            addImage: function (image) {\n                var id = String(++this._imgID);\n                if (typeof image == 'string') {\n                    this._images[id] = { url: image };\n                } else {\n                    this._images[id] = { blob: image };\n                }\n                return id;\n            },\n            imageUrl: function (id) {\n                var img = this._images[id];\n                var url = img.url;\n                if (!url) {\n                    url = img.url = window.URL.createObjectURL(img.blob);\n                }\n                return url;\n            },\n            cleanupImages: function () {\n                Object.keys(this._images).forEach(function (id) {\n                    if (!this.usesImage(id)) {\n                        var url = this._images[id].url;\n                        if (url) {\n                            window.URL.revokeObjectURL(url);\n                        }\n                        delete this._images[id];\n                    }\n                }, this);\n            },\n            usesImage: function (img) {\n                var i;\n                var sheets = this._sheets;\n                for (i = sheets.length; --i >= 0;) {\n                    if (sheets[i].usesImage(img)) {\n                        return 1;\n                    }\n                }\n                var stack = this.undoRedoStack.stack;\n                for (i = stack.length; --i >= 0;) {\n                    if (stack[i].usesImage(img)) {\n                        return 2;\n                    }\n                }\n                return false;\n            }\n        });\n        function sheetParamsFromJSON(data, options) {\n            function or(a, b, c) {\n                return a !== undefined ? a : b !== undefined ? b : c;\n            }\n            var rowCount = or(data.rowCount, options.rows, 200), columnCount = or(data.columnCount, options.columns, 50), rowHeight = or(data.rowHeight, options.rowHeight, 20), columnWidth = or(data.columnWidth, options.columnWidth, 64), headerHeight = or(data.headerHeight, options.headerHeight, 20), headerWidth = or(data.headerWidth, options.headerWidth, 32);\n            if (data.rows !== undefined) {\n                for (var i = 0; i < data.rows.length; ++i) {\n                    var row = data.rows[i];\n                    var ri = or(row.index, i);\n                    if (ri >= rowCount) {\n                        rowCount = ri + 1;\n                    }\n                    if (row.cells) {\n                        for (var j = 0; j < row.cells.length; ++j) {\n                            var cell = row.cells[j];\n                            var ci = or(cell.index, j);\n                            if (ci >= columnCount) {\n                                columnCount = ci + 1;\n                            }\n                        }\n                    }\n                }\n            }\n            return {\n                rowCount: rowCount,\n                columnCount: columnCount,\n                rowHeight: rowHeight,\n                columnWidth: columnWidth,\n                headerHeight: headerHeight,\n                headerWidth: headerWidth\n            };\n        }\n        kendo.spreadsheet.Workbook = Workbook;\n        if (kendo.PDFMixin) {\n            kendo.PDFMixin.extend(Workbook.prototype);\n            Workbook.prototype.saveAsPDF = function (options) {\n                var progress = new $.Deferred();\n                var promise = progress.promise();\n                var args = { promise: promise };\n                if (this.trigger('pdfExport', args)) {\n                    return;\n                }\n                this._drawPDF(options, progress).then(function (root) {\n                    return options.forceProxy ? kendo.pdf.exportPDF(root) : kendo.pdf.exportPDFToBlob(root);\n                }).done(function (dataURI) {\n                    kendo.saveAs({\n                        dataURI: dataURI,\n                        fileName: options.fileName,\n                        proxyURL: options.proxyURL,\n                        forceProxy: options.forceProxy,\n                        proxyTarget: options.proxyTarget\n                    });\n                    progress.resolve();\n                }).fail(function (err) {\n                    progress.reject(err);\n                });\n                return promise;\n            };\n            Workbook.prototype._drawPDF = function (options) {\n                var result = new $.Deferred();\n                var callback = function (group) {\n                    result.resolve(group);\n                };\n                switch (options.area) {\n                case 'workbook':\n                    options.workbook.draw(options, callback);\n                    break;\n                case 'sheet':\n                    options.workbook.activeSheet().draw(options, callback);\n                    break;\n                case 'selection':\n                    options.workbook.activeSheet().selection().draw(options, callback);\n                    break;\n                }\n                return result.promise();\n            };\n        }\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/formulacontext', ['kendo.core'], f);\n}(function () {\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var CellRef = spreadsheet.CellRef;\n    var RangeRef = spreadsheet.RangeRef;\n    var UnionRef = spreadsheet.UnionRef;\n    var NameRef = spreadsheet.NameRef;\n    var Ref = spreadsheet.Ref;\n    var FormulaContext = kendo.Class.extend({\n        init: function (workbook) {\n            this.workbook = workbook;\n        },\n        getRefCells: function (ref, hiddenInfo, fsheet, frow, fcol, wantNulls) {\n            var sheet, formula, value, i;\n            if (ref instanceof CellRef) {\n                sheet = this.workbook.sheetByName(ref.sheet);\n                if (!sheet || !ref.valid()) {\n                    return [{ value: new kendo.spreadsheet.calc.runtime.CalcError('REF') }];\n                }\n                formula = sheet.formula(ref);\n                value = sheet.range(ref.row, ref.col).value();\n                if (wantNulls || formula != null || value != null) {\n                    return [{\n                            formula: formula,\n                            value: value,\n                            row: ref.row,\n                            col: ref.col,\n                            sheet: ref.sheet,\n                            hidden: hiddenInfo ? sheet.columnWidth(ref.col) === 0 || sheet.rowHeight(ref.row) === 0 : false\n                        }];\n                } else {\n                    return [];\n                }\n            }\n            if (ref instanceof RangeRef) {\n                i = this.workbook.sheetIndex(ref.sheet);\n                var states = [], n = i;\n                if (ref.endSheet) {\n                    n = this.workbook.sheetIndex(ref.endSheet);\n                    if (i > n) {\n                        var tmp = i;\n                        i = n;\n                        n = tmp;\n                    }\n                }\n                if (i < 0 || n < 0 || !ref.valid()) {\n                    return [{ value: new kendo.spreadsheet.calc.runtime.CalcError('REF') }];\n                }\n                while (i <= n) {\n                    sheet = this.workbook.sheetByIndex(i++);\n                    var tl = sheet._grid.normalize(ref.topLeft);\n                    var br = sheet._grid.normalize(ref.bottomRight);\n                    var startCellIndex = sheet._grid.cellRefIndex(tl);\n                    var endCellIndex = sheet._grid.cellRefIndex(br);\n                    var values = sheet._properties.iterator('value', startCellIndex, endCellIndex);\n                    for (var col = tl.col; col <= br.col; ++col) {\n                        for (var row = tl.row; row <= br.row; ++row) {\n                            var index = sheet._grid.index(row, col);\n                            formula = sheet._properties.get('formula', index);\n                            value = values.at(index);\n                            if (wantNulls || formula != null || value != null) {\n                                states.push({\n                                    formula: formula,\n                                    value: value,\n                                    row: row,\n                                    col: col,\n                                    sheet: sheet.name(),\n                                    hidden: hiddenInfo ? sheet.columnWidth(col) === 0 || sheet.rowHeight(row) === 0 : false\n                                });\n                            }\n                        }\n                    }\n                }\n                return states;\n            }\n            if (ref instanceof UnionRef) {\n                var a = [];\n                for (i = 0; i < ref.refs.length; ++i) {\n                    a = a.concat(this.getRefCells(ref.refs[i], hiddenInfo, fsheet, frow, fcol));\n                }\n                return a;\n            }\n            if (ref instanceof NameRef) {\n                var val = this.nameValue(ref, fsheet, frow, fcol);\n                if (val instanceof Ref) {\n                    return this.getRefCells(val, hiddenInfo, fsheet, frow, fcol);\n                }\n                return [{ value: val == null ? new kendo.spreadsheet.calc.runtime.CalcError('NAME') : val }];\n            }\n            return [];\n        },\n        nameValue: function (ref, fsheet, frow, fcol) {\n            var val;\n            if (ref.hasSheet()) {\n                val = this.workbook.nameValue(ref.print());\n            } else {\n                ref = ref.clone().setSheet(fsheet, true);\n                val = this.workbook.nameValue(ref.print());\n                if (val == null) {\n                    val = this.workbook.nameValue(ref.name);\n                }\n            }\n            if (val instanceof Ref) {\n                val = val.absolute(frow, fcol);\n            }\n            return val;\n        },\n        getData: function (ref, fsheet, frow, fcol, wantNulls) {\n            var single = ref instanceof CellRef;\n            if (ref instanceof NameRef) {\n                single = this.workbook.nameValue(ref.name) instanceof CellRef;\n            }\n            var data = this.getRefCells(ref, false, fsheet, frow, fcol, wantNulls).map(function (cell) {\n                var val = cell.value;\n                if (val instanceof kendo.spreadsheet.calc.runtime.Formula) {\n                    val = val.value;\n                }\n                return val;\n            });\n            return single ? data[0] : data;\n        },\n        onFormula: function (f) {\n            var sheet = this.workbook.sheetByName(f.sheet);\n            var row = f.row, col = f.col, value = f.value;\n            var currentFormula = sheet.formula({\n                row: row,\n                col: col\n            });\n            if (currentFormula !== f) {\n                return false;\n            }\n            var arrayRange = f.arrayFormulaRange;\n            if (arrayRange) {\n                var tlRow, tlCol;\n                var width = value.width;\n                var height = value.height;\n                sheet.forEach(arrayRange, function (row, col) {\n                    if (tlRow === undefined) {\n                        tlRow = row;\n                        tlCol = col;\n                    }\n                    var vrow = row - tlRow;\n                    var vcol = col - tlCol;\n                    var val;\n                    if (vrow < height && vcol < width) {\n                        val = value.get(vrow, vcol);\n                    } else {\n                        val = new kendo.spreadsheet.calc.runtime.CalcError('N/A');\n                    }\n                    sheet._value(row, col, val);\n                });\n            } else {\n                if (value instanceof Ref) {\n                    value = this.getData(value, f.sheet, row, col);\n                    if (Array.isArray(value)) {\n                        value = value[0];\n                    }\n                    if (value === undefined) {\n                        value = null;\n                    }\n                }\n                if (value instanceof kendo.spreadsheet.calc.runtime.Matrix) {\n                    value = value.get(0, 0);\n                }\n                sheet._value(row, col, value);\n            }\n            clearTimeout(sheet._formulaContextRefresh);\n            sheet._formulaContextRefresh = setTimeout(function () {\n                sheet.batch(function () {\n                }, { layout: true });\n            }, 50);\n            return true;\n        }\n    });\n    var ValidationFormulaContext = FormulaContext.extend({\n        onFormula: function () {\n            return true;\n        }\n    });\n    spreadsheet.FormulaContext = FormulaContext;\n    spreadsheet.ValidationFormulaContext = ValidationFormulaContext;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/controller', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        'use strict';\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var alphaNumRegExp = /:alphanum$/;\n        var ACTIONS = {\n            'up': 'up',\n            'down': 'down',\n            'left': 'left',\n            'right': 'right',\n            'home': 'first-col',\n            'ctrl+left': 'first-col',\n            'end': 'last-col',\n            'ctrl+right': 'last-col',\n            'ctrl+up': 'first-row',\n            'ctrl+down': 'last-row',\n            'ctrl+home': 'first',\n            'ctrl+end': 'last',\n            'pageup': 'prev-page',\n            'pagedown': 'next-page'\n        };\n        var ENTRY_ACTIONS = {\n            'tab': 'next',\n            'shift+tab': 'previous',\n            'enter': 'lower',\n            'shift+enter': 'upper',\n            'delete': 'clearContents',\n            'backspace': 'clearContents',\n            'shift+:alphanum': 'edit',\n            'alt+:alphanum': 'edit',\n            ':alphanum': 'edit',\n            'ctrl+:alphanum': 'ctrl',\n            'alt+ctrl+:alphanum': 'edit',\n            ':edit': 'edit'\n        };\n        var CONTAINER_EVENTS = {\n            'wheel': 'onWheel',\n            '*+mousedown': 'onMouseDown',\n            'contextmenu': 'onContextMenu',\n            '*+mousedrag': 'onMouseDrag',\n            '*+mouseup': 'onMouseUp',\n            '*+dblclick': 'onDblClick',\n            'mousemove': 'onMouseMove',\n            'touchmove': 'onTouchMove',\n            'touchend': 'onTouchEnd'\n        };\n        var CLIPBOARD_EVENTS = {\n            'pageup': 'onPageUp',\n            'pagedown': 'onPageDown',\n            'mouseup': 'onMouseUp',\n            '*+cut': 'onCut',\n            '*+paste': 'onPaste',\n            '*+copy': 'onCopy'\n        };\n        var EDITOR_EVENTS = {\n            'esc': 'onEditorEsc',\n            'enter': 'onEditorBlur',\n            'alt+enter': 'insertNewline',\n            'shift+enter': 'onEditorBlur',\n            'tab': 'onEditorBlur',\n            'shift+tab': 'onEditorBlur',\n            'shift+ctrl+enter': 'onEditorArrayFormula'\n        };\n        var FORMULABAR_EVENTS = $.extend({ focus: 'onEditorBarFocus' }, EDITOR_EVENTS);\n        var FORMULAINPUT_EVENTS = $.extend({ focus: 'onEditorCellFocus' }, EDITOR_EVENTS);\n        var SELECTION_MODES = {\n            cell: 'range',\n            rowheader: 'row',\n            columnheader: 'column',\n            topcorner: 'sheet',\n            autofill: 'autofill'\n        };\n        function toActionSelector(selectors) {\n            return selectors.map(function (action) {\n                return '[data-action=\"' + action + '\"]';\n            }).join(',');\n        }\n        var COMPOSITE_UNAVAILABLE_ACTION_SELECTORS = toActionSelector([\n            'cut',\n            'copy',\n            'paste',\n            'insert-left',\n            'insert-right',\n            'insert-above',\n            'insert-below'\n        ]);\n        var UNHIDE_ACTION_SELECTORS = toActionSelector([\n            'unhide-row',\n            'unhide-column'\n        ]);\n        var ACTION_KEYS = [];\n        var SHIFT_ACTION_KEYS = [];\n        var ENTRY_ACTION_KEYS = [];\n        for (var key in ACTIONS) {\n            ACTION_KEYS.push(key);\n            SHIFT_ACTION_KEYS.push('shift+' + key);\n        }\n        for (key in ENTRY_ACTIONS) {\n            ENTRY_ACTION_KEYS.push(key);\n        }\n        CLIPBOARD_EVENTS[ACTION_KEYS] = 'onAction';\n        CLIPBOARD_EVENTS[SHIFT_ACTION_KEYS] = 'onShiftAction';\n        CLIPBOARD_EVENTS[ENTRY_ACTION_KEYS] = 'onEntryAction';\n        FORMULAINPUT_EVENTS[ACTION_KEYS] = 'onEditorAction';\n        FORMULAINPUT_EVENTS[SHIFT_ACTION_KEYS] = 'onEditorShiftAction';\n        var Controller = kendo.Class.extend({\n            init: function (view, workbook) {\n                this.view = view;\n                this.workbook(workbook);\n                this.container = $(view.container);\n                this.clipboardElement = $(view.clipboard);\n                this.cellContextMenu = view.cellContextMenu;\n                this.rowHeaderContextMenu = view.rowHeaderContextMenu;\n                this.colHeaderContextMenu = view.colHeaderContextMenu;\n                this.drawingContextMenu = view.drawingContextMenu;\n                this.scroller = view.scroller;\n                this.tabstrip = view.tabstrip;\n                this.sheetsbar = view.sheetsbar;\n                view.nameEditor.bind('enter', this.onNameEditorEnter.bind(this));\n                view.nameEditor.bind('cancel', this.onNameEditorCancel.bind(this));\n                view.nameEditor.bind('select', this.onNameEditorSelect.bind(this));\n                view.nameEditor.bind('delete', this.onNameEditorDelete.bind(this));\n                this.editor = view.editor;\n                this.editor.bind('change', this.onEditorChange.bind(this));\n                this.editor.bind('activate', this.onEditorActivate.bind(this));\n                this.editor.bind('deactivate', this.onEditorDeactivate.bind(this));\n                this.editor.bind('update', this.onEditorUpdate.bind(this));\n                $(view.scroller).on('scroll', this.onScroll.bind(this));\n                this.listener = new kendo.spreadsheet.EventListener(this.container, this, CONTAINER_EVENTS);\n                this._enableEditorEvents();\n                if (this.sheetsbar) {\n                    this.sheetsbar.bind('select', this.onSheetBarSelect.bind(this));\n                    this.sheetsbar.bind('reorder', this.onSheetBarReorder.bind(this));\n                    this.sheetsbar.bind('rename', this.onSheetBarRename.bind(this));\n                    this.sheetsbar.bind('remove', this.onSheetBarRemove.bind(this));\n                }\n                this.cellContextMenu.bind('select', this.onContextMenuSelect.bind(this));\n                this.rowHeaderContextMenu.bind('select', this.onContextMenuSelect.bind(this));\n                this.colHeaderContextMenu.bind('select', this.onContextMenuSelect.bind(this));\n                this.drawingContextMenu.bind('select', this.onContextMenuSelect.bind(this));\n                this.cellContextMenu.element.add(this.rowHeaderContextMenu.element).add(this.colHeaderContextMenu.element).add(this.drawingContextMenu.element).on('contextmenu', false);\n                if (this.tabstrip) {\n                    this.tabstrip.bind('action', this.onCommandRequest.bind(this));\n                    this.tabstrip.bind('dialog', this.onDialogRequest.bind(this));\n                }\n            },\n            _enableEditorEvents: function (enable) {\n                if (enable === undefined || enable) {\n                    this.keyListener = new kendo.spreadsheet.EventListener(this.clipboardElement, this, CLIPBOARD_EVENTS);\n                    this.barKeyListener = new kendo.spreadsheet.EventListener(this.editor.barElement(), this, FORMULABAR_EVENTS);\n                    this.inputKeyListener = new kendo.spreadsheet.EventListener(this.editor.cellElement(), this, FORMULAINPUT_EVENTS);\n                } else {\n                    this.keyListener.destroy();\n                    this.barKeyListener.destroy();\n                    this.inputKeyListener.destroy();\n                }\n            },\n            _execute: function (options) {\n                var result = this._workbook.execute(options);\n                if (options.command === 'EditCommand' && !result) {\n                    this._workbook.trigger('change', { editorClose: true });\n                }\n                if (result) {\n                    this._preventNavigation = true;\n                    if (result.reason === 'error') {\n                        this.editor.deactivate(true);\n                        this.view.showError(result, function () {\n                            this.activateEditor(false);\n                            this.editor.value(this._lastEditorValue);\n                            this.editor._value = this._workbook._inputForRef(this._workbook.activeSheet()._viewActiveCell());\n                            this.editor.select();\n                        }.bind(this));\n                    } else {\n                        this.view.openDialog(result.reason);\n                    }\n                }\n                return result;\n            },\n            _activeTooltip: function () {\n                return this._workbook.activeSheet().activeCell().simplify().toString();\n            },\n            onContextMenuSelect: function (e) {\n                var action = $(e.item).data('action');\n                var command;\n                switch (action) {\n                case 'cut':\n                    command = {\n                        command: 'ToolbarCutCommand',\n                        options: { workbook: this._workbook }\n                    };\n                    break;\n                case 'copy':\n                    command = {\n                        command: 'ToolbarCopyCommand',\n                        options: { workbook: this._workbook }\n                    };\n                    break;\n                case 'paste':\n                    command = {\n                        command: 'ToolbarPasteCommand',\n                        options: { workbook: this._workbook }\n                    };\n                    break;\n                case 'delete-drawing':\n                    command = {\n                        command: 'DeleteDrawingCommand',\n                        options: { drawing: this.navigator._sheet._activeDrawing }\n                    };\n                    break;\n                case 'bring-to-front':\n                    command = {\n                        command: 'BringToFrontCommand',\n                        options: { drawing: this.navigator._sheet._activeDrawing }\n                    };\n                    break;\n                case 'send-to-back':\n                    command = {\n                        command: 'SendToBackCommand',\n                        options: { drawing: this.navigator._sheet._activeDrawing }\n                    };\n                    break;\n                case 'unmerge':\n                    command = {\n                        command: 'MergeCellCommand',\n                        options: { value: 'unmerge' }\n                    };\n                    break;\n                case 'merge':\n                    this.view.openDialog('merge');\n                    break;\n                case 'hide-row':\n                    command = {\n                        command: 'HideLineCommand',\n                        options: { axis: 'row' }\n                    };\n                    break;\n                case 'hide-column':\n                    command = {\n                        command: 'HideLineCommand',\n                        options: { axis: 'column' }\n                    };\n                    break;\n                case 'unhide-row':\n                    command = {\n                        command: 'UnHideLineCommand',\n                        options: { axis: 'row' }\n                    };\n                    break;\n                case 'unhide-column':\n                    command = {\n                        command: 'UnHideLineCommand',\n                        options: { axis: 'column' }\n                    };\n                    break;\n                case 'delete-row':\n                    command = { command: 'DeleteRowCommand' };\n                    break;\n                case 'delete-column':\n                    command = { command: 'DeleteColumnCommand' };\n                    break;\n                }\n                if (command) {\n                    this._execute(command);\n                }\n            },\n            onSheetBarRemove: function (e) {\n                var sheet = this._workbook.sheetByName(e.name);\n                if (!sheet) {\n                    return;\n                }\n                this._workbook.removeSheet(sheet);\n            },\n            destroy: function () {\n                this.listener.destroy();\n                this._enableEditorEvents(false);\n                this.keyListener.destroy();\n                this.inputKeyListener.destroy();\n            },\n            onSheetBarSelect: function (e) {\n                var sheet;\n                var workbook = this._workbook;\n                if (e.isAddButton) {\n                    if (this._workbook.trigger('insertSheet')) {\n                        return;\n                    }\n                    sheet = workbook.insertSheet();\n                } else {\n                    sheet = workbook.sheetByName(e.name);\n                }\n                if (workbook.activeSheet().name() !== sheet.name()) {\n                    if (this._workbook.trigger('selectSheet', { sheet: sheet })) {\n                        return;\n                    }\n                    if (!this.editor.canInsertRef(false)) {\n                        this.editor.deactivate();\n                    }\n                    workbook.activeSheet(sheet);\n                }\n            },\n            onSheetBarReorder: function (e) {\n                var sheet = this._workbook.sheetByIndex(e.oldIndex);\n                this._workbook.moveSheetToIndex(sheet, e.newIndex);\n                this._workbook.activeSheet(sheet);\n            },\n            onSheetBarRename: function (e) {\n                var sheet = this._workbook.sheetByIndex(e.sheetIndex);\n                if (this._workbook.sheetByName(e.name)) {\n                    this.view.showError({\n                        reason: 'error',\n                        type: 'duplicateSheetName'\n                    });\n                    return;\n                }\n                this._workbook.renameSheet(sheet, e.name);\n                this.clipboardElement.focus();\n            },\n            sheet: function (sheet) {\n                this.navigator = sheet.navigator();\n                this.axisManager = sheet.axisManager();\n            },\n            workbook: function (workbook) {\n                this._workbook = workbook;\n                this.clipboard = workbook.clipboard();\n                workbook.bind('commandRequest', this.onCommandRequest.bind(this));\n            },\n            refresh: function () {\n                var editor = this.editor;\n                var workbook = this._workbook;\n                var sheet = workbook.activeSheet();\n                this._viewPortHeight = this.view.scroller.clientHeight;\n                this.navigator.height(this._viewPortHeight);\n                if (!editor.isActive() && !this.isEditorDisabled) {\n                    editor.enable(sheet.selection().enable() !== false);\n                    this.resetEditorValue();\n                }\n                var ref = sheet.selection()._ref.simplify();\n                var def = this._workbook.nameForRef(ref, sheet.name());\n                this.view.nameEditor.value(def.name);\n            },\n            onScroll: function () {\n                this.view.render({ scroll: true });\n            },\n            onWheel: function (event) {\n                var deltaX = event.originalEvent.deltaX;\n                var deltaY = event.originalEvent.deltaY;\n                if (event.originalEvent.deltaMode === 1) {\n                    deltaX *= 10;\n                    deltaY *= 10;\n                }\n                this.scrollWith(deltaX, deltaY);\n                event.preventDefault();\n            },\n            onTouchMove: function () {\n                this.view.forceScrollerStackingOrder(2);\n            },\n            onTouchEnd: function () {\n                this.view.forceScrollerStackingOrder(1);\n            },\n            onAction: function (event, action) {\n                var sheet = this._workbook.activeSheet();\n                sheet._activeDrawing = null;\n                this.navigator.moveActiveCell(ACTIONS[action]);\n                event.preventDefault();\n            },\n            onPageUp: function () {\n                this.scrollDown(-this._viewPortHeight);\n            },\n            onPageDown: function () {\n                this.scrollDown(this._viewPortHeight);\n            },\n            onEntryAction: function (event, action) {\n                var sheet = this._workbook.activeSheet();\n                if (event.mod) {\n                    var shouldPrevent = true;\n                    var key = String.fromCharCode(event.keyCode);\n                    switch (key) {\n                    case 'A':\n                        sheet._activeDrawing = null;\n                        this.navigator.selectAll();\n                        break;\n                    case 'Y':\n                        this._workbook.undoRedoStack.redo();\n                        break;\n                    case 'Z':\n                        this._workbook.undoRedoStack.undo();\n                        break;\n                    default:\n                        shouldPrevent = false;\n                        break;\n                    }\n                    if (shouldPrevent) {\n                        event.preventDefault();\n                    }\n                } else {\n                    var disabled = sheet.selection().enable() === false;\n                    var casual = action !== ':edit';\n                    if (action == 'delete' || action == 'backspace') {\n                        if (sheet._activeDrawing) {\n                            this._execute({\n                                command: 'DeleteDrawingCommand',\n                                options: { drawing: sheet._activeDrawing }\n                            });\n                        } else if (!disabled) {\n                            this._execute({ command: 'ClearContentCommand' });\n                        }\n                        event.preventDefault();\n                    } else if (alphaNumRegExp.test(action) || !casual) {\n                        sheet._activeDrawing = null;\n                        if (disabled) {\n                            event.preventDefault();\n                            return;\n                        }\n                        if (casual) {\n                            this.editor.value('');\n                        }\n                        this.activateEditor(casual);\n                    } else {\n                        this.navigator.navigateInSelection(ENTRY_ACTIONS[action]);\n                        event.preventDefault();\n                    }\n                }\n            },\n            onShiftAction: function (event, action) {\n                this.navigator.modifySelection(ACTIONS[action.replace('shift+', '')], this.appendSelection);\n                event.preventDefault();\n            },\n            onMouseMove: function (event) {\n                var sheet = this._workbook.activeSheet();\n                if (sheet.resizingInProgress() || sheet.selectionInProgress()) {\n                    return;\n                }\n                var object = this.objectAt(event);\n                if (object.type === 'columnresizehandle' || object.type === 'rowresizehandle') {\n                    sheet.positionResizeHandle(object.ref);\n                } else {\n                    sheet.removeResizeHandle();\n                }\n                sheet._renderComment(object.type == 'cell' ? object.ref : null);\n            },\n            onMouseDown: function (event) {\n                var object = this.objectAt(event);\n                if (object.pane) {\n                    this.originFrame = object.pane;\n                }\n                if (this._startResizingDrawing(event, object)) {\n                    event.stopPropagation();\n                    return;\n                }\n                var sheet = this._workbook.activeSheet();\n                var win = this.container.closest('[data-role=\"window\"]');\n                if (win.length) {\n                    win = kendo.widgetInstance(win);\n                    if (win && win.options.modal) {\n                        event.stopPropagation();\n                    }\n                }\n                sheet._activeDrawing = null;\n                if (object.type === 'drawing') {\n                    sheet._activeDrawing = object.drawing;\n                    object.copy = object.drawing.clone();\n                    object.startBox = sheet.drawingBoundingBox(object.copy);\n                    sheet.startDragging(object);\n                    sheet.triggerChange({ dragging: true });\n                    event.preventDefault();\n                    return;\n                }\n                if (object.type === 'editor') {\n                    this.onEditorEsc();\n                    this.openCustomEditor();\n                    event.preventDefault();\n                    return;\n                }\n                if (this.editor.canInsertRef(false) && object.ref) {\n                    this._workbook.activeSheet()._setFormulaSelections(this.editor.highlightedRefs());\n                    this.navigator.startSelection(object.ref, this._selectionMode, this.appendSelection, event.shiftKey);\n                    event.preventDefault();\n                    return;\n                } else {\n                    this._preventNavigation = false;\n                    this.editor.deactivate();\n                    if (this._preventNavigation) {\n                        return;\n                    }\n                }\n                if (object.type === 'columnresizehandle' || object.type === 'rowresizehandle') {\n                    sheet.startResizing({\n                        x: object.x,\n                        y: object.y\n                    });\n                    event.preventDefault();\n                    return;\n                }\n                if (object.type === 'filtericon') {\n                    this.openFilterMenu(event);\n                    event.preventDefault();\n                    return;\n                }\n                this._selectionMode = SELECTION_MODES[object.type];\n                this.appendSelection = event.mod;\n                this.navigator.startSelection(object.ref, this._selectionMode, this.appendSelection, event.shiftKey);\n            },\n            _startResizingDrawing: function (event) {\n                var handle = $(event.target).closest('.k-spreadsheet-drawing-handle');\n                if (handle.length) {\n                    var location = this.translateCoords(event);\n                    var direction = handle.data('direction');\n                    var sheet = this._workbook.activeSheet();\n                    var drawing = sheet._activeDrawing;\n                    sheet.startDragging({\n                        pane: this.originFrame,\n                        drawing: drawing,\n                        copy: drawing.clone(),\n                        startBox: sheet.drawingBoundingBox(drawing),\n                        resize: direction,\n                        startX: location.x,\n                        startY: location.y\n                    });\n                    return true;\n                }\n            },\n            onContextMenu: function (event) {\n                var sheet = this._workbook.activeSheet();\n                event.preventDefault();\n                if (sheet.resizingInProgress() || sheet.draggingInProgress()) {\n                    return;\n                }\n                this.cellContextMenu.close();\n                this.colHeaderContextMenu.close();\n                this.rowHeaderContextMenu.close();\n                this.drawingContextMenu.close();\n                var menu;\n                var object = this.objectAt(event);\n                if (object.type === 'columnresizehandle' || object.type === 'rowresizehandle') {\n                    return;\n                }\n                if (object.ref) {\n                    this.navigator.selectForContextMenu(object.ref, SELECTION_MODES[object.type]);\n                } else if (object.type == 'drawing') {\n                    this.navigator.selectDrawingForContextMenu(object.drawing);\n                }\n                var isComposite = this.navigator._sheet.select() instanceof kendo.spreadsheet.UnionRef;\n                var showUnhide = false;\n                var showUnmerge = false;\n                if (object.type == 'columnheader') {\n                    menu = this.colHeaderContextMenu;\n                    showUnhide = !isComposite && this.axisManager.selectionIncludesHiddenColumns();\n                } else if (object.type == 'rowheader') {\n                    menu = this.rowHeaderContextMenu;\n                    showUnhide = !isComposite && this.axisManager.selectionIncludesHiddenRows();\n                } else if (object.type == 'drawing') {\n                    menu = this.drawingContextMenu;\n                } else {\n                    menu = this.cellContextMenu;\n                    showUnmerge = this.navigator.selectionIncludesMergedCells();\n                }\n                menu.element.find(COMPOSITE_UNAVAILABLE_ACTION_SELECTORS).toggle(!isComposite);\n                menu.element.find(UNHIDE_ACTION_SELECTORS).toggle(showUnhide);\n                menu.element.find('[data-action=unmerge]').toggle(showUnmerge);\n                setTimeout(function () {\n                    menu.open(event.pageX, event.pageY);\n                });\n            },\n            prevent: function (event) {\n                event.preventDefault();\n            },\n            constrainResize: function (type, ref) {\n                var sheet = this._workbook.activeSheet();\n                var resizeHandle = sheet.resizeHandlePosition();\n                return !resizeHandle || type === 'outside' || type === 'topcorner' || ref.col < resizeHandle.col || ref.row < resizeHandle.row;\n            },\n            _dragDrawing: function (event) {\n                var sheet = this._workbook.activeSheet();\n                var drag = sheet.draggingInProgress();\n                if (!drag) {\n                    return false;\n                }\n                var location = this.translateCoords(event);\n                var drawing = drag.drawing;\n                var deltaX = location.x - drag.startX;\n                var deltaY = location.y - drag.startY;\n                if (drag.resize == 'SE') {\n                    if (drag.aspect) {\n                        if (Math.abs(deltaX) > Math.abs(deltaY)) {\n                            drawing.width = Math.max(drag.copy.width + deltaX, 20);\n                            drawing.height = drawing.width / drag.aspect;\n                        } else {\n                            drawing.height = Math.max(drag.copy.height + deltaY, 20);\n                            drawing.width = drawing.height * drag.aspect;\n                        }\n                    } else {\n                        drawing.width = Math.max(drag.copy.width + deltaX, 20);\n                        drawing.height = Math.max(drag.copy.height + deltaY, 20);\n                    }\n                } else if (drag.resize == 'E') {\n                    drawing.width = Math.max(drag.copy.width + deltaX, 20);\n                } else if (drag.resize == 'S') {\n                    drawing.height = Math.max(drag.copy.height + deltaY, 20);\n                } else if (drag.resize == 'N') {\n                    if (drag.copy.height - deltaY > 20) {\n                        drawing.height = drag.copy.height - deltaY;\n                        drawing.offsetY = drag.copy.offsetY + deltaY;\n                    }\n                } else if (drag.resize == 'W') {\n                    if (drag.copy.width - deltaX > 20) {\n                        drawing.width = drag.copy.width - deltaX;\n                        drawing.offsetX = drag.copy.offsetX + deltaX;\n                    }\n                } else if (drag.resize == 'NE') {\n                    drawing.width = Math.max(drag.copy.width + deltaX, 20);\n                    if (drag.copy.height - deltaY > 20) {\n                        drawing.height = drag.copy.height - deltaY;\n                        drawing.offsetY = drag.copy.offsetY + deltaY;\n                    }\n                } else if (drag.resize == 'SW') {\n                    drawing.height = Math.max(drag.copy.height + deltaY, 20);\n                    if (drag.copy.width - deltaX > 20) {\n                        drawing.width = drag.copy.width - deltaX;\n                        drawing.offsetX = drag.copy.offsetX + deltaX;\n                    }\n                } else if (drag.resize == 'NW') {\n                    if (drag.copy.height - deltaY > 20) {\n                        drawing.height = drag.copy.height - deltaY;\n                        drawing.offsetY = drag.copy.offsetY + deltaY;\n                    }\n                    if (drag.copy.width - deltaX > 20) {\n                        drawing.width = drag.copy.width - deltaX;\n                        drawing.offsetX = drag.copy.offsetX + deltaX;\n                    }\n                } else {\n                    drawing.offsetX = drag.copy.offsetX + deltaX;\n                    drawing.offsetY = drag.copy.offsetY + deltaY;\n                }\n                sheet.triggerChange({ dragging: true });\n                return true;\n            },\n            onMouseDrag: function (event) {\n                if (this._selectionMode === 'sheet') {\n                    return;\n                }\n                var location = {\n                    clientX: event.clientX,\n                    clientY: event.clientY\n                };\n                var sheet = this._workbook.activeSheet();\n                if (this._dragDrawing(event)) {\n                    return;\n                }\n                var object = this.objectAt(location);\n                if (sheet.resizingInProgress()) {\n                    if (!this.constrainResize(object.type, object.ref)) {\n                        sheet.resizeHintPosition({\n                            x: object.x,\n                            y: object.y\n                        });\n                    }\n                    return;\n                }\n                if (object.type === 'outside') {\n                    this.startAutoScroll(object);\n                    return;\n                }\n                if (this.originFrame === object.pane) {\n                    this.selectToLocation(location);\n                } else {\n                    var frame = this.originFrame._grid;\n                    if (object.x > frame.right) {\n                        this.scrollLeft();\n                    }\n                    if (object.y > frame.bottom) {\n                        this.scrollTop();\n                    }\n                    if (object.y < frame.top || object.x < frame.left) {\n                        this.startAutoScroll(object, location);\n                    } else {\n                        this.selectToLocation(location);\n                    }\n                }\n                event.preventDefault();\n            },\n            onMouseUp: function (event) {\n                var sheet = this._workbook.activeSheet();\n                sheet.completeResizing();\n                sheet.completeDragging();\n                this.navigator.completeSelection();\n                this.stopAutoScroll();\n                var editor = this.editor.activeEditor();\n                if (!editor) {\n                    return;\n                }\n                var el = event.target;\n                while (el) {\n                    if (el === editor.element[0]) {\n                        return;\n                    }\n                    el = el.parentNode;\n                }\n                var object = this.objectAt(event);\n                if (object && object.ref && editor.canInsertRef(false)) {\n                    editor.refAtPoint(sheet);\n                    sheet._setFormulaSelections(editor.highlightedRefs());\n                }\n            },\n            onDblClick: function (event) {\n                var object = this.objectAt(event);\n                var disabled = this._workbook.activeSheet().selection().enable() === false;\n                if (object.type !== 'cell' || disabled) {\n                    return;\n                }\n                var sel = this._workbook.activeSheet().selection();\n                this.activateEditor(!sel.value() && !sel.formula());\n                this.onEditorUpdate();\n            },\n            onCut: function (e) {\n                if (e) {\n                    var table = this.clipboardElement.find('table.kendo-clipboard-' + this.clipboard._uid).detach();\n                    this.clipboardElement.append(table.clone(false));\n                    setTimeout(function () {\n                        this.clipboardElement.empty().append(table);\n                    }.bind(this));\n                }\n                this._execute({\n                    command: 'CutCommand',\n                    options: {\n                        workbook: this.view._workbook,\n                        event: e.originalEvent || e\n                    }\n                });\n            },\n            clipBoardValue: function () {\n                return this.clipboardElement.html();\n            },\n            _pasteImage: function (dataTransferItem) {\n                var self = this;\n                var blob = dataTransferItem.getAsFile();\n                var img = new window.Image();\n                img.src = window.URL.createObjectURL(blob);\n                img.onload = function () {\n                    self._execute({\n                        command: 'InsertImageCommand',\n                        options: {\n                            blob: blob,\n                            width: img.width,\n                            height: img.height\n                        }\n                    });\n                };\n                setTimeout(function () {\n                    window.URL.revokeObjectURL(img.src);\n                }, 10);\n            },\n            onPaste: function (e) {\n                var self = this;\n                var html = '';\n                var plain = '';\n                self.clipboard.menuInvoked = e === undefined;\n                if (e) {\n                    var clipboardData = e.originalEvent.clipboardData;\n                    if (clipboardData && clipboardData.getData) {\n                        e.preventDefault();\n                        var hasHTML = false;\n                        var hasPlainText = false;\n                        if (window.DOMStringList && clipboardData.types instanceof window.DOMStringList) {\n                            hasHTML = clipboardData.types.contains('text/html');\n                            hasPlainText = clipboardData.types.contains('text/plain');\n                        } else {\n                            hasHTML = /text\\/html/.test(clipboardData.types);\n                            hasPlainText = /text\\/plain/.test(clipboardData.types);\n                        }\n                        if (hasHTML) {\n                            html = clipboardData.getData('text/html');\n                        }\n                        if (hasPlainText) {\n                            plain = clipboardData.getData('text/plain').trim();\n                        }\n                        if (!hasHTML && !hasPlainText && clipboardData.items && clipboardData.items.length) {\n                            for (var i = 0; i < clipboardData.items.length; ++i) {\n                                var item = clipboardData.items[i];\n                                if (item.kind == 'file' && /^image\\/(?:png|jpe?g|gif)$/i.test(item.type)) {\n                                    return self._pasteImage(item);\n                                }\n                            }\n                        }\n                    } else {\n                        var table = self.clipboardElement.find('table.kendo-clipboard-' + self.clipboard._uid).detach();\n                        self.clipboardElement.empty();\n                        setTimeout(function () {\n                            var html = self.clipboardElement.html();\n                            var plain = window.clipboardData.getData('Text').trim();\n                            if (!html && !plain) {\n                                return;\n                            }\n                            self.clipboard.external({\n                                html: html,\n                                plain: plain\n                            });\n                            self.clipboardElement.empty().append(table);\n                            self._execute({\n                                command: 'PasteCommand',\n                                options: {\n                                    workbook: self.view._workbook,\n                                    event: e.originalEvent || e\n                                }\n                            });\n                            self.clipboard.menuInvoked = true;\n                        });\n                        return;\n                    }\n                } else {\n                    if (kendo.support.browser.msie) {\n                        self.clipboardElement.focus().select();\n                        document.execCommand('paste');\n                        return;\n                    } else {\n                        self.clipboard.menuInvoked = true;\n                    }\n                }\n                if (!html && !plain) {\n                    return;\n                }\n                self.clipboard.external({\n                    html: html,\n                    plain: plain\n                });\n                self._execute({\n                    command: 'PasteCommand',\n                    options: {\n                        workbook: self.view._workbook,\n                        event: e.originalEvent || e\n                    }\n                });\n            },\n            onCopy: function (e) {\n                this.clipboard.menuInvoked = e === undefined;\n                this._execute({\n                    command: 'CopyCommand',\n                    options: {\n                        workbook: this.view._workbook,\n                        event: e.originalEvent || e\n                    }\n                });\n            },\n            scrollTop: function () {\n                this.scroller.scrollTop = 0;\n            },\n            scrollLeft: function () {\n                this.scroller.scrollLeft = 0;\n            },\n            scrollDown: function (value) {\n                this.scroller.scrollTop += value;\n            },\n            scrollRight: function (value) {\n                this.scroller.scrollLeft += value;\n            },\n            scrollWith: function (right, down) {\n                this.scroller.scrollTop += down;\n                this.scroller.scrollLeft += right;\n            },\n            translateCoords: function (location) {\n                var box = this.container[0].getBoundingClientRect();\n                return {\n                    x: location.clientX - box.left,\n                    y: location.clientY - box.top\n                };\n            },\n            objectAt: function (location, noDrawing) {\n                if (!location) {\n                    return;\n                }\n                location = this.translateCoords(location);\n                return this.view.objectAt(location.x, location.y, noDrawing);\n            },\n            selectToLocation: function (cellLocation) {\n                var object = this.objectAt(cellLocation, true);\n                if (object.pane && object.ref) {\n                    this.extendSelection(object);\n                    this.lastKnownCellLocation = cellLocation;\n                    this.originFrame = object.pane;\n                }\n                this.stopAutoScroll();\n            },\n            extendSelection: function (object) {\n                this.navigator.extendSelection(object.ref, this._selectionMode, this.appendSelection);\n            },\n            autoScroll: function () {\n                var x = this._autoScrollTarget.x;\n                var y = this._autoScrollTarget.y;\n                var boundaries = this.originFrame._grid;\n                var scroller = this.view.scroller;\n                var scrollStep = 8;\n                var scrollLeft = scroller.scrollLeft;\n                var scrollTop = scroller.scrollTop;\n                if (x < boundaries.left) {\n                    this.scrollRight(-scrollStep);\n                }\n                if (x > boundaries.right) {\n                    this.scrollRight(scrollStep);\n                }\n                if (y < boundaries.top) {\n                    this.scrollDown(-scrollStep);\n                }\n                if (y > boundaries.bottom) {\n                    this.scrollDown(scrollStep);\n                }\n                if (scrollTop === scroller.scrollTop && scrollLeft === scroller.scrollLeft) {\n                    this.selectToLocation(this.finalLocation);\n                } else {\n                    this.extendSelection(this.objectAt(this.lastKnownCellLocation));\n                }\n            },\n            startAutoScroll: function (viewObject, location) {\n                if (!this._scrollInterval) {\n                    this._scrollInterval = setInterval(this.autoScroll.bind(this), 50);\n                }\n                this.finalLocation = location || this.lastKnownCellLocation;\n                this._autoScrollTarget = viewObject;\n            },\n            stopAutoScroll: function () {\n                clearInterval(this._scrollInterval);\n                this._scrollInterval = null;\n            },\n            openCustomEditor: function () {\n                this.view.openCustomEditor();\n            },\n            openFilterMenu: function (event) {\n                var object = this.objectAt(event);\n                var sheet = this._workbook.activeSheet();\n                var column = sheet.filterColumn(object.ref);\n                var filterMenu = this.view.createFilterMenu(column);\n                filterMenu.bind('action', this.onCommandRequest.bind(this));\n                filterMenu.bind('action', filterMenu.close.bind(filterMenu));\n                filterMenu.openFor(event.target);\n            },\n            _saveEditorValue: function (arrayFormula) {\n                var sheet = this.editor._range.sheet();\n                var value = this.editor.value();\n                if (this._workbook.activeSheet() !== sheet) {\n                    this._workbook.activeSheet()._setFormulaSelections();\n                    this._workbook.activeSheet(sheet);\n                }\n                sheet.isInEditMode(false);\n                this._lastEditorValue = value;\n                this._execute({\n                    command: 'EditCommand',\n                    options: {\n                        value: value,\n                        arrayFormula: arrayFormula\n                    }\n                });\n            },\n            onEditorChange: function () {\n                this._saveEditorValue(false);\n            },\n            onEditorArrayFormula: function () {\n                this._saveEditorValue(true);\n                this.editor.deactivate(true);\n            },\n            onEditorActivate: function () {\n                var workbook = this._workbook;\n                var sheet = workbook.activeSheet();\n                sheet._setFormulaSelections(this.editor.highlightedRefs());\n                sheet.isInEditMode(true);\n            },\n            onEditorDeactivate: function () {\n                var sheet = this._workbook.activeSheet();\n                sheet.isInEditMode(false);\n                sheet._setFormulaSelections([]);\n            },\n            onEditorUpdate: function () {\n                this._workbook.activeSheet()._setFormulaSelections(this.editor.highlightedRefs());\n            },\n            onEditorBarFocus: function () {\n                var disabled = this._workbook.activeSheet().selection().enable() === false;\n                if (disabled) {\n                    return;\n                }\n                this.editor.activate({\n                    range: this._workbook.activeSheet().selection(),\n                    rect: this.view.activeCellRectangle(),\n                    tooltip: this._activeTooltip()\n                });\n            },\n            onEditorCellFocus: function () {\n                this.editor.scale();\n            },\n            onEditorEsc: function () {\n                this.resetEditorValue();\n                this.editor.deactivate();\n                this.clipboardElement.focus();\n            },\n            insertNewline: function (e) {\n                e.preventDefault();\n                this.editor.insertNewline();\n            },\n            onEditorBlur: function (_, action) {\n                if (this.editor.isFiltered()) {\n                    return;\n                }\n                this._preventNavigation = false;\n                this.editor.deactivate();\n                if (!this._preventNavigation) {\n                    this.clipboardElement.focus();\n                    this.navigator.navigateInSelection(ENTRY_ACTIONS[action]);\n                }\n            },\n            onEditorAction: function (event, action) {\n                var editor = this.editor;\n                var sheet = this._workbook.activeSheet();\n                if (this._casualEditing && /^(?:up|right|down|left)$/.test(action)) {\n                    this.deactivateEditor();\n                    this.navigator.moveActiveCell(ACTIONS[action]);\n                    event.preventDefault();\n                } else if (editor.canInsertRef(true)) {\n                    this.navigator.moveActiveCell(ACTIONS[action]);\n                    editor.activeEditor().refAtPoint(sheet);\n                    sheet._setFormulaSelections(editor.highlightedRefs());\n                    event.preventDefault();\n                }\n            },\n            onEditorShiftAction: function (event, action) {\n                var editor = this.editor;\n                var sheet = this._workbook.activeSheet();\n                if (editor.canInsertRef(true)) {\n                    this.navigator.modifySelection(ACTIONS[action.replace('shift+', '')], this.appendSelection);\n                    editor.activeEditor().refAtPoint(sheet);\n                    sheet._setFormulaSelections(editor.highlightedRefs());\n                    event.preventDefault();\n                }\n            },\n            resetEditorValue: function () {\n                var sheet = this._workbook.activeSheet();\n                var ref = sheet.activeCell();\n                var input = this._workbook._inputForRef(ref);\n                var x = sheet.range(ref).intersectingArrayFormula();\n                if (x) {\n                    input = '=' + x.formula;\n                }\n                this.editor.value(input, !!x);\n            },\n            activateEditor: function (casual) {\n                this._casualEditing = casual;\n                this.editor.activate({\n                    range: this._workbook.activeSheet().selection(),\n                    rect: this.view.activeCellRectangle(),\n                    tooltip: this._activeTooltip()\n                }).focus();\n            },\n            deactivateEditor: function () {\n                this.view.editor.deactivate();\n            },\n            onCommandRequest: function (e) {\n                if (e.command) {\n                    this._execute(e);\n                } else {\n                    this._workbook.undoRedoStack[e.action]();\n                }\n            },\n            onDialogRequest: function (e) {\n                var additionalOptions = {\n                    pdfExport: this._workbook.options.pdf,\n                    excelExport: this._workbook.options.excel\n                };\n                if (e.options) {\n                    $.extend(true, e.options, additionalOptions);\n                } else {\n                    e.options = additionalOptions;\n                }\n                this.view.openDialog(e.name, e.options);\n            },\n            onNameEditorEnter: function () {\n                var ref;\n                var workbook = this._workbook;\n                var sheet = workbook.activeSheet();\n                var name = this.view.nameEditor.value();\n                ref = kendo.spreadsheet.calc.parseReference(name, true) || workbook.nameValue(name);\n                if (ref instanceof kendo.spreadsheet.Ref) {\n                    if (ref.sheet && ref.sheet.toLowerCase() != sheet.name().toLowerCase()) {\n                        var tmp = workbook.sheetByName(ref.sheet);\n                        if (tmp) {\n                            workbook.activeSheet(tmp);\n                            sheet = tmp;\n                        }\n                    }\n                    sheet.range(ref).select();\n                    return;\n                }\n                ref = sheet.selection()._ref.clone().simplify().setSheet(sheet.name(), true);\n                this._execute({\n                    command: 'DefineNameCommand',\n                    options: {\n                        name: name,\n                        value: ref\n                    }\n                });\n                this.clipboardElement.focus();\n            },\n            onNameEditorCancel: function () {\n                this.clipboardElement.focus();\n            },\n            onNameEditorSelect: function (ev) {\n                var name = ev.name;\n                var workbook = this._workbook;\n                var sheet = workbook.activeSheet();\n                var ref = workbook.nameValue(name);\n                if (ref instanceof kendo.spreadsheet.Ref) {\n                    if (ref.sheet && ref.sheet.toLowerCase() != sheet.name().toLowerCase()) {\n                        var tmp = workbook.sheetByName(ref.sheet);\n                        if (tmp) {\n                            workbook.activeSheet(tmp);\n                            sheet = tmp;\n                        }\n                    }\n                    sheet.range(ref).select();\n                    return;\n                }\n                this.clipboardElement.focus();\n            },\n            onNameEditorDelete: function (ev) {\n                this._execute({\n                    command: 'DeleteNameCommand',\n                    options: { name: ev.name }\n                });\n                this.clipboardElement.focus();\n            }\n        });\n        kendo.spreadsheet.Controller = Controller;\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/view', [\n        'kendo.core',\n        'kendo.menu',\n        'spreadsheet/sheetsbar',\n        'util/main'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var DOT = '.';\n        var RESIZE_HANDLE_WIDTH = 7;\n        var EDIT_BUTTON_WIDTH = 20;\n        var viewClassNames = {\n            view: 'k-spreadsheet-view',\n            fixedContainer: 'k-spreadsheet-fixed-container',\n            editContainer: 'k-spreadsheet-edit-container',\n            scroller: 'k-spreadsheet-scroller',\n            viewSize: 'k-spreadsheet-view-size',\n            clipboard: 'k-spreadsheet-clipboard',\n            cellEditor: 'k-spreadsheet-cell-editor',\n            barEditor: 'k-spreadsheet-editor',\n            topCorner: 'k-spreadsheet-top-corner',\n            filterHeadersWrapper: 'k-filter-wrapper',\n            filterRange: 'k-filter-range',\n            filterButton: 'k-spreadsheet-filter',\n            filterButtonActive: 'k-state-active',\n            horizontalResize: 'k-horizontal-resize',\n            verticalResize: 'k-vertical-resize',\n            icon: 'k-icon',\n            iconFilterDefault: 'k-i-arrow-60-down',\n            sheetsBar: 'k-spreadsheet-sheets-bar',\n            sheetsBarActive: 'k-spreadsheet-sheets-bar-active',\n            sheetsBarInactive: 'k-spreadsheet-sheets-bar-inactive',\n            cellContextMenu: 'k-spreadsheet-cell-context-menu',\n            rowHeaderContextMenu: 'k-spreadsheet-row-header-context-menu',\n            colHeaderContextMenu: 'k-spreadsheet-col-header-context-menu',\n            drawingContextMenu: 'k-spreadsheet-drawing-context-menu'\n        };\n        kendo.spreadsheet.messages.view = {\n            nameBox: 'Name Box',\n            errors: {\n                openUnsupported: 'Unsupported format. Please select an .xlsx file.',\n                shiftingNonblankCells: 'Cannot insert cells due to data loss possibility. Select another insert location or delete the data from the end of your worksheet.',\n                insertColumnWhenRowIsSelected: 'Cannot insert column when all columns are selected.',\n                insertRowWhenColumnIsSelected: 'Cannot insert row when all rows are selected.',\n                filterRangeContainingMerges: 'Cannot create a filter within a range containing merges',\n                sortRangeContainingMerges: 'Cannot sort a range containing merges',\n                cantSortMultipleSelection: 'Cannot sort multiple selection',\n                cantSortNullRef: 'Cannot sort empty selection',\n                cantSortMixedCells: 'Cannot sort range containing cells of mixed shapes',\n                validationError: 'The value that you entered violates the validation rules set on the cell.',\n                cannotModifyDisabled: 'Cannot modify disabled cells.'\n            },\n            tabs: {\n                home: 'Home',\n                insert: 'Insert',\n                data: 'Data'\n            }\n        };\n        kendo.spreadsheet.messages.menus = {\n            'cut': 'Cut',\n            'copy': 'Copy',\n            'paste': 'Paste',\n            'merge': 'Merge',\n            'unmerge': 'Unmerge',\n            'delete': 'Delete',\n            'hide': 'Hide',\n            'unhide': 'Unhide',\n            'bringToFront': 'Bring to front',\n            'sendToBack': 'Send to back'\n        };\n        function selectElementContents(el) {\n            var sel = window.getSelection();\n            sel.removeAllRanges();\n            var range = document.createRange();\n            range.selectNodeContents(el);\n            sel.addRange(range);\n        }\n        function cellBefore(table, row) {\n            var cells = table.trs[row].children;\n            return cells[cells.length - 2];\n        }\n        function cellAbove(table, row) {\n            var prevRow = table.trs[row - 1];\n            var index = table.trs[row].children.length - 1;\n            if (prevRow && index >= 0) {\n                return prevRow.children[index];\n            }\n        }\n        function cellBorder(value) {\n            return (value.size || 1) + 'px solid ' + (value.color || '#000');\n        }\n        function asURL(link) {\n            if (!/:\\/\\//.test(link)) {\n                link = 'http://' + link;\n            }\n            return link;\n        }\n        function drawCell(collection, cell, cls, showGrid) {\n            function maybeLink(el) {\n                var link = cell.link;\n                if (!link) {\n                    if (typeof cell.value == 'object') {\n                        link = cell.value.link;\n                    }\n                }\n                if (link) {\n                    var style = { textDecoration: 'none' };\n                    if (cell.color) {\n                        style.color = cell.color;\n                    }\n                    if (cell.underline) {\n                        style.textDecoration = 'underline';\n                    }\n                    return kendo.dom.element('a', {\n                        href: asURL(link),\n                        style: style,\n                        target: '_blank'\n                    }, el ? [el] : []);\n                }\n                return el;\n            }\n            var shouldDraw = cell.value != null || cell.validation != null && !cell.validation.value || cell.background || cell.merged || cell.comment;\n            if (!cls && !shouldDraw) {\n                return;\n            }\n            var style = {};\n            var background = cell.background;\n            if (background) {\n                var defaultBorder = background;\n                if (showGrid) {\n                    defaultBorder = kendo.parseColor(defaultBorder).toHSV();\n                    defaultBorder.v *= 0.9;\n                    defaultBorder = defaultBorder.toCssRgba();\n                }\n                defaultBorder = cellBorder({ color: defaultBorder });\n                style.outline = defaultBorder;\n            }\n            if (background) {\n                style.backgroundColor = background;\n            }\n            if (cell.color) {\n                style.color = cell.color;\n            }\n            if (cell.fontFamily) {\n                style.fontFamily = cell.fontFamily;\n            }\n            if (cell.underline) {\n                style.textDecoration = 'underline';\n            }\n            if (cell.italic) {\n                style.fontStyle = 'italic';\n            }\n            if (cell.textAlign) {\n                style.textAlign = cell.textAlign;\n            }\n            if (cell.bold) {\n                style.fontWeight = 'bold';\n            }\n            if (cell.fontSize) {\n                style.fontSize = cell.fontSize + 'px';\n            }\n            if (cell.wrap === true) {\n                style.whiteSpace = 'pre-wrap';\n                style.overflowWrap = 'break-word';\n                style.wordWrap = 'break-word';\n            } else {\n                style.whiteSpace = 'pre';\n                style.overflowWrap = 'normal';\n                style.wordWrap = 'normal';\n            }\n            style.left = cell.left + 1 + 'px';\n            style.top = cell.top + 1 + 'px';\n            style.width = cell.width - 1 + 'px';\n            style.height = cell.height - 1 + 'px';\n            var data = cell.value, type = typeof data, format = cell.format;\n            if (!format && type == 'number' && data != Math.floor(data)) {\n                format = '0.##############';\n            }\n            if (format && data != null) {\n                data = kendo.spreadsheet.formatting.format(data, format);\n                if (data.__dataType) {\n                    type = data.__dataType;\n                }\n            } else if (data !== null && data !== undefined) {\n                data = kendo.dom.text(data);\n            }\n            if (!style.textAlign) {\n                switch (type) {\n                case 'number':\n                case 'date':\n                case 'percent':\n                case 'currency':\n                    style.textAlign = 'right';\n                    break;\n                case 'boolean':\n                    style.textAlign = 'center';\n                    break;\n                }\n            }\n            kendo.spreadsheet.draw.applyIndent(cell, style);\n            var classNames = [paneClassNames.cell];\n            if (cls) {\n                classNames.push(cls);\n            }\n            if (cell.enable === false) {\n                classNames.push('k-state-disabled');\n            }\n            if (cell.merged) {\n                classNames.push('k-spreadsheet-merged-cell');\n            }\n            if (cell.comment) {\n                classNames.push('k-spreadsheet-has-comment');\n            }\n            var verticalAlign = cell.verticalAlign || 'bottom';\n            if (verticalAlign && data) {\n                data = kendo.dom.element('div', { className: 'k-vertical-align-' + verticalAlign }, [maybeLink(data)]);\n            } else {\n                data = maybeLink(data);\n            }\n            var children = data ? [data] : [];\n            var properties = { style: style };\n            var validation = cell.validation;\n            if (validation && !validation.value) {\n                children.push(kendo.dom.element('span', { className: 'k-dirty' }));\n                classNames.push('k-dirty-cell');\n                properties.title = validation.message;\n            }\n            properties.className = classNames.join(' ');\n            var div = kendo.dom.element('div', properties, children);\n            collection.push(div);\n            return div;\n        }\n        function addCell(table, row, cell) {\n            var style = {};\n            if (cell.background) {\n                style.backgroundColor = cell.background;\n            }\n            if (cell.color) {\n                style.color = cell.color;\n            }\n            if (cell.fontFamily) {\n                style.fontFamily = cell.fontFamily;\n            }\n            if (cell.underline) {\n                style.textDecoration = 'underline';\n            }\n            if (cell.italic) {\n                style.fontStyle = 'italic';\n            }\n            if (cell.textAlign) {\n                style.textAlign = cell.textAlign;\n            }\n            if (cell.verticalAlign) {\n                style.verticalAlign = cell.verticalAlign === 'center' ? 'middle' : cell.verticalAlign;\n            }\n            if (cell.bold) {\n                style.fontWeight = 'bold';\n            }\n            if (cell.fontSize) {\n                style.fontSize = cell.fontSize + 'px';\n            }\n            if (cell.wrap === true) {\n                style.whiteSpace = 'pre-wrap';\n            }\n            if (cell.borderRight) {\n                style.borderRight = cellBorder(cell.borderRight);\n            } else if (cell.background) {\n                style.borderRightColor = cell.background;\n            }\n            if (cell.borderBottom) {\n                style.borderBottom = cellBorder(cell.borderBottom);\n            } else if (cell.background) {\n                style.borderBottomColor = cell.background;\n            }\n            var data = cell.value, type = typeof data, format = cell.format;\n            if (!format && type == 'number' && data != Math.floor(data)) {\n                format = '0.##############';\n            }\n            if (format && data != null) {\n                data = kendo.spreadsheet.formatting.format(data, format);\n                if (data.__dataType) {\n                    type = data.__dataType;\n                }\n            }\n            if (!style.textAlign) {\n                switch (type) {\n                case 'number':\n                case 'date':\n                case 'percent':\n                case 'currency':\n                    style.textAlign = 'right';\n                    break;\n                case 'boolean':\n                    style.textAlign = 'center';\n                    break;\n                }\n            }\n            var className = null;\n            if (cell.enable === false) {\n                className = 'k-state-disabled';\n            }\n            var td = table.addCell(row, data, style, className, cell.validation);\n            var border, sibling;\n            if (cell.borderLeft) {\n                sibling = cellBefore(table, row);\n                border = cellBorder(cell.borderLeft);\n                if (sibling && border) {\n                    sibling.attr.style.borderRight = border;\n                }\n            } else if (cell.background) {\n                style.borderLeftColor = cell.background;\n            }\n            if (cell.borderTop) {\n                sibling = cellAbove(table, row);\n                border = cellBorder(cell.borderTop);\n                if (sibling && border) {\n                    sibling.attr.style.borderBottom = border;\n                }\n            } else if (cell.background) {\n                style.borderTopColor = cell.background;\n            }\n            return td;\n        }\n        var HtmlTable = kendo.Class.extend({\n            init: function () {\n                this.cols = [];\n                this.trs = [];\n                this._height = 0;\n                this._width = 0;\n            },\n            addColumn: function (width) {\n                this._width += width;\n                var col = kendo.dom.element('col', { style: { width: width + 'px' } });\n                col.visible = width > 0;\n                this.cols.push(col);\n            },\n            addRow: function (height) {\n                var attr = null;\n                attr = { style: { height: height + 'px' } };\n                this._height += height;\n                var tr = kendo.dom.element('tr', attr);\n                tr.visible = height > 0;\n                this.trs.push(tr);\n            },\n            addCell: function (rowIndex, text, style, className, validation) {\n                if (text === null || text === undefined) {\n                    text = '';\n                }\n                if (!(text instanceof kendo.dom.Node)) {\n                    text = kendo.dom.text(text);\n                }\n                var children = [text];\n                var properties = { style: style };\n                if (validation && !validation.value) {\n                    children.push(kendo.dom.element('span', { className: 'k-dirty' }));\n                    className = (className || '') + (className ? ' ' : '') + 'k-dirty-cell';\n                    properties.title = validation.message;\n                }\n                if (className) {\n                    properties.className = className;\n                }\n                var td = kendo.dom.element('td', properties, children);\n                this.trs[rowIndex].children.push(td);\n                return td;\n            },\n            toDomTree: function (x, y, className) {\n                this.trs = this.trs.filter(function (tr) {\n                    return tr.visible;\n                });\n                var offset = 0;\n                this.cols = this.cols.filter(function (col, ci) {\n                    if (!col.visible) {\n                        this.trs.forEach(function (tr) {\n                            tr.children.splice(ci - offset, 1);\n                        });\n                        offset++;\n                    }\n                    return col.visible;\n                }, this);\n                return kendo.dom.element('table', {\n                    style: {\n                        left: x + 'px',\n                        top: y + 'px',\n                        height: this._height + 'px',\n                        width: this._width + 'px'\n                    },\n                    className: className\n                }, [\n                    kendo.dom.element('colgroup', null, this.cols),\n                    kendo.dom.element('tbody', null, this.trs)\n                ]);\n            }\n        });\n        var CELL_CONTEXT_MENU = '<ul class=\"#=classNames.cellContextMenu#\">' + '<li data-action=cut>#: messages.cut #</li>' + '<li data-action=copy>#: messages.copy #</li>' + '<li data-action=paste>#: messages.paste #</li>' + '<li class=\"k-separator\"></li>' + '<li data-action=merge>#: messages.merge #</li>' + '<li data-action=unmerge>#: messages.unmerge #</li>' + '</ul>';\n        var ROW_HEADER_CONTEXT_MENU = '<ul class=\"#=classNames.rowHeaderContextMenu#\">' + '<li data-action=cut>#: messages.cut #</li>' + '<li data-action=copy>#: messages.copy #</li>' + '<li data-action=paste>#: messages.paste #</li>' + '<li class=\"k-separator\"></li>' + '<li data-action=\"delete-row\">#: messages.delete #</li>' + '<li data-action=\"hide-row\">#: messages.hide #</li>' + '<li data-action=\"unhide-row\">#: messages.unhide #</li>' + '</ul>';\n        var COL_HEADER_CONTEXT_MENU = '<ul class=\"#=classNames.colHeaderContextMenu#\">' + '<li data-action=cut>#: messages.cut #</li>' + '<li data-action=copy>#: messages.copy #</li>' + '<li data-action=paste>#: messages.paste #</li>' + '<li class=\"k-separator\"></li>' + '<li data-action=\"delete-column\">#: messages.delete #</li>' + '<li data-action=\"hide-column\">#: messages.hide #</li>' + '<li data-action=\"unhide-column\">#: messages.unhide #</li>' + '</ul>';\n        var DRAWING_CONTEXT_MENU = '<ul class=\"#=classNames.drawingContextMenu#\">' + '<li data-action=\"bring-to-front\">#: messages.bringToFront #</li>' + '<li data-action=\"send-to-back\">#: messages.sendToBack #</li>' + '<li class=\"k-separator\"></li>' + '<li data-action=\"delete-drawing\">#: messages.delete #</li>' + '</ul>';\n        kendo.spreadsheet.ContextMenu = kendo.ui.ContextMenu;\n        var VIEW_CONTENTS = kendo.template('<div class=\"#=classNames.view#\"><div class=\"#=classNames.fixedContainer#\"></div><div class=\"#=classNames.scroller#\"><div class=\"#=classNames.viewSize#\"></div></div>' + '<div tabindex=\"0\" class=\"#=classNames.clipboard#\" contenteditable=true></div><div class=\"#=classNames.cellEditor#\"></div></div><div class=\"#=classNames.sheetsBar#\"></div>' + CELL_CONTEXT_MENU + ROW_HEADER_CONTEXT_MENU + COL_HEADER_CONTEXT_MENU + DRAWING_CONTEXT_MENU);\n        function within(value, min, max) {\n            return value >= min && value <= max;\n        }\n        var View = kendo.Class.extend({\n            init: function (element, options) {\n                var classNames = View.classNames;\n                this.element = element;\n                this.options = $.extend(true, { messages: kendo.spreadsheet.messages.view }, this.options, options);\n                this._chrome();\n                this._dialogs = [];\n                element.append(VIEW_CONTENTS({\n                    classNames: classNames,\n                    messages: kendo.spreadsheet.messages.menus\n                }));\n                this._formulaInput();\n                this.wrapper = element.find(DOT + classNames.view);\n                this.container = element.find(DOT + classNames.fixedContainer)[0];\n                this.scroller = element.find(DOT + classNames.scroller)[0];\n                this.clipboard = element.find(DOT + classNames.clipboard);\n                this.viewSize = $(this.scroller.firstChild);\n                this.tree = new kendo.dom.Tree(this.container);\n                this.clipboardContents = new kendo.dom.Tree(this.clipboard[0]);\n                this.editor = new kendo.spreadsheet.SheetEditor(this);\n                this._sheetsbar();\n                var contextMenuConfig = {\n                    target: element,\n                    animation: false,\n                    showOn: 'never'\n                };\n                this.cellContextMenu = new kendo.spreadsheet.ContextMenu(element.find(DOT + classNames.cellContextMenu), contextMenuConfig);\n                this.colHeaderContextMenu = new kendo.spreadsheet.ContextMenu(element.find(DOT + classNames.colHeaderContextMenu), contextMenuConfig);\n                this.rowHeaderContextMenu = new kendo.spreadsheet.ContextMenu(element.find(DOT + classNames.rowHeaderContextMenu), contextMenuConfig);\n                this.drawingContextMenu = new kendo.spreadsheet.ContextMenu(element.find(DOT + classNames.drawingContextMenu), contextMenuConfig);\n            },\n            enableClipboard: function (enable) {\n                this.isClipboardDeactivated = !enable;\n                if (enable) {\n                    this.clipboard.attr('contenteditable', enable);\n                } else {\n                    this.clipboard.removeAttr('contenteditable');\n                }\n            },\n            _resize: function () {\n                var actionBar = $(this.formulaBar.element).parents('.k-spreadsheet-action-bar');\n                var outerHeight = kendo._outerHeight;\n                var tabstripHeight = this.tabstrip ? outerHeight(this.tabstrip.element) : 0;\n                var formulaBarHeight = actionBar ? outerHeight(actionBar) : 0;\n                var sheetsBarHeight = this.sheetsbar ? outerHeight(this.sheetsbar.element) : 0;\n                this.wrapper.height(this.element.height() - (tabstripHeight + formulaBarHeight + sheetsBarHeight));\n                if (this.tabstrip) {\n                    this.tabstrip.quickAccessAdjust();\n                }\n            },\n            _chrome: function () {\n                var wrapper = $('<div class=\\'k-spreadsheet-action-bar\\' />').prependTo(this.element);\n                var nameEditor = $('<div class=\\'k-spreadsheet-name-editor\\' />').appendTo(wrapper);\n                this.nameEditor = new kendo.spreadsheet.NameEditor(nameEditor, this.options);\n                var formulaBar = $('<div />').appendTo(wrapper);\n                this.formulaBar = new kendo.spreadsheet.FormulaBar(formulaBar);\n                if (this.options.toolbar) {\n                    this._tabstrip();\n                }\n            },\n            _formulaInput: function () {\n                var editor = this.element.find(DOT + View.classNames.cellEditor);\n                this.formulaInput = new kendo.spreadsheet.FormulaInput(editor, { autoScale: true });\n            },\n            _sheetsbar: function () {\n                if (this.options.sheetsbar) {\n                    var options = $.extend(true, { openDialog: this.openDialog.bind(this) }, this.options.sheetsbar);\n                    this.sheetsbar = new kendo.spreadsheet.SheetsBar(this.element.find(DOT + View.classNames.sheetsBar), options);\n                }\n            },\n            _tabstrip: function () {\n                var messages = this.options.messages.tabs;\n                var options = $.extend(true, {\n                    home: true,\n                    insert: true,\n                    data: true\n                }, this.options.toolbar);\n                var tabs = [];\n                if (this.tabstrip) {\n                    this.tabstrip.destroy();\n                    this.element.children('.k-tabstrip').remove();\n                }\n                for (var name in options) {\n                    if (options[name] === true || options[name] instanceof Array) {\n                        tabs.push({\n                            id: name,\n                            text: messages[name],\n                            content: ''\n                        });\n                    }\n                }\n                this.tabstrip = new kendo.spreadsheet.TabStrip($('<div />').prependTo(this.element), {\n                    animation: false,\n                    dataTextField: 'text',\n                    dataContentField: 'content',\n                    dataSource: tabs,\n                    toolbarOptions: options,\n                    view: this\n                });\n                this.tabstrip.select(0);\n            },\n            _executeCommand: function (e) {\n                this._sheet.trigger('commandRequest', e);\n            },\n            workbook: function (workbook) {\n                this._workbook = workbook;\n                workbook._view = this;\n                this.nameEditor._workbook = workbook;\n            },\n            sheet: function (sheet) {\n                this._sheet = sheet;\n            },\n            activeCellRectangle: function () {\n                return this.cellRectangle(this._sheet._viewActiveCell());\n            },\n            _rectangle: function (pane, ref) {\n                return pane._grid.boundingRectangle(ref.toRangeRef());\n            },\n            isColumnResizer: function (x, pane, col) {\n                x -= this._sheet._grid._headerWidth;\n                if (!pane._grid.columns.frozen) {\n                    x += this.scroller.scrollLeft;\n                }\n                col = this._sheet._grid._columns.locate(0, col, function (w) {\n                    return Math.abs(x - w) <= RESIZE_HANDLE_WIDTH / 2;\n                });\n                return col !== null && !this._sheet.isHiddenColumn(col) ? col : null;\n            },\n            isRowResizer: function (y, pane, row) {\n                y -= this._sheet._grid._headerHeight;\n                if (!pane._grid.rows.frozen) {\n                    y += this.scroller.scrollTop;\n                }\n                row = this._sheet._grid._rows.locate(0, row, function (h) {\n                    return Math.abs(y - h) <= RESIZE_HANDLE_WIDTH / 2;\n                });\n                return row !== null && !this._sheet.isHiddenRow(row) ? row : null;\n            },\n            isFilterIcon: function (x, y, pane, ref) {\n                var self = this;\n                var theGrid = pane._grid;\n                var scrollTop = theGrid.rows.frozen ? 0 : self.scroller.scrollTop;\n                var scrollLeft = theGrid.columns.frozen ? 0 : self.scroller.scrollLeft;\n                x -= self._sheet._grid._headerWidth - scrollLeft;\n                y -= self._sheet._grid._headerHeight - scrollTop;\n                return kendo.util.withExit(function (exit) {\n                    self._sheet.forEachFilterHeader(ref, function (ref) {\n                        var rect = self._rectangle(pane, ref);\n                        if (pane.filterIconRect(rect).intersects(x, y)) {\n                            exit(true);\n                        }\n                    });\n                });\n            },\n            isAutoFill: function (x, y, pane) {\n                var selection = this._sheet.select();\n                if (selection.size > 1) {\n                    return false;\n                }\n                x -= this._sheet._grid._headerWidth;\n                y -= this._sheet._grid._headerHeight;\n                if (!pane._grid.columns.frozen) {\n                    x += this.scroller.scrollLeft;\n                }\n                if (!pane._grid.rows.frozen) {\n                    y += this.scroller.scrollTop;\n                }\n                var rectangle = this._rectangle(pane, selection);\n                return Math.abs(rectangle.right - x) < 8 && Math.abs(rectangle.bottom - y) < 8;\n            },\n            isEditButton: function (x, y, pane) {\n                var ed = this._sheet.activeCellCustomEditor();\n                if (ed) {\n                    var r = this.activeCellRectangle();\n                    if (y >= r.top && y <= r.bottom) {\n                        return pane._editorInLastColumn ? x < r.left && x >= r.left - EDIT_BUTTON_WIDTH : x > r.right && x <= r.right + EDIT_BUTTON_WIDTH;\n                    }\n                }\n            },\n            drawingAt: function (x, y, pane) {\n                x -= this._sheet._grid._headerWidth;\n                y -= this._sheet._grid._headerHeight;\n                if (!pane._grid.columns.frozen) {\n                    x += this.scroller.scrollLeft;\n                }\n                if (!pane._grid.rows.frozen) {\n                    y += this.scroller.scrollTop;\n                }\n                var sheet = this._sheet;\n                var drawings = this._sheet._drawings;\n                for (var i = drawings.length; --i >= 0;) {\n                    var d = drawings[i];\n                    var box = sheet.drawingBoundingBox(d);\n                    if (box.intersects(x, y)) {\n                        return {\n                            drawing: d,\n                            drx: box.left - x,\n                            dry: box.top - y\n                        };\n                    }\n                }\n            },\n            objectAt: function (x, y, noDrawing) {\n                var grid = this._sheet._grid;\n                var object, pane;\n                if (x < 0 || y < 0 || x > this.scroller.clientWidth || y > this.scroller.clientHeight) {\n                    object = { type: 'outside' };\n                } else if (x < grid._headerWidth && y < grid._headerHeight) {\n                    object = { type: 'topcorner' };\n                } else {\n                    pane = this.paneAt(x, y);\n                    if (!pane) {\n                        object = { type: 'outside' };\n                    } else {\n                        if (!noDrawing) {\n                            var drawing = this.drawingAt(x, y, pane);\n                            if (drawing) {\n                                return {\n                                    type: 'drawing',\n                                    drawing: drawing.drawing,\n                                    drx: drawing.drx,\n                                    dry: drawing.dry,\n                                    pane: pane,\n                                    startX: x,\n                                    startY: y\n                                };\n                            }\n                        }\n                        var row = pane._grid.rows.indexVisible(y, this.scroller.scrollTop);\n                        var column = pane._grid.columns.indexVisible(x, this.scroller.scrollLeft);\n                        var type = 'cell';\n                        var ref = new CellRef(row, column);\n                        var selecting = this._sheet.selectionInProgress();\n                        if (this.isAutoFill(x, y, pane)) {\n                            type = 'autofill';\n                        } else if (this.isFilterIcon(x, y, pane, ref)) {\n                            type = 'filtericon';\n                        } else if (!selecting && x < grid._headerWidth) {\n                            type = 'rowheader';\n                            if ((row = this.isRowResizer(y, pane, row)) !== null) {\n                                ref = new CellRef(row, -Infinity);\n                                type = 'rowresizehandle';\n                            }\n                        } else if (!selecting && y < grid._headerHeight) {\n                            type = 'columnheader';\n                            if ((column = this.isColumnResizer(x, pane, column)) !== null) {\n                                ref = new CellRef(-Infinity, column);\n                                type = 'columnresizehandle';\n                            }\n                        } else if (this.isEditButton(x, y, pane)) {\n                            type = 'editor';\n                        }\n                        if (type == 'cell') {\n                            this._sheet.forEachMergedCell(ref, function (merged) {\n                                ref = merged.topLeft;\n                            });\n                        }\n                        object = {\n                            type: type,\n                            ref: ref\n                        };\n                    }\n                }\n                object.pane = pane;\n                object.x = x;\n                object.y = y;\n                return object;\n            },\n            paneAt: function (x, y) {\n                return this.panes.filter(function paneLocationWithin(pane) {\n                    var grid = pane._grid;\n                    return within(y, grid.top, grid.bottom) && within(x, grid.left, grid.right);\n                })[0];\n            },\n            containingPane: function (cell) {\n                return this.panes.filter(function (pane) {\n                    if (pane._grid.contains(cell)) {\n                        return true;\n                    }\n                    return false;\n                })[0];\n            },\n            cellRectangle: function (cell) {\n                var theGrid = this.containingPane(cell)._grid;\n                var rectangle = this._sheet._grid.rectangle(cell);\n                return rectangle.offset(theGrid.headerWidth - (theGrid.columns.frozen ? 0 : this.scroller.scrollLeft), theGrid.headerHeight - (theGrid.rows.frozen ? 0 : this.scroller.scrollTop));\n            },\n            refresh: function (reason) {\n                var sheet = this._sheet;\n                if (this.tabstrip) {\n                    this.tabstrip.refreshTools(sheet.range(sheet.activeCell()));\n                }\n                if (reason.sheetSelection && this.sheetsbar) {\n                    this.sheetsbar.renderSheets(this._workbook.sheets(), this._workbook.sheetIndex(this._sheet));\n                }\n                this._resize();\n                this.viewSize[0].style.height = sheet._grid.totalHeight() + 'px';\n                this.viewSize[0].style.width = sheet._grid.totalWidth() + 'px';\n                if (reason.layout) {\n                    var frozenColumns = sheet.frozenColumns();\n                    var frozenRows = sheet.frozenRows();\n                    this.panes = [this._pane(frozenRows, frozenColumns)];\n                    if (frozenColumns > 0) {\n                        this.panes.push(this._pane(frozenRows, 0, null, frozenColumns));\n                    }\n                    if (frozenRows > 0) {\n                        this.panes.push(this._pane(0, frozenColumns, frozenRows, null));\n                    }\n                    if (frozenRows > 0 && frozenColumns > 0) {\n                        this.panes.push(this._pane(0, 0, frozenRows, frozenColumns));\n                    }\n                }\n                if (reason.filter) {\n                    this._destroyFilterMenu();\n                }\n                if (reason.activeCell) {\n                    this._focus = sheet.activeCell().toRangeRef();\n                }\n            },\n            createFilterMenu: function (column) {\n                if (this._filterMenu && this._filterMenu.options.column == column) {\n                    return this._filterMenu;\n                }\n                this._destroyFilterMenu();\n                var sheet = this._sheet;\n                var ref = sheet.filter().ref;\n                var range = new kendo.spreadsheet.Range(ref, sheet);\n                var element = $('<div />').appendTo(this.element);\n                var options = {\n                    column: column,\n                    range: range\n                };\n                var filterMenu = new kendo.spreadsheet.FilterMenu(element, options);\n                this._filterMenu = filterMenu;\n                return filterMenu;\n            },\n            selectClipboardContents: function () {\n                if (!this.isClipboardDeactivated) {\n                    this.clipboard.focus();\n                    selectElementContents(this.clipboard[0]);\n                }\n            },\n            scrollIntoView: function (cell) {\n                var willScroll = false;\n                var theGrid = this.containingPane(cell)._grid;\n                var boundaries = theGrid.scrollBoundaries(cell);\n                var scroller = this.scroller;\n                var scrollTop = theGrid.rows.frozen ? 0 : scroller.scrollTop;\n                var scrollLeft = theGrid.columns.frozen ? 0 : scroller.scrollLeft;\n                if (boundaries.top < scrollTop) {\n                    willScroll = true;\n                    scroller.scrollTop = boundaries.scrollTop;\n                }\n                if (boundaries.bottom > scrollTop) {\n                    willScroll = true;\n                    scroller.scrollTop = boundaries.scrollBottom;\n                }\n                if (boundaries.left < scrollLeft) {\n                    willScroll = true;\n                    scroller.scrollLeft = boundaries.scrollLeft;\n                }\n                if (boundaries.right > scrollLeft) {\n                    willScroll = true;\n                    scroller.scrollLeft = boundaries.scrollRight;\n                }\n                return willScroll;\n            },\n            _destroyDialog: function () {\n                this._dialogs.pop();\n            },\n            openCustomEditor: function () {\n                var self = this;\n                var cell = self._sheet.activeCell().first();\n                var editor = self._sheet.activeCellCustomEditor();\n                var range = self._sheet.range(cell);\n                editor.edit({\n                    range: range,\n                    rect: self.activeCellRectangle(),\n                    view: this,\n                    validation: this._sheet.validation(cell),\n                    callback: function (value, parse) {\n                        self._executeCommand({\n                            command: 'EditCommand',\n                            options: {\n                                operatingRange: range,\n                                property: parse ? 'input' : 'value',\n                                value: value\n                            }\n                        });\n                    }\n                });\n            },\n            openDialog: function (name, options) {\n                var sheet = this._sheet;\n                return sheet.withCultureDecimals(function () {\n                    var dialog = kendo.spreadsheet.dialogs.create(name, options);\n                    if (dialog) {\n                        dialog.bind('action', this._executeCommand.bind(this));\n                        dialog.bind('deactivate', this._destroyDialog.bind(this));\n                        this._dialogs.push(dialog);\n                        var ref = sheet.activeCell();\n                        var range = new kendo.spreadsheet.Range(ref, sheet);\n                        dialog.open(range);\n                        return dialog;\n                    }\n                }.bind(this));\n            },\n            showError: function (options, reopenEditor) {\n                var errorMessages = this.options.messages.errors;\n                var focusButton = function (e) {\n                    var cont = e.sender.dialog().element;\n                    cont.find('.k-button:first').focus();\n                    cont.find('.k-button, input').on('keydown', function (ev) {\n                        if (ev.keyCode == kendo.keys.ESC) {\n                            e.sender.close();\n                        }\n                    });\n                };\n                var onClose = function (e) {\n                    var dlg = e.sender;\n                    this.selectClipboardContents();\n                    if (dlg._retry && reopenEditor) {\n                        reopenEditor();\n                    }\n                }.bind(this);\n                if (kendo.spreadsheet.dialogs.registered(options.type)) {\n                    var dialogOptions = { close: onClose };\n                    if (options.type === 'validationError') {\n                        dialogOptions = $.extend(dialogOptions, {\n                            title: options.title || 'Error',\n                            text: options.body ? options.body : errorMessages[options.type],\n                            activate: focusButton\n                        });\n                    }\n                    this.openDialog(options.type, dialogOptions);\n                } else {\n                    this.openDialog('message', {\n                        title: options.title || 'Error',\n                        text: options.body ? options.body : errorMessages[options.type],\n                        activate: focusButton,\n                        close: onClose\n                    });\n                }\n            },\n            destroy: function () {\n                this._dialogs.forEach(function (dialog) {\n                    dialog.destroy();\n                });\n                this.cellContextMenu.destroy();\n                this.rowHeaderContextMenu.destroy();\n                this.colHeaderContextMenu.destroy();\n                if (this.tabstrip) {\n                    this.tabstrip.destroy();\n                }\n                this._destroyFilterMenu();\n            },\n            _destroyFilterMenu: function () {\n                if (this._filterMenu) {\n                    this._filterMenu.destroy();\n                    this._filterMenu = undefined;\n                    this._filterMenuColumn = undefined;\n                }\n            },\n            render: function (reason) {\n                if (!this.element.is(':visible')) {\n                    return;\n                }\n                var sheet = this._sheet;\n                var focus = sheet.focus();\n                if (focus && this.scrollIntoView(focus)) {\n                    return;\n                }\n                var resizeDirection = !sheet.resizingInProgress() ? 'none' : sheet.resizeHandlePosition().col === -Infinity ? 'column' : 'row';\n                this.wrapper.toggleClass(viewClassNames.editContainer, this.editor.isActive()).toggleClass(viewClassNames.horizontalResize, resizeDirection == 'row').toggleClass(viewClassNames.verticalResize, resizeDirection == 'column');\n                var grid = sheet._grid;\n                var scroller = this.scroller;\n                var result = this.panes.map(function (pane) {\n                    return pane.render(scroller);\n                });\n                var topCorner = kendo.dom.element('div', {\n                    style: {\n                        width: grid._headerWidth + 'px',\n                        height: grid._headerHeight + 'px'\n                    },\n                    className: View.classNames.topCorner\n                });\n                result.push(topCorner);\n                if (sheet.resizeHandlePosition() && sheet.resizeHintPosition()) {\n                    result.push(this.renderResizeHint());\n                }\n                this.tree.render(result);\n                var scrollbar = kendo.support.scrollbar();\n                $(this.container).css({\n                    width: this.wrapper[0].clientWidth - scrollbar,\n                    height: this.wrapper[0].clientHeight - scrollbar\n                });\n                if (this.editor.isActive()) {\n                    this.editor.toggleTooltip(this.activeCellRectangle());\n                } else if (!(reason.resize || reason.scroll || reason.comment || sheet.selectionInProgress() || sheet.resizingInProgress() || sheet.draggingInProgress() || sheet.isInEditMode())) {\n                    this.renderClipboardContents();\n                }\n            },\n            renderResizeHint: function () {\n                var sheet = this._sheet;\n                var ref = sheet.resizeHandlePosition();\n                var horizontal = ref.col !== -Infinity;\n                var style;\n                if (horizontal) {\n                    style = {\n                        height: this.scroller.clientHeight + 'px',\n                        width: RESIZE_HANDLE_WIDTH + 'px',\n                        left: sheet.resizeHintPosition().x + 'px',\n                        top: '0px'\n                    };\n                } else {\n                    style = {\n                        height: RESIZE_HANDLE_WIDTH + 'px',\n                        width: this.scroller.clientWidth + 'px',\n                        top: sheet.resizeHintPosition().y + 'px',\n                        left: '0px'\n                    };\n                }\n                var classNames = Pane.classNames;\n                return kendo.dom.element('div', {\n                    className: classNames.resizeHint + (!horizontal ? ' ' + classNames.resizeHintVertical : ''),\n                    style: style\n                }, [\n                    kendo.dom.element('div', { className: classNames.resizeHintHandle }),\n                    kendo.dom.element('div', { className: classNames.resizeHintMarker })\n                ]);\n            },\n            renderClipboardContents: function () {\n                var sheet = this._sheet;\n                var grid = sheet._grid;\n                var selection = grid.normalize(sheet.select().toRangeRef());\n                var status = this._workbook.clipboard().canCopy();\n                if (status.canCopy === false && status.multiSelection) {\n                    this.clipboardContents.render([]);\n                    this.selectClipboardContents();\n                    return;\n                }\n                selection = sheet.trim(selection);\n                var table = new HtmlTable();\n                var selectionView = grid.rangeDimensions(selection);\n                selectionView.rows.forEach(function (height) {\n                    table.addRow(height);\n                });\n                selectionView.columns.forEach(function (width) {\n                    table.addColumn(width);\n                });\n                var tmp = sheet._getMergedCells(selection);\n                var primaryMergedCells = tmp.primary;\n                var secondaryMergedCells = tmp.secondary;\n                sheet.forEach(selection, function (row, col, cell) {\n                    var location = new CellRef(row, col).print();\n                    if (!secondaryMergedCells[location]) {\n                        var td = addCell(table, row - selection.topLeft.row, cell);\n                        var mergedCell = primaryMergedCells[location];\n                        if (mergedCell) {\n                            td.attr.colspan = mergedCell.width();\n                            td.attr.rowspan = mergedCell.height();\n                        }\n                    }\n                });\n                this.clipboardContents.render([table.toDomTree(0, 0, 'kendo-clipboard-' + this._workbook.clipboard()._uid)]);\n                this.selectClipboardContents();\n            },\n            _pane: function (row, column, rowCount, columnCount) {\n                var pane = new Pane(this._sheet, this._sheet._grid.pane({\n                    row: row,\n                    column: column,\n                    rowCount: rowCount,\n                    columnCount: columnCount\n                }));\n                pane.refresh(this.scroller.clientWidth, this.scroller.clientHeight);\n                return pane;\n            },\n            forceScrollerStackingOrder: function (value) {\n                $(this.scroller).css('z-index', value);\n            }\n        });\n        var paneClassNames = {\n            cell: 'k-spreadsheet-cell',\n            vaxis: 'k-spreadsheet-vaxis',\n            haxis: 'k-spreadsheet-haxis',\n            vborder: 'k-spreadsheet-vborder',\n            hborder: 'k-spreadsheet-hborder',\n            rowHeader: 'k-spreadsheet-row-header',\n            columnHeader: 'k-spreadsheet-column-header',\n            pane: 'k-spreadsheet-pane',\n            data: 'k-spreadsheet-data',\n            mergedCell: 'k-spreadsheet-merged-cell',\n            mergedCellsWrapper: 'k-merged-cells-wrapper',\n            activeCell: 'k-spreadsheet-active-cell',\n            selection: 'k-spreadsheet-selection',\n            selectionWrapper: 'k-selection-wrapper',\n            autoFillWrapper: 'k-auto-fill-wrapper',\n            single: 'k-single',\n            top: 'k-top',\n            right: 'k-right',\n            bottom: 'k-bottom',\n            left: 'k-left',\n            resizeHandle: 'k-resize-handle',\n            columnResizeHandle: 'k-column-resize-handle',\n            rowResizeHandle: 'k-row-resize-handle',\n            resizeHint: 'k-resize-hint',\n            resizeHintHandle: 'k-resize-hint-handle',\n            resizeHintMarker: 'k-resize-hint-marker',\n            resizeHintVertical: 'k-resize-hint-vertical',\n            selectionHighlight: 'k-spreadsheet-selection-highlight',\n            series: [\n                'k-series-a',\n                'k-series-b',\n                'k-series-c',\n                'k-series-d',\n                'k-series-e',\n                'k-series-f'\n            ]\n        };\n        var Pane = kendo.Class.extend({\n            init: function (sheet, grid) {\n                this._sheet = sheet;\n                this._grid = grid;\n            },\n            refresh: function (width, height) {\n                this._grid.refresh(width, height);\n            },\n            isVisible: function (scrollLeft, scrollTop, ref) {\n                return this._grid.view(scrollLeft, scrollTop).ref.intersects(ref);\n            },\n            render: function (scroller) {\n                var scrollLeft = scroller.scrollLeft;\n                var scrollTop = scroller.scrollTop;\n                if (scrollTop < 0) {\n                    scrollTop = 0;\n                }\n                if (scrollLeft < 0) {\n                    scrollLeft = 0;\n                }\n                var classNames = Pane.classNames;\n                var sheet = this._sheet;\n                var grid = this._grid;\n                var view = grid.view(scrollLeft, scrollTop);\n                this._currentView = view;\n                this._currentRect = this._rectangle(view.ref);\n                this._selectedHeaders = sheet.selectedHeaders();\n                var children = [];\n                children.push(this.renderData());\n                if (!sheet._activeDrawing) {\n                    children.push(this.renderSelection(scroller));\n                }\n                children.push(this.renderAutoFill());\n                children.push(this.renderEditorSelection());\n                children.push(this.renderFilterHeaders());\n                if (grid.hasRowHeader) {\n                    var rowHeader = kendo.dom.element('div', {\n                        className: classNames.rowHeader,\n                        style: {\n                            width: grid.headerWidth + 'px',\n                            top: view.rowOffset + 'px'\n                        }\n                    });\n                    children.push(rowHeader);\n                    sheet.forEach(view.ref.leftColumn(), function (row) {\n                        if (!sheet.isHiddenRow(row)) {\n                            var text = row + 1, height = sheet.rowHeight(row);\n                            rowHeader.children.push(kendo.dom.element('div', {\n                                className: this.headerClassName(row, 'row'),\n                                style: {\n                                    width: grid.headerWidth + 'px',\n                                    height: height + 'px'\n                                }\n                            }, [kendo.dom.element('div', { className: 'k-vertical-align-center' }, [kendo.dom.text(text + '')])]));\n                        }\n                    }.bind(this));\n                }\n                if (grid.hasColumnHeader) {\n                    var columnHeader = kendo.dom.element('div', {\n                        className: classNames.columnHeader,\n                        style: {\n                            top: '0px',\n                            left: view.columnOffset + 'px',\n                            width: this._currentRect.width + 'px',\n                            height: grid.headerHeight + 'px'\n                        }\n                    });\n                    children.push(columnHeader);\n                    var left = 0;\n                    sheet.forEach(view.ref.topRow(), function (row, col) {\n                        if (!sheet.isHiddenColumn(col)) {\n                            var text = kendo.spreadsheet.Ref.display(null, Infinity, col), width = sheet.columnWidth(col);\n                            columnHeader.children.push(kendo.dom.element('div', {\n                                className: this.headerClassName(col, 'col'),\n                                style: {\n                                    position: 'absolute',\n                                    left: left + 'px',\n                                    width: width + 'px',\n                                    height: grid.headerHeight + 'px'\n                                }\n                            }, [kendo.dom.element('div', { className: 'k-vertical-align-center' }, [kendo.dom.text(text + '')])]));\n                            left += width;\n                        }\n                    }.bind(this));\n                }\n                if (sheet.resizeHandlePosition() && (grid.hasColumnHeader || grid.hasRowHeader)) {\n                    if (!sheet.resizeHintPosition()) {\n                        this.renderResizeHandle(children);\n                    }\n                }\n                var paneClasses = [classNames.pane];\n                if (grid.hasColumnHeader) {\n                    paneClasses.push(classNames.top);\n                }\n                if (grid.hasRowHeader) {\n                    paneClasses.push(classNames.left);\n                }\n                return kendo.dom.element('div', {\n                    style: grid.style,\n                    className: paneClasses.join(' ')\n                }, children);\n            },\n            headerClassName: function (index, type) {\n                var selectedHeaders = this._selectedHeaders;\n                var itemSelection;\n                var allHeaders;\n                if (type === 'row') {\n                    itemSelection = selectedHeaders.rows[index];\n                    allHeaders = selectedHeaders.allRows;\n                } else {\n                    itemSelection = selectedHeaders.cols[index];\n                    allHeaders = selectedHeaders.allCols;\n                }\n                var className = itemSelection || (selectedHeaders.all ? 'full' : allHeaders ? 'partial' : 'none');\n                if (className) {\n                    className = 'k-selection-' + className;\n                }\n                return className;\n            },\n            renderData: function () {\n                var sheet = this._sheet;\n                var view = this._currentView;\n                var cont = kendo.dom.element('div', {\n                    className: Pane.classNames.data,\n                    style: {\n                        position: 'relative',\n                        left: view.columnOffset + 'px',\n                        top: view.rowOffset + 'px'\n                    }\n                });\n                var rect = this._currentRect;\n                var layout = kendo.spreadsheet.draw.doLayout(sheet, view.ref, { forScreen: true }), prev;\n                var showGridLines = sheet._showGridLines;\n                if (showGridLines) {\n                    prev = null;\n                    layout.xCoords.forEach(function (x) {\n                        if (x !== prev) {\n                            prev = x;\n                            cont.children.push(kendo.dom.element('div', {\n                                className: paneClassNames.vaxis,\n                                style: {\n                                    left: x + 'px',\n                                    height: rect.height + 'px',\n                                    borderColor: sheet.gridLinesColor()\n                                }\n                            }));\n                        }\n                    });\n                    prev = null;\n                    layout.yCoords.forEach(function (y) {\n                        if (y !== prev) {\n                            prev = y;\n                            cont.children.push(kendo.dom.element('div', {\n                                className: paneClassNames.haxis,\n                                style: {\n                                    top: y + 'px',\n                                    width: rect.width + 'px',\n                                    borderColor: sheet.gridLinesColor()\n                                }\n                            }));\n                        }\n                    });\n                }\n                var borders = kendo.spreadsheet.draw.Borders();\n                var activeCellRange = sheet.activeCell().toRangeRef();\n                var activeCell = activeCellRange.topLeft;\n                layout.cells.forEach(function (cell) {\n                    var cls = null;\n                    var absRow = cell.row + view.ref.topLeft.row;\n                    var absCol = cell.col + view.ref.topLeft.col;\n                    if (sheet._activeDrawing) {\n                        var ref = sheet._activeDrawing.topLeftCell;\n                        if (ref && ref.row == absRow && ref.col == absCol) {\n                            cls = 'k-spreadsheet-drawing-anchor-cell';\n                        }\n                    } else if (absRow == activeCell.row && absCol == activeCell.col) {\n                        cls = [Pane.classNames.activeCell].concat(this._activeFormulaColor(), this._directionClasses(activeCellRange));\n                        if (sheet.singleCellSelection()) {\n                            cls.push(Pane.classNames.single);\n                        }\n                        cls = cls.join(' ');\n                    }\n                    borders.add(cell);\n                    drawCell(cont.children, cell, cls, showGridLines);\n                    if (cell.comment && sheet._commentRef && absRow == sheet._commentRef.row && absCol == sheet._commentRef.col) {\n                        var ttOffset = 4;\n                        var div = kendo.dom.element('div', {\n                            className: 'k-tooltip k-spreadsheet-cell-comment',\n                            style: {\n                                left: cell.right + ttOffset + 'px',\n                                top: cell.top + 'px'\n                            }\n                        }, [kendo.dom.text(cell.comment)]);\n                        cont.children.push(div);\n                    }\n                }, this);\n                borders.vert.forEach(function (a) {\n                    a.forEach(function (b) {\n                        if (!b.rendered) {\n                            b.rendered = true;\n                            var style = {\n                                left: b.x + 'px',\n                                top: b.top + 'px',\n                                height: b.bottom - b.top + 1 + 'px',\n                                borderWidth: b.size + 'px',\n                                borderColor: b.color\n                            };\n                            if (b.size != 1) {\n                                style.transform = 'translateX(-' + (b.size - 1) / 2 + 'px)';\n                            }\n                            cont.children.push(kendo.dom.element('div', {\n                                className: paneClassNames.vborder,\n                                style: style\n                            }));\n                        }\n                    });\n                });\n                borders.horiz.forEach(function (a) {\n                    a.forEach(function (b) {\n                        if (!b.rendered) {\n                            b.rendered = true;\n                            var style = {\n                                top: b.y + 'px',\n                                left: b.left + 'px',\n                                width: b.right - b.left + 'px',\n                                borderWidth: b.size + 'px',\n                                borderColor: b.color\n                            };\n                            if (b.size != 1) {\n                                style.transform = 'translateY(-' + (b.size - 1) / 2 + 'px)';\n                            }\n                            cont.children.push(kendo.dom.element('div', {\n                                className: paneClassNames.hborder,\n                                style: style\n                            }));\n                        }\n                    });\n                });\n                this.renderDrawings(layout, cont.children);\n                return cont;\n            },\n            renderDrawings: function (layout, container) {\n                var sheet = this._sheet;\n                var workbook = sheet._workbook;\n                layout.drawings.forEach(function (d) {\n                    var drawing = d.drawing;\n                    var box = d.box;\n                    var div = box.toDiv('k-spreadsheet-drawing');\n                    if (drawing.image) {\n                        div.children.push(kendo.dom.element('div', {\n                            className: 'k-spreadsheet-drawing-image',\n                            style: {\n                                backgroundImage: 'url(\\'' + workbook.imageUrl(drawing.image) + '\\')',\n                                opacity: drawing.opacity\n                            }\n                        }));\n                    }\n                    if (drawing === sheet._activeDrawing) {\n                        div.attr.className += ' k-spreadsheet-active-drawing';\n                        drawingResizeHandles(div.children);\n                    }\n                    container.push(div);\n                });\n            },\n            renderResizeHandle: function (container) {\n                var sheet = this._sheet;\n                var ref = sheet.resizeHandlePosition();\n                var rectangle = this._rectangle(ref);\n                var classNames = [Pane.classNames.resizeHandle];\n                var style;\n                if (ref.col !== -Infinity) {\n                    if (this._grid.rows._start > 0) {\n                        return;\n                    }\n                    style = {\n                        height: this._grid.headerHeight + 'px',\n                        width: RESIZE_HANDLE_WIDTH + 'px',\n                        left: rectangle.right - RESIZE_HANDLE_WIDTH / 2 + 'px',\n                        top: '0px'\n                    };\n                    classNames.push(viewClassNames.horizontalResize);\n                } else {\n                    if (this._grid.columns._start > 0) {\n                        return;\n                    }\n                    style = {\n                        height: RESIZE_HANDLE_WIDTH + 'px',\n                        width: this._grid.headerWidth + 'px',\n                        top: rectangle.bottom - RESIZE_HANDLE_WIDTH / 2 + 'px',\n                        left: '0px'\n                    };\n                    classNames.push(viewClassNames.verticalResize);\n                }\n                container.push(kendo.dom.element('div', {\n                    className: classNames.join(' '),\n                    style: style\n                }));\n            },\n            filterIconRect: function (rect) {\n                var BUTTON_SIZE = 16;\n                var BUTTON_OFFSET = 3;\n                return new kendo.spreadsheet.Rectangle(rect.right - BUTTON_SIZE - BUTTON_OFFSET, rect.top + BUTTON_OFFSET, BUTTON_SIZE, BUTTON_SIZE);\n            },\n            renderFilterHeaders: function () {\n                var sheet = this._sheet;\n                var children = [];\n                var classNames = View.classNames;\n                var filter = sheet.filter();\n                function icon(className) {\n                    return kendo.dom.element('span', { className: classNames.icon + ' ' + className });\n                }\n                function filterButton(classNames, position, index) {\n                    var style = {\n                        left: position.left + 'px',\n                        top: position.top + 'px'\n                    };\n                    var filtered = filter && filter.columns.some(function (c) {\n                        return c.index === index;\n                    });\n                    var classes = classNames.filterButton;\n                    if (filtered) {\n                        classes += ' ' + classNames.filterButtonActive;\n                    }\n                    var button = kendo.dom.element('span', {\n                        className: classes,\n                        style: style\n                    }, [icon(classNames.iconFilterDefault)]);\n                    return button;\n                }\n                if (filter) {\n                    this._addDiv(children, filter.ref, classNames.filterRange);\n                }\n                sheet.forEachFilterHeader(this._currentView.ref, function (ref) {\n                    var rect = this._rectangle(ref);\n                    var position = this.filterIconRect(rect);\n                    var column = this._sheet.filterColumn(ref);\n                    var button = filterButton(classNames, position, column);\n                    children.push(button);\n                }.bind(this));\n                return kendo.dom.element('div', { className: classNames.filterHeadersWrapper }, children);\n            },\n            renderEditorSelection: function () {\n                var classNames = Pane.classNames;\n                var sheet = this._sheet;\n                var selections = [];\n                sheet._formulaSelections.forEach(function (range) {\n                    var ref = range.ref;\n                    if (ref === kendo.spreadsheet.NULLREF) {\n                        return;\n                    }\n                    this._addDiv(selections, ref, classNames.selectionHighlight + ' ' + range.colorClass);\n                }.bind(this));\n                return kendo.dom.element('div', { className: classNames.selectionWrapper }, selections);\n            },\n            renderSelection: function (scroller) {\n                var classNames = Pane.classNames;\n                var selections = [];\n                var selectionClasses = [classNames.selection];\n                var sheet = this._sheet;\n                var activeCell = sheet.activeCell().toRangeRef();\n                var selection = sheet.select();\n                selectionClasses = selectionClasses.concat(this._activeFormulaColor());\n                if (selection.size() === 1) {\n                    selectionClasses.push('k-single-selection');\n                }\n                if (this._sheet.autoFillPunch()) {\n                    selectionClasses.push('k-dim-auto-fill-handle');\n                }\n                selection.forEach(function (ref) {\n                    if (ref !== kendo.spreadsheet.NULLREF) {\n                        this._addDiv(selections, ref, selectionClasses.join(' '));\n                    }\n                }.bind(this));\n                this._renderCustomEditorButton(selections, activeCell, scroller);\n                return kendo.dom.element('div', { className: classNames.selectionWrapper }, selections);\n            },\n            renderAutoFill: function () {\n                var autoFillRectangle = [];\n                if (this._sheet.autoFillInProgress()) {\n                    var autoFillRef = this._sheet.autoFillRef();\n                    var punch = this._sheet.autoFillPunch();\n                    var direction = this._sheet._autoFillDirection;\n                    this._addDiv(autoFillRectangle, autoFillRef, 'k-auto-fill');\n                    if (punch) {\n                        this._addDiv(autoFillRectangle, punch, 'k-auto-fill-punch');\n                    } else if (direction !== undefined) {\n                        var ref, cssClass;\n                        switch (direction) {\n                        case 0:\n                            ref = autoFillRef.bottomRight;\n                            cssClass = 'k-auto-fill-br-hint';\n                            break;\n                        case 1:\n                            ref = autoFillRef.bottomRight;\n                            cssClass = 'k-auto-fill-br-hint';\n                            break;\n                        case 2:\n                            ref = new CellRef(autoFillRef.topLeft.row, autoFillRef.bottomRight.col);\n                            cssClass = 'k-auto-fill-tr-hint';\n                            break;\n                        case 3:\n                            ref = new CellRef(autoFillRef.bottomRight.row, autoFillRef.topLeft.col);\n                            cssClass = 'k-auto-fill-bl-hint';\n                            break;\n                        }\n                        var rectangle = this._addDiv(autoFillRectangle, ref, cssClass);\n                        if (rectangle) {\n                            var hint = kendo.dom.element('span', { className: 'k-tooltip' }, [kendo.dom.text(this._sheet._autoFillHint)]);\n                            rectangle.children.push(hint);\n                        }\n                    }\n                }\n                return kendo.dom.element('div', { className: Pane.classNames.autoFillWrapper }, autoFillRectangle);\n            },\n            _addDiv: function (collection, ref, className) {\n                var view = this._currentView, div;\n                if (view.ref.intersects(ref)) {\n                    div = this._rectangle(ref).resize(1, 1).toDiv(className);\n                    collection.push(div);\n                }\n                return div;\n            },\n            _renderCustomEditorButton: function (collection, ref, scroller) {\n                var self = this;\n                var sheet = self._sheet;\n                var view = self._currentView;\n                var columnCount = self._grid.columns._axis._count;\n                var ed = sheet.activeCellCustomEditor();\n                if (ed && view.ref.intersects(ref)) {\n                    var rectangle = self._rectangle(ref);\n                    sheet.forEach(ref.collapse(), function (row, col, cell) {\n                        cell.left = rectangle.left;\n                        cell.top = rectangle.top;\n                        cell.width = rectangle.width;\n                        cell.height = rectangle.height;\n                        var btnClass = 'k-button k-spreadsheet-editor-button';\n                        var isLastColumn = col == columnCount - 1 || self._buttonOutOfVisiblePane(row, col, scroller);\n                        if (isLastColumn) {\n                            btnClass += ' k-spreadsheet-last-column';\n                        }\n                        self._editorInLastColumn = isLastColumn;\n                        var btn = kendo.dom.element('div', {\n                            className: btnClass,\n                            style: {\n                                left: cell.left + (isLastColumn ? 0 : cell.width) + 'px',\n                                top: cell.top + 'px',\n                                height: cell.height + 'px'\n                            }\n                        });\n                        if (ed.icon) {\n                            btn.children.push(kendo.dom.element('span', { className: 'k-icon ' + ed.icon }));\n                        }\n                        collection.push(btn);\n                    });\n                }\n            },\n            _activeFormulaColor: function () {\n                var activeFormulaSelection;\n                var colorClasses = [];\n                if (this._sheet.isInEditMode()) {\n                    activeFormulaSelection = this._sheet._formulaSelections.filter(function (sel) {\n                        return sel.active && sel.type == 'ref';\n                    })[0];\n                    if (activeFormulaSelection) {\n                        colorClasses.push(activeFormulaSelection.colorClass);\n                    }\n                }\n                return colorClasses;\n            },\n            _directionClasses: function (cell) {\n                var cellClasses = [];\n                var classNames = Pane.classNames;\n                var view = this._currentView.ref;\n                if (!cell.move(0, -1).intersects(view)) {\n                    cellClasses.push(classNames.left);\n                }\n                if (!cell.move(-1, 0).intersects(view)) {\n                    cellClasses.push(classNames.top);\n                }\n                if (!cell.move(0, 1).intersects(view)) {\n                    cellClasses.push(classNames.right);\n                }\n                if (!cell.move(1, 0).intersects(view)) {\n                    cellClasses.push(classNames.bottom);\n                }\n                return cellClasses;\n            },\n            _rectangle: function (ref) {\n                return this._grid.boundingRectangle(ref.toRangeRef()).offset(-this._currentView.mergedCellLeft, -this._currentView.mergedCellTop);\n            },\n            _buttonOutOfVisiblePane: function (row, col, scroller) {\n                var self = this;\n                var theGrid = self._grid;\n                var sheet = self._sheet;\n                var ref = sheet.range(row, col)._ref;\n                var boundaries = theGrid.scrollBoundaries(ref);\n                var scrollLeft = theGrid.columns.frozen ? 0 : scroller.scrollLeft;\n                if (boundaries.right + EDIT_BUTTON_WIDTH > scrollLeft || col + 1 === sheet.frozenColumns()) {\n                    return true;\n                }\n            }\n        });\n        function drawingResizeHandles(container) {\n            [\n                'N',\n                'NE',\n                'E',\n                'SE',\n                'S',\n                'SW',\n                'W',\n                'NW'\n            ].forEach(function (direction) {\n                container.push(kendo.dom.element('div', {\n                    'className': 'k-spreadsheet-drawing-handle ' + direction,\n                    'data-direction': direction\n                }));\n            });\n        }\n        kendo.spreadsheet.View = View;\n        kendo.spreadsheet.Pane = Pane;\n        kendo.spreadsheet.drawCell = drawCell;\n        $.extend(true, View, { classNames: viewClassNames });\n        $.extend(true, Pane, { classNames: paneClassNames });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/customeditors', [\n        'kendo.core',\n        'kendo.popup',\n        'kendo.calendar',\n        'kendo.listview',\n        'spreadsheet/sheet'\n    ], f);\n}(function () {\n    (function (kendo) {\n        'use strict';\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var EDITORS = {};\n        var registerEditor = kendo.spreadsheet.registerEditor = function (name, editor) {\n            EDITORS[name] = editor;\n        };\n        kendo.spreadsheet.Sheet.prototype.activeCellCustomEditor = function () {\n            var cell = this.activeCell().first();\n            if (this.range(cell).enable()) {\n                var val = this.validation(cell);\n                var key = this._properties.get('editor', this._grid.cellRefIndex(cell));\n                var editor;\n                if (key != null) {\n                    editor = EDITORS[key];\n                } else if (val && val.showButton) {\n                    key = '_validation_' + val.dataType;\n                    editor = EDITORS[key];\n                }\n                if (typeof editor == 'function') {\n                    editor = EDITORS[key] = editor();\n                }\n                return editor;\n            }\n        };\n        registerEditor('_validation_date', function () {\n            var context, calendar, popup;\n            function create() {\n                if (!calendar) {\n                    calendar = $('<div>').kendoCalendar();\n                    popup = $('<div>').kendoPopup();\n                    calendar.appendTo(popup);\n                    calendar = calendar.getKendoCalendar();\n                    popup = popup.getKendoPopup();\n                    calendar.bind('change', function () {\n                        popup.close();\n                        var date = calendar.value();\n                        if (!context.range.format()) {\n                            context.range.format('yyyy-mm-dd');\n                        }\n                        context.callback(kendo.spreadsheet.dateToNumber(date));\n                    });\n                }\n                popup.setOptions({ anchor: context.view.element.find('.k-spreadsheet-editor-button') });\n            }\n            function open() {\n                create();\n                var date = context.range.value();\n                if (date != null) {\n                    calendar.value(kendo.spreadsheet.numberToDate(date));\n                } else {\n                    calendar.value(null);\n                }\n                var val = context.validation;\n                if (val) {\n                    var min = kendo.ui.Calendar.fn.options.min;\n                    var max = kendo.ui.Calendar.fn.options.max;\n                    if (/^(?:greaterThan|between)/.test(val.comparerType)) {\n                        min = kendo.spreadsheet.numberToDate(val.from.value);\n                    }\n                    if (val.comparerType == 'between') {\n                        max = kendo.spreadsheet.numberToDate(val.to.value);\n                    }\n                    if (val.comparerType == 'lessThan') {\n                        max = kendo.spreadsheet.numberToDate(val.from.value);\n                    }\n                    calendar.setOptions({\n                        disableDates: function (date) {\n                            var from = val.from ? val.from.value | 0 : 0;\n                            var to = val.to ? val.to.value | 0 : 0;\n                            date = kendo.spreadsheet.dateToNumber(date) | 0;\n                            return !kendo.spreadsheet.validation.validationComparers[val.comparerType](date, from, to);\n                        },\n                        min: min,\n                        max: max\n                    });\n                } else {\n                    calendar.setOptions({\n                        disableDates: null,\n                        min: null,\n                        max: null\n                    });\n                }\n                popup.open();\n            }\n            return {\n                edit: function (options) {\n                    context = options;\n                    open();\n                },\n                icon: 'k-i-calendar'\n            };\n        });\n        registerEditor('_validation_list', function () {\n            var context, list, popup;\n            function create() {\n                if (!list) {\n                    list = $('<ul class=\\'k-list k-reset\\'/>').kendoStaticList({\n                        template: '#:value#',\n                        selectable: true,\n                        autoBind: false\n                    });\n                    popup = $('<div>').kendoPopup();\n                    list.appendTo(popup);\n                    popup = popup.getKendoPopup();\n                    list = list.getKendoStaticList();\n                    list.bind('change', function () {\n                        popup.close();\n                        var item = list.value()[0];\n                        if (item) {\n                            context.callback(item.value);\n                        }\n                    });\n                }\n                popup.setOptions({ anchor: context.view.element.find('.k-spreadsheet-editor-button') });\n            }\n            function open() {\n                create();\n                var items = context.validation.from.value;\n                var data = [], add = function (el) {\n                        data.push({ value: el });\n                    };\n                if (items instanceof kendo.spreadsheet.calc.runtime.Matrix) {\n                    items.each(add);\n                } else {\n                    (items + '').split(/\\s*,\\s*/).forEach(add);\n                }\n                var dataSource = new kendo.data.DataSource({ data: data });\n                list.setDataSource(dataSource);\n                dataSource.read();\n                popup.open();\n            }\n            return {\n                edit: function (options) {\n                    context = options;\n                    open();\n                },\n                icon: 'k-i-arrow-60-down'\n            };\n        });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/grid', [\n        'kendo.core',\n        'spreadsheet/references'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var CellRef = kendo.spreadsheet.CellRef;\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var UnionRef = kendo.spreadsheet.UnionRef;\n        var Rectangle = kendo.Class.extend({\n            init: function Rectangle(left, top, width, height) {\n                this.left = left;\n                this.top = top;\n                this.width = width;\n                this.height = height;\n                this.right = this.left + this.width;\n                this.bottom = this.top + this.height;\n            },\n            offset: function (left, top) {\n                return new Rectangle(this.left + left, this.top + top, this.width, this.height);\n            },\n            resize: function (width, height) {\n                return new Rectangle(this.left, this.top, this.width + width, this.height + height);\n            },\n            intersects: function (x, y) {\n                if (x instanceof Rectangle) {\n                    return this.intersectsRect(x);\n                }\n                return this.left < x && x < this.left + this.width && this.top < y && y < this.top + this.height;\n            },\n            intersectsRect: function (b) {\n                var a = this;\n                return a.left <= b.right && b.left <= a.right && a.top <= b.bottom && b.top <= a.bottom;\n            },\n            toDiv: function (className) {\n                return kendo.dom.element('div', {\n                    className: className,\n                    style: {\n                        width: this.width + 'px',\n                        height: this.height + 'px',\n                        top: this.top + 'px',\n                        left: this.left + 'px'\n                    }\n                });\n            }\n        });\n        var Grid = kendo.Class.extend({\n            init: function (rows, columns, rowCount, columnCount, headerHeight, headerWidth) {\n                this.rowCount = rowCount;\n                this.columnCount = columnCount;\n                this._columns = columns;\n                this._rows = rows;\n                this._headerHeight = headerHeight;\n                this._headerWidth = headerWidth;\n            },\n            isAxis: function (ref) {\n                ref = ref.toRangeRef();\n                var topLeft = ref.topLeft;\n                var bottomRight = ref.bottomRight;\n                return topLeft.row === 0 && bottomRight.row === this.rowCount - 1 || topLeft.col === 0 && bottomRight.col === this.columnCount - 1;\n            },\n            width: function (start, end) {\n                return this._columns.sum(start, end);\n            },\n            height: function (start, end) {\n                return this._rows.sum(start, end);\n            },\n            totalHeight: function () {\n                return this._rows.total + this._headerHeight;\n            },\n            totalWidth: function () {\n                return this._columns.total + this._headerWidth;\n            },\n            index: function (row, column) {\n                return column * this.rowCount + row;\n            },\n            cellRef: function (index) {\n                return new CellRef(index % this.rowCount, index / this.rowCount >> 0);\n            },\n            rowRef: function (row) {\n                return new RangeRef(new CellRef(row, 0), new CellRef(row, this.columnCount - 1));\n            },\n            colRef: function (col) {\n                return new RangeRef(new CellRef(0, col), new CellRef(this.rowCount - 1, col));\n            },\n            cellRefIndex: function (ref) {\n                return this.index(ref.row, ref.col);\n            },\n            normalize: function (ref) {\n                if (ref instanceof RangeRef) {\n                    return new RangeRef(this.normalize(ref.topLeft), this.normalize(ref.bottomRight)).setSheet(ref.sheet, ref.hasSheet());\n                }\n                if (ref instanceof UnionRef) {\n                    return ref.map(function (ref) {\n                        return this.normalize(ref);\n                    }, this);\n                }\n                if (ref instanceof CellRef) {\n                    ref = ref.clone();\n                    ref.col = Math.max(0, Math.min(this.columnCount - 1, ref.col));\n                    ref.row = Math.max(0, Math.min(this.rowCount - 1, ref.row));\n                }\n                return ref;\n            },\n            rectangle: function (ref) {\n                var topLeft = this.normalize(ref.topLeft);\n                var bottomRight = this.normalize(ref.bottomRight);\n                return new Rectangle(this.width(0, topLeft.col - 1), this.height(0, topLeft.row - 1), this.width(topLeft.col, bottomRight.col), this.height(topLeft.row, bottomRight.row));\n            },\n            pane: function (options) {\n                return new PaneGrid(new kendo.spreadsheet.PaneAxis(this._rows, options.row, options.rowCount, this._headerHeight), new kendo.spreadsheet.PaneAxis(this._columns, options.column, options.columnCount, this._headerWidth), this);\n            },\n            rangeDimensions: function (rangeRef) {\n                return {\n                    rows: this._rows.values.iterator(rangeRef.topLeft.row, rangeRef.bottomRight.row),\n                    columns: this._columns.values.iterator(rangeRef.topLeft.col, rangeRef.bottomRight.col)\n                };\n            },\n            forEach: function (ref, callback) {\n                var topLeft = this.normalize(ref.topLeft);\n                var bottomRight = this.normalize(ref.bottomRight);\n                for (var ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                    for (var ri = topLeft.row; ri <= bottomRight.row; ri++) {\n                        callback(new CellRef(ri, ci));\n                    }\n                }\n            },\n            trim: function (ref, property) {\n                var topLeft = this.normalize(ref.topLeft);\n                var bottomRight = this.normalize(ref.bottomRight);\n                var bottomRightRow = topLeft.row;\n                var bottomRightCol = topLeft.col;\n                for (var ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                    var start = this.index(topLeft.row, ci);\n                    var end = this.index(bottomRight.row, ci);\n                    var values = property.tree.intersecting(start, end);\n                    if (values.length) {\n                        var cell = this.cellRef(values[values.length - 1].end);\n                        bottomRightRow = Math.max(bottomRightRow, cell.row);\n                        bottomRightCol = ci;\n                    }\n                }\n                return new RangeRef(ref.topLeft, new CellRef(Math.min(bottomRightRow, ref.bottomRight.row), bottomRightCol));\n            }\n        });\n        var PaneGrid = kendo.Class.extend({\n            init: function (rows, columns, grid) {\n                this.rows = rows;\n                this.columns = columns;\n                this._grid = grid;\n                this.headerHeight = rows.headerSize;\n                this.headerWidth = columns.headerSize;\n                this.hasRowHeader = columns.hasHeader;\n                this.hasColumnHeader = rows.hasHeader;\n            },\n            refresh: function (width, height) {\n                this.columns.viewSize(width);\n                this.rows.viewSize(height);\n                var x = this.columns.paneSegment();\n                var y = this.rows.paneSegment();\n                this.left = x.offset;\n                this.top = y.offset;\n                this.right = x.offset + x.length;\n                this.bottom = y.offset + y.length;\n                this.style = {\n                    top: y.offset + 'px',\n                    left: x.offset + 'px',\n                    height: y.length + 'px',\n                    width: x.length + 'px'\n                };\n            },\n            view: function (left, top) {\n                var rows = this.rows.visible(top);\n                var columns = this.columns.visible(left);\n                return {\n                    rows: rows,\n                    columns: columns,\n                    rowOffset: rows.offset,\n                    columnOffset: columns.offset,\n                    mergedCellLeft: columns.start,\n                    mergedCellTop: rows.start,\n                    ref: new RangeRef(new CellRef(rows.values.start, columns.values.start), new CellRef(rows.values.end, columns.values.end))\n                };\n            },\n            contains: function (ref) {\n                return this.rows.contains(ref.topLeft.row, ref.bottomRight.row) && this.columns.contains(ref.topLeft.col, ref.bottomRight.col);\n            },\n            index: function (row, column) {\n                return this._grid.index(row, column);\n            },\n            boundingRectangle: function (ref) {\n                return this._grid.rectangle(ref);\n            },\n            cellRefIndex: function (ref) {\n                return this._grid.cellRefIndex(ref);\n            },\n            scrollBoundaries: function (cell) {\n                var position = this.boundingRectangle(cell);\n                var boundaries = {\n                    top: Math.max(0, position.top - this.top + (this.hasColumnHeader ? 0 : this.headerHeight)),\n                    left: Math.max(0, position.left - this.left + (this.hasRowHeader ? 0 : this.headerWidth)),\n                    right: position.right - this.columns._viewSize + this.headerWidth,\n                    bottom: position.bottom - this.rows._viewSize + this.headerHeight\n                };\n                var widthCompensation = this.columns.defaultValue / 2;\n                var heightCompensation = this.rows.defaultValue / 2;\n                boundaries.scrollTop = boundaries.top - heightCompensation;\n                boundaries.scrollBottom = boundaries.bottom + heightCompensation;\n                boundaries.scrollLeft = boundaries.left - widthCompensation;\n                boundaries.scrollRight = boundaries.right + widthCompensation;\n                return boundaries;\n            }\n        });\n        kendo.spreadsheet.Grid = Grid;\n        kendo.spreadsheet.PaneGrid = PaneGrid;\n        kendo.spreadsheet.Rectangle = Rectangle;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/axis', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var Axis = kendo.Class.extend({\n            init: function (count, value) {\n                this._value = value;\n                this._count = count;\n                this.values = new kendo.spreadsheet.RangeList(0, count - 1, value);\n                this._hidden = new kendo.spreadsheet.RangeList(0, count - 1, 0);\n                this.scrollBarSize = kendo.support.scrollbar();\n                this._refresh();\n            },\n            adjust: function (start, delta) {\n                if (delta < 0) {\n                    this.values.copy(start - delta, this._count - 1, start);\n                    this._hidden.copy(start - delta, this._count - 1, start);\n                } else {\n                    this.values.copy(start, this._count, start + delta);\n                    this._hidden.copy(start, this._count, start + delta);\n                    this.values.value(start, start + delta - 1, this._value);\n                    this._hidden.value(start, start + delta - 1, 0);\n                }\n                this._refresh();\n            },\n            toJSON: function (field, positions) {\n                var values = [];\n                var iterator = this.values.iterator(0, this._count - 1);\n                for (var idx = 0; idx < this._count; idx++) {\n                    var value = iterator.at(idx);\n                    var hidden = this._hidden.value(idx, idx);\n                    if (value === this._value && !hidden) {\n                        continue;\n                    }\n                    var position = positions[idx];\n                    if (position === undefined) {\n                        position = values.length;\n                        var item = { index: idx };\n                        item[field] = value;\n                        if (hidden) {\n                            item.hidden = hidden;\n                        }\n                        values.push(item);\n                        positions[idx] = position;\n                    }\n                }\n                return values;\n            },\n            fromJSON: function (field, values) {\n                for (var idx = 0; idx < values.length; idx++) {\n                    var el = values[idx];\n                    var index = el.index;\n                    if (index === undefined) {\n                        index = idx;\n                    }\n                    var value = el[field];\n                    if (value === 0) {\n                        this._hidden.value(index, index, el.hidden || this._value);\n                        this.value(index, index, 0);\n                    } else {\n                        this.value(index, index, value);\n                    }\n                }\n            },\n            hide: function (index) {\n                if (!this.hidden(index)) {\n                    var value = this.value(index, index);\n                    this._hidden.value(index, index, value);\n                    this.value(index, index, 0);\n                }\n            },\n            hidden: function (index) {\n                return this._hidden.value(index, index) !== 0;\n            },\n            includesHidden: function (start, end) {\n                return this._hidden.intersecting(start, end).length > 1;\n            },\n            nextVisible: function (index) {\n                var end = this._count - 1, i = index;\n                while (++i <= end) {\n                    if (!this.hidden(i)) {\n                        return i;\n                    }\n                }\n                return index;\n            },\n            nextPage: function (index, pageSize) {\n                return this.index(this.sum(0, index - 1) + pageSize);\n            },\n            prevPage: function (index, pageSize) {\n                return this.index(this.sum(0, index) - pageSize);\n            },\n            firstVisible: function () {\n                var firstHidden = this._hidden.first();\n                if (firstHidden.value === 0) {\n                    return 0;\n                } else {\n                    return firstHidden.end + 1;\n                }\n            },\n            lastVisible: function () {\n                var lastHidden = this._hidden.last();\n                if (lastHidden.value === 0) {\n                    return this._count - 1;\n                } else {\n                    return lastHidden.start - 1;\n                }\n            },\n            prevVisible: function (index) {\n                var i = index;\n                while (--i >= 0) {\n                    if (!this.hidden(i)) {\n                        return i;\n                    }\n                }\n                return index;\n            },\n            unhide: function (index) {\n                if (this.hidden(index)) {\n                    var value = this._hidden.value(index, index);\n                    this._hidden.value(index, index, 0);\n                    this.value(index, index, value);\n                }\n            },\n            value: function (start, end, value) {\n                if (value !== undefined) {\n                    this.values.value(start, end, value);\n                    this._refresh();\n                } else {\n                    return this.values.iterator(start, end).at(0);\n                }\n            },\n            sum: function (start, end) {\n                var values = this.values.iterator(start, end);\n                var sum = 0;\n                for (var idx = start; idx <= end; idx++) {\n                    sum += values.at(idx);\n                }\n                return sum;\n            },\n            locate: function (start, end, predicate) {\n                var values = this.values.iterator(start, end);\n                var sum = 0;\n                for (var idx = start; idx <= end; idx++) {\n                    sum += values.at(idx);\n                    var val = predicate(sum);\n                    if (val) {\n                        return idx;\n                    }\n                }\n                return null;\n            },\n            visible: function (start, end) {\n                var startSegment = null;\n                var endSegment = null;\n                var lastPage = false;\n                if (end >= this.total + this.scrollBarSize) {\n                    lastPage = true;\n                }\n                var ranges = this._pixelValues.intersecting(start, end);\n                startSegment = ranges[0];\n                endSegment = ranges[ranges.length - 1];\n                if (!startSegment) {\n                    return {\n                        values: this.values.iterator(0, 0),\n                        offset: 0\n                    };\n                }\n                var startOffset = start - startSegment.start;\n                var startIndex = (startOffset / startSegment.value.value >> 0) + startSegment.value.start;\n                var offset = startOffset - (startIndex - startSegment.value.start) * startSegment.value.value;\n                var endOffset = end - endSegment.start;\n                var endIndex = (endOffset / endSegment.value.value >> 0) + endSegment.value.start;\n                if (endIndex > endSegment.value.end) {\n                    endIndex = endSegment.value.end;\n                }\n                if (lastPage) {\n                    offset += endSegment.value.value - (endOffset - (endIndex - endSegment.value.start) * endSegment.value.value);\n                }\n                offset = Math.min(-offset, 0);\n                return {\n                    values: this.values.iterator(startIndex, endIndex),\n                    offset: offset\n                };\n            },\n            index: function (value) {\n                var index = 0;\n                var iterator = this.values.iterator(0, this._count - 1);\n                var current = iterator.at(0);\n                while (current < value && index < this._count - 1) {\n                    current += iterator.at(++index);\n                }\n                return index;\n            },\n            indexVisible: function (value) {\n                var index = this.index(value);\n                if (this.hidden(index)) {\n                    index = this.prevVisible(index);\n                }\n                return index;\n            },\n            _refresh: function () {\n                var current = 0;\n                this._pixelValues = this.values.map(function (range) {\n                    var start = current;\n                    current += (range.end - range.start + 1) * range.value;\n                    var end = current - 1;\n                    return new kendo.spreadsheet.ValueRange(start, end, range);\n                });\n                this.total = current;\n            },\n            getState: function () {\n                return {\n                    values: this.values.getState(),\n                    hidden: this._hidden.getState()\n                };\n            },\n            setState: function (state) {\n                this.values.setState(state.values);\n                this._hidden.setState(state.hidden);\n                this._refresh();\n            }\n        });\n        var PaneAxis = kendo.Class.extend({\n            init: function (axis, start, count, headerSize) {\n                this._axis = axis;\n                this._start = start;\n                this._count = count;\n                this.hasHeader = start === 0;\n                this.headerSize = headerSize;\n                this.defaultValue = axis._value;\n                this.frozen = count > 0;\n            },\n            viewSize: function (viewSize) {\n                this._viewSize = viewSize;\n            },\n            sum: function (start, end) {\n                return this._axis.sum(start, end - 1);\n            },\n            start: function () {\n                return this.sum(0, this._start);\n            },\n            size: function () {\n                return this.sum(this._start, this._start + this._count);\n            },\n            index: function (value, offset) {\n                return this._axis.index(value + (this.frozen ? 0 : offset) - this.headerSize);\n            },\n            indexVisible: function (value, offset) {\n                return this._axis.indexVisible(value + (this.frozen ? 0 : offset) - this.headerSize);\n            },\n            paneSegment: function () {\n                var offset = this.start();\n                var length;\n                if (!this.hasHeader) {\n                    offset += this.headerSize;\n                }\n                if (this.frozen) {\n                    length = this.size();\n                    if (this.hasHeader) {\n                        length += this.headerSize;\n                    } else {\n                        length -= this.headerSize;\n                    }\n                } else {\n                    length = this._viewSize - offset;\n                }\n                return {\n                    offset: offset,\n                    length: length\n                };\n            },\n            visible: function (offset) {\n                var start = this.start();\n                var size;\n                if (this.frozen) {\n                    size = this.size();\n                    if (!this.hasHeader) {\n                        size -= this.headerSize;\n                    }\n                } else {\n                    size = this._viewSize - start - this.headerSize;\n                    start += offset;\n                }\n                var result = this._axis.visible(start, start + size - 1);\n                if (this.frozen) {\n                    result.offset = 0;\n                }\n                result.start = start;\n                if (this.hasHeader) {\n                    result.offset += this.headerSize;\n                    result.start -= this.headerSize;\n                }\n                return result;\n            },\n            contains: function (start, end) {\n                if (this.frozen) {\n                    if (start > this._start + this._count) {\n                        return false;\n                    }\n                    if (end < this._start) {\n                        return false;\n                    }\n                    return true;\n                } else {\n                    return end >= this._start;\n                }\n            }\n        });\n        kendo.spreadsheet.Axis = Axis;\n        kendo.spreadsheet.PaneAxis = PaneAxis;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/filter', [\n        'kendo.core',\n        'kendo.data'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var Filter = kendo.spreadsheet.Filter = kendo.Class.extend({\n            prepare: function () {\n            },\n            value: function (cell) {\n                return cell.value;\n            },\n            matches: function () {\n                throw new Error('The \\'matches\\' method is not implemented.');\n            },\n            toJSON: function () {\n                throw new Error('The \\'toJSON\\' method is not implemented.');\n            }\n        });\n        Filter.create = function (options) {\n            var filter = options.filter;\n            if (!filter) {\n                throw new Error('Filter type not specified.');\n            }\n            var constructor = kendo.spreadsheet[filter.charAt(0).toUpperCase() + filter.substring(1) + 'Filter'];\n            if (!constructor) {\n                throw new Error('Filter type not recognized.');\n            }\n            return new constructor(options);\n        };\n        kendo.spreadsheet.ValueFilter = Filter.extend({\n            _values: [],\n            _dates: [],\n            _blanks: false,\n            init: function ValueFilter(options) {\n                if (options.values !== undefined) {\n                    this._values = options.values;\n                }\n                if (options.blanks !== undefined) {\n                    this._blanks = options.blanks;\n                }\n                if (options.dates !== undefined) {\n                    this._dates = options.dates;\n                }\n            },\n            value: function (cell) {\n                var value = cell.value;\n                if (this._dates.length > 0 && cell.format && typeof value === 'number') {\n                    var type = kendo.spreadsheet.formatting.type(value, cell.format);\n                    if (type === 'date') {\n                        value = kendo.spreadsheet.numberToDate(value);\n                    }\n                }\n                return value;\n            },\n            matches: function (value) {\n                if (value === null || value === undefined) {\n                    return this._blanks;\n                }\n                if (value instanceof Date) {\n                    return this._dates.some(function (date) {\n                        return date.year === value.getFullYear() && (date.month === undefined || date.month === value.getMonth()) && (date.day === undefined || date.day === value.getDate()) && (date.hours === undefined || date.hours === value.getHours()) && (date.minutes === undefined || date.minutes === value.getMinutes()) && (date.seconds === undefined || date.seconds === value.getSeconds());\n                    });\n                }\n                return this._values.indexOf(value) >= 0;\n            },\n            toJSON: function () {\n                return {\n                    filter: 'value',\n                    blanks: this._blanks,\n                    values: this._values.slice(0)\n                };\n            }\n        });\n        kendo.spreadsheet.CustomFilter = Filter.extend({\n            _logic: 'and',\n            init: function CustomFilter(options) {\n                if (options.logic !== undefined) {\n                    this._logic = options.logic;\n                }\n                if (options.criteria === undefined) {\n                    throw new Error('Must specify criteria.');\n                }\n                this._criteria = options.criteria;\n                var expression = kendo.data.Query.filterExpr({\n                    logic: this._logic,\n                    filters: this._criteria\n                }).expression;\n                this._matches = new Function('d', 'return ' + expression);\n            },\n            matches: function (value) {\n                if (value === null) {\n                    return false;\n                }\n                return this._matches(value);\n            },\n            value: function (cell) {\n                var value = cell.value;\n                var criterionValue = this._criteria[0].value;\n                var criterionType = criterionValue instanceof Date ? 'date' : typeof criterionValue;\n                var valueType = typeof value;\n                if (cell.format) {\n                    valueType = kendo.spreadsheet.formatting.type(value, cell.format);\n                }\n                if (valueType != criterionType) {\n                    if (criterionType == 'string') {\n                        if (cell.format) {\n                            value = kendo.spreadsheet.formatting.text(value, cell.format);\n                        }\n                        value = value + '';\n                    }\n                } else if (valueType == 'date') {\n                    value = kendo.spreadsheet.numberToDate(value);\n                }\n                return value;\n            },\n            toJSON: function () {\n                return {\n                    filter: 'custom',\n                    logic: this._logic,\n                    criteria: this._criteria\n                };\n            }\n        });\n        kendo.spreadsheet.TopFilter = Filter.extend({\n            init: function TopFilter(options) {\n                this._type = options.type;\n                this._value = options.value;\n                this._values = [];\n            },\n            prepare: function (cells) {\n                var values = cells.map(this.value).sort().filter(function (value, index, array) {\n                    return index === 0 || value !== array[index - 1];\n                });\n                if (this._type === 'topNumber' || this._type == 'topPercent') {\n                    values.sort(function (x, y) {\n                        return y - x;\n                    });\n                } else {\n                    values.sort(function (x, y) {\n                        return x - y;\n                    });\n                }\n                var count = this._value;\n                if (this._type === 'topPercent' || this._type === 'bottomPercent') {\n                    count = values.length * count / 100 >> 0;\n                }\n                this._values = values.slice(0, count);\n            },\n            matches: function (value) {\n                return this._values.indexOf(value) >= 0;\n            },\n            toJSON: function () {\n                return {\n                    filter: 'top',\n                    type: this._type,\n                    value: this._value\n                };\n            }\n        });\n        kendo.spreadsheet.DynamicFilter = Filter.extend({\n            init: function DynamicFilter(options) {\n                this._type = options.type;\n                this._predicate = this[options.type];\n                if (typeof this._predicate !== 'function') {\n                    throw new Error('DynamicFilter type \\'' + options.type + '\\' not recognized.');\n                }\n            },\n            value: function (cell) {\n                var value = cell.value;\n                if (cell.format) {\n                    var type = kendo.spreadsheet.formatting.type(value, cell.format);\n                    if (type === 'date') {\n                        value = kendo.spreadsheet.numberToDate(value);\n                    }\n                }\n                return value;\n            },\n            prepare: function (cells) {\n                var sum = 0;\n                var count = 0;\n                for (var ci = 0; ci < cells.length; ci++) {\n                    var value = this.value(cells[ci]);\n                    if (typeof value === 'number') {\n                        sum += value;\n                        count++;\n                    }\n                }\n                if (count > 0) {\n                    this._average = sum / count;\n                } else {\n                    this._average = 0;\n                }\n            },\n            matches: function (value) {\n                return this._predicate(value);\n            },\n            aboveAverage: function (value) {\n                if (value instanceof Date) {\n                    value = kendo.spreadsheet.dateToNumber(value);\n                }\n                if (typeof value !== 'number') {\n                    return false;\n                }\n                return value > this._average;\n            },\n            belowAverage: function (value) {\n                if (value instanceof Date) {\n                    value = kendo.spreadsheet.dateToNumber(value);\n                }\n                if (typeof value !== 'number') {\n                    return false;\n                }\n                return value < this._average;\n            },\n            tomorrow: function (value) {\n                if (value instanceof Date) {\n                    var tomorrow = kendo.date.addDays(kendo.date.today(), 1);\n                    return kendo.date.getDate(value).getTime() === tomorrow.getTime();\n                }\n                return false;\n            },\n            today: function (value) {\n                if (value instanceof Date) {\n                    return kendo.date.isToday(value);\n                }\n                return false;\n            },\n            yesterday: function (value) {\n                if (value instanceof Date) {\n                    var yesterday = kendo.date.addDays(kendo.date.today(), -1);\n                    return kendo.date.getDate(value).getTime() === yesterday.getTime();\n                }\n                return false;\n            },\n            nextWeek: function (value) {\n                return sameWeek(kendo.date.addDays(kendo.date.today(), 7), value);\n            },\n            thisWeek: function (value) {\n                return sameWeek(kendo.date.today(), value);\n            },\n            lastWeek: function (value) {\n                return sameWeek(kendo.date.addDays(kendo.date.today(), -7), value);\n            },\n            nextMonth: function (value) {\n                return sameMonth(value, 1);\n            },\n            thisMonth: function (value) {\n                return sameMonth(value, 0);\n            },\n            lastMonth: function (value) {\n                return sameMonth(value, -1);\n            },\n            nextQuarter: function (value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n                    var diff = quarter(value) - quarter(today);\n                    return diff === 1 && today.getFullYear() === value.getFullYear() || diff == -3 && today.getFullYear() + 1 === value.getFullYear();\n                }\n                return false;\n            },\n            thisQuarter: function (value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n                    var diff = quarter(value) - quarter(today);\n                    return diff === 0 && today.getFullYear() === value.getFullYear();\n                }\n                return false;\n            },\n            lastQuarter: function (value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n                    var diff = quarter(today) - quarter(value);\n                    return diff === 1 && today.getFullYear() === value.getFullYear() || diff == -3 && today.getFullYear() - 1 === value.getFullYear();\n                }\n                return false;\n            },\n            nextYear: function (value) {\n                return sameYear(value, 1);\n            },\n            thisYear: function (value) {\n                return sameYear(value, 0);\n            },\n            lastYear: function (value) {\n                return sameYear(value, -1);\n            },\n            yearToDate: function (value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n                    return value.getFullYear() === today.getFullYear() && value <= today;\n                }\n                return false;\n            },\n            toJSON: function () {\n                return {\n                    filter: 'dynamic',\n                    type: this._type\n                };\n            }\n        });\n        [\n            1,\n            2,\n            3,\n            4\n        ].forEach(function (target) {\n            kendo.spreadsheet.DynamicFilter.prototype['quarter' + target] = function (value) {\n                if (value instanceof Date) {\n                    return quarter(value) === target;\n                }\n                return false;\n            };\n        });\n        kendo.cultures['en-US'].calendar.months.names.forEach(function (month, index) {\n            kendo.spreadsheet.DynamicFilter.prototype[month.toLowerCase()] = function (value) {\n                if (value instanceof Date) {\n                    return value.getMonth() === index;\n                }\n                return false;\n            };\n        });\n        function quarter(value) {\n            var month = value.getMonth() + 1;\n            if (month >= 1 && month <= 3) {\n                return 1;\n            } else if (month >= 4 && month <= 6) {\n                return 2;\n            } else if (month >= 7 && month <= 9) {\n                return 3;\n            } else {\n                return 4;\n            }\n        }\n        function sameYear(value, offset) {\n            if (value instanceof Date) {\n                var today = kendo.date.today();\n                today.setFullYear(today.getFullYear() + offset);\n                return today.getFullYear() === value.getFullYear();\n            }\n            return false;\n        }\n        function sameMonth(value, offset) {\n            if (value instanceof Date) {\n                var today = kendo.date.firstDayOfMonth(kendo.date.today());\n                today.setMonth(today.getMonth() + offset, 1);\n                return today.getTime() === kendo.date.firstDayOfMonth(value).getTime();\n            }\n            return false;\n        }\n        function sameWeek(a, b) {\n            if (b instanceof Date) {\n                var firstWeek = kendo.date.dayOfWeek(kendo.date.getDate(a), 1);\n                var secondWeek = kendo.date.dayOfWeek(kendo.date.getDate(b), 1);\n                return firstWeek.getTime() === secondWeek.getTime();\n            }\n            return false;\n        }\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/sorter', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var Sorter = kendo.Class.extend({\n            init: function (grid, lists) {\n                this._grid = grid;\n                this._lists = lists;\n            },\n            indices: function (rangeRef, list, ascending, indices) {\n                var comparer = Sorter.ascendingComparer;\n                if (ascending === false) {\n                    comparer = Sorter.descendingComparer;\n                }\n                return list.sortedIndices(this._grid.cellRefIndex(rangeRef.topLeft), this._grid.cellRefIndex(rangeRef.bottomRight), comparer, indices);\n            },\n            sortBy: function (ref, column, list, ascending, indices) {\n                var sortedIndices = this.indices(ref.toColumn(column), list, ascending, indices);\n                for (var ci = ref.topLeft.col; ci <= ref.bottomRight.col; ci++) {\n                    var start = this._grid.index(ref.topLeft.row, ci);\n                    var end = this._grid.index(ref.bottomRight.row, ci);\n                    for (var li = 0; li < this._lists.length; li++) {\n                        if (start < this._lists[li].lastRangeStart()) {\n                            this._lists[li].sort(start, end, sortedIndices);\n                        }\n                    }\n                }\n                return sortedIndices;\n            }\n        });\n        Sorter.ascendingComparer = function (a, b) {\n            if (a === null && b === null) {\n                return 0;\n            }\n            if (a === null) {\n                return 1;\n            }\n            if (b === null) {\n                return -1;\n            }\n            var typeA = typeof a;\n            var typeB = typeof b;\n            if (typeA === 'number') {\n                if (typeB === 'number') {\n                    return a - b;\n                } else {\n                    return -1;\n                }\n            }\n            if (typeA === 'string') {\n                switch (typeB) {\n                case 'number':\n                    return 1;\n                case 'string':\n                    return a.localeCompare(b);\n                default:\n                    return -1;\n                }\n            }\n            if (typeA === 'boolean') {\n                switch (typeB) {\n                case 'number':\n                    return 1;\n                case 'string':\n                    return 1;\n                case 'boolean':\n                    return a - b;\n                default:\n                    return -1;\n                }\n            }\n            if (a instanceof kendo.spreadsheet.calc.runtime.CalcError) {\n                if (b instanceof kendo.spreadsheet.calc.runtime.CalcError) {\n                    return 0;\n                } else {\n                    return 1;\n                }\n            }\n            throw new Error('Cannot compare ' + a + ' and ' + b);\n        };\n        Sorter.descendingComparer = function (a, b) {\n            if (a === null && b === null) {\n                return 0;\n            }\n            if (a === null) {\n                return 1;\n            }\n            if (b === null) {\n                return -1;\n            }\n            return Sorter.ascendingComparer(b, a);\n        };\n        kendo.spreadsheet.Sorter = Sorter;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/numformat', [\n        'spreadsheet/calc',\n        'kendo.dom',\n        'util/main'\n    ], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var util = kendo.util;\n    var calc = kendo.spreadsheet.calc;\n    var dom = kendo.dom;\n    var RX_COLORS = /^\\[(black|green|white|blue|magenta|yellow|cyan|red)\\]/i;\n    var RX_CONDITION = /^\\[(<=|>=|<>|<|>|=)(-?[0-9.]+)\\]/;\n    function parse(input) {\n        input = calc.InputStream(input);\n        var sections = [], haveConditional = false, decimalPart;\n        while (!input.eof()) {\n            var sec = readSection();\n            sections.push(sec);\n            if (sec.cond) {\n                haveConditional = true;\n            }\n        }\n        if (!haveConditional) {\n            if (sections.length == 1) {\n                sections[0].cond = 'num';\n            } else if (sections.length == 2) {\n                sections[0].cond = {\n                    op: '>=',\n                    value: 0\n                };\n                sections[1].cond = {\n                    op: '<',\n                    value: 0\n                };\n            } else if (sections.length >= 3) {\n                sections[0].cond = {\n                    op: '>',\n                    value: 0\n                };\n                sections[1].cond = {\n                    op: '<',\n                    value: 0\n                };\n                sections[2].cond = {\n                    op: '=',\n                    value: 0\n                };\n                if (sections.length > 3) {\n                    sections[3].cond = 'text';\n                    sections = sections.slice(0, 4);\n                }\n            }\n        }\n        return sections;\n        function maybeColor() {\n            var m = input.skip(RX_COLORS);\n            if (m) {\n                return m[1].toLowerCase();\n            }\n        }\n        function maybeCondition() {\n            var m = input.skip(RX_CONDITION);\n            if (m) {\n                var val = parseFloat(m[2]);\n                if (!isNaN(val)) {\n                    return {\n                        op: m[1],\n                        value: val,\n                        custom: true\n                    };\n                }\n            }\n        }\n        function readFormat() {\n            var format = [], tok, prev = null;\n            while (!input.eof() && (tok = readNext())) {\n                if (tok.type == 'date') {\n                    if (prev && /^(el)?time$/.test(prev.type) && prev.part == 'h' && tok.part == 'm' && tok.format < 3) {\n                        tok.type = 'time';\n                    }\n                } else if (/^(el)?time$/.test(tok.type) && tok.part == 's') {\n                    if (prev && prev.type == 'date' && prev.part == 'm' && prev.format < 3) {\n                        prev.type = 'time';\n                    }\n                }\n                if (!/^(?:str|space|fill)$/.test(tok.type)) {\n                    prev = tok;\n                }\n                format.push(tok);\n            }\n            return format;\n        }\n        function maybeFraction(tok) {\n            if (tok.type != 'date' || tok.part == 'm' && tok.format < 3) {\n                var m = input.skip(/^\\.(0+)/);\n                if (m) {\n                    tok.fraction = m[1].length;\n                    if (tok.type == 'date') {\n                        tok.type = 'time';\n                    }\n                }\n            }\n            return tok;\n        }\n        function readNext() {\n            var ch, m;\n            if (m = input.skip(/^([#0?]+)(?:,([#0?]+))+/)) {\n                return {\n                    type: 'digit',\n                    sep: true,\n                    format: m[1] + m[2],\n                    decimal: decimalPart\n                };\n            }\n            if (m = input.skip(/^[#0?]+/)) {\n                return {\n                    type: 'digit',\n                    sep: false,\n                    format: m[0],\n                    decimal: decimalPart\n                };\n            }\n            if (m = input.skip(/^(e)([+-])/i)) {\n                return {\n                    type: 'exp',\n                    ch: m[1],\n                    sign: m[2]\n                };\n            }\n            if (m = input.skip(/^(d{1,4}|m{1,5}|yyyy|yy)/i)) {\n                m = m[1].toLowerCase();\n                return maybeFraction({\n                    type: 'date',\n                    part: m.charAt(0),\n                    format: m.length\n                });\n            }\n            if (m = input.skip(/^(hh?|ss?)/i)) {\n                m = m[1].toLowerCase();\n                return maybeFraction({\n                    type: 'time',\n                    part: m.charAt(0),\n                    format: m.length\n                });\n            }\n            if (m = input.skip(/^\\[(hh?|mm?|ss?)\\]/i)) {\n                m = m[1].toLowerCase();\n                return maybeFraction({\n                    type: 'eltime',\n                    part: m.charAt(0),\n                    format: m.length\n                });\n            }\n            if (m = input.skip(/^(a[.]?m[.]?\\/p[.]?m[.]?|a\\/p)/i)) {\n                m = m[1].split('/');\n                return {\n                    type: 'ampm',\n                    am: m[0],\n                    pm: m[1]\n                };\n            }\n            switch (ch = input.next()) {\n            case ';':\n                return null;\n            case '\\\\':\n                return {\n                    type: 'str',\n                    value: input.next()\n                };\n            case '\"':\n                return {\n                    type: 'str',\n                    value: input.readEscaped(ch)\n                };\n            case '@':\n                return { type: 'text' };\n            case '_':\n                return {\n                    type: 'space',\n                    value: input.next()\n                };\n            case '*':\n                return {\n                    type: 'fill',\n                    value: input.next()\n                };\n            case '.':\n                if (input.lookingAt(/^\\s*[#0?]/)) {\n                    decimalPart = true;\n                    return { type: 'dec' };\n                }\n                return {\n                    type: 'str',\n                    value: '.'\n                };\n            case '%':\n                return { type: 'percent' };\n            case ',':\n                return { type: 'comma' };\n            }\n            return {\n                type: 'str',\n                value: ch\n            };\n        }\n        function readSection() {\n            decimalPart = false;\n            var color = maybeColor(), cond = maybeCondition();\n            if (!color && cond) {\n                color = maybeColor();\n            }\n            return {\n                color: color,\n                cond: cond,\n                body: readFormat()\n            };\n        }\n    }\n    function print(sections) {\n        return sections.map(printSection).join(';');\n        function printSection(sec) {\n            var out = '';\n            if (sec.color) {\n                out += '[' + sec.color + ']';\n            }\n            if (sec.cond) {\n                if (!(sec.cond == 'text' || sec.cond == 'num')) {\n                    out += '[' + sec.cond.op + sec.cond.value + ']';\n                }\n            }\n            out += sec.body.map(printToken).join('');\n            return out;\n        }\n        function maybeFraction(fmt, tok) {\n            if (tok.fraction) {\n                fmt += '.' + padLeft('', tok.fraction, '0');\n            }\n            return fmt;\n        }\n        function printToken(tok) {\n            if (tok.type == 'digit') {\n                if (tok.sep) {\n                    return tok.format.charAt(0) + ',' + tok.format.substr(1);\n                } else {\n                    return tok.format;\n                }\n            } else if (tok.type == 'exp') {\n                return tok.ch + tok.sign;\n            } else if (tok.type == 'date' || tok.type == 'time') {\n                return maybeFraction(padLeft('', tok.format, tok.part), tok);\n            } else if (tok.type == 'eltime') {\n                return maybeFraction('[' + padLeft('', tok.format, tok.part) + ']', tok);\n            } else if (tok.type == 'ampm') {\n                return tok.am + '/' + tok.pm;\n            } else if (tok.type == 'str') {\n                return JSON.stringify(tok.value);\n            } else if (tok.type == 'text') {\n                return '@';\n            } else if (tok.type == 'space') {\n                return '_' + tok.value;\n            } else if (tok.type == 'fill') {\n                return '*' + tok.value;\n            } else if (tok.type == 'dec') {\n                return '.';\n            } else if (tok.type == 'percent') {\n                return '%';\n            } else if (tok.type == 'comma') {\n                return ',';\n            }\n        }\n    }\n    function adjustDecimals(sections, x) {\n        sections.forEach(function (sec) {\n            var diff = x;\n            if (sec.cond == 'text') {\n                return;\n            }\n            var body = sec.body, adjusted = false, i = body.length;\n            while (diff !== 0 && --i >= 0) {\n                var tok = body[i];\n                if (tok.type == 'digit') {\n                    if (tok.decimal) {\n                        adjusted = true;\n                        if (diff > 0) {\n                            tok.format += padLeft('', diff, '0');\n                        } else if (diff < 0) {\n                            var tmp = tok.format.length;\n                            tok.format = tok.format.substr(0, tmp + diff);\n                            diff += tmp - tok.format.length;\n                        }\n                        if (tok.format.length === 0) {\n                            body.splice(i, 1);\n                            while (--i >= 0) {\n                                tok = body[i];\n                                if (tok.type == 'digit' && tok.decimal) {\n                                    ++i;\n                                    break;\n                                }\n                                if (tok.type == 'dec') {\n                                    body.splice(i, 1);\n                                    break;\n                                }\n                            }\n                        }\n                    }\n                    if (diff > 0) {\n                        break;\n                    }\n                }\n            }\n            if (!adjusted && diff > 0) {\n                body.splice(i + 1, 0, { type: 'dec' }, {\n                    type: 'digit',\n                    sep: false,\n                    decimal: true,\n                    format: padLeft('', diff, '0')\n                });\n            }\n        });\n    }\n    function TokenStream(parts) {\n        var index = 0;\n        return {\n            next: function () {\n                return parts[index++];\n            },\n            eof: function () {\n                return index >= parts.length;\n            },\n            ahead: function (n, f) {\n                if (index + n <= parts.length) {\n                    var val = f.apply(null, parts.slice(index, index + n));\n                    if (val) {\n                        index += n;\n                    }\n                    return val;\n                }\n            },\n            restart: function () {\n                index = 0;\n            }\n        };\n    }\n    function compileFormatPart(format) {\n        var input = TokenStream(format.body);\n        var hasDate = false;\n        var hasTime = false;\n        var hasAmpm = false;\n        var percentCount = 0;\n        var currency = /[\\$\\xA2-\\xA5\\u058F\\u060B\\u09F2\\u09F3\\u09FB\\u0AF1\\u0BF9\\u0E3F\\u17DB\\u20A0-\\u20BD\\uA838\\uFDFC\\uFE69\\uFF04\\uFFE0\\uFFE1\\uFFE5\\uFFE6]/;\n        var scaleCount = 0;\n        var code = '';\n        var separeThousands = false;\n        var declen = 0;\n        var intFormat = [], decFormat = [];\n        var condition = format.cond;\n        var preamble = '';\n        if (condition == 'text') {\n            preamble = 'if (typeof value == \\'string\\' || value instanceof kendo.spreadsheet.CalcError) { ';\n        } else if (condition == 'num') {\n            preamble = 'if (typeof value == \\'number\\') { ';\n        } else if (condition) {\n            var op = condition.op == '=' ? '==' : condition.op;\n            preamble = 'if (typeof value == \\'number\\' && value ' + op + ' ' + condition.value + ') { ';\n            if (!condition.custom) {\n                code += 'value = Math.abs(value); ';\n            }\n        }\n        if (format.color) {\n            code += 'result.color = ' + JSON.stringify(format.color) + '; ';\n        }\n        function checkComma(a, b) {\n            if (a.type == 'digit' && b.type == 'comma' || a.type == 'comma' && a.hidden && b.type == 'comma') {\n                b.hidden = true;\n                scaleCount++;\n            }\n        }\n        while (!input.eof()) {\n            input.ahead(2, checkComma);\n            var tok = input.next();\n            if (tok.type == 'percent') {\n                percentCount++;\n            } else if (tok.type == 'digit') {\n                if (tok.decimal) {\n                    declen += tok.format.length;\n                    decFormat.push(tok.format);\n                } else {\n                    intFormat.push(tok.format);\n                    if (tok.sep) {\n                        separeThousands = true;\n                    }\n                }\n            } else if (tok.type == 'time') {\n                hasTime = true;\n            } else if (tok.type == 'date') {\n                hasDate = true;\n            } else if (tok.type == 'ampm') {\n                hasAmpm = hasTime = true;\n            }\n        }\n        if (percentCount > 0) {\n            code += 'value *= ' + Math.pow(100, percentCount) + '; ';\n        }\n        if (scaleCount > 0) {\n            code += 'value /= ' + Math.pow(1000, scaleCount) + '; ';\n        }\n        if (intFormat.length) {\n            code += 'var intPart = runtime.formatInt(culture, value, ' + JSON.stringify(intFormat) + ', ' + declen + ', ' + separeThousands + '); ';\n            code += 'var isNegative = parseInt(intPart[0]) < 0;';\n        }\n        if (decFormat.length) {\n            code += 'var decPart = runtime.formatDec(value, ' + JSON.stringify(decFormat) + ', ' + declen + '); ';\n        }\n        if (intFormat.length || decFormat.length) {\n            code += 'type = \\'number\\'; ';\n        }\n        if (hasDate) {\n            code += 'var date = runtime.unpackDate(value); ';\n        }\n        if (hasTime) {\n            code += 'var time = runtime.unpackTime(value); ';\n        }\n        if (hasDate || hasTime) {\n            code += 'type = \\'date\\'; ';\n        }\n        if (percentCount > 0 || scaleCount > 0 || intFormat.length || decFormat.length || hasDate || hasTime) {\n            if (!preamble) {\n                preamble = 'if (typeof value == \\'number\\') { ';\n            }\n        }\n        input.restart();\n        code += 'var matchedCurrency = false;';\n        while (!input.eof()) {\n            var tok = input.next();\n            if (tok.type == 'dec') {\n                code += 'output += culture.numberFormat[\\'.\\']; ';\n            } else if (tok.type == 'comma' && !tok.hidden) {\n                code += 'output += \\',\\'; ';\n            } else if (tok.type == 'percent') {\n                code += 'type = \\'percent\\'; ';\n                code += 'output += culture.numberFormat.percent.symbol; ';\n            } else if (tok.type == 'str') {\n                if (currency.test(tok.value)) {\n                    code += 'type = \\'currency\\'; ';\n                    code += 'if (isNegative) { output += \\'-\\'; matchedCurrency = true; }';\n                }\n                code += 'output += ' + JSON.stringify(tok.value) + '; ';\n            } else if (tok.type == 'text') {\n                code += 'type = \\'text\\'; ';\n                code += 'output += value; ';\n            } else if (tok.type == 'space') {\n                code += 'if (output) result.body.push(output); ';\n                code += 'output = \\'\\'; ';\n                code += 'result.body.push({ type: \\'space\\', value: ' + JSON.stringify(tok.value) + ' }); ';\n            } else if (tok.type == 'fill') {\n                code += 'output += runtime.fill(' + JSON.stringify(tok.value) + '); ';\n            } else if (tok.type == 'digit') {\n                code += 'if (isNegative && intPart[0] && matchedCurrency) {intPart[0] = intPart[0].replace(\\'-\\', \\'\\');}';\n                code += 'output += ' + (tok.decimal ? 'decPart' : 'intPart') + '.shift(); ';\n            } else if (tok.type == 'date') {\n                code += 'output += runtime.date(culture, date, ' + JSON.stringify(tok.part) + ', ' + tok.format + '); ';\n            } else if (tok.type == 'time') {\n                code += 'output += runtime.time(time, ' + JSON.stringify(tok.part) + ', ' + tok.format + ', ' + hasAmpm + ', ' + tok.fraction + '); ';\n            } else if (tok.type == 'eltime') {\n                code += 'output += runtime.eltime(value, ' + JSON.stringify(tok.part) + ', ' + tok.format + ', ' + tok.fraction + '); ';\n            } else if (tok.type == 'ampm') {\n                code += 'output += time.hours < 12 ? ' + JSON.stringify(tok.am) + ' : ' + JSON.stringify(tok.pm) + '; ';\n            }\n        }\n        code += 'if (output) result.body.push(output); ';\n        code += 'result.type = type; ';\n        code += 'return result; ';\n        if (preamble) {\n            code = preamble + code + '}';\n        }\n        return code;\n    }\n    var TEXT = compileFormatPart({\n        cond: 'text',\n        body: [{ type: 'text' }]\n    });\n    var compile = util.memoize(function (format) {\n        var tree = parse(format);\n        var code = tree.map(compileFormatPart);\n        code.push(TEXT);\n        code = code.join('\\n');\n        code = '\\'use strict\\'; return function(value, culture){ ' + 'if (!culture) culture = kendo.culture(); ' + 'var output = \\'\\', type = null, result = { body: [] }; ' + code + '; return result; };';\n        return new Function('runtime', code)(runtime);\n    });\n    var makeDateFormat = util.memoize(function (format) {\n        var tree = parse(format);\n        var section, found = false, hasAmpm = false;\n        for (var i = 0; i < tree.length; ++i) {\n            section = tree[i];\n            for (var j = 0; j < section.body.length; ++j) {\n                if (/^(?:date|time|ampm)$/.test(section.body[j].type)) {\n                    found = true;\n                    if (section.body[j].type == 'ampm') {\n                        hasAmpm = true;\n                    }\n                }\n            }\n            if (found) {\n                break;\n            }\n        }\n        if (!found) {\n            return null;\n        }\n        return section.body.map(printToken).join('');\n        function maybeFraction(fmt, tok) {\n            if (tok.fraction) {\n                fmt += padLeft('', Math.max(tok.fraction, 3), 'f');\n            }\n            return fmt;\n        }\n        function printToken(tok) {\n            if (tok.type == 'digit') {\n                if (tok.sep) {\n                    return tok.format.charAt(0) + ',' + tok.format.substr(1);\n                } else {\n                    return tok.format;\n                }\n            } else if (tok.type == 'exp') {\n                return tok.ch + tok.sign;\n            } else if (tok.type == 'date' || tok.type == 'time') {\n                var part = tok.part;\n                if (tok.type == 'date' && /^m/.test(part)) {\n                    part = 'M';\n                } else if (tok.type == 'time' && /^h/.test(part)) {\n                    if (!hasAmpm) {\n                        part = part.toUpperCase();\n                    }\n                }\n                return maybeFraction(padLeft('', tok.format, part), tok);\n            } else if (tok.type == 'ampm') {\n                return 'tt';\n            } else if (tok.type == 'str') {\n                return tok.value;\n            } else if (tok.type == 'space') {\n                return ' ';\n            } else if (tok.type == 'dec') {\n                return '.';\n            } else if (tok.type == 'percent') {\n                return '%';\n            } else if (tok.type == 'comma') {\n                return ',';\n            } else {\n                return '';\n            }\n        }\n    });\n    var runtime = {\n        unpackDate: calc.runtime.unpackDate,\n        unpackTime: calc.runtime.unpackTime,\n        date: function (culture, d, part, length) {\n            switch (part) {\n            case 'd':\n                switch (length) {\n                case 1:\n                    return d.date;\n                case 2:\n                    return padLeft(d.date, 2, '0');\n                case 3:\n                    return culture.calendars.standard.days.namesAbbr[d.day];\n                case 4:\n                    return culture.calendars.standard.days.names[d.day];\n                }\n                break;\n            case 'm':\n                switch (length) {\n                case 1:\n                    return d.month + 1;\n                case 2:\n                    return padLeft(d.month + 1, 2, '0');\n                case 3:\n                    return culture.calendars.standard.months.namesAbbr[d.month];\n                case 4:\n                    return culture.calendars.standard.months.names[d.month];\n                case 5:\n                    return culture.calendars.standard.months.names[d.month].charAt(0);\n                }\n                break;\n            case 'y':\n                switch (length) {\n                case 2:\n                    return d.year % 100;\n                case 4:\n                    return d.year;\n                }\n                break;\n            }\n            return '##';\n        },\n        time: function (t, part, length, ampm, fraclen) {\n            var ret, fraction;\n            switch (part) {\n            case 'h':\n                ret = padLeft(ampm ? t.hours % 12 || 12 : t.hours, length, '0');\n                if (fraclen) {\n                    fraction = (t.minutes + (t.seconds + t.milliseconds / 1000) / 60) / 60;\n                }\n                break;\n            case 'm':\n                ret = padLeft(t.minutes, length, '0');\n                if (fraclen) {\n                    fraction = (t.seconds + t.milliseconds / 1000) / 60;\n                }\n                break;\n            case 's':\n                ret = padLeft(t.seconds, length, '0');\n                if (fraclen) {\n                    fraction = t.milliseconds / 1000;\n                }\n                break;\n            }\n            if (fraction) {\n                ret += runtime.toFixed(fraction, fraclen).replace(/^0+/, '');\n            }\n            return ret;\n        },\n        eltime: function (value, part, length, fraclen) {\n            var ret, fraction;\n            switch (part) {\n            case 'h':\n                ret = value * 24;\n                break;\n            case 'm':\n                ret = value * 24 * 60;\n                break;\n            case 's':\n                ret = value * 24 * 60 * 60;\n                break;\n            }\n            if (fraclen) {\n                fraction = ret - (ret | 0);\n            }\n            ret = padLeft(ret | 0, length, '0');\n            if (fraction) {\n                ret += runtime.toFixed(fraction, fraclen).replace(/^0+/, '');\n            }\n            return ret;\n        },\n        fill: function (ch) {\n            return ch;\n        },\n        formatInt: function (culture, value, parts, declen, sep) {\n            value = runtime.toFixed(value, declen).replace(/\\..*$/, '');\n            var lastPart = parts[parts.length - 1];\n            if (declen > 0 && lastPart[parts.length - 1] != '0') {\n                if (value === '0') {\n                    value = '';\n                } else if (value === '-0') {\n                    value = '-';\n                }\n            }\n            var shouldInsertMinus = false;\n            var iv = value.length - 1;\n            var result = [];\n            var len = 0, str;\n            function add(ch, skipMinus) {\n                if (sep && len && len % 3 === 0 && /^[0-9]$/.test(ch)) {\n                    str = culture.numberFormat[','] + str;\n                }\n                if (skipMinus && ch === '-') {\n                    shouldInsertMinus = true;\n                    ch = '0';\n                }\n                str = ch + str;\n                len++;\n            }\n            for (var j = parts.length; --j >= 0;) {\n                var format = parts[j];\n                str = '';\n                for (var k = format.length; --k >= 0;) {\n                    var chf = format.charAt(k);\n                    if (iv < 0) {\n                        if (chf == '0') {\n                            add('0');\n                        } else if (chf == '?') {\n                            add(' ');\n                        }\n                    } else {\n                        if (value == '0' && chf == '?') {\n                            add(' ');\n                        } else if (chf == '0') {\n                            add(value.charAt(iv), true);\n                        } else {\n                            add(value.charAt(iv));\n                        }\n                        iv--;\n                    }\n                }\n                if (j === 0) {\n                    while (iv >= 0) {\n                        add(value.charAt(iv--));\n                    }\n                }\n                result.unshift(str);\n            }\n            if (shouldInsertMinus) {\n                result[0] = '-' + result[0];\n            }\n            return result;\n        },\n        formatDec: function (value, parts, declen) {\n            value = runtime.toFixed(value, declen);\n            var pos = value.indexOf('.');\n            if (pos >= 0) {\n                value = value.substr(pos + 1).replace(/0+$/, '');\n            } else {\n                value = '';\n            }\n            var iv = 0;\n            var result = [];\n            for (var j = 0; j < parts.length; ++j) {\n                var format = parts[j];\n                var str = '';\n                for (var k = 0; k < format.length; ++k) {\n                    var chf = format.charAt(k);\n                    if (iv < value.length) {\n                        str += value.charAt(iv++);\n                    } else if (chf == '0') {\n                        str += '0';\n                    } else if (chf == '?') {\n                        str += ' ';\n                    }\n                }\n                result.push(str);\n            }\n            return result;\n        },\n        toFixed: function (value, decimals) {\n            return function toFixed(value, last) {\n                if (!isFinite(value)) {\n                    return '#NUM!';\n                }\n                if (value < 0) {\n                    return '-' + toFixed(-value);\n                }\n                if (decimals === 0) {\n                    return String(Math.round(value));\n                }\n                if (value === Math.round(value) && !/e/i.test(String(value))) {\n                    return value.toFixed(decimals);\n                }\n                var num = digNumber(value);\n                var intpart = num.intpart;\n                var decpart = num.decpart;\n                if (decpart.length <= decimals) {\n                    while (decpart.length < decimals) {\n                        decpart += '0';\n                    }\n                    return intpart + '.' + decpart;\n                }\n                if (last) {\n                    return intpart + '.' + decpart.substr(0, decimals);\n                }\n                var f = Math.pow(10, decimals);\n                return toFixed(Math.round(value * f) / f, true);\n            }(Number(value.toFixed(14)));\n        }\n    };\n    function padLeft(val, width, ch) {\n        val += '';\n        while (val.length < width) {\n            val = ch + val;\n        }\n        return val;\n    }\n    function padRight(val, width, ch) {\n        val += '';\n        while (val.length < width) {\n            val += ch;\n        }\n        return val;\n    }\n    function digNumber(num) {\n        var str = String(num).toLowerCase();\n        var intpart, decpart, m;\n        var pos = str.indexOf('.');\n        if (pos < 0) {\n            pos = str.indexOf('e');\n            if (pos < 0) {\n                intpart = str;\n                decpart = '';\n            } else {\n                intpart = str.substr(0, pos);\n                decpart = str.substr(pos);\n            }\n        } else {\n            intpart = str.substr(0, pos);\n            decpart = str.substr(pos + 1);\n        }\n        if (m = /(\\d*)e([-+]?\\d+)/.exec(decpart)) {\n            var exp = parseInt(m[2], 10);\n            if (exp >= 0) {\n                decpart = padRight(m[1], exp, '0');\n                intpart += decpart.substr(0, exp);\n                decpart = decpart.substr(exp);\n            } else {\n                intpart = padLeft(intpart, -exp, '0');\n                decpart = intpart.substr(exp) + m[1];\n                intpart = intpart.substr(0, intpart.length + exp);\n            }\n        }\n        return {\n            intpart: intpart || '0',\n            decpart: decpart\n        };\n    }\n    function text(f) {\n        var a = f.body;\n        var text = '';\n        for (var i = 0; i < a.length; ++i) {\n            var el = a[i];\n            if (typeof el == 'string') {\n                text += el;\n            } else if (el.type == 'space') {\n                text += ' ';\n            }\n        }\n        return text;\n    }\n    kendo.spreadsheet.formatting = {\n        compile: compile,\n        parse: parse,\n        format: function (value, format, culture) {\n            var f = compile(format)(value, culture);\n            var span = dom.element('span');\n            span.__dataType = f.type;\n            var a = f.body;\n            if (f.color) {\n                span.attr.style = { color: f.color };\n            }\n            for (var i = 0; i < a.length; ++i) {\n                var el = a[i];\n                if (typeof el == 'string') {\n                    span.children.push(dom.text(el));\n                } else if (el.type == 'space') {\n                    span.children.push(dom.element('span', { style: { visibility: 'hidden' } }, [dom.text(el.value)]));\n                }\n            }\n            return span;\n        },\n        text: function (value, format, culture) {\n            var f = compile(format)(value, culture);\n            return text(f);\n        },\n        textAndColor: function (value, format, culture) {\n            var f = compile(format)(value, culture);\n            return {\n                text: text(f),\n                color: f.color,\n                type: f.type\n            };\n        },\n        type: function (value, format) {\n            return compile(format)(value).type;\n        },\n        adjustDecimals: function (format, diff) {\n            var ast = parse(format);\n            adjustDecimals(ast, diff);\n            return print(ast);\n        },\n        makeDateFormat: makeDateFormat\n    };\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/runtime.functions', [\n        'spreadsheet/runtime',\n        'util/main'\n    ], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var util = kendo.util;\n    var spreadsheet = kendo.spreadsheet;\n    var calc = spreadsheet.calc;\n    var runtime = calc.runtime;\n    var defineFunction = runtime.defineFunction;\n    var defineAlias = runtime.defineAlias;\n    var CalcError = runtime.CalcError;\n    var RangeRef = spreadsheet.RangeRef;\n    var CellRef = spreadsheet.CellRef;\n    var UnionRef = spreadsheet.UnionRef;\n    var Matrix = runtime.Matrix;\n    var Ref = spreadsheet.Ref;\n    var daysInMonth = runtime.daysInMonth;\n    var packDate = runtime.packDate;\n    var unpackDate = runtime.unpackDate;\n    var daysInYear = runtime.daysInYear;\n    [\n        'abs',\n        'cos',\n        'sin',\n        'acos',\n        'asin',\n        'tan',\n        'atan',\n        'exp',\n        'sqrt'\n    ].forEach(function (name) {\n        defineFunction(name, Math[name]).args([[\n                '*n',\n                'number'\n            ]]);\n    });\n    defineFunction('ln', Math.log).args([[\n            '*n',\n            'number'\n        ]]);\n    defineFunction('log', function (num, base) {\n        return Math.log(num) / Math.log(base);\n    }).args([\n        [\n            '*num',\n            'number++'\n        ],\n        [\n            '*base',\n            [\n                'or',\n                'number++',\n                [\n                    'null',\n                    10\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$base != 1',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('log10', function (num) {\n        return Math.log(num) / Math.log(10);\n    }).args([[\n            '*num',\n            'number++'\n        ]]);\n    defineFunction('pi', function () {\n        return Math.PI;\n    }).args([]);\n    defineFunction('sqrtpi', function (n) {\n        return Math.sqrt(n * Math.PI);\n    }).args([[\n            '*num',\n            'number+'\n        ]]);\n    defineFunction('degrees', function (rad) {\n        return 180 * rad / Math.PI % 360;\n    }).args([[\n            '*radians',\n            'number'\n        ]]);\n    defineFunction('radians', function (deg) {\n        return Math.PI * deg / 180;\n    }).args([[\n            '*degrees',\n            'number'\n        ]]);\n    function _cosh(n) {\n        return (Math.exp(n) + Math.exp(-n)) / 2;\n    }\n    defineFunction('cosh', _cosh).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('acosh', function (n) {\n        return Math.log(n + Math.sqrt(n - 1) * Math.sqrt(n + 1));\n    }).args([\n        [\n            '*num',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$num >= 1'\n            ]\n        ]\n    ]);\n    function _sinh(n) {\n        return (Math.exp(n) - Math.exp(-n)) / 2;\n    }\n    defineFunction('sinh', _sinh).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('asinh', function (n) {\n        return Math.log(n + Math.sqrt(n * n + 1));\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('sec', function (n) {\n        return 1 / Math.cos(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('sech', function (n) {\n        return 1 / _cosh(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('csc', function (n) {\n        return 1 / Math.sin(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('csch', function (n) {\n        return 1 / _sinh(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('atan2', function (x, y) {\n        return Math.atan(y / x);\n    }).args([\n        [\n            '*x',\n            'divisor'\n        ],\n        [\n            '*y',\n            'number'\n        ]\n    ]);\n    function _tanh(n) {\n        return _sinh(n) / _cosh(n);\n    }\n    defineFunction('tanh', _tanh).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('atanh', function (n) {\n        return Math.log(Math.sqrt(1 - n * n) / (1 - n));\n    }).args([[\n            '*num',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    -1,\n                    1\n                ]\n            ]\n        ]]);\n    defineFunction('cot', function (n) {\n        return 1 / Math.tan(n);\n    }).args([[\n            '*num',\n            'divisor'\n        ]]);\n    defineFunction('coth', function (n) {\n        return 1 / _tanh(n);\n    }).args([[\n            '*num',\n            'divisor'\n        ]]);\n    defineFunction('acot', function (n) {\n        return Math.PI / 2 - Math.atan(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('acoth', function (n) {\n        return Math.log((n + 1) / (n - 1)) / 2;\n    }).args([\n        [\n            '*num',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'or',\n                [\n                    'assert',\n                    '$num < -1'\n                ],\n                [\n                    'assert',\n                    '$num > 1'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('power', function (a, b) {\n        return Math.pow(a, b);\n    }).args([\n        [\n            '*a',\n            'number'\n        ],\n        [\n            '*b',\n            'number'\n        ]\n    ]);\n    defineFunction('mod', function (a, b) {\n        return a % b;\n    }).args([\n        [\n            '*a',\n            'number'\n        ],\n        [\n            '*b',\n            'divisor'\n        ]\n    ]);\n    defineFunction('quotient', function (a, b) {\n        return Math.floor(a / b);\n    }).args([\n        [\n            '*a',\n            'number'\n        ],\n        [\n            '*b',\n            'divisor'\n        ]\n    ]);\n    defineFunction('ceiling', function (num, s) {\n        return s ? s * Math.ceil(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$significance >= 0 || $number < 0'\n            ]\n        ]\n    ]);\n    defineFunction('ceiling.precise', function (num, s) {\n        s = Math.abs(s);\n        return s ? s * Math.ceil(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineAlias('iso.ceiling', 'ceiling.precise');\n    defineFunction('ceiling.math', function (num, s, mode) {\n        if (!s || !num) {\n            return 0;\n        }\n        if (num < 0 && (!mode && s < 0 || mode && s > 0)) {\n            s = -s;\n        }\n        return s ? s * Math.ceil(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    '$number < 0 ? -1 : 1'\n                ]\n            ]\n        ],\n        [\n            '*mode',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('floor', function (num, s) {\n        return s ? s * Math.floor(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$significance >= 0 || $number < 0'\n            ]\n        ]\n    ]);\n    defineFunction('floor.precise', function (num, s) {\n        s = Math.abs(s);\n        return s ? s * Math.floor(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('floor.math', function (num, s, mode) {\n        if (!s || !num) {\n            return 0;\n        }\n        if (num < 0 && (!mode && s < 0 || mode && s > 0)) {\n            s = -s;\n        }\n        return s ? s * Math.floor(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    '$number < 0 ? -1 : 1'\n                ]\n            ]\n        ],\n        [\n            '*mode',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('int', Math.floor).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('mround', function (num, mult) {\n        return mult ? mult * Math.round(num / mult) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*multiple',\n            'number'\n        ]\n    ]);\n    defineFunction('round', function (num, digits) {\n        var sign = num < 0 ? -1 : 1;\n        if (sign < 0) {\n            num = -num;\n        }\n        digits = Math.pow(10, digits);\n        num *= digits;\n        num = Math.round(num);\n        return sign * num / digits;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*digits',\n            'number'\n        ]\n    ]);\n    defineFunction('roundup', function (num, digits) {\n        digits = Math.pow(10, digits);\n        num *= digits;\n        num = num < 0 ? Math.floor(num) : Math.ceil(num);\n        return num / digits;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*digits',\n            'number'\n        ]\n    ]);\n    defineFunction('rounddown', function (num, digits) {\n        digits = Math.pow(10, digits);\n        num *= digits;\n        num = num < 0 ? Math.ceil(num) : Math.floor(num);\n        return num / digits;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*digits',\n            'number'\n        ]\n    ]);\n    defineFunction('even', function (num) {\n        var n = num < 0 ? Math.floor(num) : Math.ceil(num);\n        return n % 2 ? n + (n < 0 ? -1 : 1) : n;\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('odd', function (num) {\n        var n = num < 0 ? Math.floor(num) : Math.ceil(num);\n        return n % 2 ? n : n + (n < 0 ? -1 : 1);\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('sign', function (num) {\n        return num < 0 ? -1 : num > 0 ? 1 : 0;\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    function _gcd(a, b) {\n        while (b) {\n            var r = a % b;\n            a = b;\n            b = r;\n        }\n        return a;\n    }\n    function _lcm(a, b) {\n        return Math.abs(a * b) / _gcd(a, b);\n    }\n    defineFunction('gcd', function (args) {\n        var a = args[0];\n        for (var i = 1; i < args.length; ++i) {\n            a = _gcd(a, args[i]);\n        }\n        return a;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('lcm', function (args) {\n        var a = args[0];\n        for (var i = 1; i < args.length; ++i) {\n            a = _lcm(a, args[i]);\n        }\n        return a;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('sum', function (numbers) {\n        return numbers.reduce(function (sum, num) {\n            return sum + num;\n        }, 0);\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('product', function (numbers) {\n        return numbers.reduce(function (prod, num) {\n            return prod * num;\n        }, 1);\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('sumproduct', function (first, rest) {\n        var sum = 0;\n        first.each(function (p, row, col) {\n            if (typeof p == 'number') {\n                for (var i = 0; i < rest.length; ++i) {\n                    var v = rest[i].get(row, col);\n                    if (typeof v != 'number') {\n                        return;\n                    }\n                    p *= v;\n                }\n                sum += p;\n            }\n        });\n        return sum;\n    }).args([\n        [\n            'a1',\n            'matrix'\n        ],\n        [\n            '+',\n            [\n                'a2',\n                [\n                    'and',\n                    'matrix',\n                    [\n                        'assert',\n                        '$a2.width == $a1.width'\n                    ],\n                    [\n                        'assert',\n                        '$a2.height == $a1.height'\n                    ]\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('sumsq', function (numbers) {\n        return numbers.reduce(function (sum, num) {\n            return sum + num * num;\n        }, 0);\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('sumx2my2', function (a, b) {\n        var sum = 0;\n        a.each(function (x, row, col) {\n            var y = b.get(row, col);\n            if (typeof x == 'number' && typeof y == 'number') {\n                sum += x * x - y * y;\n            }\n        });\n        return sum;\n    }).args([\n        [\n            'a',\n            'matrix'\n        ],\n        [\n            'b',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$b.width == $a.width'\n                ],\n                [\n                    'assert',\n                    '$b.height == $a.height'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('sumx2py2', function (a, b) {\n        var sum = 0;\n        a.each(function (x, row, col) {\n            var y = b.get(row, col);\n            if (typeof x == 'number' && typeof y == 'number') {\n                sum += x * x + y * y;\n            }\n        });\n        return sum;\n    }).args([\n        [\n            'a',\n            'matrix'\n        ],\n        [\n            'b',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$b.width == $a.width'\n                ],\n                [\n                    'assert',\n                    '$b.height == $a.height'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('sumxmy2', function (a, b) {\n        var sum = 0;\n        a.each(function (x, row, col) {\n            var y = b.get(row, col);\n            if (typeof x == 'number' && typeof y == 'number') {\n                sum += (x - y) * (x - y);\n            }\n        });\n        return sum;\n    }).args([\n        [\n            'a',\n            'matrix'\n        ],\n        [\n            'b',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$b.width == $a.width'\n                ],\n                [\n                    'assert',\n                    '$b.height == $a.height'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('seriessum', function (x, n, m, a) {\n        var sum = 0;\n        a.each(function (coef) {\n            if (typeof coef != 'number') {\n                throw new CalcError('VALUE');\n            }\n            sum += coef * Math.pow(x, n);\n            n += m;\n        });\n        return sum;\n    }).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'y',\n            'number'\n        ],\n        [\n            'm',\n            'number'\n        ],\n        [\n            'a',\n            'matrix'\n        ]\n    ]);\n    defineFunction('min', function (numbers) {\n        return numbers.length ? Math.min.apply(Math, numbers) : 0;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('max', function (numbers) {\n        return numbers.length ? Math.max.apply(Math, numbers) : 0;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('counta', function (values) {\n        return values.length;\n    }).args([[\n            'values',\n            [\n                '#collect',\n                'anyvalue'\n            ]\n        ]]);\n    defineFunction('count', function (numbers) {\n        return numbers.length;\n    }).args([[\n            'numbers',\n            [\n                '#collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('countunique', function (values) {\n        var count = 0, seen = [];\n        values.forEach(function (val) {\n            if (seen.indexOf(val) < 0) {\n                count++;\n                seen.push(val);\n            }\n        });\n        return count;\n    }).args([[\n            'values',\n            [\n                '#collect',\n                'anyvalue'\n            ]\n        ]]);\n    defineFunction('countblank', function (a) {\n        var count = 0;\n        function add(val) {\n            if (val == null || val === '') {\n                count++;\n            }\n        }\n        function loop(args) {\n            for (var i = 0; i < args.length; ++i) {\n                var x = args[i];\n                if (x instanceof Matrix) {\n                    x.each(add, true);\n                } else {\n                    add(x);\n                }\n            }\n        }\n        loop(a);\n        return count;\n    }).args([[\n            '+',\n            [\n                'args',\n                [\n                    'or',\n                    'matrix',\n                    'anyvalue'\n                ]\n            ]\n        ]]);\n    defineFunction('iseven', function (num) {\n        return num % 2 === 0;\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('isodd', function (num) {\n        return num % 2 !== 0;\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('n', function (val) {\n        if (typeof val == 'boolean') {\n            return val ? 1 : 0;\n        }\n        if (typeof val == 'number') {\n            return val;\n        }\n        return 0;\n    }).args([[\n            '*value',\n            'anyvalue'\n        ]]);\n    defineFunction('na', function () {\n        return new CalcError('N/A');\n    }).args([]);\n    function forIFS(args, f) {\n        var chunks = [], i = 0, matrix = args[0];\n        while (i < args.length) {\n            chunks.push({\n                matrix: args[i++],\n                pred: parseCriteria(args[i++])\n            });\n        }\n        ROW:\n            for (var row = 0; row < matrix.height; ++row) {\n                COL:\n                    for (var col = 0; col < matrix.width; ++col) {\n                        for (i = 0; i < chunks.length; ++i) {\n                            var val = chunks[i].matrix.get(row, col);\n                            if (!chunks[i].pred(val == null || val === '' ? 0 : val)) {\n                                continue COL;\n                            }\n                        }\n                        f(row, col);\n                    }\n            }\n    }\n    var ARGS_COUNTIFS = [\n        [\n            'm1',\n            'matrix'\n        ],\n        [\n            'c1',\n            'anyvalue'\n        ],\n        [\n            [\n                'm2',\n                'matrix'\n            ],\n            [\n                'c2',\n                'anyvalue'\n            ]\n        ]\n    ];\n    defineFunction('countifs', function (m1, c1, rest) {\n        var count = 0;\n        rest.unshift(m1, c1);\n        forIFS(rest, function () {\n            count++;\n        });\n        return count;\n    }).args(ARGS_COUNTIFS);\n    var ARGS_SUMIFS = [[\n            'range',\n            'matrix'\n        ]].concat(ARGS_COUNTIFS);\n    defineFunction('sumifs', function (range, m1, c1, args) {\n        args.unshift(range, numericPredicate, m1, c1);\n        var sum = 0;\n        forIFS(args, function (row, col) {\n            var val = range.get(row, col);\n            if (val) {\n                sum += val;\n            }\n        });\n        return sum;\n    }).args(ARGS_SUMIFS);\n    defineFunction('averageifs', function (range, m1, c1, args) {\n        args.unshift(range, numericPredicate, m1, c1);\n        var sum = 0, count = 0;\n        forIFS(args, function (row, col) {\n            var val = range.get(row, col);\n            if (val == null || val === '') {\n                val = 0;\n            }\n            sum += val;\n            count++;\n        });\n        return count ? sum / count : new CalcError('DIV/0');\n    }).args(ARGS_SUMIFS);\n    defineFunction('countif', function (matrix, criteria) {\n        criteria = parseCriteria(criteria);\n        var count = 0;\n        matrix.each(function (val) {\n            if (criteria(val)) {\n                count++;\n            }\n        });\n        return count;\n    }).args([\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            '*criteria',\n            'anyvalue'\n        ]\n    ]);\n    var ARGS_SUMIF = [\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            '*criteria',\n            'anyvalue'\n        ],\n        [\n            'sumRange',\n            [\n                'or',\n                [\n                    'and',\n                    'matrix',\n                    [\n                        'assert',\n                        '$sumRange.width == $range.width'\n                    ],\n                    [\n                        'assert',\n                        '$sumRange.height == $range.height'\n                    ]\n                ],\n                [\n                    'null',\n                    '$range'\n                ]\n            ]\n        ]\n    ];\n    defineFunction('sumif', function (range, criteria, sumRange) {\n        var sum = 0;\n        criteria = parseCriteria(criteria);\n        range.each(function (val, row, col) {\n            if (criteria(val)) {\n                var v = sumRange.get(row, col);\n                if (numericPredicate(v)) {\n                    sum += v || 0;\n                }\n            }\n        });\n        return sum;\n    }).args(ARGS_SUMIF);\n    defineFunction('averageif', function (range, criteria, sumRange) {\n        var sum = 0, count = 0;\n        criteria = parseCriteria(criteria);\n        range.each(function (val, row, col) {\n            if (criteria(val)) {\n                var v = sumRange.get(row, col);\n                if (numericPredicate(v)) {\n                    sum += v || 0;\n                    count++;\n                }\n            }\n        });\n        return count ? sum / count : new CalcError('DIV/0');\n    }).args(ARGS_SUMIF);\n    (function (def) {\n        def('large', function (numbers, nth) {\n            return numbers.sort(descending)[nth];\n        });\n        def('small', function (numbers, nth) {\n            return numbers.sort(ascending)[nth];\n        });\n    }(function (name, handler) {\n        defineFunction(name, function (matrix, nth) {\n            var numbers = [];\n            var error = matrix.each(function (val) {\n                if (val instanceof CalcError) {\n                    return val;\n                }\n                if (typeof val == 'number') {\n                    numbers.push(val);\n                }\n            });\n            if (error) {\n                return error;\n            }\n            if (nth > numbers.length) {\n                return new CalcError('NUM');\n            }\n            return handler(numbers, nth - 1);\n        }).args([\n            [\n                'array',\n                'matrix'\n            ],\n            [\n                '*nth',\n                'number++'\n            ]\n        ]);\n    }));\n    function _avg(numbers) {\n        return numbers.reduce(function (sum, num) {\n            return sum + num;\n        }, 0) / numbers.length;\n    }\n    function _var_sp(numbers, divisor, avg) {\n        if (avg == null) {\n            avg = _avg(numbers);\n        }\n        return numbers.reduce(function (sum, num) {\n            return sum + Math.pow(num - avg, 2);\n        }, 0) / divisor;\n    }\n    function _stdev_sp(numbers, divisor) {\n        return Math.sqrt(_var_sp(numbers, divisor));\n    }\n    defineFunction('stdev.s', function (numbers) {\n        return _stdev_sp(numbers, numbers.length - 1);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('stdev.p', function (numbers) {\n        return _stdev_sp(numbers, numbers.length);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('var.s', function (numbers) {\n        return _var_sp(numbers, numbers.length - 1);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('var.p', function (numbers) {\n        return _var_sp(numbers, numbers.length);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('median', function (numbers) {\n        var n = numbers.length;\n        numbers.sort(ascending);\n        if (n % 2) {\n            return numbers[n >> 1];\n        }\n        return (numbers[n >>= 1] + numbers[n - 1]) / 2;\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('mode.sngl', function (numbers) {\n        numbers.sort(ascending);\n        var prev = null, count = 0, max = 1, mode = null;\n        for (var i = 0; i < numbers.length; ++i) {\n            var n = numbers[i];\n            if (n != prev) {\n                count = 1;\n                prev = n;\n            } else {\n                count++;\n            }\n            if (count > max) {\n                max = count;\n                mode = n;\n            }\n        }\n        return mode == null ? new CalcError('N/A') : mode;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('mode.mult', function (numbers) {\n        var seen = Object.create(null), max = 2, res = [];\n        numbers.forEach(function (num) {\n            var s = seen[num] || 0;\n            seen[num] = ++s;\n            if (s == max) {\n                res.push(num);\n            } else if (s > max) {\n                max = s;\n                res = [num];\n            }\n        });\n        var m = new Matrix(this);\n        res.forEach(function (num, i) {\n            m.set(i, 0, num);\n        });\n        return m;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('geomean', function (numbers) {\n        var n = numbers.length;\n        var p = numbers.reduce(function (p, num) {\n            if (num < 0) {\n                throw new CalcError('NUM');\n            }\n            return p * num;\n        }, 1);\n        return Math.pow(p, 1 / n);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('harmean', function (numbers) {\n        var n = numbers.length;\n        var s = numbers.reduce(function (s, num) {\n            if (!num) {\n                throw new CalcError('DIV/0');\n            }\n            return s + 1 / num;\n        }, 0);\n        return n / s;\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('trimmean', function (numbers, p) {\n        var n = numbers.length;\n        numbers.sort(ascending);\n        var discard = Math.floor(n * p);\n        if (discard % 2) {\n            --discard;\n        }\n        discard /= 2;\n        var sum = 0;\n        for (var i = discard; i < n - discard; ++i) {\n            sum += numbers[i];\n        }\n        return sum / (n - discard * 2);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'percent',\n            [\n                'and',\n                'number',\n                [\n                    '[between)',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('frequency', function (data, bins) {\n        data.sort(ascending);\n        bins.sort(ascending);\n        var prev = -Infinity;\n        var i = 0;\n        function count(max) {\n            var n = 0;\n            while (i < data.length && data[i] > prev && data[i] <= max) {\n                ++n;\n                ++i;\n            }\n            return n;\n        }\n        var m = new Matrix(this);\n        bins.forEach(function (val, i) {\n            var n = count(val);\n            prev = val;\n            m.set(i, 0, n);\n        });\n        m.set(m.height, 0, data.length - i);\n        return m;\n    }).args([\n        [\n            'data',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'bins',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ]\n    ]);\n    defineFunction('rank.eq', function (val, numbers, asc) {\n        numbers.sort(asc ? ascending : descending);\n        var pos = numbers.indexOf(val);\n        return pos < 0 ? new CalcError('N/A') : pos + 1;\n    }).args([\n        [\n            'value',\n            'number'\n        ],\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            'order',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineAlias('rank', 'rank.eq');\n    defineFunction('rank.avg', function (val, numbers, asc) {\n        numbers.sort(asc ? ascending : descending);\n        var pos = numbers.indexOf(val);\n        if (pos < 0) {\n            return new CalcError('N/A');\n        }\n        for (var i = pos; numbers[i] == val; ++i) {\n        }\n        return (pos + i + 1) / 2;\n    }).args([\n        [\n            'value',\n            'number'\n        ],\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            'order',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('kurt', function (numbers) {\n        var n = numbers.length;\n        var avg = _avg(numbers);\n        var variance = _var_sp(numbers, n - 1, avg);\n        var stddev = Math.sqrt(variance);\n        var sum = numbers.reduce(function (sum, num) {\n            return sum + Math.pow((num - avg) / stddev, 4);\n        }, 0);\n        return n * (n + 1) / ((n - 1) * (n - 2) * (n - 3)) * sum - 3 * Math.pow(n - 1, 2) / ((n - 2) * (n - 3));\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 4',\n                'NUM'\n            ]\n        ]\n    ]);\n    function _percentrank(numbers, x, exc) {\n        var nlt = 0, ngt = 0, left = null, right = null, found = false;\n        numbers.forEach(function (num) {\n            if (num < x) {\n                nlt++;\n                left = left == null ? num : Math.max(left, num);\n            } else if (num > x) {\n                ngt++;\n                right = right == null ? num : Math.min(right, num);\n            } else {\n                found = true;\n            }\n        });\n        if (!nlt && !ngt) {\n            return new CalcError('N/A');\n        }\n        if (found) {\n            if (exc) {\n                return (nlt + 1) / (numbers.length + 1);\n            }\n            return nlt / (nlt + ngt);\n        }\n        return ((right - x) * _percentrank(numbers, left, exc) + (x - left) * _percentrank(numbers, right, exc)) / (right - left);\n    }\n    var ARGS_PERCENTRANK = [\n        [\n            'array',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'x',\n            'number'\n        ],\n        [\n            'significance',\n            [\n                'or',\n                [\n                    'null',\n                    3\n                ],\n                'integer++'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array.length > 0',\n                'NUM'\n            ]\n        ]\n    ];\n    defineFunction('percentrank.inc', function (numbers, x, significance) {\n        var p = _percentrank(numbers, x, 0);\n        p = p.toFixed(significance + 1);\n        return parseFloat(p.substr(0, p.length - 1));\n    }).args(ARGS_PERCENTRANK);\n    defineFunction('percentrank.exc', function (numbers, x, significance) {\n        var p = _percentrank(numbers, x, 1);\n        p = p.toFixed(significance + 1);\n        return parseFloat(p.substr(0, p.length - 1));\n    }).args(ARGS_PERCENTRANK);\n    defineAlias('percentrank', 'percentrank.inc');\n    function _covariance(x, y, divisor) {\n        var sum = 0;\n        var ax = _avg(x);\n        var ay = _avg(y);\n        var n = x.length;\n        for (var i = 0; i < n; ++i) {\n            sum += (x[i] - ax) * (y[i] - ay);\n        }\n        return sum / divisor;\n    }\n    defineFunction('covariance.p', function (x, y) {\n        return _covariance(x, y, x.length);\n    }).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length == $array2.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length > 0',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('covariance.s', function (x, y) {\n        return _covariance(x, y, x.length - 1);\n    }).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length == $array2.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length > 1',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineAlias('covar', 'covariance.p');\n    var _fact = util.memoize(function (n) {\n        for (var i = 2, fact = 1; i <= n; ++i) {\n            fact *= i;\n        }\n        return fact;\n    });\n    defineFunction('fact', _fact).args([[\n            '*n',\n            'integer+'\n        ]]);\n    defineFunction('factdouble', function (n) {\n        for (var i = 2 + (n & 1), fact = 1; i <= n; i += 2) {\n            fact *= i;\n        }\n        return fact;\n    }).args([[\n            '*n',\n            'integer+'\n        ]]);\n    defineFunction('multinomial', function (numbers) {\n        var div = 1, sum = 0;\n        numbers.forEach(function (n) {\n            if (n < 0) {\n                throw new CalcError('NUM');\n            }\n            sum += n;\n            div *= _fact(n);\n        });\n        return _fact(sum) / div;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    var _combinations = util.memoize(function (n, k) {\n        for (var f1 = k + 1, f2 = 1, p1 = 1, p2 = 1; f2 <= n - k; ++f1, ++f2) {\n            p1 *= f1;\n            p2 *= f2;\n        }\n        return p1 / p2;\n    });\n    defineFunction('combin', _combinations).args([\n        [\n            '*n',\n            'integer++'\n        ],\n        [\n            '*k',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    0,\n                    '$n'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('combina', function (n, k) {\n        return _combinations(n + k - 1, n - 1);\n    }).args([\n        [\n            '*n',\n            'integer++'\n        ],\n        [\n            '*k',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    1,\n                    '$n'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('average', function (numbers) {\n        var sum = numbers.reduce(function (sum, num) {\n            return sum + num;\n        }, 0);\n        return sum / numbers.length;\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number!'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('averagea', function (values) {\n        var sum = 0, count = 0;\n        values.forEach(function (num) {\n            if (typeof num != 'string') {\n                sum += num;\n            }\n            ++count;\n        });\n        return count ? sum / count : new CalcError('DIV/0');\n    }).args([[\n            'values',\n            [\n                'collect',\n                'anyvalue'\n            ]\n        ]]);\n    function _percentile(numbers, rank) {\n        numbers.sort(ascending);\n        var n = numbers.length;\n        var k = rank | 0, d = rank - k;\n        if (k === 0) {\n            return numbers[0];\n        }\n        if (k >= n) {\n            return numbers[n - 1];\n        }\n        --k;\n        return numbers[k] + d * (numbers[k + 1] - numbers[k]);\n    }\n    function _percentile_inc(numbers, p) {\n        var rank = p * (numbers.length - 1) + 1;\n        return _percentile(numbers, rank);\n    }\n    function _percentile_exc(numbers, p) {\n        var rank = p * (numbers.length + 1);\n        return _percentile(numbers, rank);\n    }\n    defineFunction('percentile.inc', _percentile_inc).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('percentile.exc', _percentile_exc).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    0,\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('quartile.inc', function (numbers, quarter) {\n        return _percentile_inc(numbers, quarter / 4);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'quarter',\n            [\n                'values',\n                0,\n                1,\n                2,\n                3,\n                4\n            ]\n        ]\n    ]);\n    defineFunction('quartile.exc', function (numbers, quarter) {\n        return _percentile_exc(numbers, quarter / 4);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'quarter',\n            [\n                'values',\n                0,\n                1,\n                2,\n                3,\n                4\n            ]\n        ]\n    ]);\n    defineAlias('quartile', 'quartile.inc');\n    defineAlias('percentile', 'percentile.inc');\n    var AGGREGATE_FUNCS = [\n        'AVERAGE',\n        'COUNT',\n        'COUNTA',\n        'MAX',\n        'MIN',\n        'PRODUCT',\n        'STDEV.S',\n        'STDEV.P',\n        'SUM',\n        'VAR.S',\n        'VAR.P',\n        'MEDIAN',\n        'MODE.SNGL',\n        'LARGE',\n        'SMALL',\n        'PERCENTILE.INC',\n        'QUARTILE.INC',\n        'PERCENTILE.EXC',\n        'QUARTILE.EXC'\n    ];\n    function fetchValuesForAggregate(self, args, options) {\n        var values = [];\n        var opt_ignore_hidden_rows = 1;\n        var opt_ignore_errors = 2;\n        var opt_use_aggregates = 4;\n        (function fetchValues(args) {\n            if (args instanceof Ref) {\n                self.getRefCells(args, true).forEach(function (cell) {\n                    var value = cell.value;\n                    if (options & opt_ignore_hidden_rows && cell.hidden) {\n                        return;\n                    }\n                    if (cell.formula) {\n                        var str = cell.formula.print(cell.row, cell.col);\n                        if (/^\\s*(?:aggregate|subtotal)\\s*\\(/i.test(str)) {\n                            if (!(options & opt_use_aggregates)) {\n                                return;\n                            }\n                        }\n                        if ('value' in cell.formula) {\n                            value = cell.formula.value;\n                        }\n                    }\n                    if (options & opt_ignore_errors && value instanceof CalcError) {\n                        return;\n                    }\n                    if (typeof value == 'number' || value instanceof CalcError) {\n                        values.push(value);\n                    }\n                });\n            } else if (Array.isArray(args)) {\n                for (var i = 0; i < args.length; ++i) {\n                    fetchValues(args[i]);\n                }\n            } else if (args instanceof Matrix) {\n                args.each(fetchValues);\n            } else if (typeof args == 'number') {\n                values.push(args);\n            } else if (args instanceof CalcError && !(options & opt_ignore_errors)) {\n                values.push(args);\n            }\n        }(args));\n        return values;\n    }\n    defineFunction('aggregate', function (callback, funcId, options, args) {\n        var self = this;\n        self.resolveCells(args, function () {\n            var values;\n            if (funcId > 12) {\n                values = fetchValuesForAggregate(self, args[0], options);\n                var k = args[1];\n                if (k instanceof CellRef) {\n                    k = self.getRefData(k);\n                }\n                if (typeof k != 'number') {\n                    return callback(new CalcError('VALUE'));\n                }\n            } else {\n                values = fetchValuesForAggregate(self, args, options);\n            }\n            self.func(AGGREGATE_FUNCS[funcId - 1], callback, values);\n        });\n    }).argsAsync([\n        [\n            'funcId',\n            [\n                'values',\n                1,\n                2,\n                3,\n                4,\n                5,\n                6,\n                7,\n                8,\n                9,\n                10,\n                11,\n                12,\n                13,\n                14,\n                15,\n                16,\n                17,\n                18,\n                19\n            ]\n        ],\n        [\n            'options',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'values',\n                    0,\n                    1,\n                    2,\n                    3,\n                    4,\n                    5,\n                    6,\n                    7\n                ]\n            ]\n        ],\n        [\n            'args',\n            'rest'\n        ]\n    ]);\n    defineFunction('subtotal', function (callback, funcId) {\n        var self = this;\n        var ignoreHidden = funcId > 100;\n        if (ignoreHidden) {\n            funcId -= 100;\n        }\n        var args = [];\n        for (var i = 2; i < arguments.length; ++i) {\n            args.push(arguments[i]);\n        }\n        self.resolveCells(args, function () {\n            var values = fetchValuesForAggregate(self, args, ignoreHidden ? 1 : 0);\n            self.func(AGGREGATE_FUNCS[funcId - 1], callback, values);\n        });\n    }).argsAsync([\n        [\n            'funcId',\n            [\n                'values',\n                1,\n                2,\n                3,\n                4,\n                5,\n                6,\n                7,\n                8,\n                9,\n                10,\n                11,\n                101,\n                102,\n                103,\n                104,\n                105,\n                106,\n                107,\n                108,\n                109,\n                110,\n                111\n            ]\n        ],\n        [\n            '+',\n            [\n                'ref',\n                [\n                    'or',\n                    'ref',\n                    '#matrix'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('avedev', function (numbers) {\n        var avg = numbers.reduce(function (sum, num) {\n            return sum + num;\n        }, 0) / numbers.length;\n        return numbers.reduce(function (sum, num) {\n            return sum + Math.abs(num - avg);\n        }, 0) / numbers.length;\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    function _binom_dist(x, n, p, cumulative) {\n        if (!cumulative) {\n            return _combinations(n, x) * Math.pow(p, x) * Math.pow(1 - p, n - x);\n        } else {\n            var sum = 0;\n            for (var j = 0; j <= x; ++j) {\n                sum += _combinations(n, j) * Math.pow(p, j) * Math.pow(1 - p, n - j);\n            }\n            return sum;\n        }\n    }\n    defineFunction('binom.dist', _binom_dist).args([\n        [\n            'successes',\n            'integer+'\n        ],\n        [\n            'trials',\n            [\n                'and',\n                'integer',\n                [\n                    'assert',\n                    '$trials >= $successes'\n                ]\n            ]\n        ],\n        [\n            'probability',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineAlias('binomdist', 'binom.dist');\n    defineFunction('binom.inv', function (n, p, alpha) {\n        for (var x = 0; x <= n; ++x) {\n            if (_binom_dist(x, n, p, true) >= alpha) {\n                return x;\n            }\n        }\n        return new CalcError('N/A');\n    }).args([\n        [\n            'trials',\n            'integer+'\n        ],\n        [\n            'probability',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'alpha',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineAlias('critbinom', 'binom.inv');\n    defineFunction('binom.dist.range', function (n, p, s, s2) {\n        var sum = 0;\n        for (var k = s; k <= s2; ++k) {\n            sum += _combinations(n, k) * Math.pow(p, k) * Math.pow(1 - p, n - k);\n        }\n        return sum;\n    }).args([\n        [\n            'trials',\n            'integer+'\n        ],\n        [\n            'probability',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'successes_min',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    0,\n                    '$trials'\n                ]\n            ]\n        ],\n        [\n            'successes_max',\n            [\n                'or',\n                [\n                    'and',\n                    'integer',\n                    [\n                        '[between]',\n                        '$successes_min',\n                        '$trials'\n                    ]\n                ],\n                [\n                    'null',\n                    '$successes_min'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('negbinom.dist', function (x, k, p, cumulative) {\n        if (cumulative) {\n            var sum = 0;\n            while (x >= 0) {\n                sum += _combinations(x + k - 1, x) * Math.pow(p, k) * Math.pow(1 - p, x);\n                x--;\n            }\n            return sum;\n        }\n        return _combinations(x + k - 1, x) * Math.pow(p, k) * Math.pow(1 - p, x);\n    }).args([\n        [\n            'number_f',\n            'integer+'\n        ],\n        [\n            'number_s',\n            'integer+'\n        ],\n        [\n            'probability_s',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineAlias('negbinomdist', 'negbinom.dist');\n    defineFunction('address', function (row, col, abs, a1, sheet) {\n        var cell = new CellRef(row - 1, col - 1, abs - 1);\n        if (sheet) {\n            cell.setSheet(sheet, true);\n        }\n        return a1 ? cell.print(0, 0) : cell.print();\n    }).args([\n        [\n            'row',\n            'integer++'\n        ],\n        [\n            'col',\n            'integer++'\n        ],\n        [\n            'abs',\n            [\n                'or',\n                [\n                    'null',\n                    1\n                ],\n                [\n                    'values',\n                    1,\n                    2,\n                    3,\n                    4\n                ]\n            ]\n        ],\n        [\n            'a1',\n            [\n                'or',\n                [\n                    'null',\n                    true\n                ],\n                'logical'\n            ]\n        ],\n        [\n            'sheet',\n            [\n                'or',\n                'null',\n                'string'\n            ]\n        ]\n    ]);\n    defineFunction('areas', function (ref) {\n        var count = 0;\n        (function loop(x) {\n            if (x instanceof CellRef || x instanceof RangeRef) {\n                count++;\n            } else if (x instanceof UnionRef) {\n                x.refs.forEach(loop);\n            }\n        }(ref));\n        return count;\n    }).args([[\n            'ref',\n            'ref'\n        ]]);\n    defineFunction('choose', function (index, args) {\n        if (index > args.length) {\n            return new CalcError('N/A');\n        } else {\n            return args[index - 1];\n        }\n    }).args([\n        [\n            '*index',\n            'integer'\n        ],\n        [\n            '+',\n            [\n                'value',\n                'anything'\n            ]\n        ]\n    ]);\n    defineFunction('column', function (ref) {\n        if (!ref) {\n            return this.formula.col + 1;\n        }\n        if (ref instanceof CellRef) {\n            return ref.col + 1;\n        }\n        return this.asMatrix(ref).mapCol(function (col) {\n            return col + ref.topLeft.col + 1;\n        });\n    }).args([[\n            'ref',\n            [\n                'or',\n                'area',\n                'null'\n            ]\n        ]]);\n    defineFunction('columns', function (m) {\n        return m instanceof Ref ? m.width() : m.width;\n    }).args([[\n            'ref',\n            [\n                'or',\n                'area',\n                '#matrix'\n            ]\n        ]]);\n    defineFunction('formulatext', function (ref) {\n        var cell = this.getRefCells(ref)[0];\n        if (!cell.formula) {\n            return new CalcError('N/A');\n        }\n        return cell.formula.print(cell.row, cell.col);\n    }).args([[\n            'ref',\n            'ref'\n        ]]);\n    defineFunction('hlookup', function (value, m, row, approx) {\n        var resultCol = null;\n        m.eachCol(function (col) {\n            var data = m.get(0, col);\n            if (approx) {\n                if (data > value) {\n                    return true;\n                }\n                resultCol = col;\n            } else if (data === value) {\n                resultCol = col;\n                return true;\n            }\n        });\n        if (resultCol == null) {\n            return new CalcError('N/A');\n        }\n        return m.get(row - 1, resultCol);\n    }).args([\n        [\n            'value',\n            'anyvalue'\n        ],\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            'row',\n            'integer++'\n        ],\n        [\n            'approx',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('index', function (callback, ref, row, col, areanum) {\n        var self = this;\n        if (ref instanceof UnionRef) {\n            ref = ref.refs[areanum - 1];\n        }\n        if (!row && !col || !ref) {\n            return callback(new CalcError('N/A'));\n        }\n        if (ref instanceof CellRef) {\n            ref = ref.toRangeRef();\n        }\n        if (ref instanceof RangeRef) {\n            if (row && col) {\n                if (col > ref.width() || row > ref.height()) {\n                    return callback(new CalcError('REF'));\n                }\n                var cell = ref.toCell(row - 1, col - 1);\n                self.resolveCells([cell], function () {\n                    callback(self.getRefData(cell));\n                });\n                return;\n            }\n            if (!row) {\n                var colRange = ref.toColumn(col - 1);\n                self.resolveCells([colRange], function () {\n                    callback(self.asMatrix(colRange));\n                });\n                return;\n            }\n            if (!col) {\n                var rowRange = ref.toRow(row - 1);\n                self.resolveCells([rowRange], function () {\n                    callback(self.asMatrix(rowRange));\n                });\n                return;\n            }\n        } else if (ref instanceof Matrix) {\n            if (ref.width > 1 && ref.height > 1) {\n                if (row && col) {\n                    return callback(ref.get(row - 1, col - 1));\n                }\n                if (!row) {\n                    return callback(ref.mapRow(function (row) {\n                        return ref.get(row, col - 1);\n                    }));\n                }\n                if (!col) {\n                    return callback(ref.mapCol(function (col) {\n                        return ref.get(row - 1, col);\n                    }));\n                }\n            }\n            if (ref.width == 1) {\n                return callback(ref.get(row - 1, 0));\n            }\n            if (ref.height == 1) {\n                return callback(ref.get(0, col - 1));\n            }\n        } else {\n            callback(new CalcError('REF'));\n        }\n    }).argsAsync([\n        [\n            'range',\n            [\n                'or',\n                'ref',\n                'matrix'\n            ]\n        ],\n        [\n            'row',\n            [\n                'or',\n                'integer+',\n                'null'\n            ]\n        ],\n        [\n            'col',\n            [\n                'or',\n                'integer+',\n                'null'\n            ]\n        ],\n        [\n            'areanum',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('indirect', function (thing) {\n        try {\n            var f = this.formula;\n            var exp = calc.parseFormula(f.sheet, f.row, f.col, thing);\n            if (!(exp.ast instanceof Ref)) {\n                throw 1;\n            }\n            return exp.ast.absolute(f.row, f.col);\n        } catch (ex) {\n            return new CalcError('REF');\n        }\n    }).args([[\n            'thing',\n            'string'\n        ]]);\n    defineFunction('match', function (val, m, type) {\n        var index = 1, cmp;\n        if (type === 0) {\n            cmp = parseCriteria(val);\n        } else if (type === -1) {\n            cmp = parseCriteria('<=' + val);\n        } else if (type === 1) {\n            cmp = parseCriteria('>=' + val);\n        }\n        if (m.each(function (el) {\n                if (el != null && cmp(el)) {\n                    if (type !== 0 && val != el) {\n                        --index;\n                    }\n                    return true;\n                }\n                index++;\n            }, true) && index > 0) {\n            return index;\n        } else {\n            return new CalcError('N/A');\n        }\n    }).args([\n        [\n            'value',\n            'anyvalue'\n        ],\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    -1,\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('offset', function (ref, rows, cols, height, width) {\n        var topLeft = (ref instanceof CellRef ? ref : ref.topLeft).clone();\n        topLeft.row += rows;\n        topLeft.col += cols;\n        if (topLeft.row < 0 || topLeft.col < 0) {\n            return new CalcError('VALUE');\n        }\n        if (height > 1 || width > 1) {\n            return new RangeRef(topLeft, new CellRef(topLeft.row + height - 1, topLeft.col + width - 1)).setSheet(ref.sheet, ref.hasSheet());\n        }\n        return topLeft;\n    }).args([\n        [\n            'ref',\n            'area'\n        ],\n        [\n            '*rows',\n            'integer'\n        ],\n        [\n            '*cols',\n            'integer'\n        ],\n        [\n            '*height',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    '$ref.height()'\n                ]\n            ]\n        ],\n        [\n            '*width',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    '$ref.width()'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('row', function (ref) {\n        if (!ref) {\n            return this.formula.row + 1;\n        }\n        if (ref instanceof CellRef) {\n            return ref.row + 1;\n        }\n        return this.asMatrix(ref).mapRow(function (row) {\n            return row + ref.topLeft.row + 1;\n        });\n    }).args([[\n            'ref',\n            [\n                'or',\n                'area',\n                'null'\n            ]\n        ]]);\n    defineFunction('rows', function (m) {\n        return m instanceof Ref ? m.height() : m.height;\n    }).args([[\n            'ref',\n            [\n                'or',\n                'area',\n                '#matrix'\n            ]\n        ]]);\n    defineFunction('vlookup', function (value, m, col, approx) {\n        var resultRow = null;\n        if (typeof value != 'number') {\n            approx = false;\n        }\n        if (typeof value == 'string') {\n            value = value.toLowerCase();\n        }\n        m.eachRow(function (row) {\n            var data = m.get(row, 0);\n            if (approx) {\n                if (data > value) {\n                    return true;\n                }\n                resultRow = row;\n            } else {\n                if (typeof data == 'string') {\n                    data = data.toLowerCase();\n                }\n                if (data === value) {\n                    resultRow = row;\n                    return true;\n                }\n            }\n        });\n        if (resultRow == null) {\n            return new CalcError('N/A');\n        }\n        return m.get(resultRow, col - 1);\n    }).args([\n        [\n            'value',\n            'anyvalue'\n        ],\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            'col',\n            'integer++'\n        ],\n        [\n            'approx',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('date', function (year, month, date) {\n        return packDate(year, month - 1, date);\n    }).args([\n        [\n            '*year',\n            'integer'\n        ],\n        [\n            '*month',\n            'integer'\n        ],\n        [\n            '*date',\n            'integer'\n        ]\n    ]);\n    defineFunction('day', function (date) {\n        return unpackDate(date).date;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('month', function (date) {\n        return unpackDate(date).month + 1;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('year', function (date) {\n        return unpackDate(date).year;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('weekday', function (date) {\n        return unpackDate(date).day + 1;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('weeknum', function (date, type) {\n        var fw = packDate(unpackDate(date).year, 0, 1);\n        var sy = unpackDate(fw);\n        var diff;\n        if (type == 21) {\n            diff = 3 - (sy.day + 6) % 7;\n            if (diff < 0) {\n                diff += 7;\n            }\n            fw += diff;\n            sy.date += diff;\n            sy.day = 4;\n            type = 1;\n        } else {\n            if (type == 1) {\n                type = 0;\n            } else if (type == 2) {\n                type = 1;\n            } else {\n                type = (type - 10) % 7;\n            }\n        }\n        diff = sy.day - type;\n        if (diff < 0) {\n            diff += 7;\n        }\n        fw -= diff;\n        return Math.ceil((date + 1 - fw) / 7);\n    }).args([\n        [\n            '*date',\n            'date'\n        ],\n        [\n            '*type',\n            [\n                'or',\n                [\n                    'null',\n                    1\n                ],\n                [\n                    'values',\n                    1,\n                    2,\n                    11,\n                    12,\n                    13,\n                    14,\n                    15,\n                    16,\n                    17,\n                    21\n                ]\n            ]\n        ]\n    ]);\n    function weeksInYear(year) {\n        var d = unpackDate(packDate(year, 0, 1));\n        if (d.day == 4 || d.day == 3 && runtime.isLeapYear(year)) {\n            return 53;\n        }\n        return 52;\n    }\n    defineFunction('isoweeknum', function isoweeknum(date) {\n        var d = unpackDate(date);\n        var dow = d.day || 7;\n        var wk = Math.floor((d.ord - dow + 10) / 7);\n        if (wk < 1) {\n            return weeksInYear(d.year - 1);\n        } else if (wk == 53 && wk > weeksInYear(d.year)) {\n            return 1;\n        }\n        return wk;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('now', function () {\n        return runtime.dateToSerial(new Date());\n    }).args([]);\n    defineFunction('today', function () {\n        return runtime.dateToSerial(new Date()) | 0;\n    }).args([]);\n    defineFunction('time', function (hh, mm, ss) {\n        return runtime.packTime(hh, mm, ss, 0);\n    }).args([\n        [\n            '*hours',\n            'integer'\n        ],\n        [\n            '*minutes',\n            'integer'\n        ],\n        [\n            '*seconds',\n            'integer'\n        ]\n    ]);\n    defineFunction('hour', function (time) {\n        return runtime.unpackTime(time).hours;\n    }).args([[\n            '*time',\n            'datetime'\n        ]]);\n    defineFunction('minute', function (time) {\n        return runtime.unpackTime(time).minutes;\n    }).args([[\n            '*time',\n            'datetime'\n        ]]);\n    defineFunction('second', function (time) {\n        return runtime.unpackTime(time).seconds;\n    }).args([[\n            '*time',\n            'datetime'\n        ]]);\n    defineFunction('edate', function (base, months) {\n        var d = unpackDate(base);\n        var m = d.month + months;\n        var y = d.year + Math.floor(m / 12);\n        m %= 12;\n        if (m < 0) {\n            m += 12;\n        }\n        d = Math.min(d.date, daysInMonth(y, m));\n        return packDate(y, m, d);\n    }).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*months',\n            'integer'\n        ]\n    ]);\n    defineFunction('eomonth', function (base, months) {\n        var d = unpackDate(base);\n        var m = d.month + months;\n        var y = d.year + Math.floor(m / 12);\n        m %= 12;\n        if (m < 0) {\n            m += 12;\n        }\n        d = daysInMonth(y, m);\n        return packDate(y, m, d);\n    }).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*months',\n            'integer'\n        ]\n    ]);\n    defineFunction('workday', function (date, n, holidays) {\n        var inc = n > 0 ? 1 : -1;\n        n = Math.abs(n);\n        var dow = unpackDate(date).day;\n        while (n > 0) {\n            date += inc;\n            dow = (dow + inc) % 7;\n            if (dow > 0 && dow < 6 && holidays.indexOf(date) < 0) {\n                --n;\n            }\n        }\n        return date;\n    }).args([\n        [\n            'start_date',\n            'date'\n        ],\n        [\n            'days',\n            'integer'\n        ],\n        [\n            'holidays',\n            [\n                'collect',\n                'date'\n            ]\n        ]\n    ]);\n    defineFunction('networkdays', function (date, end, holidays) {\n        if (date > end) {\n            var tmp = date;\n            date = end;\n            end = tmp;\n        }\n        var count = 0;\n        var dow = unpackDate(date).day;\n        while (date <= end) {\n            if (dow > 0 && dow < 6 && holidays.indexOf(date) < 0) {\n                count++;\n            }\n            date++;\n            dow = (dow + 1) % 7;\n        }\n        return count;\n    }).args([\n        [\n            'start_date',\n            'date'\n        ],\n        [\n            'end_date',\n            'date'\n        ],\n        [\n            'holidays',\n            [\n                'collect',\n                'date'\n            ]\n        ]\n    ]);\n    defineFunction('days', function (start, end) {\n        return end - start;\n    }).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*end_date',\n            'date'\n        ]\n    ]);\n    function _days_360(start, end, method) {\n        var d1 = unpackDate(start);\n        var d2 = unpackDate(end);\n        if (method) {\n            if (d1.date == 31) {\n                d1.date = 30;\n            }\n            if (d2.date == 31) {\n                d2.date = 30;\n            }\n        } else {\n            if (d1.month == 1 && d2.month == 1 && d1.date == daysInMonth(d1.year, 1) && d2.date == daysInMonth(d2.year, 1)) {\n                d2.date = 30;\n            }\n            if (d1.date == daysInMonth(d1.year, d1.month)) {\n                d1.date = 30;\n                if (d2.date == 31) {\n                    d2.date = 30;\n                }\n            } else {\n                if (d1.date == 30 && d2.date == 31) {\n                    d2.date = 30;\n                }\n            }\n        }\n        return 360 * (d2.year - d1.year) + 30 * (d2.month - d1.month) + (d2.date - d1.date);\n    }\n    runtime._days_360 = _days_360;\n    defineFunction('days360', _days_360).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*end_date',\n            'date'\n        ],\n        [\n            '*method',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('yearfrac', function (start, end, method) {\n        switch (method) {\n        case 0:\n            return _days_360(start, end, false) / 360;\n        case 1:\n            return (end - start) / daysInYear(unpackDate(start).year);\n        case 2:\n            return (end - start) / 360;\n        case 3:\n            return (end - start) / 365;\n        case 4:\n            return _days_360(start, end, true) / 360;\n        }\n    }).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*end_date',\n            'date'\n        ],\n        [\n            '*method',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'values',\n                    0,\n                    1,\n                    2,\n                    3,\n                    4\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('datevalue', function (text) {\n        var date = runtime.parseDate(text);\n        if (date) {\n            return runtime.dateToSerial(date);\n        }\n        return new CalcError('VALUE');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('timevalue', function (text) {\n        var m = text.toLowerCase().match(/(\\d+):(\\d+)(:(\\d+)(\\.(\\d+))?)?\\s*(am?|pm?)?/);\n        if (m) {\n            var hh = parseFloat(m[1]);\n            var mm = parseFloat(m[2]);\n            var ss = m[3] ? parseFloat(m[4]) : 0;\n            var ampm = m[7];\n            if (ampm && (hh > 12 || hh < 1)) {\n                return new CalcError('VALUE');\n            }\n            if (/^p/.test(ampm)) {\n                hh += 12;\n            }\n            return runtime.packTime(hh, mm, ss, 0);\n        }\n        return new CalcError('VALUE');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('mdeterm', function (m) {\n        var error = m.each(function (val) {\n            if (typeof val != 'number') {\n                return new CalcError('VALUE');\n            }\n        }, true);\n        return error || m.determinant();\n    }).args([[\n            'm',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$m.width == $m.height'\n                ]\n            ]\n        ]]);\n    defineFunction('transpose', function (m) {\n        return m.transpose();\n    }).args([[\n            'range',\n            'matrix'\n        ]]);\n    defineFunction('mmult', function (a, b) {\n        return a.multiply(b);\n    }).args([\n        [\n            'a',\n            'matrix'\n        ],\n        [\n            'b',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$b.height == $a.width'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('munit', function (n) {\n        return new Matrix(this).unit(n);\n    }).args([[\n            'n',\n            'integer+'\n        ]]);\n    defineFunction('minverse', function (m) {\n        var error = m.each(function (val) {\n            if (typeof val != 'number') {\n                return new CalcError('VALUE');\n            }\n        }, true);\n        return error || m.inverse() || new CalcError('VALUE');\n    }).args([[\n            'm',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$m.width == $m.height'\n                ]\n            ]\n        ]]);\n    defineFunction('rand', function () {\n        return Math.random();\n    }).args([]);\n    defineFunction('randbetween', function (min, max) {\n        return min + Math.floor((max - min + 1) * Math.random());\n    }).args([\n        [\n            'min',\n            'integer'\n        ],\n        [\n            'max',\n            [\n                'and',\n                'integer',\n                [\n                    'assert',\n                    '$max >= $min'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('true', function () {\n        return true;\n    }).args([]);\n    defineFunction('false', function () {\n        return true;\n    }).args([]);\n    defineFunction('roman', function (num) {\n        return util.arabicToRoman(num).toUpperCase();\n    }).args([[\n            '*number',\n            'integer'\n        ]]);\n    defineFunction('arabic', function (rom) {\n        var num = util.romanToArabic(rom);\n        return num == null ? new CalcError('VALUE') : num;\n    }).args([[\n            '*roman',\n            'string'\n        ]]);\n    defineFunction('base', function (number, radix, minLen) {\n        var str = number.toString(radix).toUpperCase();\n        while (str.length < minLen) {\n            str = '0' + str;\n        }\n        return str;\n    }).args([\n        [\n            '*number',\n            'integer'\n        ],\n        [\n            '*radix',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    2,\n                    36\n                ]\n            ]\n        ],\n        [\n            '*minLen',\n            [\n                'or',\n                'integer+',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('decimal', function (text, radix) {\n        text = text.toUpperCase();\n        var val = 0;\n        for (var i = 0; i < text.length; ++i) {\n            var d = text.charCodeAt(i);\n            if (d >= 48 && d <= 57) {\n                d -= 48;\n            } else if (d >= 65 && d < 55 + radix) {\n                d -= 55;\n            } else {\n                return new CalcError('VALUE');\n            }\n            val = val * radix + d;\n        }\n        return val;\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*radix',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    2,\n                    36\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('char', function (code) {\n        return String.fromCharCode(code);\n    }).args([[\n            '*code',\n            'integer+'\n        ]]);\n    var RX_NON_PRINTABLE = /[\\0-\\x1F\\x7F-\\x9F\\xAD\\u0378\\u0379\\u037F-\\u0383\\u038B\\u038D\\u03A2\\u0528-\\u0530\\u0557\\u0558\\u0560\\u0588\\u058B-\\u058E\\u0590\\u05C8-\\u05CF\\u05EB-\\u05EF\\u05F5-\\u0605\\u061C\\u061D\\u06DD\\u070E\\u070F\\u074B\\u074C\\u07B2-\\u07BF\\u07FB-\\u07FF\\u082E\\u082F\\u083F\\u085C\\u085D\\u085F-\\u089F\\u08A1\\u08AD-\\u08E3\\u08FF\\u0978\\u0980\\u0984\\u098D\\u098E\\u0991\\u0992\\u09A9\\u09B1\\u09B3-\\u09B5\\u09BA\\u09BB\\u09C5\\u09C6\\u09C9\\u09CA\\u09CF-\\u09D6\\u09D8-\\u09DB\\u09DE\\u09E4\\u09E5\\u09FC-\\u0A00\\u0A04\\u0A0B-\\u0A0E\\u0A11\\u0A12\\u0A29\\u0A31\\u0A34\\u0A37\\u0A3A\\u0A3B\\u0A3D\\u0A43-\\u0A46\\u0A49\\u0A4A\\u0A4E-\\u0A50\\u0A52-\\u0A58\\u0A5D\\u0A5F-\\u0A65\\u0A76-\\u0A80\\u0A84\\u0A8E\\u0A92\\u0AA9\\u0AB1\\u0AB4\\u0ABA\\u0ABB\\u0AC6\\u0ACA\\u0ACE\\u0ACF\\u0AD1-\\u0ADF\\u0AE4\\u0AE5\\u0AF2-\\u0B00\\u0B04\\u0B0D\\u0B0E\\u0B11\\u0B12\\u0B29\\u0B31\\u0B34\\u0B3A\\u0B3B\\u0B45\\u0B46\\u0B49\\u0B4A\\u0B4E-\\u0B55\\u0B58-\\u0B5B\\u0B5E\\u0B64\\u0B65\\u0B78-\\u0B81\\u0B84\\u0B8B-\\u0B8D\\u0B91\\u0B96-\\u0B98\\u0B9B\\u0B9D\\u0BA0-\\u0BA2\\u0BA5-\\u0BA7\\u0BAB-\\u0BAD\\u0BBA-\\u0BBD\\u0BC3-\\u0BC5\\u0BC9\\u0BCE\\u0BCF\\u0BD1-\\u0BD6\\u0BD8-\\u0BE5\\u0BFB-\\u0C00\\u0C04\\u0C0D\\u0C11\\u0C29\\u0C34\\u0C3A-\\u0C3C\\u0C45\\u0C49\\u0C4E-\\u0C54\\u0C57\\u0C5A-\\u0C5F\\u0C64\\u0C65\\u0C70-\\u0C77\\u0C80\\u0C81\\u0C84\\u0C8D\\u0C91\\u0CA9\\u0CB4\\u0CBA\\u0CBB\\u0CC5\\u0CC9\\u0CCE-\\u0CD4\\u0CD7-\\u0CDD\\u0CDF\\u0CE4\\u0CE5\\u0CF0\\u0CF3-\\u0D01\\u0D04\\u0D0D\\u0D11\\u0D3B\\u0D3C\\u0D45\\u0D49\\u0D4F-\\u0D56\\u0D58-\\u0D5F\\u0D64\\u0D65\\u0D76-\\u0D78\\u0D80\\u0D81\\u0D84\\u0D97-\\u0D99\\u0DB2\\u0DBC\\u0DBE\\u0DBF\\u0DC7-\\u0DC9\\u0DCB-\\u0DCE\\u0DD5\\u0DD7\\u0DE0-\\u0DF1\\u0DF5-\\u0E00\\u0E3B-\\u0E3E\\u0E5C-\\u0E80\\u0E83\\u0E85\\u0E86\\u0E89\\u0E8B\\u0E8C\\u0E8E-\\u0E93\\u0E98\\u0EA0\\u0EA4\\u0EA6\\u0EA8\\u0EA9\\u0EAC\\u0EBA\\u0EBE\\u0EBF\\u0EC5\\u0EC7\\u0ECE\\u0ECF\\u0EDA\\u0EDB\\u0EE0-\\u0EFF\\u0F48\\u0F6D-\\u0F70\\u0F98\\u0FBD\\u0FCD\\u0FDB-\\u0FFF\\u10C6\\u10C8-\\u10CC\\u10CE\\u10CF\\u1249\\u124E\\u124F\\u1257\\u1259\\u125E\\u125F\\u1289\\u128E\\u128F\\u12B1\\u12B6\\u12B7\\u12BF\\u12C1\\u12C6\\u12C7\\u12D7\\u1311\\u1316\\u1317\\u135B\\u135C\\u137D-\\u137F\\u139A-\\u139F\\u13F5-\\u13FF\\u169D-\\u169F\\u16F1-\\u16FF\\u170D\\u1715-\\u171F\\u1737-\\u173F\\u1754-\\u175F\\u176D\\u1771\\u1774-\\u177F\\u17DE\\u17DF\\u17EA-\\u17EF\\u17FA-\\u17FF\\u180F\\u181A-\\u181F\\u1878-\\u187F\\u18AB-\\u18AF\\u18F6-\\u18FF\\u191D-\\u191F\\u192C-\\u192F\\u193C-\\u193F\\u1941-\\u1943\\u196E\\u196F\\u1975-\\u197F\\u19AC-\\u19AF\\u19CA-\\u19CF\\u19DB-\\u19DD\\u1A1C\\u1A1D\\u1A5F\\u1A7D\\u1A7E\\u1A8A-\\u1A8F\\u1A9A-\\u1A9F\\u1AAE-\\u1AFF\\u1B4C-\\u1B4F\\u1B7D-\\u1B7F\\u1BF4-\\u1BFB\\u1C38-\\u1C3A\\u1C4A-\\u1C4C\\u1C80-\\u1CBF\\u1CC8-\\u1CCF\\u1CF7-\\u1CFF\\u1DE7-\\u1DFB\\u1F16\\u1F17\\u1F1E\\u1F1F\\u1F46\\u1F47\\u1F4E\\u1F4F\\u1F58\\u1F5A\\u1F5C\\u1F5E\\u1F7E\\u1F7F\\u1FB5\\u1FC5\\u1FD4\\u1FD5\\u1FDC\\u1FF0\\u1FF1\\u1FF5\\u1FFF\\u200B-\\u200F\\u202A-\\u202E\\u2060-\\u206F\\u2072\\u2073\\u208F\\u209D-\\u209F\\u20BB-\\u20CF\\u20F1-\\u20FF\\u218A-\\u218F\\u23F4-\\u23FF\\u2427-\\u243F\\u244B-\\u245F\\u2700\\u2B4D-\\u2B4F\\u2B5A-\\u2BFF\\u2C2F\\u2C5F\\u2CF4-\\u2CF8\\u2D26\\u2D28-\\u2D2C\\u2D2E\\u2D2F\\u2D68-\\u2D6E\\u2D71-\\u2D7E\\u2D97-\\u2D9F\\u2DA7\\u2DAF\\u2DB7\\u2DBF\\u2DC7\\u2DCF\\u2DD7\\u2DDF\\u2E3C-\\u2E7F\\u2E9A\\u2EF4-\\u2EFF\\u2FD6-\\u2FEF\\u2FFC-\\u2FFF\\u3040\\u3097\\u3098\\u3100-\\u3104\\u312E-\\u3130\\u318F\\u31BB-\\u31BF\\u31E4-\\u31EF\\u321F\\u32FF\\u4DB6-\\u4DBF\\u9FCD-\\u9FFF\\uA48D-\\uA48F\\uA4C7-\\uA4CF\\uA62C-\\uA63F\\uA698-\\uA69E\\uA6F8-\\uA6FF\\uA78F\\uA794-\\uA79F\\uA7AB-\\uA7F7\\uA82C-\\uA82F\\uA83A-\\uA83F\\uA878-\\uA87F\\uA8C5-\\uA8CD\\uA8DA-\\uA8DF\\uA8FC-\\uA8FF\\uA954-\\uA95E\\uA97D-\\uA97F\\uA9CE\\uA9DA-\\uA9DD\\uA9E0-\\uA9FF\\uAA37-\\uAA3F\\uAA4E\\uAA4F\\uAA5A\\uAA5B\\uAA7C-\\uAA7F\\uAAC3-\\uAADA\\uAAF7-\\uAB00\\uAB07\\uAB08\\uAB0F\\uAB10\\uAB17-\\uAB1F\\uAB27\\uAB2F-\\uABBF\\uABEE\\uABEF\\uABFA-\\uABFF\\uD7A4-\\uD7AF\\uD7C7-\\uD7CA\\uD7FC-\\uF8FF\\uFA6E\\uFA6F\\uFADA-\\uFAFF\\uFB07-\\uFB12\\uFB18-\\uFB1C\\uFB37\\uFB3D\\uFB3F\\uFB42\\uFB45\\uFBC2-\\uFBD2\\uFD40-\\uFD4F\\uFD90\\uFD91\\uFDC8-\\uFDEF\\uFDFE\\uFDFF\\uFE1A-\\uFE1F\\uFE27-\\uFE2F\\uFE53\\uFE67\\uFE6C-\\uFE6F\\uFE75\\uFEFD-\\uFF00\\uFFBF-\\uFFC1\\uFFC8\\uFFC9\\uFFD0\\uFFD1\\uFFD8\\uFFD9\\uFFDD-\\uFFDF\\uFFE7\\uFFEF-\\uFFFB\\uFFFE\\uFFFF]/g;\n    defineFunction('clean', function (text) {\n        return text.replace(RX_NON_PRINTABLE, '');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('code', function (text) {\n        return text.charAt(0);\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineAlias('unichar', 'char');\n    defineAlias('unicode', 'code');\n    defineFunction('concatenate', function (args) {\n        var out = '';\n        for (var i = 0; i < args.length; ++i) {\n            out += args[i];\n        }\n        return out;\n    }).args([[\n            '+',\n            [\n                '*text',\n                'string'\n            ]\n        ]]);\n    defineFunction('dollar', function (number, decimals) {\n        var format = '$#,##0DECIMALS;($#,##0DECIMALS)';\n        var dec = '';\n        var denomitator = 1;\n        while (decimals-- > 0) {\n            dec += '0';\n        }\n        while (++decimals < 0) {\n            denomitator *= 10;\n        }\n        if (dec !== '') {\n            dec = '.' + dec;\n        } else if (denomitator !== 1) {\n            number = Math.round(number / denomitator) * denomitator;\n        }\n        format = format.replace(/DECIMALS/g, dec);\n        return spreadsheet.formatting.text(number, format);\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*decimals',\n            [\n                'or',\n                'integer',\n                [\n                    'null',\n                    2\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('exact', function (a, b) {\n        return a === b;\n    }).args([\n        [\n            '*text1',\n            'string'\n        ],\n        [\n            '*text2',\n            'string'\n        ]\n    ]);\n    defineFunction('find', function (substring, string, start) {\n        var pos = string.indexOf(substring, start - 1);\n        return pos < 0 ? new CalcError('VALUE') : pos + 1;\n    }).args([\n        [\n            '*substring',\n            'string'\n        ],\n        [\n            '*string',\n            'string'\n        ],\n        [\n            '*start',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('fixed', function (number, decimals, noCommas) {\n        var scale = Math.pow(10, decimals);\n        number = Math.round(number * scale) / scale;\n        var format = noCommas ? '0' : '#,##0';\n        if (decimals > 0) {\n            format += '.';\n            while (decimals-- > 0) {\n                format += '0';\n            }\n        }\n        return spreadsheet.formatting.text(number, format);\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*decimals',\n            [\n                'or',\n                'integer',\n                [\n                    'null',\n                    2\n                ]\n            ]\n        ],\n        [\n            '*noCommas',\n            [\n                'or',\n                'boolean',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('left', function (text, length) {\n        return text.substr(0, length);\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*length',\n            [\n                'or',\n                'integer+',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('right', function (text, length) {\n        return text.substr(-length);\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*length',\n            [\n                'or',\n                'integer+',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('len', function (text) {\n        return text.length;\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('lower', function (text) {\n        return text.toLowerCase();\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('upper', function (text) {\n        return text.toUpperCase();\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('ltrim', function (text) {\n        return text.replace(/^\\s+/, '');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('rtrim', function (text) {\n        return text.replace(/\\s+$/, '');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('trim', function (text) {\n        return text.replace(/^\\s+|\\s+$/, '');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('mid', function (text, start, length) {\n        return text.substr(start - 1, length);\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*start',\n            'integer++'\n        ],\n        [\n            '*length',\n            'integer+'\n        ]\n    ]);\n    defineFunction('proper', function (text) {\n        return text.toLowerCase().replace(/\\b./g, function (s) {\n            return s.toUpperCase();\n        });\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('replace', function (text, start, length, newText) {\n        return text.substr(0, --start) + newText + text.substr(start + length);\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*start',\n            'integer++'\n        ],\n        [\n            '*length',\n            'integer+'\n        ],\n        [\n            '*newText',\n            'string'\n        ]\n    ]);\n    defineFunction('rept', function (text, number) {\n        var out = '';\n        while (number-- > 0) {\n            out += text;\n        }\n        return out;\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*number',\n            'integer+'\n        ]\n    ]);\n    defineFunction('search', function (substring, string, start) {\n        var pos = string.toLowerCase().indexOf(substring.toLowerCase(), start - 1);\n        return pos < 0 ? new CalcError('VALUE') : pos + 1;\n    }).args([\n        [\n            '*substring',\n            'string'\n        ],\n        [\n            '*string',\n            'string'\n        ],\n        [\n            '*start',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('substitute', function (text, oldText, newText, nth) {\n        if (oldText === newText) {\n            return text;\n        }\n        var pos = -1;\n        function replace() {\n            text = text.substring(0, pos) + newText + text.substring(pos + oldText.length);\n        }\n        while ((pos = text.indexOf(oldText, pos + 1)) >= 0) {\n            if (nth == null) {\n                replace();\n            } else if (--nth === 0) {\n                replace();\n                break;\n            }\n        }\n        return text;\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*oldText',\n            'string'\n        ],\n        [\n            '*newText',\n            'string'\n        ],\n        [\n            '*nth',\n            [\n                'or',\n                'integer++',\n                'null'\n            ]\n        ]\n    ]);\n    defineFunction('t', function (value) {\n        return typeof value == 'string' ? value : '';\n    }).args([[\n            '*value',\n            'anyvalue'\n        ]]);\n    defineFunction('text', function (value, format) {\n        return spreadsheet.formatting.text(value, format);\n    }).args([\n        [\n            '*value',\n            'anyvalue'\n        ],\n        [\n            '*format',\n            'string'\n        ]\n    ]);\n    defineFunction('value', function (value) {\n        if (typeof value == 'number') {\n            return value;\n        }\n        if (typeof value == 'boolean') {\n            return +value;\n        }\n        value = (value + '').replace(/[$€,]/g, '');\n        value = parseFloat(value);\n        return isNaN(value) ? new CalcError('VALUE') : value;\n    }).args([[\n            '*value',\n            'anyvalue'\n        ]]);\n    function Hyperlink(link, text) {\n        this.link = link;\n        this.text = text;\n    }\n    Hyperlink.prototype.toString = function () {\n        return this.text;\n    };\n    defineFunction('hyperlink', function (link, text) {\n        return new Hyperlink(link, text);\n    }).args([\n        [\n            '*link',\n            'string'\n        ],\n        [\n            '*text',\n            [\n                'or',\n                'string',\n                [\n                    'null',\n                    '$link'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('iferror', function (value, valueIfError) {\n        return value instanceof CalcError ? valueIfError : value;\n    }).args([\n        [\n            '*value',\n            'forced!'\n        ],\n        [\n            '*value_if_error',\n            'anyvalue!'\n        ]\n    ]);\n    var parseCriteria = function () {\n        var RXCACHE = Object.create(null);\n        function makeComparator(cmp, x) {\n            if (typeof x == 'string') {\n                var num = parseFloat(x);\n                if (!isNaN(num) && num == x) {\n                    x = num;\n                }\n            }\n            return function (a) {\n                var b = x;\n                if (typeof a == 'string' && typeof b == 'string') {\n                    a = a.toLowerCase();\n                    b = b.toLowerCase();\n                }\n                return cmp(a, b);\n            };\n        }\n        function lc(a) {\n            var num, str;\n            if (typeof a == 'string') {\n                a = a.toLowerCase();\n            }\n            if (/^[0-9.]+%$/.test(a)) {\n                str = a.substr(0, a.length - 1);\n                num = parseFloat(str);\n                if (!isNaN(num) && num == str) {\n                    a = num / 100;\n                }\n            } else if (/^[0-9.]+$/.test(a)) {\n                num = parseFloat(a);\n                if (!isNaN(num) && num == a) {\n                    a = num;\n                }\n            }\n            return a;\n        }\n        function compLT(a, b) {\n            return lc(a) < lc(b);\n        }\n        function compLTE(a, b) {\n            return lc(a) <= lc(b);\n        }\n        function compGT(a, b) {\n            return lc(a) > lc(b);\n        }\n        function compGTE(a, b) {\n            return lc(a) >= lc(b);\n        }\n        function compNE(a, b) {\n            return !compEQ(a, b);\n        }\n        function compEQ(a, b) {\n            if (b instanceof RegExp) {\n                return b.test(a);\n            }\n            if (typeof a == 'string' || typeof b == 'string') {\n                a = String(a);\n                b = String(b);\n            }\n            return lc(a) == lc(b);\n        }\n        return function (cmp) {\n            if (typeof cmp == 'function') {\n                return cmp;\n            }\n            var m;\n            if (m = /^=(.*)$/.exec(cmp)) {\n                return makeComparator(compEQ, m[1]);\n            }\n            if (m = /^<>(.*)$/.exec(cmp)) {\n                return makeComparator(compNE, m[1]);\n            }\n            if (m = /^<=(.*)$/.exec(cmp)) {\n                return makeComparator(compLTE, m[1]);\n            }\n            if (m = /^<(.*)$/.exec(cmp)) {\n                return makeComparator(compLT, m[1]);\n            }\n            if (m = /^>=(.*)$/.exec(cmp)) {\n                return makeComparator(compGTE, m[1]);\n            }\n            if (m = /^>(.*)$/.exec(cmp)) {\n                return makeComparator(compGT, m[1]);\n            }\n            if (/[?*]/.exec(cmp)) {\n                var rx = RXCACHE[cmp];\n                if (!rx) {\n                    rx = cmp.replace(/(~\\?|~\\*|[\\]({\\+\\.\\|\\^\\$\\\\})\\[]|[?*])/g, function (s) {\n                        switch (s) {\n                        case '~?':\n                            return '\\\\?';\n                        case '~*':\n                            return '\\\\*';\n                        case '?':\n                            return '.';\n                        case '*':\n                            return '.*';\n                        default:\n                            return '\\\\' + s;\n                        }\n                    });\n                    rx = RXCACHE[cmp] = new RegExp('^' + rx + '$', 'i');\n                }\n                return makeComparator(compEQ, rx);\n            }\n            return makeComparator(compEQ, cmp);\n        };\n    }();\n    function numericPredicate(val) {\n        return typeof val == 'number' || typeof val == 'boolean' || val == null || val === '';\n    }\n    function ascending(a, b) {\n        return a === b ? 0 : a < b ? -1 : 1;\n    }\n    function descending(a, b) {\n        return a === b ? 0 : a < b ? 1 : -1;\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/runtime.functions.2', ['spreadsheet/runtime'], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var calc = spreadsheet.calc;\n    var runtime = calc.runtime;\n    var defineFunction = runtime.defineFunction;\n    var CalcError = runtime.CalcError;\n    var packDate = runtime.packDate;\n    var unpackDate = runtime.unpackDate;\n    var isLeapYear = runtime.isLeapYear;\n    var daysInMonth = runtime.daysInMonth;\n    var _days_360 = runtime._days_360;\n    defineFunction('ERF', function (ll, ul) {\n        if (ul == null) {\n            return ERF(ll);\n        }\n        return ERF(ul) - ERF(ll);\n    }).args([\n        [\n            'lower_limit',\n            'number'\n        ],\n        [\n            'upper_limit',\n            [\n                'or',\n                'number',\n                'null'\n            ]\n        ]\n    ]);\n    defineFunction('ERFC', ERFC).args([[\n            'x',\n            'number'\n        ]]);\n    defineFunction('GAMMALN', GAMMALN).args([[\n            'x',\n            'number++'\n        ]]);\n    defineFunction('GAMMA', GAMMA).args([[\n            'x',\n            'number'\n        ]]);\n    defineFunction('GAMMA.DIST', GAMMA_DIST).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('GAMMA.INV', GAMMA_INV).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ]\n    ]);\n    defineFunction('NORM.S.DIST', NORM_S_DIST).args([\n        [\n            'z',\n            'number'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('NORM.S.INV', NORM_S_INV).args([[\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ]]);\n    defineFunction('NORM.DIST', NORM_DIST).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'mean',\n            'number'\n        ],\n        [\n            'stddev',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('NORM.INV', NORM_INV).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'mean',\n            'number'\n        ],\n        [\n            'stddev',\n            'number++'\n        ]\n    ]);\n    defineFunction('BETADIST', BETADIST).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ],\n        [\n            'A',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'B',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$x >= $A',\n                'NUM'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$x <= $B',\n                'NUM'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$A < $B',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('BETA.DIST', BETA_DIST).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ],\n        [\n            'A',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'B',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$x >= $A',\n                'NUM'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$x <= $B',\n                'NUM'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$A < $B',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('BETA.INV', BETA_INV).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ],\n        [\n            'A',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'B',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('CHISQ.DIST', chisq_left).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('CHISQ.DIST.RT', chisq_right).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('CHISQ.INV', chisq_left_inv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('CHISQ.INV.RT', chisq_right_inv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('CHISQ.TEST', function (ac, ex) {\n        return chisq_test(ac.data, ex.data);\n    }).args([\n        [\n            'actual_range',\n            'matrix'\n        ],\n        [\n            'expected_range',\n            'matrix'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$actual_range.width == $expected_range.width'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$actual_range.height == $expected_range.height'\n            ]\n        ]\n    ]);\n    defineFunction('EXPON.DIST', expon).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'lambda',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('POISSON.DIST', poisson).args([\n        [\n            'x',\n            'integer+'\n        ],\n        [\n            'mean',\n            'number+'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('F.DIST', Fdist).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom1',\n            'integer++'\n        ],\n        [\n            'deg_freedom2',\n            'integer++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('F.DIST.RT', Fdist_right).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom1',\n            'integer++'\n        ],\n        [\n            'deg_freedom2',\n            'integer++'\n        ]\n    ]);\n    defineFunction('F.INV', Finv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom1',\n            'integer++'\n        ],\n        [\n            'deg_freedom2',\n            'integer++'\n        ]\n    ]);\n    defineFunction('F.INV.RT', Finv_right).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom1',\n            'integer++'\n        ],\n        [\n            'deg_freedom2',\n            'integer++'\n        ]\n    ]);\n    defineFunction('F.TEST', Ftest).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length >= 2',\n                'DIV/0'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array2.length >= 2',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('FISHER', fisher).args([[\n            'x',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    -1,\n                    1\n                ]\n            ]\n        ]]);\n    defineFunction('FISHERINV', fisherinv).args([[\n            'y',\n            'number'\n        ]]);\n    defineFunction('T.DIST', Tdist).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('T.DIST.RT', Tdist_right).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('T.DIST.2T', Tdist_2tail).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('T.INV', Tdist_inv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '(between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('T.INV.2T', Tdist_2tail_inv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '(between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('T.TEST', Tdist_test).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'tails',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2,\n                    3\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$type != 1 || $array1.length == $array2.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length >= 2',\n                'DIV/0'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array2.length >= 2',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('CONFIDENCE.T', confidence_t).args([\n        [\n            'alpha',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'standard_dev',\n            'number++'\n        ],\n        [\n            'size',\n            [\n                'and',\n                'integer++',\n                [\n                    'assert',\n                    '$size != 1',\n                    'DIV/0'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('CONFIDENCE.NORM', confidence_norm).args([\n        [\n            'alpha',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'standard_dev',\n            'number++'\n        ],\n        [\n            'size',\n            [\n                'and',\n                'integer++'\n            ]\n        ]\n    ]);\n    defineFunction('GAUSS', gauss).args([[\n            'z',\n            'number'\n        ]]);\n    defineFunction('PHI', phi).args([[\n            'x',\n            'number'\n        ]]);\n    defineFunction('LOGNORM.DIST', lognorm_dist).args([\n        [\n            'x',\n            'number++'\n        ],\n        [\n            'mean',\n            'number'\n        ],\n        [\n            'standard_dev',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('LOGNORM.INV', lognorm_inv).args([\n        [\n            'probability',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'mean',\n            'number'\n        ],\n        [\n            'standard_dev',\n            'number++'\n        ]\n    ]);\n    defineFunction('PROB', prob).args([\n        [\n            'x_range',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'prob_range',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'lower_limit',\n            'number'\n        ],\n        [\n            'upper_limit',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    '$lower_limit'\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$prob_range.length == $x_range.length',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('SLOPE', slope).args([\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length > 0 && $known_y.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('INTERCEPT', intercept).args([\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length > 0 && $known_y.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('PEARSON', pearson).args([\n        [\n            'array1',\n            [\n                'collect!',\n                'anything',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect!',\n                'anything',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array2.length == $array1.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array2.length > 0 && $array1.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('RSQ', rsq).args([\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length > 0 && $known_y.length > 0',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length != 1 && $known_y.length != 1',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('STEYX', steyx).args([\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length >= 3 && $known_y.length >= 3',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('FORECAST', forecast).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length > 0 && $known_y.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('LINEST', linest).args([\n        [\n            'known_y',\n            'matrix'\n        ],\n        [\n            'known_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'const',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ],\n        [\n            'stats',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('LOGEST', logest).args([\n        [\n            'known_y',\n            'matrix'\n        ],\n        [\n            'known_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'const',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ],\n        [\n            'stats',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('TREND', trend).args([\n        [\n            'known_y',\n            'matrix'\n        ],\n        [\n            'known_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'new_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'const',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('GROWTH', growth).args([\n        [\n            'known_y',\n            'matrix'\n        ],\n        [\n            'known_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'new_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'const',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('FV', FV).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'nper',\n            'number'\n        ],\n        [\n            'pmt',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'pv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$pmt || $pv'\n            ]\n        ]\n    ]);\n    defineFunction('PV', PV).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'nper',\n            'number'\n        ],\n        [\n            'pmt',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('PMT', PMT).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'nper',\n            'number'\n        ],\n        [\n            'pmt',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('NPER', NPER).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'pmt',\n            'number'\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('RATE', RATE).args([\n        [\n            'nper',\n            'number'\n        ],\n        [\n            'pmt',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'guess',\n            [\n                'or',\n                'number++',\n                [\n                    'null',\n                    0.01\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$pmt || $fv'\n            ]\n        ]\n    ]);\n    defineFunction('IPMT', IPMT).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'per',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$per >= 1 && $per <= $nper'\n            ]\n        ]\n    ]);\n    defineFunction('PPMT', PPMT).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'per',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$per >= 1 && $per <= $nper'\n            ]\n        ]\n    ]);\n    defineFunction('CUMPRINC', CUMPRINC).args([\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number++'\n        ],\n        [\n            'start_period',\n            'number++'\n        ],\n        [\n            'end_period',\n            'number++'\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$end_period >= $start_period',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('CUMIPMT', CUMIPMT).args([\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number++'\n        ],\n        [\n            'start_period',\n            'number++'\n        ],\n        [\n            'end_period',\n            'number++'\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$end_period >= $start_period',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('NPV', NPV).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'values',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$values.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('IRR', IRR).args([\n        [\n            'values',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'guess',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0.1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('EFFECT', EFFECT).args([\n        [\n            'nominal_rate',\n            'number++'\n        ],\n        [\n            'npery',\n            'integer++'\n        ]\n    ]);\n    defineFunction('NOMINAL', NOMINAL).args([\n        [\n            'effect_rate',\n            'number++'\n        ],\n        [\n            'npery',\n            'integer++'\n        ]\n    ]);\n    defineFunction('XNPV', XNPV).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'values',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'dates',\n            [\n                'collect',\n                'date',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$values.length == $dates.length',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('XIRR', XIRR).args([\n        [\n            'values',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'dates',\n            [\n                'collect',\n                'date',\n                1\n            ]\n        ],\n        [\n            'guess',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0.1\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$values.length == $dates.length',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('ISPMT', ISPMT).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'per',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$per >= 1 && $per <= $nper'\n            ]\n        ]\n    ]);\n    defineFunction('DB', DB).args([\n        [\n            'cost',\n            'number'\n        ],\n        [\n            'salvage',\n            'number'\n        ],\n        [\n            'life',\n            'number++'\n        ],\n        [\n            'period',\n            'number++'\n        ],\n        [\n            'month',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    12\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('DDB', DDB).args([\n        [\n            'cost',\n            'number'\n        ],\n        [\n            'salvage',\n            'number'\n        ],\n        [\n            'life',\n            'number++'\n        ],\n        [\n            'period',\n            'number++'\n        ],\n        [\n            'factor',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    2\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('SLN', SLN).args([\n        [\n            'cost',\n            'number'\n        ],\n        [\n            'salvage',\n            'number'\n        ],\n        [\n            'life',\n            'number++'\n        ]\n    ]);\n    defineFunction('SYD', SYD).args([\n        [\n            'cost',\n            'number'\n        ],\n        [\n            'salvage',\n            'number'\n        ],\n        [\n            'life',\n            'number++'\n        ],\n        [\n            'per',\n            'number++'\n        ]\n    ]);\n    defineFunction('VDB', VDB).args([\n        [\n            'cost',\n            'number+'\n        ],\n        [\n            'salvage',\n            'number+'\n        ],\n        [\n            'life',\n            'number++'\n        ],\n        [\n            'start_period',\n            'number+'\n        ],\n        [\n            'end_period',\n            'number+'\n        ],\n        [\n            'factor',\n            [\n                'or',\n                'number+',\n                [\n                    'null',\n                    2\n                ]\n            ]\n        ],\n        [\n            'no_switch',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$end_period >= $start_period',\n                'NUM'\n            ]\n        ]\n    ]);\n    var COUPS_ARGS = [\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'frequency',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2,\n                    4\n                ]\n            ]\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ];\n    defineFunction('COUPDAYBS', COUPDAYBS).args(COUPS_ARGS);\n    defineFunction('COUPDAYS', COUPDAYS).args(COUPS_ARGS);\n    defineFunction('COUPDAYSNC', COUPDAYSNC).args(COUPS_ARGS);\n    defineFunction('COUPPCD', COUPPCD).args(COUPS_ARGS);\n    defineFunction('COUPNCD', COUPNCD).args(COUPS_ARGS);\n    defineFunction('COUPNUM', COUPNUM).args(COUPS_ARGS);\n    defineFunction('ACCRINTM', ACCRINTM).args([\n        [\n            'issue',\n            'date'\n        ],\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'par',\n            [\n                'or',\n                [\n                    'null',\n                    1000\n                ],\n                'number++'\n            ]\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$issue < $settlement',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('ACCRINT', ACCRINT).args([\n        [\n            'issue',\n            'date'\n        ],\n        [\n            'first_interest',\n            'date'\n        ],\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'par',\n            [\n                'or',\n                [\n                    'null',\n                    1000\n                ],\n                'number++'\n            ]\n        ],\n        [\n            'frequency',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2,\n                    4\n                ]\n            ]\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            'calc_method',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$issue < $settlement',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('DISC', DISC).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'pr',\n            'number++'\n        ],\n        [\n            'redemption',\n            'number++'\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('INTRATE', INTRATE).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'investment',\n            'number++'\n        ],\n        [\n            'redemption',\n            'number++'\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('RECEIVED', RECEIVED).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'investment',\n            'number++'\n        ],\n        [\n            'discount',\n            'number++'\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('PRICE', PRICE).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'yld',\n            'number++'\n        ],\n        [\n            'redemption',\n            'number++'\n        ],\n        [\n            'frequency',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2,\n                    4\n                ]\n            ]\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('PRICEDISC', PRICEDISC).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'discount',\n            'number++'\n        ],\n        [\n            'redemption',\n            'number++'\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    var MAX_IT = 300, EPS = 2.2204e-16, FP_MIN = 1e-30, f_abs = Math.abs;\n    function ERF(x) {\n        if (f_abs(x) >= 3.3) {\n            return 1 - ERFC(x);\n        }\n        var S = x > 0 ? 1 : -1;\n        if (S == -1) {\n            x = -x;\n        }\n        var m = 0, an = 1;\n        for (var n = 1; n < 100; n++) {\n            m += an;\n            an *= 2 * x * x / (2 * n + 1);\n        }\n        return S * 2 / Math.sqrt(Math.PI) * x * Math.exp(-x * x) * m;\n    }\n    function ERFC(x) {\n        if (f_abs(x) < 3.3) {\n            return 1 - ERF(x);\n        }\n        var s = 1;\n        if (x < 0) {\n            s = -1;\n            x = -x;\n        }\n        var frac = x;\n        for (var n = 8; n >= 1; n -= 0.5) {\n            frac = x + n / frac;\n        }\n        frac = 1 / (x + frac);\n        return s == 1 ? Math.exp(-x * x) / Math.sqrt(Math.PI) * frac : 2 - Math.exp(-x * x) / Math.sqrt(Math.PI) * frac;\n    }\n    function GAMMALN(x) {\n        var cof = [\n            1.000000000190015,\n            76.18009172947146,\n            -86.50532032941678,\n            24.01409824083091,\n            -1.231739572450155,\n            0.001208650973866179,\n            -0.000005395239384953\n        ];\n        var y = x, tmp = x + 5.5, ser = cof[0];\n        tmp -= (x + 0.5) * Math.log(tmp);\n        for (var j = 1; j <= 6; j++) {\n            y += 1;\n            ser += cof[j] / y;\n        }\n        return -tmp + Math.log(Math.sqrt(2 * Math.PI) * ser / x);\n    }\n    function GAMMA(x) {\n        if (x > 0) {\n            return Math.exp(GAMMALN(x));\n        }\n        var pi = Math.PI, y = -x;\n        return -pi / (y * GAMMA(y) * Math.sin(pi * y));\n    }\n    function BETALN(a, b) {\n        return GAMMALN(a) + GAMMALN(b) - GAMMALN(a + b);\n    }\n    function BETA(a, b) {\n        return Math.exp(BETALN(a, b));\n    }\n    function gamma_inc(a, x) {\n        return x < a + 1 ? g_series(a, x) : 1 - g_contfrac(a, x);\n    }\n    function g_series(a, x) {\n        var sum = 1 / a, frac = sum, ap = a;\n        var gln = GAMMALN(a), n;\n        for (n = 1; n <= MAX_IT; n++) {\n            ap++;\n            frac *= x / ap;\n            sum += frac;\n            if (f_abs(frac) < f_abs(sum) * EPS) {\n                break;\n            }\n        }\n        return sum * Math.exp(-x + a * Math.log(x) - gln);\n    }\n    function g_contfrac(a, x) {\n        var f = FP_MIN, c = f, d = 0, aj = 1, bj = x + 1 - a;\n        var gln = GAMMALN(a);\n        for (var i = 1; i <= MAX_IT; i++) {\n            d = bj + aj * d;\n            if (f_abs(d) < FP_MIN) {\n                d = FP_MIN;\n            }\n            c = bj + aj / c;\n            if (f_abs(c) < FP_MIN) {\n                c = FP_MIN;\n            }\n            d = 1 / d;\n            var delta = c * d;\n            f *= delta;\n            if (f_abs(delta - 1) < EPS) {\n                break;\n            }\n            bj += 2;\n            aj = -i * (i - a);\n        }\n        return f * Math.exp(-x - gln + a * Math.log(x));\n    }\n    function GAMMA_DIST(x, a, b, cumulative) {\n        if (!cumulative) {\n            return Math.pow(x / b, a - 1) * Math.exp(-x / b) / (b * GAMMA(a));\n        }\n        return gamma_inc(a, x / b);\n    }\n    function GAMMA_INV(p, a, b) {\n        if (p === 0) {\n            return 0;\n        }\n        if (p == 1) {\n            return Infinity;\n        }\n        var m = 0, M = 10, x = 0, ab = a * b;\n        if (ab > 1) {\n            M *= ab;\n        }\n        for (var i = 0; i < MAX_IT; i++) {\n            x = 0.5 * (m + M);\n            var q = GAMMA_DIST(x, a, b, true);\n            if (f_abs(p - q) < 1e-16) {\n                break;\n            }\n            if (q > p) {\n                M = x;\n            } else {\n                m = x;\n            }\n        }\n        return x;\n    }\n    function NORM_S_DIST(x, cumulative) {\n        if (!cumulative) {\n            return Math.exp(-x * x / 2) / Math.sqrt(2 * Math.PI);\n        }\n        return 0.5 + 0.5 * ERF(x / Math.sqrt(2));\n    }\n    function NORM_S_INV(p) {\n        var a = [\n                -39.69683028665376,\n                220.9460984245205,\n                -275.9285104469687,\n                138.357751867269,\n                -30.66479806614716,\n                2.506628277459239\n            ], b = [\n                -54.47609879822406,\n                161.5858368580409,\n                -155.6989798598866,\n                66.80131188771972,\n                -13.28068155288572\n            ], c = [\n                -0.007784894002430293,\n                -0.3223964580411365,\n                -2.400758277161838,\n                -2.549732539343734,\n                4.374664141464968,\n                2.938163982698783\n            ], d = [\n                0.007784695709041462,\n                0.3224671290700398,\n                2.445134137142996,\n                3.754408661907416\n            ];\n        var plow = 0.02425, phigh = 1 - plow;\n        var q, r;\n        if (p < plow) {\n            q = Math.sqrt(-2 * Math.log(p));\n            return (((((c[0] * q + c[1]) * q + c[2]) * q + c[3]) * q + c[4]) * q + c[5]) / ((((d[0] * q + d[1]) * q + d[2]) * q + d[3]) * q + 1);\n        }\n        if (phigh < p) {\n            q = Math.sqrt(-2 * Math.log(1 - p));\n            return -(((((c[0] * q + c[1]) * q + c[2]) * q + c[3]) * q + c[4]) * q + c[5]) / ((((d[0] * q + d[1]) * q + d[2]) * q + d[3]) * q + 1);\n        }\n        q = p - 0.5;\n        r = q * q;\n        return (((((a[0] * r + a[1]) * r + a[2]) * r + a[3]) * r + a[4]) * r + a[5]) * q / (((((b[0] * r + b[1]) * r + b[2]) * r + b[3]) * r + b[4]) * r + 1);\n    }\n    function NORM_DIST(x, m, s, cumulative) {\n        if (!cumulative) {\n            return Math.exp(-(x - m) * (x - m) / (2 * s * s)) / (s * Math.sqrt(2 * Math.PI));\n        }\n        return NORM_S_DIST((x - m) / s, true);\n    }\n    function NORM_INV(p, m, s) {\n        return m + s * NORM_S_INV(p);\n    }\n    function betastd_pdf(x, a, b) {\n        return Math.exp((a - 1) * Math.log(x) + (b - 1) * Math.log(1 - x) - BETALN(a, b));\n    }\n    function betastd_cdf(x, a, b) {\n        var k = Math.exp(a * Math.log(x) + b * Math.log(1 - x) - BETALN(a, b));\n        return x < (a + 1) / (a + b + 2) ? k * beta_lentz(a, b, x) / a : 1 - k * beta_lentz(b, a, 1 - x) / b;\n    }\n    function beta_lentz(a, b, x) {\n        var m, m2;\n        var aa, c, d, del, h, qab, qam, qap;\n        qab = a + b;\n        qap = a + 1;\n        qam = a - 1;\n        c = 1;\n        d = 1 - qab * x / qap;\n        if (f_abs(d) < FP_MIN) {\n            d = FP_MIN;\n        }\n        d = 1 / d;\n        h = d;\n        for (m = 1; m <= MAX_IT; m++) {\n            m2 = 2 * m;\n            aa = m * (b - m) * x / ((qam + m2) * (a + m2));\n            d = 1 + aa * d;\n            if (f_abs(d) < FP_MIN) {\n                d = FP_MIN;\n            }\n            c = 1 + aa / c;\n            if (f_abs(c) < FP_MIN) {\n                c = FP_MIN;\n            }\n            d = 1 / d;\n            h *= d * c;\n            aa = -(a + m) * (qab + m) * x / ((a + m2) * (qap + m2));\n            d = 1 + aa * d;\n            if (f_abs(d) < FP_MIN) {\n                d = FP_MIN;\n            }\n            c = 1 + aa / c;\n            if (f_abs(c) < FP_MIN) {\n                c = FP_MIN;\n            }\n            d = 1 / d;\n            del = d * c;\n            h *= del;\n            if (f_abs(del - 1) < EPS) {\n                break;\n            }\n        }\n        return h;\n    }\n    function betastd_inv(p, a, b) {\n        var m = 0, M = 1, x = 0;\n        for (var i = 0; i < MAX_IT; i++) {\n            x = 0.5 * (m + M);\n            var q = betastd_cdf(x, a, b);\n            if (f_abs(p - q) < EPS) {\n                break;\n            }\n            if (q > p) {\n                M = x;\n            } else {\n                m = x;\n            }\n        }\n        return x;\n    }\n    function BETADIST(x, a, b, m, M) {\n        return betastd_cdf((x - m) / (M - m), a, b);\n    }\n    function BETA_DIST(x, a, b, cdf, m, M) {\n        if (cdf) {\n            return betastd_cdf((x - m) / (M - m), a, b);\n        }\n        return betastd_pdf((x - m) / (M - m), a, b) / (M - m);\n    }\n    function BETA_INV(p, a, b, m, M) {\n        return m + (M - m) * betastd_inv(p, a, b);\n    }\n    function chisq_left(x, n, cds) {\n        return GAMMA_DIST(x, n / 2, 2, cds);\n    }\n    function chisq_right(x, n) {\n        return 1 - chisq_left(x, n, true);\n    }\n    function chisq_left_inv(p, n) {\n        return GAMMA_INV(p, n / 2, 2);\n    }\n    function chisq_right_inv(p, n) {\n        return chisq_left_inv(1 - p, n);\n    }\n    function chisq_test(obsv, expect) {\n        var rows = obsv.length, cols = obsv[0].length;\n        var x = 0, i, j;\n        for (i = 0; i < rows; i++) {\n            for (j = 0; j < cols; j++) {\n                var eij = expect[i][j];\n                var delta = obsv[i][j] - eij;\n                delta *= delta;\n                x += delta / eij;\n            }\n        }\n        var n = (rows - 1) * (cols - 1);\n        return chisq_right(x, n);\n    }\n    function expon(x, r, cdf) {\n        if (cdf) {\n            return 1 - Math.exp(-r * x);\n        }\n        return r * Math.exp(-r * x);\n    }\n    function poisson(k, m, cdf) {\n        if (cdf) {\n            return 1 - chisq_left(2 * m, 2 * (k + 1), true);\n        }\n        var lnf = 0;\n        for (var i = 2; i <= k; i++) {\n            lnf += Math.log(i);\n        }\n        return Math.exp(k * Math.log(m) - m - lnf);\n    }\n    function Fdist(x, n, d, cdf) {\n        if (cdf) {\n            return betastd_cdf(n * x / (d + n * x), n / 2, d / 2);\n        }\n        var u = n / d;\n        n /= 2;\n        d /= 2;\n        return u / BETA(n, d) * Math.pow(u * x, n - 1) / Math.pow(1 + u * x, n + d);\n    }\n    function Fdist_right(x, n, d) {\n        return 1 - Fdist(x, n, d, true);\n    }\n    function Finv_right(p, n, d) {\n        return d / n * (1 / BETA_INV(p, d / 2, n / 2, 0, 1) - 1);\n    }\n    function Finv(p, n, d) {\n        return d / n * (1 / BETA_INV(1 - p, d / 2, n / 2, 0, 1) - 1);\n    }\n    function _mean(arr) {\n        var me = 0, n = arr.length;\n        for (var i = 0; i < n; i++) {\n            me += arr[i];\n        }\n        return me / n;\n    }\n    function _var_sq(arr, m) {\n        var v = 0, n = arr.length;\n        for (var i = 0; i < n; i++) {\n            var delta = arr[i] - m;\n            v += delta * delta;\n        }\n        return v / (n - 1);\n    }\n    function Ftest(arr1, arr2) {\n        var n1 = arr1.length - 1, n2 = arr2.length - 1;\n        var va1 = _var_sq(arr1, _mean(arr1)), va2 = _var_sq(arr2, _mean(arr2));\n        if (!va1 || !va2) {\n            throw new CalcError('DIV/0');\n        }\n        return 2 * Fdist(va1 / va2, n1, n2, true);\n    }\n    function fisher(x) {\n        return 0.5 * Math.log((1 + x) / (1 - x));\n    }\n    function fisherinv(x) {\n        var e2 = Math.exp(2 * x);\n        return (e2 - 1) / (e2 + 1);\n    }\n    function Tdist(x, n, cdf) {\n        if (cdf) {\n            return 1 - 0.5 * betastd_cdf(n / (x * x + n), n / 2, 0.5);\n        }\n        return 1 / (Math.sqrt(n) * BETA(0.5, n / 2)) * Math.pow(1 + x * x / n, -(n + 1) / 2);\n    }\n    function Tdist_right(x, n) {\n        return 1 - Tdist(x, n, true);\n    }\n    function Tdist_2tail(x, n) {\n        if (x < 0) {\n            x = -x;\n        }\n        return 2 * Tdist_right(x, n);\n    }\n    function Tdist_inv(p, n) {\n        var x = betastd_inv(2 * Math.min(p, 1 - p), n / 2, 0.5);\n        x = Math.sqrt(n * (1 - x) / x);\n        return p > 0.5 ? x : -x;\n    }\n    function Tdist_2tail_inv(p, n) {\n        return Tdist_inv(1 - p / 2, n);\n    }\n    function Tdist_test(gr1, gr2, tail, type) {\n        var n1 = gr1.length, n2 = gr2.length;\n        var t_st, df;\n        if (type == 1) {\n            var d = 0, d2 = 0;\n            for (var i = 0; i < n1; i++) {\n                var delta = gr1[i] - gr2[i];\n                d += delta;\n                d2 += delta * delta;\n            }\n            var md = d / n1;\n            t_st = md / Math.sqrt((d2 - d * md) / (n1 * (n1 - 1)));\n            return tail == 1 ? Tdist_right(t_st, n1 - 1) : Tdist_2tail(t_st, n1 - 1);\n        }\n        var m1 = _mean(gr1), m2 = _mean(gr2), v1 = _var_sq(gr1, m1), v2 = _var_sq(gr2, m2);\n        if (type == 3) {\n            var u1 = v1 / n1, u2 = v2 / n2, u = u1 + u2;\n            var q1 = u1 / u, q2 = u2 / u;\n            df = 1 / (q1 * q1 / (n1 - 1) + q2 * q2 / (n2 - 1));\n            t_st = f_abs(m1 - m2) / Math.sqrt(u);\n            return tail == 1 ? Tdist_right(t_st, df) : Tdist_2tail(t_st, df);\n        } else {\n            df = n1 + n2 - 2;\n            t_st = f_abs(m1 - m2) * Math.sqrt(df * n1 * n2 / ((n1 + n2) * ((n1 - 1) * v1 + (n2 - 1) * v2)));\n            return tail == 1 ? Tdist_right(t_st, df) : Tdist_2tail(t_st, df);\n        }\n    }\n    function confidence_t(alpha, stddev, size) {\n        return -Tdist_inv(alpha / 2, size - 1) * stddev / Math.sqrt(size);\n    }\n    function confidence_norm(alpha, stddev, size) {\n        return -NORM_S_INV(alpha / 2) * stddev / Math.sqrt(size);\n    }\n    function gauss(z) {\n        return NORM_S_DIST(z, true) - 0.5;\n    }\n    function phi(x) {\n        return NORM_S_DIST(x);\n    }\n    function lognorm_dist(x, m, s, cumulative) {\n        if (cumulative) {\n            return 0.5 + 0.5 * ERF((Math.log(x) - m) / (s * Math.sqrt(2)));\n        }\n        var t = Math.log(x) - m;\n        return Math.exp(-t * t / (2 * s * s)) / (x * s * Math.sqrt(2 * Math.PI));\n    }\n    function lognorm_inv(p, m, s) {\n        return Math.exp(NORM_INV(p, m, s));\n    }\n    function prob(x_, p_, lw, up) {\n        var n = x_.length;\n        var s = 0, i;\n        for (i = 0; i < n; i++) {\n            if (p_[i] <= 0 || p_[i] > 1) {\n                throw new CalcError('NUM');\n            }\n            s += p_[i];\n        }\n        if (s != 1) {\n            throw new CalcError('NUM');\n        }\n        var res = 0;\n        for (i = 0; i < n; i++) {\n            var x = x_[i];\n            if (x >= lw && x <= up) {\n                res += p_[i];\n            }\n        }\n        return res;\n    }\n    function slope(y_, x_) {\n        var mx = _mean(x_), my = _mean(y_), b1 = 0, b2 = 0;\n        for (var i = 0, n = y_.length; i < n; i++) {\n            var t = x_[i] - mx;\n            b1 += t * (y_[i] - my);\n            b2 += t * t;\n        }\n        return b1 / b2;\n    }\n    function intercept(y_, x_) {\n        var mx = _mean(x_), my = _mean(y_);\n        var b1 = 0, b2 = 0;\n        for (var i = 0, n = y_.length; i < n; i++) {\n            var t = x_[i] - mx;\n            b1 += t * (y_[i] - my);\n            b2 += t * t;\n        }\n        return my - b1 * mx / b2;\n    }\n    function pearson(x_, y_) {\n        whipNumberArrays(x_, y_);\n        var mx = _mean(x_), my = _mean(y_);\n        var s1 = 0, s2 = 0, s3 = 0;\n        for (var i = 0, n = x_.length; i < n; i++) {\n            var t1 = x_[i] - mx, t2 = y_[i] - my;\n            s1 += t1 * t2;\n            s2 += t1 * t1;\n            s3 += t2 * t2;\n        }\n        return s1 / Math.sqrt(s2 * s3);\n    }\n    function rsq(x_, y_) {\n        var r = pearson(x_, y_);\n        return r * r;\n    }\n    function steyx(y_, x_) {\n        var n = x_.length;\n        var mx = _mean(x_), my = _mean(y_);\n        var s1 = 0, s2 = 0, s3 = 0;\n        for (var i = 0; i < n; i++) {\n            var t1 = x_[i] - mx, t2 = y_[i] - my;\n            s1 += t2 * t2;\n            s2 += t1 * t2;\n            s3 += t1 * t1;\n        }\n        return Math.sqrt((s1 - s2 * s2 / s3) / (n - 2));\n    }\n    function forecast(x, y_, x_) {\n        var mx = _mean(x_), my = _mean(y_);\n        var s1 = 0, s2 = 0;\n        for (var i = 0, n = x_.length; i < n; i++) {\n            var t1 = x_[i] - mx, t2 = y_[i] - my;\n            s1 += t1 * t2;\n            s2 += t1 * t1;\n        }\n        if (s2 === 0) {\n            throw new CalcError('N/A');\n        }\n        var b = s1 / s2, a = my - b * mx;\n        return a + b * x;\n    }\n    function _mat_mean(Mat) {\n        var n = Mat.height, sum = 0;\n        for (var i = 0; i < n; i++) {\n            sum += Mat.data[i][0];\n        }\n        return sum / n;\n    }\n    function _mat_devsq(Mat, mean) {\n        var n = Mat.height, sq = 0;\n        for (var i = 0; i < n; i++) {\n            var x = Mat.data[i][0] - mean;\n            sq += x * x;\n        }\n        return sq;\n    }\n    function linest(Y, X, konst, stats) {\n        var i = 0;\n        if (!X) {\n            X = Y.map(function () {\n                return ++i;\n            });\n        }\n        if (konst) {\n            X = X.clone();\n            X.eachRow(function (row) {\n                X.data[row].unshift(1);\n            });\n            ++X.width;\n        }\n        var Xt = X.transpose();\n        var B = Xt.multiply(X).inverse().multiply(Xt).multiply(Y);\n        var line_1 = [];\n        for (i = B.height - 1; i >= 0; i--) {\n            line_1.push(B.data[i][0]);\n        }\n        if (!konst) {\n            line_1.push(0);\n        }\n        if (!stats) {\n            return this.asMatrix([line_1]);\n        }\n        var Y1 = X.multiply(B);\n        var y_y1 = Y.adds(Y1, true);\n        var mp = !konst ? 0 : _mat_mean(Y1);\n        var SSreg = _mat_devsq(Y1, mp);\n        var me = !konst ? 0 : _mat_mean(y_y1);\n        var SSresid = _mat_devsq(y_y1, me);\n        var line_5 = [];\n        line_5.push(SSreg, SSresid);\n        var R2 = SSreg / (SSreg + SSresid);\n        var degfre = Y.height - X.width;\n        var err_est = Math.sqrt(SSresid / degfre);\n        var line_3 = [];\n        line_3.push(R2, err_est);\n        var F_sta = !konst ? R2 / X.width / ((1 - R2) / degfre) : SSreg / (X.width - 1) / (SSresid / degfre);\n        var line_4 = [];\n        line_4.push(F_sta, degfre);\n        var SCP = Xt.multiply(X).inverse();\n        var line_2 = [];\n        for (i = SCP.height - 1; i >= 0; i--) {\n            line_2.push(Math.sqrt(SCP.data[i][i] * SSresid / degfre));\n        }\n        return this.asMatrix([\n            line_1,\n            line_2,\n            line_3,\n            line_4,\n            line_5\n        ]);\n    }\n    function logest(Y, X, konst, stats) {\n        return linest.call(this, Y.map(Math.log), X, konst, stats).map(Math.exp);\n    }\n    function trend(Y, X, W, konst) {\n        var i = 0;\n        if (!X) {\n            X = Y.map(function () {\n                return ++i;\n            });\n        }\n        if (konst) {\n            X = X.clone();\n            X.eachRow(function (row) {\n                X.data[row].unshift(1);\n            });\n            ++X.width;\n        }\n        var Xt = X.transpose();\n        var B = Xt.multiply(X).inverse().multiply(Xt).multiply(Y);\n        if (!W) {\n            W = X;\n        } else {\n            if (konst) {\n                W = W.clone();\n                W.eachRow(function (row) {\n                    W.data[row].unshift(1);\n                });\n                ++W.width;\n            }\n        }\n        return W.multiply(B);\n    }\n    function growth(Y, X, new_X, konst) {\n        return trend.call(this, Y.map(Math.log), X, new_X, konst).map(Math.exp);\n    }\n    function root_newton(func, guess, max_it, eps) {\n        var MAX_IT = max_it || 20, EPS = eps || 1e-7;\n        var root = guess;\n        for (var j = 1; j <= MAX_IT; j++) {\n            var f_d = func(root), f = f_d[0], df = f_d[1];\n            var dx = f / df;\n            root -= dx;\n            if (Math.abs(dx) < EPS) {\n                return root;\n            }\n        }\n        return new CalcError('NUM');\n    }\n    function FV(rate, nper, pmt, pv, type) {\n        var h1 = Math.pow(1 + rate, nper);\n        var h2 = rate ? (h1 - 1) / rate : nper;\n        return -(pv * h1 + pmt * h2 * (1 + rate * type));\n    }\n    function PV(rate, nper, pmt, fv, type) {\n        if (!rate) {\n            return -fv - pmt * nper;\n        }\n        var h1 = Math.pow(1 + rate, nper);\n        return -(fv + pmt * (h1 - 1) / rate * (1 + rate * type)) / h1;\n    }\n    function PMT(rate, nper, pv, fv, type) {\n        if (!rate) {\n            return -(fv + pv) / nper;\n        }\n        var h1 = Math.pow(1 + rate, nper);\n        return -rate * (fv + pv * h1) / ((1 + rate * type) * (h1 - 1));\n    }\n    function NPER(rate, pmt, pv, fv, type) {\n        if (!rate) {\n            return -(fv + pv) / pmt;\n        }\n        var h1 = pmt * (1 + rate * type);\n        return Math.log((h1 - fv * rate) / (h1 + pv * rate)) / Math.log(1 + rate);\n    }\n    function RATE(nper, pmt, pv, fv, type, guess) {\n        function xfd(x) {\n            var h2 = Math.pow(1 + x, nper - 1), h1 = h2 * (1 + x);\n            return [\n                pv * h1 + pmt * (1 / x + type) * (h1 - 1) + fv,\n                nper * pv * h2 + pmt * (-(h1 - 1) / (x * x) + (1 / x + type) * nper * h2)\n            ];\n        }\n        return root_newton(xfd, guess);\n    }\n    function IPMT(rate, per, nper, pv, fv, type) {\n        if (type == 1 && per == 1) {\n            return 0;\n        }\n        var pmt = PMT(rate, nper, pv, fv, type);\n        var ipmt = FV(rate, per - 1, pmt, pv, type) * rate;\n        return type ? ipmt / (1 + rate) : ipmt;\n    }\n    function PPMT(rate, per, nper, pv, fv, type) {\n        var pmt = PMT(rate, nper, pv, fv, type);\n        return pmt - IPMT(rate, per, nper, pv, fv, type);\n    }\n    function CUMPRINC(rate, nper, pv, start, end, type) {\n        if (type == 1) {\n            start--;\n            end--;\n        }\n        var tn = Math.pow(1 + rate, nper), ts = Math.pow(1 + rate, start - 1), te = Math.pow(1 + rate, end);\n        var monthlyPayment = rate * pv * tn / (tn - 1);\n        var remainingBalanceAtStart = ts * pv - (ts - 1) / rate * monthlyPayment;\n        var remainingBalanceAtEnd = te * pv - (te - 1) / rate * monthlyPayment;\n        return remainingBalanceAtEnd - remainingBalanceAtStart;\n    }\n    function CUMIPMT(rate, nper, pv, start, end, type) {\n        var cip = 0;\n        for (var i = start; i <= end; i++) {\n            cip += IPMT(rate, i, nper, pv, 0, type);\n        }\n        return cip;\n    }\n    function NPV(rate, flows) {\n        var npv = 0;\n        for (var i = 0, n = flows.length; i < n; i++) {\n            npv += flows[i] * Math.pow(1 + rate, -i - 1);\n        }\n        return npv;\n    }\n    function IRR(flows, guess) {\n        function xfd(x) {\n            var npv = 0, npv1 = 0;\n            for (var j = 0, n = flows.length; j < n; j++) {\n                npv += flows[j] * Math.pow(1 + x, -j - 1);\n                npv1 += -j * flows[j] * Math.pow(1 + x, -j - 2);\n            }\n            return [\n                npv,\n                npv1\n            ];\n        }\n        return root_newton(xfd, guess);\n    }\n    function EFFECT(nominal_rate, npery) {\n        return Math.pow(1 + nominal_rate / npery, npery) - 1;\n    }\n    function NOMINAL(effect_rate, npery) {\n        return npery * (Math.pow(effect_rate + 1, 1 / npery) - 1);\n    }\n    function XNPV(rate, values, dates) {\n        var npv = 0;\n        for (var i = 0, n = values.length; i < n; i++) {\n            npv += values[i] * Math.pow(1 + rate, (dates[0] - dates[i]) / 365);\n        }\n        return npv;\n    }\n    function XIRR(values, dates, guess) {\n        function xfd(x) {\n            var npv = values[0], npv1 = 0;\n            for (var j = 1, n = values.length; j < n; j++) {\n                var delta = (dates[0] - dates[j]) / 365;\n                npv += values[j] * Math.pow(1 + x, delta);\n                npv1 += delta * values[j] * Math.pow(1 + x, delta - 1);\n            }\n            return [\n                npv,\n                npv1\n            ];\n        }\n        return root_newton(xfd, guess);\n    }\n    function ISPMT(rate, per, nper, pv) {\n        var tmp = -pv * rate;\n        return tmp * (1 - per / nper);\n    }\n    function DB(cost, salvage, life, period, month) {\n        var rate = 1 - Math.pow(salvage / cost, 1 / life);\n        rate = Math.floor(rate * 1000 + 0.5) / 1000;\n        var db = cost * rate * month / 12;\n        if (period == 1) {\n            return db;\n        }\n        for (var i = 1; i < life; i++) {\n            if (i == period - 1) {\n                return (cost - db) * rate;\n            }\n            db += (cost - db) * rate;\n        }\n        return (cost - db) * rate * (12 - month) / 12;\n    }\n    function DDB(cost, salvage, life, period, factor) {\n        var f = factor / life;\n        var prior = -cost * (Math.pow(1 - f, period - 1) - 1);\n        var dep = (cost - prior) * f;\n        dep = Math.min(dep, Math.max(0, cost - prior - salvage));\n        return dep;\n    }\n    function SLN(cost, salvage, life) {\n        return (cost - salvage) / life;\n    }\n    function SYD(cost, salvage, life, per) {\n        return (cost - salvage) * (life - per + 1) * 2 / (life * (life + 1));\n    }\n    function VDB(cost, salvage, life, start, end, factor, no_switch) {\n        var interest = factor >= life ? 1 : factor / life;\n        function _getGDA(value, period) {\n            var gda, oldValue, newValue;\n            if (interest == 1) {\n                oldValue = period == 1 ? value : 0;\n            } else {\n                oldValue = value * Math.pow(1 - interest, period - 1);\n            }\n            newValue = value * Math.pow(1 - interest, period);\n            gda = newValue < salvage ? oldValue - salvage : oldValue - newValue;\n            return gda < 0 ? 0 : gda;\n        }\n        function _interVDB(cost, life1, period) {\n            var remValue = cost - salvage;\n            var intEnd = Math.ceil(period);\n            var term, lia = 0, vdb = 0, nowLia = false;\n            for (var i = 1; i <= intEnd; i++) {\n                if (!nowLia) {\n                    var gda = _getGDA(cost, i);\n                    lia = remValue / (life1 - i + 1);\n                    if (lia > gda) {\n                        term = lia;\n                        nowLia = true;\n                    } else {\n                        term = gda;\n                        remValue -= gda;\n                    }\n                } else {\n                    term = lia;\n                }\n                if (i == intEnd) {\n                    term *= period + 1 - intEnd;\n                }\n                vdb += term;\n            }\n            return vdb;\n        }\n        var intStart = Math.floor(start), intEnd = Math.ceil(end);\n        var vdb = 0;\n        if (no_switch) {\n            for (var i = intStart + 1; i <= intEnd; i++) {\n                var term = _getGDA(cost, i);\n                if (i == intStart + 1) {\n                    term *= Math.min(end, intStart + 1) - start;\n                } else {\n                    if (i == intEnd) {\n                        term *= end + 1 - intEnd;\n                    }\n                }\n                vdb += term;\n            }\n        } else {\n            var life1 = life;\n            if (start != Math.floor(start)) {\n                if (factor > 1) {\n                    if (start >= life / 2) {\n                        var part = start - life / 2;\n                        start = life / 2;\n                        end -= part;\n                        life1 += 1;\n                    }\n                }\n            }\n            cost -= _interVDB(cost, life1, start);\n            vdb = _interVDB(cost, life - start, end - start);\n        }\n        return vdb;\n    }\n    function _edate(base, months) {\n        var d = unpackDate(base);\n        var m = d.month + months;\n        var y = d.year + Math.floor(m / 12);\n        m %= 12;\n        if (m < 0) {\n            m += 12;\n        }\n        d = Math.min(d.date, daysInMonth(y, m));\n        return packDate(y, m, d);\n    }\n    function _daysBetween(from, to, basis) {\n        if (basis == 1 || basis == 2 || basis == 3) {\n            return to - from;\n        }\n        return _days_360(from, to, basis);\n    }\n    function _borderCoupons(settlement, maturity, freq) {\n        var sett = unpackDate(settlement), base = unpackDate(maturity);\n        var periods = base.year - sett.year;\n        if (periods > 0) {\n            periods = (periods - 1) * freq;\n        }\n        var prev, next, months = 12 / freq;\n        do {\n            periods++;\n            prev = _edate(maturity, -periods * months);\n        } while (settlement < prev);\n        periods--;\n        next = _edate(maturity, -periods * months);\n        return [\n            prev,\n            next\n        ];\n    }\n    function _borderCoupons_fw(first, settlement, freq) {\n        var sett = unpackDate(settlement), base = unpackDate(first);\n        var periods = sett.year - base.year;\n        if (periods > 0) {\n            periods = (periods - 1) * freq;\n        }\n        var prev = first, next, months = 12 / freq;\n        while (settlement > prev) {\n            next = prev;\n            periods++;\n            prev = _edate(first, periods * months);\n        }\n        return [\n            next,\n            prev\n        ];\n    }\n    function COUPDAYBS(settlement, maturity, frequency, basis) {\n        var prev = _borderCoupons(settlement, maturity, frequency)[0];\n        return _daysBetween(prev, settlement, basis);\n    }\n    function COUPDAYS(settl, matur, freq, basis) {\n        if (basis == 1) {\n            var borders = _borderCoupons(settl, matur, freq);\n            return _daysBetween(borders[0], borders[1], 1);\n        }\n        if (basis == 3) {\n            return 365 / freq;\n        }\n        return 360 / freq;\n    }\n    function COUPDAYSNC(settl, matur, freq, basis) {\n        var next = _borderCoupons(settl, matur, freq)[1];\n        return _daysBetween(settl, next, basis);\n    }\n    function COUPPCD(settl, matur, freq) {\n        return _borderCoupons(settl, matur, freq)[0];\n    }\n    function COUPNCD(settl, matur, freq) {\n        return _borderCoupons(settl, matur, freq)[1];\n    }\n    function COUPNUM(settl, matur, freq) {\n        var sett = unpackDate(settl), mat = unpackDate(matur);\n        var months = 12 * (mat.year - sett.year) + mat.month - sett.month;\n        return 1 + (months * freq / 12 | 0);\n    }\n    function daysInYear(yr, basis) {\n        if (basis == 3) {\n            return 365;\n        }\n        if (basis == 1) {\n            return isLeapYear(yr) ? 366 : 365;\n        }\n        return 360;\n    }\n    function ACCRINTM(issue, maturity, rate, par, basis) {\n        var year_days = daysInYear(unpackDate(maturity).year, basis);\n        return rate * par * _daysBetween(issue, maturity, basis) / year_days;\n    }\n    function ACCRINT(issue, first, settl, rate, par, freq, basis, calc) {\n        var accr = 0, cost = par * rate / freq;\n        var brace, prev, next, prev1, next1, nrc;\n        var annual = basis % 2 === 0 ? 360 : 365;\n        function _numCoupons(from, to) {\n            return (to - from) * freq / annual | 0;\n        }\n        if (settl <= first) {\n            brace = _borderCoupons(settl, first, freq);\n            prev = brace[0];\n            next = brace[1];\n            if (prev <= issue) {\n                return cost * _daysBetween(issue, settl, basis) / _daysBetween(prev, next, basis);\n            }\n            brace = _borderCoupons(issue, prev, freq);\n            prev1 = brace[0];\n            next1 = brace[1];\n            nrc = _numCoupons(next1, settl);\n            return cost * (nrc + _daysBetween(issue, next1, basis) / _daysBetween(prev1, next1, basis) + (settl < next ? _daysBetween(prev, settl, basis) / _daysBetween(prev, next, basis) : 0));\n        } else {\n            brace = _borderCoupons_fw(first, settl, freq);\n            prev = brace[0];\n            next = brace[1];\n            nrc = _numCoupons(first, settl);\n            if (next == settl) {\n                accr = cost * nrc;\n            } else {\n                accr = cost * (nrc + _daysBetween(prev, settl, basis) / _daysBetween(prev, next, basis));\n            }\n            if (!calc) {\n                return accr;\n            }\n            brace = _borderCoupons(issue, first, freq);\n            prev = brace[0];\n            next = brace[1];\n            nrc = _numCoupons(issue, first);\n            accr += cost * (nrc + _daysBetween(issue, next, basis) / _daysBetween(prev, next, basis));\n            return accr;\n        }\n    }\n    function DISC(settl, matur, pr, redemption, basis) {\n        var annual = basis % 2 === 0 ? 360 : isLeapYear(unpackDate(settl).year) ? 366 : 365;\n        return (redemption - pr) / redemption * annual / _daysBetween(settl, matur, basis);\n    }\n    function INTRATE(settl, matur, investment, redemption, basis) {\n        var annual = basis % 2 === 0 ? 360 : isLeapYear(unpackDate(settl).year) ? 366 : 365;\n        return (redemption - investment) / investment * annual / _daysBetween(settl, matur, basis);\n    }\n    function RECEIVED(settl, matur, investment, discount, basis) {\n        var annual = basis % 2 === 0 ? 360 : isLeapYear(unpackDate(settl).year) ? 366 : 365;\n        return investment / (1 - discount * _daysBetween(settl, matur, basis) / annual);\n    }\n    function PRICE(settl, matur, rate, yld, redemption, freq, basis) {\n        var N = 1 + ((matur - settl) * freq / (basis % 2 === 0 ? 360 : 365) | 0);\n        var brace = _borderCoupons(settl, matur, freq), prev = brace[0], next = brace[1];\n        var beg_settl = _daysBetween(prev, settl, basis), settl_end = _daysBetween(settl, next, basis), beg_end = _daysBetween(prev, next, basis);\n        var den = 100 * rate / freq, yf = yld / freq, frac = settl_end / beg_end;\n        if (N == 1) {\n            return (redemption + den) / (1 + frac * yf) - beg_settl / beg_end * den;\n        }\n        return redemption / Math.pow(1 + yf, N - 1 + frac) + den * Math.pow(1 + yf, 1 - N - frac) * (Math.pow(1 + yf, N) - 1) / yf - beg_settl / beg_end * den;\n    }\n    function PRICEDISC(settl, matur, discount, redemption, basis) {\n        var dsm = _daysBetween(settl, matur, basis), dy = daysInYear(unpackDate(matur).year, basis);\n        return redemption - discount * redemption * dsm / dy;\n    }\n    function whipNumberArrays(a, b) {\n        for (var i = a.length; --i >= 0;) {\n            if (typeof a[i] != 'number' || typeof b[i] != 'number') {\n                a.splice(i, 1);\n                b.splice(i, 1);\n            }\n        }\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/borderpalette', [\n        'kendo.core',\n        'kendo.colorpicker',\n        'kendo.popup'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var BORDER_TYPES = [\n            'allBorders',\n            'insideBorders',\n            'insideHorizontalBorders',\n            'insideVerticalBorders',\n            'outsideBorders',\n            'leftBorder',\n            'topBorder',\n            'rightBorder',\n            'bottomBorder',\n            'noBorders'\n        ];\n        var BORDER_PALETTE_MESSAGES = kendo.spreadsheet.messages.borderPalette = {\n            allBorders: 'All borders',\n            insideBorders: 'Inside borders',\n            insideHorizontalBorders: 'Inside horizontal borders',\n            insideVerticalBorders: 'Inside vertical borders',\n            outsideBorders: 'Outside borders',\n            leftBorder: 'Left border',\n            topBorder: 'Top border',\n            rightBorder: 'Right border',\n            bottomBorder: 'Bottom border',\n            noBorders: 'No border'\n        };\n        var COLOR_PICKER_MESSAGES = kendo.spreadsheet.messages.colorPicker = {\n            reset: 'Reset color',\n            customColor: 'Custom color...',\n            apply: 'Apply',\n            cancel: 'Cancel'\n        };\n        function withPreventDefault(f) {\n            return function (e) {\n                e.preventDefault();\n                return f.apply(this, arguments);\n            };\n        }\n        var ColorChooser = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                kendo.ui.Widget.call(this, element, options);\n                this.element = element;\n                this.color = options.color;\n                this._resetButton();\n                this._colorPalette();\n                this._customColorPalette();\n                this._customColorButton();\n                this.resetButton.on('click', withPreventDefault(this.resetColor.bind(this)));\n                this.customColorButton.on('click', withPreventDefault(this.customColor.bind(this)));\n            },\n            options: { name: 'ColorChooser' },\n            events: ['change'],\n            destroy: function () {\n                kendo.unbind(this.dialog.element.find('.k-action-buttons'));\n                this.dialog.destroy();\n                this.colorPalette.destroy();\n                this.resetButton.off('click');\n                this.customColorButton.off('click');\n            },\n            value: function (value) {\n                if (value !== undefined) {\n                    this.color = value;\n                    this.customColorButton.find('.k-icon').css('background-color', this.color);\n                    this.colorPalette.value(null);\n                    this.flatColorPicker.value(this.color);\n                } else {\n                    return this.color;\n                }\n            },\n            _change: function (value) {\n                this.color = value;\n                this.trigger('change', { value: value });\n            },\n            _colorPalette: function () {\n                var element = $('<div />', { 'class': 'k-spreadsheet-color-palette' });\n                var colorPalette = this.colorPalette = $('<div />').kendoColorPalette({\n                    palette: [\n                        '#ffffff',\n                        '#000000',\n                        '#d6ecff',\n                        '#4e5b6f',\n                        '#7fd13b',\n                        '#ea157a',\n                        '#feb80a',\n                        '#00addc',\n                        '#738ac8',\n                        '#1ab39f',\n                        '#f2f2f2',\n                        '#7f7f7f',\n                        '#a7d6ff',\n                        '#d9dde4',\n                        '#e5f5d7',\n                        '#fad0e4',\n                        '#fef0cd',\n                        '#c5f2ff',\n                        '#e2e7f4',\n                        '#c9f7f1',\n                        '#d8d8d8',\n                        '#595959',\n                        '#60b5ff',\n                        '#b3bcca',\n                        '#cbecb0',\n                        '#f6a1c9',\n                        '#fee29c',\n                        '#8be6ff',\n                        '#c7d0e9',\n                        '#94efe3',\n                        '#bfbfbf',\n                        '#3f3f3f',\n                        '#007dea',\n                        '#8d9baf',\n                        '#b2e389',\n                        '#f272af',\n                        '#fed46b',\n                        '#51d9ff',\n                        '#aab8de',\n                        '#5fe7d5',\n                        '#a5a5a5',\n                        '#262626',\n                        '#003e75',\n                        '#3a4453',\n                        '#5ea226',\n                        '#af0f5b',\n                        '#c58c00',\n                        '#0081a5',\n                        '#425ea9',\n                        '#138677',\n                        '#7f7f7f',\n                        '#0c0c0c',\n                        '#00192e',\n                        '#272d37',\n                        '#3f6c19',\n                        '#750a3d',\n                        '#835d00',\n                        '#00566e',\n                        '#2c3f71',\n                        '#0c594f'\n                    ],\n                    value: this.color,\n                    change: function (e) {\n                        this.customColorButton.find('.k-icon').css('background-color', 'transparent');\n                        this.flatColorPicker.value(null);\n                        this._change(e.value);\n                    }.bind(this)\n                }).data('kendoColorPalette');\n                element.append(colorPalette.wrapper).appendTo(this.element);\n            },\n            _customColorPalette: function () {\n                var element = $('<div />', {\n                    'class': 'k-spreadsheet-window',\n                    'html': '<div></div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>' + COLOR_PICKER_MESSAGES.apply + '</button>' + '<button class=\\'k-button\\' data-bind=\\'click: close\\'>' + COLOR_PICKER_MESSAGES.cancel + '</button>' + '</div>'\n                });\n                var dialog = this.dialog = element.appendTo(document.body).kendoWindow({\n                    animation: false,\n                    scrollable: false,\n                    resizable: false,\n                    maximizable: false,\n                    modal: true,\n                    visible: false,\n                    width: 268,\n                    open: function () {\n                        this.center();\n                    }\n                }).data('kendoWindow');\n                dialog.one('activate', function () {\n                    this.element.find('[data-role=flatcolorpicker]').data('kendoFlatColorPicker')._hueSlider.resize();\n                });\n                var flatColorPicker = this.flatColorPicker = dialog.element.children().first().kendoFlatColorPicker().data('kendoFlatColorPicker');\n                var viewModel = kendo.observable({\n                    apply: function () {\n                        this.customColorButton.find('.k-icon').css('background-color', flatColorPicker.value());\n                        this.colorPalette.value(null);\n                        this._change(flatColorPicker.value());\n                        dialog.close();\n                    }.bind(this),\n                    close: function () {\n                        flatColorPicker.value(null);\n                        dialog.close();\n                    }\n                });\n                kendo.bind(dialog.element.find('.k-action-buttons'), viewModel);\n            },\n            _resetButton: function () {\n                this.resetButton = $('<a class=\\'k-button k-reset-color\\' href=\\'#\\'>' + '<span class=\\'k-icon k-i-reset-color\\'></span>' + COLOR_PICKER_MESSAGES.reset + '</a>').appendTo(this.element);\n            },\n            _customColorButton: function () {\n                this.customColorButton = $('<a class=\\'k-button k-custom-color\\' href=\\'#\\'>' + '<span class=\\'k-icon\\'></span>' + COLOR_PICKER_MESSAGES.customColor + '</a>').appendTo(this.element);\n            },\n            resetColor: function () {\n                this.colorPalette.value(null);\n                this.flatColorPicker.value(null);\n                this._change(null);\n            },\n            customColor: function () {\n                this.dialog.open();\n            }\n        });\n        var BorderPalette = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                kendo.ui.Widget.call(this, element, options);\n                this.element = element;\n                this.color = '#000';\n                this.element.addClass('k-spreadsheet-border-palette');\n                this._borderTypePalette();\n                this._borderColorPalette();\n                this.element.on('click', '.k-spreadsheet-border-type-palette .k-button', withPreventDefault(this._click.bind(this)));\n            },\n            options: { name: 'BorderPalette' },\n            events: ['change'],\n            destroy: function () {\n                this.colorChooser.destroy();\n                this.element.off('click');\n            },\n            _borderTypePalette: function () {\n                var messages = BORDER_PALETTE_MESSAGES;\n                var buttons = BORDER_TYPES.map(function (type) {\n                    return '<a title=\"' + messages[type] + '\" aria-label=\"' + messages[type] + '\" href=\"#\" data-border-type=\"' + type + '\" class=\"k-button k-button-icon\">' + '<span class=\"k-icon k-i-' + kendo.toHyphens(type) + '\"></span>' + '</a>';\n                }).join('');\n                var element = $('<div />', {\n                    'class': 'k-spreadsheet-border-type-palette',\n                    'html': buttons\n                });\n                element.appendTo(this.element);\n            },\n            _borderColorPalette: function () {\n                var element = $('<div />', { 'class': 'k-spreadsheet-border-color-palette' });\n                element.appendTo(this.element);\n                this.colorChooser = new ColorChooser(element, {\n                    color: this.color,\n                    change: this._colorChange.bind(this)\n                });\n            },\n            _click: function (e) {\n                this.type = $(e.currentTarget).data('borderType');\n                this.trigger('change', {\n                    type: this.type,\n                    color: this.color\n                });\n            },\n            _colorChange: function (e) {\n                this.color = e.value;\n                if (this.type) {\n                    this.trigger('change', {\n                        type: this.type,\n                        color: this.color\n                    });\n                }\n            }\n        });\n        kendo.spreadsheet.ColorChooser = ColorChooser;\n        kendo.spreadsheet.BorderPalette = BorderPalette;\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/toolbar', [\n        'kendo.toolbar',\n        'kendo.colorpicker',\n        'kendo.combobox',\n        'kendo.dropdownlist',\n        'kendo.popup',\n        'spreadsheet/borderpalette'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var ToolBar = kendo.ui.ToolBar;\n        var MESSAGES = kendo.spreadsheet.messages.toolbar = {\n            addColumnLeft: 'Add column left',\n            addColumnRight: 'Add column right',\n            addRowAbove: 'Add row above',\n            addRowBelow: 'Add row below',\n            alignment: 'Alignment',\n            alignmentButtons: {\n                justtifyLeft: 'Align left',\n                justifyCenter: 'Center',\n                justifyRight: 'Align right',\n                justifyFull: 'Justify',\n                alignTop: 'Align top',\n                alignMiddle: 'Align middle',\n                alignBottom: 'Align bottom'\n            },\n            backgroundColor: 'Background',\n            bold: 'Bold',\n            borders: 'Borders',\n            copy: 'Copy',\n            cut: 'Cut',\n            deleteColumn: 'Delete column',\n            deleteRow: 'Delete row',\n            filter: 'Filter',\n            fontFamily: 'Font',\n            fontSize: 'Font size',\n            format: 'Custom format...',\n            formatTypes: {\n                automatic: 'Automatic',\n                text: 'Text',\n                number: 'Number',\n                percent: 'Percent',\n                financial: 'Financial',\n                currency: 'Currency',\n                date: 'Date',\n                time: 'Time',\n                dateTime: 'Date time',\n                duration: 'Duration',\n                moreFormats: 'More formats...'\n            },\n            formatDecreaseDecimal: 'Decrease decimal',\n            formatIncreaseDecimal: 'Increase decimal',\n            freeze: 'Freeze panes',\n            freezeButtons: {\n                freezePanes: 'Freeze panes',\n                freezeRows: 'Freeze rows',\n                freezeColumns: 'Freeze columns',\n                unfreeze: 'Unfreeze panes'\n            },\n            insertComment: 'Insert comment',\n            insertImage: 'Insert image',\n            italic: 'Italic',\n            merge: 'Merge cells',\n            mergeButtons: {\n                mergeCells: 'Merge all',\n                mergeHorizontally: 'Merge horizontally',\n                mergeVertically: 'Merge vertically',\n                unmerge: 'Unmerge'\n            },\n            open: 'Open...',\n            paste: 'Paste',\n            quickAccess: {\n                redo: 'Redo',\n                undo: 'Undo'\n            },\n            exportAs: 'Export...',\n            toggleGridlines: 'Toggle gridlines',\n            sort: 'Sort',\n            sortButtons: {\n                sortRangeAsc: 'Sort range A to Z',\n                sortRangeDesc: 'Sort range Z to A'\n            },\n            textColor: 'Text Color',\n            textWrap: 'Wrap text',\n            underline: 'Underline',\n            validation: 'Data validation...',\n            hyperlink: 'Link'\n        };\n        var defaultTools = {\n            home: [\n                'open',\n                'exportAs',\n                [\n                    'cut',\n                    'copy',\n                    'paste'\n                ],\n                [\n                    'bold',\n                    'italic',\n                    'underline'\n                ],\n                'hyperlink',\n                'insertComment',\n                'insertImage',\n                'backgroundColor',\n                'textColor',\n                'borders',\n                'fontSize',\n                'fontFamily',\n                'alignment',\n                'textWrap',\n                [\n                    'formatDecreaseDecimal',\n                    'formatIncreaseDecimal'\n                ],\n                'format',\n                'merge',\n                'freeze',\n                'filter',\n                'toggleGridlines'\n            ],\n            insert: [\n                [\n                    'addColumnLeft',\n                    'addColumnRight',\n                    'addRowBelow',\n                    'addRowAbove'\n                ],\n                [\n                    'deleteColumn',\n                    'deleteRow'\n                ]\n            ],\n            data: [\n                'sort',\n                'filter',\n                'validation'\n            ]\n        };\n        var toolDefaults = {\n            open: {\n                type: 'open',\n                overflow: 'never',\n                iconClass: 'file-excel'\n            },\n            exportAs: {\n                type: 'exportAsDialog',\n                dialogName: 'exportAs',\n                overflow: 'never',\n                text: '',\n                iconClass: 'file-excel'\n            },\n            bold: {\n                type: 'button',\n                command: 'PropertyChangeCommand',\n                property: 'bold',\n                value: true,\n                iconClass: 'bold',\n                togglable: true\n            },\n            italic: {\n                type: 'button',\n                command: 'PropertyChangeCommand',\n                property: 'italic',\n                value: true,\n                iconClass: 'italic',\n                togglable: true\n            },\n            underline: {\n                type: 'button',\n                command: 'PropertyChangeCommand',\n                property: 'underline',\n                value: true,\n                iconClass: 'underline',\n                togglable: true\n            },\n            formatDecreaseDecimal: {\n                type: 'button',\n                command: 'AdjustDecimalsCommand',\n                value: -1,\n                iconClass: 'decimal-decrease'\n            },\n            formatIncreaseDecimal: {\n                type: 'button',\n                command: 'AdjustDecimalsCommand',\n                value: +1,\n                iconClass: 'decimal-increase'\n            },\n            textWrap: {\n                type: 'button',\n                command: 'TextWrapCommand',\n                property: 'wrap',\n                value: true,\n                iconClass: 'text-wrap',\n                togglable: true\n            },\n            cut: {\n                type: 'button',\n                command: 'ToolbarCutCommand',\n                iconClass: 'cut'\n            },\n            copy: {\n                type: 'button',\n                command: 'ToolbarCopyCommand',\n                iconClass: 'copy'\n            },\n            paste: {\n                type: 'button',\n                command: 'ToolbarPasteCommand',\n                iconClass: 'paste'\n            },\n            separator: { type: 'separator' },\n            alignment: {\n                type: 'alignment',\n                iconClass: 'align-left'\n            },\n            backgroundColor: {\n                type: 'colorPicker',\n                property: 'background',\n                iconClass: 'paint'\n            },\n            textColor: {\n                type: 'colorPicker',\n                property: 'color',\n                iconClass: 'foreground-color'\n            },\n            fontFamily: {\n                type: 'fontFamily',\n                property: 'fontFamily',\n                iconClass: 'font-family'\n            },\n            fontSize: {\n                type: 'fontSize',\n                property: 'fontSize',\n                iconClass: 'font-size'\n            },\n            format: {\n                type: 'format',\n                property: 'format',\n                iconClass: 'custom-format'\n            },\n            filter: {\n                type: 'filter',\n                property: 'hasFilter',\n                iconClass: 'filter'\n            },\n            merge: {\n                type: 'merge',\n                iconClass: 'cells-merge'\n            },\n            freeze: {\n                type: 'freeze',\n                iconClass: 'pane-freeze'\n            },\n            borders: {\n                type: 'borders',\n                iconClass: 'borders-all'\n            },\n            formatCells: {\n                type: 'dialog',\n                dialogName: 'formatCells',\n                overflow: 'never'\n            },\n            hyperlink: {\n                type: 'dialog',\n                dialogName: 'hyperlink',\n                iconClass: 'link-horizontal',\n                overflow: 'never',\n                text: ''\n            },\n            toggleGridlines: {\n                type: 'button',\n                command: 'GridLinesChangeCommand',\n                property: 'gridLines',\n                value: true,\n                iconClass: 'border-no',\n                togglable: true\n            },\n            insertComment: {\n                type: 'dialog',\n                dialogName: 'insertComment',\n                property: 'comment',\n                togglable: true,\n                overflow: 'never',\n                iconClass: 'comment',\n                text: ''\n            },\n            insertImage: {\n                type: 'dialog',\n                dialogName: 'insertImage',\n                overflow: 'never',\n                iconClass: 'image',\n                text: ''\n            },\n            addColumnLeft: {\n                type: 'button',\n                command: 'AddColumnCommand',\n                value: 'left',\n                iconClass: 'table-column-insert-left'\n            },\n            addColumnRight: {\n                type: 'button',\n                command: 'AddColumnCommand',\n                value: 'right',\n                iconClass: 'table-column-insert-right'\n            },\n            addRowBelow: {\n                type: 'button',\n                command: 'AddRowCommand',\n                value: 'below',\n                iconClass: 'table-row-insert-below'\n            },\n            addRowAbove: {\n                type: 'button',\n                command: 'AddRowCommand',\n                value: 'above',\n                iconClass: 'table-row-insert-above'\n            },\n            deleteColumn: {\n                type: 'button',\n                command: 'DeleteColumnCommand',\n                iconClass: 'table-column-delete'\n            },\n            deleteRow: {\n                type: 'button',\n                command: 'DeleteRowCommand',\n                iconClass: 'table-row-delete'\n            },\n            sort: {\n                type: 'sort',\n                iconClass: 'sort-desc'\n            },\n            validation: {\n                type: 'dialog',\n                dialogName: 'validation',\n                iconClass: 'exception',\n                overflow: 'never'\n            }\n        };\n        var SpreadsheetToolBar = ToolBar.extend({\n            init: function (element, options) {\n                options.items = this._expandTools(options.tools || SpreadsheetToolBar.prototype.options.tools[options.toolbarName]);\n                ToolBar.fn.init.call(this, element, options);\n                var handleClick = this._click.bind(this);\n                this.element.addClass('k-spreadsheet-toolbar');\n                this._addSeparators(this.element);\n                var that = this;\n                this.element.on('keydown', function (e) {\n                    var tool;\n                    if (e.keyCode === 9) {\n                        tool = that._nextTool(e.shiftKey ? -1 : 1);\n                        if (tool) {\n                            document.activeElement.blur();\n                            if ($(tool).is('.k-upload-button')) {\n                                $(tool).addClass('k-state-focused');\n                            }\n                            if ($(tool).find('input').length) {\n                                $(tool).find('input').focus();\n                            } else {\n                                tool.focus();\n                            }\n                            e.preventDefault();\n                        }\n                    }\n                });\n                this.element.on('focusout', function () {\n                    $(this).find('.k-toolbar-first-visible').removeClass('k-state-focused');\n                });\n                this.bind({\n                    click: handleClick,\n                    toggle: handleClick\n                });\n            },\n            _nextTool: function (direction) {\n                var that = this;\n                var tools = that.element.find('.k-widget, .k-button, .k-button-group > a');\n                var activeIndex = tools.index($(document.activeElement).closest('.k-widget, .k-button, .k-button-group > a'));\n                if (activeIndex > 0) {\n                    return tools[activeIndex + direction];\n                }\n            },\n            _addSeparators: function (element) {\n                var groups = element.children('.k-widget, a.k-button, .k-button-group');\n                groups.before('<span class=\\'k-separator\\' />');\n            },\n            _expandTools: function (tools) {\n                function expandTool(toolName) {\n                    var options = $.isPlainObject(toolName) ? toolName : toolDefaults[toolName] || {};\n                    var spriteCssClass = 'k-icon k-i-' + options.iconClass;\n                    var type = options.type;\n                    var typeDefaults = {\n                        button: { showText: 'overflow' },\n                        colorPicker: {\n                            toolIcon: spriteCssClass,\n                            spriteCssClass: spriteCssClass\n                        },\n                        borders: { spriteCssClass: spriteCssClass },\n                        alignment: { spriteCssClass: spriteCssClass },\n                        merge: { spriteCssClass: spriteCssClass },\n                        freeze: { spriteCssClass: spriteCssClass }\n                    };\n                    var tool = $.extend({\n                        name: options.name || toolName,\n                        text: MESSAGES[options.name || toolName],\n                        icon: options.iconClass,\n                        attributes: {\n                            title: MESSAGES[options.name || toolName],\n                            'aria-label': MESSAGES[options.name || toolName]\n                        }\n                    }, typeDefaults[type], options);\n                    if (type == 'splitButton') {\n                        tool.menuButtons = tool.menuButtons.map(expandTool);\n                    }\n                    tool.attributes['data-tool'] = toolName;\n                    if (options.property) {\n                        tool.attributes['data-property'] = options.property;\n                    }\n                    return tool;\n                }\n                return tools.reduce(function (tools, tool) {\n                    if ($.isArray(tool)) {\n                        tools.push({\n                            type: 'buttonGroup',\n                            buttons: tool.map(expandTool)\n                        });\n                    } else {\n                        tools.push(expandTool.call(this, tool));\n                    }\n                    return tools;\n                }, []);\n            },\n            _click: function (e) {\n                var toolName = e.target.attr('data-tool');\n                var tool = toolDefaults[toolName] || {};\n                var commandType = tool.command;\n                if (!commandType) {\n                    return;\n                }\n                var args = {\n                    command: commandType,\n                    options: {\n                        property: tool.property || null,\n                        value: tool.value || null\n                    }\n                };\n                if (typeof args.options.value === 'boolean') {\n                    args.options.value = e.checked ? true : null;\n                }\n                this.action(args);\n            },\n            events: [\n                'click',\n                'toggle',\n                'open',\n                'close',\n                'overflowOpen',\n                'overflowClose',\n                'action',\n                'dialog'\n            ],\n            options: {\n                name: 'SpreadsheetToolBar',\n                resizable: true,\n                tools: defaultTools\n            },\n            action: function (args) {\n                this.trigger('action', args);\n            },\n            dialog: function (args) {\n                this.trigger('dialog', args);\n            },\n            refresh: function (activeCell) {\n                var range = activeCell;\n                var tools = this._tools();\n                function setToggle(tool, value) {\n                    var toolbar = tool.toolbar;\n                    var overflow = tool.overflow;\n                    var togglable = toolbar && toolbar.options.togglable || overflow && overflow.options.togglable;\n                    if (!togglable) {\n                        return;\n                    }\n                    var toggle = false;\n                    if (typeof value === 'boolean') {\n                        toggle = value;\n                    } else if (typeof value === 'string') {\n                        if (toolbar.options.hasOwnProperty('value')) {\n                            toggle = toolbar.options.value === value;\n                        } else {\n                            toggle = value != null;\n                        }\n                    }\n                    toolbar.toggle(toggle);\n                    if (overflow) {\n                        overflow.toggle(toggle);\n                    }\n                }\n                function update(tool, value) {\n                    var toolbar = tool.toolbar;\n                    var overflow = tool.overflow;\n                    if (toolbar && toolbar.update) {\n                        toolbar.update(value);\n                    }\n                    if (overflow && overflow.update) {\n                        overflow.update(value);\n                    }\n                }\n                for (var i = 0; i < tools.length; i++) {\n                    var property = tools[i].property;\n                    var tool = tools[i].tool;\n                    var value = kendo.isFunction(range[property]) ? range[property]() : range;\n                    if (property == 'gridLines') {\n                        value = range.sheet().showGridLines();\n                    }\n                    if (tool.type === 'button') {\n                        setToggle(tool, value);\n                    } else {\n                        update(tool, value);\n                    }\n                }\n                this.resize();\n            },\n            _tools: function () {\n                return this.element.find('[data-property]').toArray().map(function (element) {\n                    element = $(element);\n                    return {\n                        property: element.attr('data-property'),\n                        tool: this._getItem(element)\n                    };\n                }.bind(this));\n            },\n            destroy: function () {\n                this.element.find('[data-command],.k-button').each(function () {\n                    var element = $(this);\n                    var instance = element.data('instance');\n                    if (instance && instance.destroy) {\n                        instance.destroy();\n                    }\n                });\n                ToolBar.fn.destroy.call(this);\n            }\n        });\n        kendo.spreadsheet.ToolBar = SpreadsheetToolBar;\n        var DropDownTool = kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                var dropDownList = $('<select />').attr('title', options.attributes.title).attr('aria-label', options.attributes.title).kendoDropDownList({ height: 'auto' }).data('kendoDropDownList');\n                this.dropDownList = dropDownList;\n                this.element = dropDownList.wrapper;\n                this.options = options;\n                this.toolbar = toolbar;\n                this.attributes();\n                this.addUidAttr();\n                this.addOverflowAttr();\n                dropDownList.bind('open', this._open.bind(this));\n                dropDownList.bind('change', this._change.bind(this));\n                this.element.width(options.width).attr({\n                    'data-command': 'PropertyChangeCommand',\n                    'data-property': options.property\n                });\n            },\n            _open: function () {\n                var ddl = this.dropDownList;\n                var list = ddl.list;\n                var listWidth;\n                list.css({\n                    whiteSpace: 'nowrap',\n                    width: 'auto'\n                });\n                listWidth = list.width();\n                if (listWidth > 0) {\n                    listWidth += 20;\n                } else {\n                    listWidth = ddl._listWidth;\n                }\n                list.css('width', listWidth + kendo.support.scrollbar());\n                ddl._listWidth = listWidth;\n            },\n            _change: function (e) {\n                var that = this;\n                var instance = e.sender;\n                var value = instance.value();\n                var dataItem = instance.dataItem();\n                var popupName = dataItem ? dataItem.popup : undefined;\n                if (popupName) {\n                    setTimeout(function () {\n                        that.toolbar.dialog({ name: popupName });\n                    });\n                } else {\n                    that.toolbar.action({\n                        command: 'PropertyChangeCommand',\n                        options: {\n                            property: this.options.property,\n                            value: value == 'null' ? null : value\n                        }\n                    });\n                }\n            },\n            value: function (value) {\n                if (value !== undefined) {\n                    this.dropDownList.value(value);\n                } else {\n                    return this.dropDownList.value();\n                }\n            }\n        });\n        var PopupTool = kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                this.element = $('<a href=\\'#\\' class=\\'k-button k-button-icon\\'>' + '<span class=\\'' + options.spriteCssClass + '\\'>' + '</span><span class=\\'k-icon k-i-arrow-60-down\\'></span>' + '</a>');\n                this.element.on('click touchend', this.open.bind(this)).attr('data-command', options.command);\n                this.options = options;\n                this.toolbar = toolbar;\n                this.attributes();\n                this.addUidAttr();\n                this.addOverflowAttr();\n                this._popup();\n            },\n            destroy: function () {\n                this.popup.destroy();\n            },\n            open: function (ev) {\n                ev.preventDefault();\n                this.popup.toggle();\n            },\n            _popup: function () {\n                var element = this.element;\n                this.popup = $('<div class=\\'k-spreadsheet-popup\\' />').appendTo(element).kendoPopup({ anchor: element }).data('kendoPopup');\n            }\n        });\n        kendo.toolbar.registerComponent('dialog', kendo.toolbar.ToolBarButton.extend({\n            init: function (options, toolbar) {\n                kendo.toolbar.ToolBarButton.fn.init.call(this, options, toolbar);\n                this._dialogName = options.dialogName;\n                this.element.bind('click touchend', this.open.bind(this)).data('instance', this);\n            },\n            open: function () {\n                this.toolbar.dialog({ name: this._dialogName });\n            }\n        }));\n        kendo.toolbar.registerComponent('exportAsDialog', kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                this._dialogName = options.dialogName;\n                this.toolbar = toolbar;\n                this._title = options.attributes.title;\n                this.element = $('<button type=\\'button\\' class=\\'k-button k-button-icon\\'>' + '<span class=\\'k-icon k-i-download\\' />' + '</button>').attr('title', this._title).attr('aria-label', this._title).data('instance', this);\n                this.element.bind('click', this.open.bind(this)).data('instance', this);\n            },\n            open: function () {\n                this.toolbar.dialog({ name: this._dialogName });\n            }\n        }));\n        var OverflowDialogButton = kendo.toolbar.OverflowButton.extend({\n            init: function (options, toolbar) {\n                kendo.toolbar.OverflowButton.fn.init.call(this, options, toolbar);\n                this.element.on('click touchend', this._click.bind(this));\n                this.message = this.options.text;\n                var instance = this.element.data('button');\n                this.element.data(this.options.type, instance);\n            },\n            _click: $.noop\n        });\n        var ColorPicker = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this.popup.element.addClass('k-spreadsheet-colorpicker');\n                this.colorChooser = new kendo.spreadsheet.ColorChooser(this.popup.element, { change: this._colorChange.bind(this) });\n                this.element.attr({ 'data-property': options.property });\n                this.element.data({\n                    type: 'colorPicker',\n                    colorPicker: this,\n                    instance: this\n                });\n            },\n            destroy: function () {\n                this.colorChooser.destroy();\n                PopupTool.fn.destroy.call(this);\n            },\n            update: function (value) {\n                this.value(value);\n            },\n            value: function (value) {\n                this.colorChooser.value(value);\n            },\n            _colorChange: function (e) {\n                this.toolbar.action({\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: this.options.property,\n                        value: e.sender.value()\n                    }\n                });\n                this.popup.close();\n            }\n        });\n        var ColorPickerButton = OverflowDialogButton.extend({\n            init: function (options, toolbar) {\n                options.iconName = 'text';\n                OverflowDialogButton.fn.init.call(this, options, toolbar);\n            },\n            _click: function () {\n                this.toolbar.dialog({\n                    name: 'colorPicker',\n                    options: {\n                        title: this.options.property,\n                        property: this.options.property\n                    }\n                });\n            }\n        });\n        kendo.toolbar.registerComponent('colorPicker', ColorPicker, ColorPickerButton);\n        var FONT_SIZES = [\n            8,\n            9,\n            10,\n            11,\n            12,\n            13,\n            14,\n            16,\n            18,\n            20,\n            22,\n            24,\n            26,\n            28,\n            36,\n            48,\n            72\n        ];\n        var DEFAULT_FONT_SIZE = 12;\n        var FontSize = kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                var comboBox = $('<input />').attr('aria-label', options.attributes.title).kendoComboBox({\n                    change: this._valueChange.bind(this),\n                    clearButton: false,\n                    dataSource: options.fontSizes || FONT_SIZES,\n                    value: DEFAULT_FONT_SIZE\n                }).data('kendoComboBox');\n                this.comboBox = comboBox;\n                this.element = comboBox.wrapper;\n                this.options = options;\n                this.toolbar = toolbar;\n                this.attributes();\n                this.addUidAttr();\n                this.addOverflowAttr();\n                this.element.width(options.width).attr({\n                    'data-command': 'PropertyChangeCommand',\n                    'data-property': options.property\n                });\n                this.element.data({\n                    type: 'fontSize',\n                    fontSize: this\n                });\n            },\n            _valueChange: function (e) {\n                this.toolbar.action({\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: this.options.property,\n                        value: kendo.parseInt(e.sender.value())\n                    }\n                });\n            },\n            update: function (value) {\n                this.value(kendo.parseInt(value) || DEFAULT_FONT_SIZE);\n            },\n            value: function (value) {\n                if (value !== undefined) {\n                    this.comboBox.value(value);\n                } else {\n                    return this.comboBox.value();\n                }\n            }\n        });\n        var FontSizeButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({\n                    name: 'fontSize',\n                    options: {\n                        sizes: FONT_SIZES,\n                        defaultSize: DEFAULT_FONT_SIZE\n                    }\n                });\n            },\n            update: function (value) {\n                this._value = value || DEFAULT_FONT_SIZE;\n                this.element.find('.k-text').text(this.message + ' (' + this._value + ') ...');\n            }\n        });\n        kendo.toolbar.registerComponent('fontSize', FontSize, FontSizeButton);\n        var FONT_FAMILIES = [\n            'Arial',\n            'Courier New',\n            'Georgia',\n            'Times New Roman',\n            'Trebuchet MS',\n            'Verdana'\n        ];\n        var DEFAULT_FONT_FAMILY = 'Arial';\n        var FontFamily = DropDownTool.extend({\n            init: function (options, toolbar) {\n                DropDownTool.fn.init.call(this, options, toolbar);\n                var ddl = this.dropDownList;\n                ddl.setDataSource(options.fontFamilies || FONT_FAMILIES);\n                ddl.value(DEFAULT_FONT_FAMILY);\n                this.element.data({\n                    type: 'fontFamily',\n                    fontFamily: this\n                });\n            },\n            update: function (value) {\n                this.value(value || DEFAULT_FONT_FAMILY);\n            }\n        });\n        var FontFamilyButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({\n                    name: 'fontFamily',\n                    options: {\n                        fonts: FONT_FAMILIES,\n                        defaultFont: DEFAULT_FONT_FAMILY\n                    }\n                });\n            },\n            update: function (value) {\n                this._value = value || DEFAULT_FONT_FAMILY;\n                this.element.find('.k-text').text(this.message + ' (' + this._value + ') ...');\n            }\n        });\n        kendo.toolbar.registerComponent('fontFamily', FontFamily, FontFamilyButton);\n        var defaultFormats = kendo.spreadsheet.formats = {\n            automatic: null,\n            text: '@',\n            number: '#,0.00',\n            percent: '0.00%',\n            financial: '_(\"$\"* #,##0.00_);_(\"$\"* (#,##0.00);_(\"$\"* \"-\"??_);_(@_)',\n            currency: '$#,##0.00;[Red]$#,##0.00',\n            date: 'm/d/yyyy',\n            time: 'h:mm:ss AM/PM',\n            dateTime: 'm/d/yyyy h:mm',\n            duration: '[h]:mm:ss'\n        };\n        var Format = DropDownTool.extend({\n            _revertTitle: function (e) {\n                e.sender.value('');\n                e.sender.wrapper.width('auto');\n            },\n            init: function (options, toolbar) {\n                DropDownTool.fn.init.call(this, options, toolbar);\n                var ddl = this.dropDownList;\n                var icon = '<span class=\\'k-icon k-i-' + options.iconClass + '\\' style=\\'line-height: 1em; width: 1.35em;\\'></span>';\n                ddl.bind('change', this._revertTitle.bind(this));\n                ddl.bind('dataBound', this._revertTitle.bind(this));\n                ddl.setOptions({\n                    dataValueField: 'format',\n                    dataTextField: 'name',\n                    dataValuePrimitive: true,\n                    valueTemplate: icon,\n                    template: '# if (data.sample) { #' + '<span class=\\'k-spreadsheet-sample\\'>#: data.sample #</span>' + '# } #' + '#: data.name #'\n                });\n                ddl.text(icon);\n                ddl.setDataSource([\n                    {\n                        format: defaultFormats.automatic,\n                        name: MESSAGES.formatTypes.automatic\n                    },\n                    {\n                        format: defaultFormats.text,\n                        name: MESSAGES.formatTypes.text\n                    },\n                    {\n                        format: defaultFormats.number,\n                        name: MESSAGES.formatTypes.number,\n                        sample: '1,499.99'\n                    },\n                    {\n                        format: defaultFormats.percent,\n                        name: MESSAGES.formatTypes.percent,\n                        sample: '14.50%'\n                    },\n                    {\n                        format: defaultFormats.financial,\n                        name: MESSAGES.formatTypes.financial,\n                        sample: '(1,000.12)'\n                    },\n                    {\n                        format: defaultFormats.currency,\n                        name: MESSAGES.formatTypes.currency,\n                        sample: '$1,499.99'\n                    },\n                    {\n                        format: defaultFormats.date,\n                        name: MESSAGES.formatTypes.date,\n                        sample: '4/21/2012'\n                    },\n                    {\n                        format: defaultFormats.time,\n                        name: MESSAGES.formatTypes.time,\n                        sample: '5:49:00 PM'\n                    },\n                    {\n                        format: defaultFormats.dateTime,\n                        name: MESSAGES.formatTypes.dateTime,\n                        sample: '4/21/2012 5:49:00'\n                    },\n                    {\n                        format: defaultFormats.duration,\n                        name: MESSAGES.formatTypes.duration,\n                        sample: '168:05:00'\n                    },\n                    {\n                        popup: 'formatCells',\n                        name: MESSAGES.formatTypes.moreFormats\n                    }\n                ]);\n                this.element.data({\n                    type: 'format',\n                    format: this\n                });\n            }\n        });\n        var FormatButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'formatCells' });\n            }\n        });\n        kendo.toolbar.registerComponent('format', Format, FormatButton);\n        var BorderChangeTool = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this._borderPalette();\n                this.element.data({\n                    type: 'borders',\n                    instance: this\n                });\n            },\n            destroy: function () {\n                this.borderPalette.destroy();\n                PopupTool.fn.destroy.call(this);\n            },\n            _borderPalette: function () {\n                var element = $('<div />').appendTo(this.popup.element);\n                this.borderPalette = new kendo.spreadsheet.BorderPalette(element, { change: this._action.bind(this) });\n            },\n            _action: function (e) {\n                this.toolbar.action({\n                    command: 'BorderChangeCommand',\n                    options: {\n                        border: e.type,\n                        style: {\n                            size: 1,\n                            color: e.color\n                        }\n                    }\n                });\n            }\n        });\n        var BorderChangeButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'borders' });\n            }\n        });\n        kendo.toolbar.registerComponent('borders', BorderChangeTool, BorderChangeButton);\n        var AlignmentTool = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this.element.attr({ 'data-property': 'alignment' });\n                this._defineButtons();\n                this._commandPalette();\n                this.popup.element.on('click', '.k-button', function (e) {\n                    this._action($(e.currentTarget));\n                }.bind(this));\n                this.element.data({\n                    type: 'alignment',\n                    alignment: this,\n                    instance: this\n                });\n            },\n            _defineButtons: function () {\n                this.buttons = [\n                    {\n                        property: 'textAlign',\n                        value: 'left',\n                        iconClass: 'align-left',\n                        text: MESSAGES.alignmentButtons.justtifyLeft\n                    },\n                    {\n                        property: 'textAlign',\n                        value: 'center',\n                        iconClass: 'align-center',\n                        text: MESSAGES.alignmentButtons.justifyCenter\n                    },\n                    {\n                        property: 'textAlign',\n                        value: 'right',\n                        iconClass: 'align-right',\n                        text: MESSAGES.alignmentButtons.justifyRight\n                    },\n                    {\n                        property: 'textAlign',\n                        value: 'justify',\n                        iconClass: 'align-justify',\n                        text: MESSAGES.alignmentButtons.justifyFull\n                    },\n                    {\n                        property: 'verticalAlign',\n                        value: 'top',\n                        iconClass: 'align-top',\n                        text: MESSAGES.alignmentButtons.alignTop\n                    },\n                    {\n                        property: 'verticalAlign',\n                        value: 'center',\n                        iconClass: 'align-middle',\n                        text: MESSAGES.alignmentButtons.alignMiddle\n                    },\n                    {\n                        property: 'verticalAlign',\n                        value: 'bottom',\n                        iconClass: 'align-bottom',\n                        text: MESSAGES.alignmentButtons.alignBottom\n                    }\n                ];\n            },\n            destroy: function () {\n                this.popup.element.off();\n                PopupTool.fn.destroy.call(this);\n            },\n            update: function (range) {\n                var textAlign = range.textAlign();\n                var verticalAlign = range.verticalAlign();\n                var element = this.popup.element;\n                element.find('.k-button').removeClass('k-state-active');\n                if (textAlign) {\n                    element.find('[data-property=textAlign][data-value=' + textAlign + ']').addClass('k-state-active');\n                }\n                if (verticalAlign) {\n                    element.find('[data-property=verticalAlign][data-value=' + verticalAlign + ']').addClass('k-state-active');\n                }\n            },\n            _commandPalette: function () {\n                var buttons = this.buttons;\n                var element = $('<div />').appendTo(this.popup.element);\n                buttons.forEach(function (options, index) {\n                    var button = '<a title=\\'' + options.text + '\\' data-property=\\'' + options.property + '\\' data-value=\\'' + options.value + '\\' class=\\'k-button k-button-icon\\'>' + '<span class=\\'k-icon k-i-' + options.iconClass + '\\'></span>' + '</a>';\n                    if (index !== 0 && buttons[index - 1].property !== options.property) {\n                        element.append($('<span class=\\'k-separator\\' />'));\n                    }\n                    element.append(button);\n                });\n            },\n            _action: function (button) {\n                var property = button.attr('data-property');\n                var value = button.attr('data-value');\n                this.toolbar.action({\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: property,\n                        value: value\n                    }\n                });\n            }\n        });\n        var AlignmentButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'alignment' });\n            }\n        });\n        kendo.toolbar.registerComponent('alignment', AlignmentTool, AlignmentButton);\n        var MergeTool = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this._defineButtons();\n                this._commandPalette();\n                this.popup.element.on('click', '.k-button', function (e) {\n                    this._action($(e.currentTarget));\n                }.bind(this));\n                this.element.data({\n                    type: 'merge',\n                    merge: this,\n                    instance: this\n                });\n            },\n            _defineButtons: function () {\n                this.buttons = [\n                    {\n                        value: 'cells',\n                        iconClass: 'cells-merge',\n                        text: MESSAGES.mergeButtons.mergeCells\n                    },\n                    {\n                        value: 'horizontally',\n                        iconClass: 'cells-merge-horizontally',\n                        text: MESSAGES.mergeButtons.mergeHorizontally\n                    },\n                    {\n                        value: 'vertically',\n                        iconClass: 'cells-merge-vertically',\n                        text: MESSAGES.mergeButtons.mergeVertically\n                    },\n                    {\n                        value: 'unmerge',\n                        iconClass: 'table-unmerge',\n                        text: MESSAGES.mergeButtons.unmerge\n                    }\n                ];\n            },\n            destroy: function () {\n                this.popup.element.off();\n                PopupTool.fn.destroy.call(this);\n            },\n            _commandPalette: function () {\n                var element = $('<div />').appendTo(this.popup.element);\n                this.buttons.forEach(function (options) {\n                    var button = '<a title=\\'' + options.text + '\\' data-value=\\'' + options.value + '\\' class=\\'k-button k-button-icontext\\'>' + '<span class=\\'k-icon k-i-' + options.iconClass + '\\'></span>' + options.text + '</a>';\n                    element.append(button);\n                });\n            },\n            _action: function (button) {\n                var value = button.attr('data-value');\n                this.toolbar.action({\n                    command: 'MergeCellCommand',\n                    options: { value: value }\n                });\n            }\n        });\n        var MergeButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'merge' });\n            }\n        });\n        kendo.toolbar.registerComponent('merge', MergeTool, MergeButton);\n        var FreezeTool = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this._defineButtons();\n                this._commandPalette();\n                this.popup.element.on('click', '.k-button', function (e) {\n                    this._action($(e.currentTarget));\n                }.bind(this));\n                this.element.data({\n                    type: 'freeze',\n                    freeze: this,\n                    instance: this\n                });\n            },\n            _defineButtons: function () {\n                this.buttons = [\n                    {\n                        value: 'panes',\n                        iconClass: 'pane-freeze',\n                        text: MESSAGES.freezeButtons.freezePanes\n                    },\n                    {\n                        value: 'rows',\n                        iconClass: 'row-freeze',\n                        text: MESSAGES.freezeButtons.freezeRows\n                    },\n                    {\n                        value: 'columns',\n                        iconClass: 'column-freeze',\n                        text: MESSAGES.freezeButtons.freezeColumns\n                    },\n                    {\n                        value: 'unfreeze',\n                        iconClass: 'table-unmerge',\n                        text: MESSAGES.freezeButtons.unfreeze\n                    }\n                ];\n            },\n            destroy: function () {\n                this.popup.element.off();\n                PopupTool.fn.destroy.call(this);\n            },\n            _commandPalette: function () {\n                var element = $('<div />').appendTo(this.popup.element);\n                this.buttons.forEach(function (options) {\n                    var button = '<a title=\\'' + options.text + '\\' data-value=\\'' + options.value + '\\' class=\\'k-button k-button-icontext\\'>' + '<span class=\\'k-icon k-i-' + options.iconClass + '\\'></span>' + options.text + '</a>';\n                    element.append(button);\n                });\n            },\n            _action: function (button) {\n                var value = button.attr('data-value');\n                this.toolbar.action({\n                    command: 'FreezePanesCommand',\n                    options: { value: value }\n                });\n            }\n        });\n        var FreezeButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'freeze' });\n            }\n        });\n        kendo.toolbar.registerComponent('freeze', FreezeTool, FreezeButton);\n        var Sort = DropDownTool.extend({\n            _revertTitle: function (e) {\n                e.sender.value('');\n                e.sender.wrapper.width('auto');\n            },\n            init: function (options, toolbar) {\n                DropDownTool.fn.init.call(this, options, toolbar);\n                var ddl = this.dropDownList;\n                ddl.bind('change', this._revertTitle.bind(this));\n                ddl.bind('dataBound', this._revertTitle.bind(this));\n                ddl.setOptions({\n                    valueTemplate: '<span class=\\'k-icon k-i-' + options.iconClass + '\\' style=\\'line-height: 1em; width: 1.35em;\\'></span>',\n                    template: '<span class=\\'k-icon k-i-#= iconClass #\\' style=\\'line-height: 1em; width: 1.35em;\\'></span>#=text#',\n                    dataTextField: 'text',\n                    dataValueField: 'value'\n                });\n                ddl.setDataSource([\n                    {\n                        value: 'asc',\n                        sheet: false,\n                        text: MESSAGES.sortButtons.sortRangeAsc,\n                        iconClass: 'sort-asc'\n                    },\n                    {\n                        value: 'desc',\n                        sheet: false,\n                        text: MESSAGES.sortButtons.sortRangeDesc,\n                        iconClass: 'sort-desc'\n                    }\n                ]);\n                ddl.select(0);\n                this.element.data({\n                    type: 'sort',\n                    sort: this\n                });\n            },\n            _change: function (e) {\n                var instance = e.sender;\n                var dataItem = instance.dataItem();\n                if (dataItem) {\n                    this.toolbar.action({\n                        command: 'SortCommand',\n                        options: {\n                            value: dataItem.value,\n                            sheet: dataItem.sheet\n                        }\n                    });\n                }\n            },\n            value: $.noop\n        });\n        var SortButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'sort' });\n            }\n        });\n        kendo.toolbar.registerComponent('sort', Sort, SortButton);\n        var Filter = kendo.toolbar.ToolBarButton.extend({\n            init: function (options, toolbar) {\n                options.showText = 'overflow';\n                kendo.toolbar.ToolBarButton.fn.init.call(this, options, toolbar);\n                this.element.on('click', this._click.bind(this));\n                this.element.data({\n                    type: 'filter',\n                    filter: this\n                });\n            },\n            _click: function () {\n                this.toolbar.action({ command: 'FilterCommand' });\n            },\n            update: function (value) {\n                this.toggle(value);\n            }\n        });\n        var FilterButton = OverflowDialogButton.extend({\n            init: function (options, toolbar) {\n                OverflowDialogButton.fn.init.call(this, options, toolbar);\n                this.element.data({\n                    type: 'filter',\n                    filter: this\n                });\n            },\n            _click: function () {\n                this.toolbar.action({ command: 'FilterCommand' });\n            },\n            update: function (value) {\n                this.toggle(value);\n            }\n        });\n        kendo.toolbar.registerComponent('filter', Filter, FilterButton);\n        var Open = kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                this.toolbar = toolbar;\n                this.element = $('<div class=\\'k-button k-upload-button k-button-icon\\'>' + '<span class=\\'k-icon k-i-folder-open\\' />' + '</div>').data('instance', this);\n                this._title = options.attributes.title;\n                this._reset();\n            },\n            _reset: function () {\n                this.element.find('input').remove();\n                $('<input type=\\'file\\' autocomplete=\\'off\\' accept=\\'.xlsx\\'/>').attr('title', this._title).attr('aria-label', this._title).one('change', this._change.bind(this)).appendTo(this.element);\n            },\n            _change: function (e) {\n                this.toolbar.action({\n                    command: 'OpenCommand',\n                    options: { file: e.target.files[0] }\n                });\n                this._reset();\n            }\n        });\n        kendo.toolbar.registerComponent('open', Open);\n        kendo.spreadsheet.TabStrip = kendo.ui.TabStrip.extend({\n            init: function (element, options) {\n                kendo.ui.TabStrip.fn.init.call(this, element, options);\n                element.addClass('k-spreadsheet-tabstrip');\n                this._quickAccessButtons();\n                this.toolbars = {};\n                var tabs = options.dataSource;\n                this.contentElements.each(function (idx, element) {\n                    this._toolbar($(element), tabs[idx].id, options.toolbarOptions[tabs[idx].id]);\n                }.bind(this));\n                this.one('activate', function () {\n                    this.toolbars[this.options.dataSource[0].id].resize();\n                });\n            },\n            events: kendo.ui.TabStrip.fn.events.concat([\n                'action',\n                'dialog'\n            ]),\n            destroy: function () {\n                this.quickAccessToolBar.off('click');\n                kendo.ui.TabStrip.fn.destroy.call(this);\n                for (var name in this.toolbars) {\n                    this.toolbars[name].destroy();\n                }\n            },\n            action: function (args) {\n                this.trigger('action', args);\n            },\n            dialog: function (args) {\n                this.trigger('dialog', args);\n            },\n            refreshTools: function (range) {\n                var toolbars = this.toolbars;\n                for (var name in toolbars) {\n                    if (toolbars.hasOwnProperty(name)) {\n                        toolbars[name].refresh(range);\n                    }\n                }\n            },\n            _quickAccessButtons: function () {\n                var buttons = [\n                    {\n                        title: MESSAGES.quickAccess.undo,\n                        iconClass: 'undo',\n                        action: 'undo'\n                    },\n                    {\n                        title: MESSAGES.quickAccess.redo,\n                        iconClass: 'redo',\n                        action: 'redo'\n                    }\n                ];\n                var buttonTemplate = kendo.template('<a href=\\'\\\\#\\' title=\\'#= title #\\' data-action=\\'#= action #\\' class=\\'k-button k-button-icon\\' aria-label=\\'#= title #\\'><span class=\\'k-icon k-i-#=iconClass#\\'></span></a>');\n                this.quickAccessToolBar = $('<div />', {\n                    'class': 'k-spreadsheet-quick-access-toolbar',\n                    'html': kendo.render(buttonTemplate, buttons)\n                }).insertBefore(this.wrapper);\n                this.quickAccessToolBar.on('click', '.k-button', function (e) {\n                    e.preventDefault();\n                    var action = $(e.currentTarget).attr('data-action');\n                    this.action({ action: action });\n                }.bind(this));\n                this.quickAccessAdjust();\n            },\n            quickAccessAdjust: function () {\n                this.tabGroup.css('padding-left', kendo._outerWidth(this.quickAccessToolBar));\n            },\n            _toolbar: function (container, name, tools) {\n                var element;\n                var options;\n                if (this.toolbars[name]) {\n                    this.toolbars[name].destroy();\n                    container.children('.k-toolbar').remove();\n                }\n                if (tools) {\n                    element = container.html('<div />').children('div');\n                    options = {\n                        tools: typeof tools === 'boolean' ? undefined : tools,\n                        toolbarName: name,\n                        action: this.action.bind(this),\n                        dialog: this.dialog.bind(this)\n                    };\n                    this.toolbars[name] = new kendo.spreadsheet.ToolBar(element, options);\n                }\n            }\n        });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/dialogs', [\n        'kendo.core',\n        'kendo.binder',\n        'kendo.validator'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var ObservableObject = kendo.data.ObservableObject;\n        var MESSAGES = kendo.spreadsheet.messages.dialogs = {\n            apply: 'Apply',\n            save: 'Save',\n            cancel: 'Cancel',\n            remove: 'Remove',\n            retry: 'Retry',\n            revert: 'Revert',\n            okText: 'OK',\n            formatCellsDialog: {\n                title: 'Format',\n                categories: {\n                    number: 'Number',\n                    currency: 'Currency',\n                    date: 'Date'\n                }\n            },\n            fontFamilyDialog: { title: 'Font' },\n            fontSizeDialog: { title: 'Font size' },\n            bordersDialog: { title: 'Borders' },\n            alignmentDialog: {\n                title: 'Alignment',\n                buttons: {\n                    justtifyLeft: 'Align left',\n                    justifyCenter: 'Center',\n                    justifyRight: 'Align right',\n                    justifyFull: 'Justify',\n                    alignTop: 'Align top',\n                    alignMiddle: 'Align middle',\n                    alignBottom: 'Align bottom'\n                }\n            },\n            mergeDialog: {\n                title: 'Merge cells',\n                buttons: {\n                    mergeCells: 'Merge all',\n                    mergeHorizontally: 'Merge horizontally',\n                    mergeVertically: 'Merge vertically',\n                    unmerge: 'Unmerge'\n                }\n            },\n            freezeDialog: {\n                title: 'Freeze panes',\n                buttons: {\n                    freezePanes: 'Freeze panes',\n                    freezeRows: 'Freeze rows',\n                    freezeColumns: 'Freeze columns',\n                    unfreeze: 'Unfreeze panes'\n                }\n            },\n            confirmationDialog: {\n                text: 'Are you sure you want to remove this sheet?',\n                title: 'Sheet remove'\n            },\n            validationDialog: {\n                title: 'Data Validation',\n                hintMessage: 'Please enter a valid {0} value {1}.',\n                hintTitle: 'Validation {0}',\n                criteria: {\n                    any: 'Any value',\n                    number: 'Number',\n                    text: 'Text',\n                    date: 'Date',\n                    custom: 'Custom Formula',\n                    list: 'List'\n                },\n                comparers: {\n                    greaterThan: 'greater than',\n                    lessThan: 'less than',\n                    between: 'between',\n                    notBetween: 'not between',\n                    equalTo: 'equal to',\n                    notEqualTo: 'not equal to',\n                    greaterThanOrEqualTo: 'greater than or equal to',\n                    lessThanOrEqualTo: 'less than or equal to'\n                },\n                comparerMessages: {\n                    greaterThan: 'greater than {0}',\n                    lessThan: 'less than {0}',\n                    between: 'between {0} and {1}',\n                    notBetween: 'not between {0} and {1}',\n                    equalTo: 'equal to {0}',\n                    notEqualTo: 'not equal to {0}',\n                    greaterThanOrEqualTo: 'greater than or equal to {0}',\n                    lessThanOrEqualTo: 'less than or equal to {0}',\n                    custom: 'that satisfies the formula: {0}'\n                },\n                labels: {\n                    criteria: 'Criteria',\n                    comparer: 'Comparer',\n                    min: 'Min',\n                    max: 'Max',\n                    value: 'Value',\n                    start: 'Start',\n                    end: 'End',\n                    onInvalidData: 'On invalid data',\n                    rejectInput: 'Reject input',\n                    showWarning: 'Show warning',\n                    showHint: 'Show hint',\n                    hintTitle: 'Hint title',\n                    hintMessage: 'Hint message',\n                    ignoreBlank: 'Ignore blank',\n                    showListButton: 'Display button to show list',\n                    showCalendarButton: 'Display button to show calendar'\n                },\n                placeholders: {\n                    typeTitle: 'Type title',\n                    typeMessage: 'Type message'\n                }\n            },\n            exportAsDialog: {\n                title: 'Export...',\n                defaultFileName: 'Workbook',\n                xlsx: { description: 'Excel Workbook (.xlsx)' },\n                pdf: {\n                    description: 'Portable Document Format (.pdf)',\n                    area: {\n                        workbook: 'Entire Workbook',\n                        sheet: 'Active Sheet',\n                        selection: 'Selection'\n                    },\n                    paper: {\n                        a2: 'A2 (420 mm \\xD7 594 mm)',\n                        a3: 'A3 (297 mm x 420 mm)',\n                        a4: 'A4 (210 mm x 297 mm)',\n                        a5: 'A5 (148 mm x 210 mm)',\n                        b3: 'B3 (353 mm \\xD7 500 mm)',\n                        b4: 'B4 (250 mm x 353 mm)',\n                        b5: 'B5 (176 mm x 250 mm)',\n                        folio: 'Folio (8.5\" x 13\")',\n                        legal: 'Legal (8.5\" x 14\")',\n                        letter: 'Letter (8.5\" x 11\")',\n                        tabloid: 'Tabloid (11\" x 17\")',\n                        executive: 'Executive (7.25\" x 10.5\")'\n                    },\n                    margin: {\n                        normal: 'Normal',\n                        narrow: 'Narrow',\n                        wide: 'Wide'\n                    }\n                },\n                labels: {\n                    scale: 'Scale',\n                    fit: 'Fit to page',\n                    fileName: 'File name',\n                    saveAsType: 'Save as type',\n                    exportArea: 'Export',\n                    paperSize: 'Paper size',\n                    margins: 'Margins',\n                    orientation: 'Orientation',\n                    print: 'Print',\n                    guidelines: 'Guidelines',\n                    center: 'Center',\n                    horizontally: 'Horizontally',\n                    vertically: 'Vertically'\n                }\n            },\n            modifyMergedDialog: { errorMessage: 'Cannot change part of a merged cell.' },\n            rangeDisabledDialog: { errorMessage: 'Destination range contains disabled cells.' },\n            intersectsArrayDialog: { errorMessage: 'You cannot alter part of an array' },\n            incompatibleRangesDialog: { errorMessage: 'Incompatible ranges' },\n            noFillDirectionDialog: { errorMessage: 'Cannot determine fill direction' },\n            duplicateSheetNameDialog: { errorMessage: 'Duplicate sheet name' },\n            overflowDialog: { errorMessage: 'Cannot paste, because the copy area and the paste area are not the same size and shape.' },\n            useKeyboardDialog: {\n                title: 'Copying and pasting',\n                errorMessage: 'These actions cannot be invoked through the menu. Please use the keyboard shortcuts instead:',\n                labels: {\n                    forCopy: 'for copy',\n                    forCut: 'for cut',\n                    forPaste: 'for paste'\n                }\n            },\n            unsupportedSelectionDialog: { errorMessage: 'That action cannot be performed on multiple selection.' },\n            linkDialog: {\n                title: 'Hyperlink',\n                labels: {\n                    text: 'Text',\n                    url: 'Address',\n                    removeLink: 'Remove link'\n                }\n            },\n            insertCommentDialog: {\n                title: 'Insert comment',\n                labels: {\n                    comment: 'Comment',\n                    removeComment: 'Remove comment'\n                }\n            },\n            insertImageDialog: {\n                title: 'Insert image',\n                info: 'Drag an image here, or click to select',\n                typeError: 'Please select a JPEG, PNG or GIF image'\n            }\n        };\n        var registry = {};\n        kendo.spreadsheet.dialogs = {\n            register: function (name, dialogClass) {\n                registry[name] = dialogClass;\n            },\n            registered: function (name) {\n                return !!registry[name];\n            },\n            create: function (name, options) {\n                var dialogClass = registry[name];\n                if (dialogClass) {\n                    return new dialogClass(options);\n                }\n            }\n        };\n        var SpreadsheetDialog = kendo.spreadsheet.SpreadsheetDialog = kendo.Observable.extend({\n            init: function (options) {\n                kendo.Observable.fn.init.call(this, options);\n                this.options = translate($.extend(true, {}, this.options, options));\n                this.bind(this.events, options);\n            },\n            events: [\n                'close',\n                'activate'\n            ],\n            options: { autoFocus: true },\n            dialog: function () {\n                if (!this._dialog) {\n                    var options = {\n                        autoFocus: false,\n                        scrollable: false,\n                        resizable: false,\n                        modal: true,\n                        visible: false,\n                        width: this.options.width || 320,\n                        title: this.options.title,\n                        open: function () {\n                            this.center();\n                        },\n                        close: this._onDialogClose.bind(this),\n                        activate: this._onDialogActivate.bind(this),\n                        deactivate: this._onDialogDeactivate.bind(this)\n                    };\n                    this._dialog = $('<div class=\\'k-spreadsheet-window k-action-window k-popup-edit-form\\' />').addClass(this.options.className || '').append(kendo.template(this.options.template)({\n                        messages: kendo.spreadsheet.messages.dialogs || MESSAGES,\n                        errors: this.options.errors\n                    })).kendoWindow(options).data('kendoWindow');\n                }\n                return this._dialog;\n            },\n            _onDialogClose: function () {\n                this.trigger('close', { action: this._action });\n            },\n            _onDialogActivate: function () {\n                this.trigger('activate');\n            },\n            _onDialogDeactivate: function () {\n                this.trigger('deactivate');\n                this.destroy();\n            },\n            destroy: function () {\n                if (this._dialog) {\n                    this._dialog.destroy();\n                    this._dialog = null;\n                }\n            },\n            open: function () {\n                this.dialog().open();\n                this.dialog().element.find('.k-primary').focus();\n            },\n            apply: function () {\n                this.close();\n            },\n            close: function () {\n                this._action = 'close';\n                this.dialog().close();\n            }\n        });\n        function formattedValue(value, format) {\n            return kendo.spreadsheet.formatting.text(value, format);\n        }\n        var FormatCellsViewModel = kendo.spreadsheet.FormatCellsViewModel = ObservableObject.extend({\n            init: function (options) {\n                ObservableObject.fn.init.call(this, options);\n                this.useCategory(this.category);\n            },\n            useCategory: function (category) {\n                var type = category && category.type || 'number';\n                var formatCurrency = type == 'currency';\n                this.category = category;\n                this.set('showCurrencyFilter', formatCurrency && this.currencies.length > 1);\n                if (!formatCurrency) {\n                    this.set('formats', this.allFormats[type + 'Formats']);\n                } else {\n                    this.currency(this.currencies[0]);\n                }\n                this.useFirstFormat();\n            },\n            useFirstFormat: function () {\n                if (this.formats.length) {\n                    this.set('format', this.formats[0].value);\n                }\n            },\n            currency: function (currency) {\n                if (currency !== undefined) {\n                    this._currency = currency;\n                    var info = currency.value;\n                    var formats = [\n                        {\n                            currency: info,\n                            decimals: true\n                        },\n                        {\n                            currency: info,\n                            decimals: true,\n                            iso: true\n                        },\n                        {\n                            currency: info,\n                            decimals: false\n                        }\n                    ];\n                    formats = formats.map(function (format) {\n                        format = FormatCellsViewModel.convert.currency(format);\n                        return {\n                            value: format,\n                            name: formattedValue(1000, format)\n                        };\n                    });\n                    this.set('formats', formats);\n                    this.useFirstFormat();\n                }\n                return this._currency || this.currencies[0];\n            },\n            categoryFilter: function (category) {\n                if (category !== undefined) {\n                    this.useCategory(category);\n                }\n                return this.category;\n            },\n            preview: function () {\n                var format = this.get('format');\n                var value = this.value || 0;\n                if (format && format.length) {\n                    return formattedValue(value, format);\n                } else {\n                    return value;\n                }\n            }\n        });\n        FormatCellsViewModel.convert = {\n            currency: function (options) {\n                function repeat(token, n) {\n                    return new Array(n + 1).join(token);\n                }\n                var info = options.currency;\n                var format = info.pattern[1];\n                if (options.decimals) {\n                    format = format.replace(/n/g, 'n' + info['.'] + repeat('0', info.decimals));\n                }\n                if (options.iso) {\n                    format = '\"' + info.abbr + '\" ' + format.replace(/\\s*\\$\\s*/g, '');\n                } else {\n                    format = format.replace(/\\$/g, JSON.stringify(info.symbol));\n                }\n                format = format.replace(/n/g, '?');\n                return format;\n            },\n            date: function (format) {\n                if (/T|Z/.test(format)) {\n                    return '';\n                }\n                return format.toLowerCase().replace(/tt/g, 'AM/PM').replace(/'/g, '\"');\n            }\n        };\n        function uniqueBy(field, array) {\n            var result = [];\n            var values = [];\n            for (var i = 0; i < array.length; i++) {\n                if ($.inArray(array[i][field], values) == -1) {\n                    result.push(array[i]);\n                    values.push(array[i][field]);\n                }\n            }\n            return result;\n        }\n        var FormatCellsDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.formatCellsDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    categories: [\n                        {\n                            type: 'number',\n                            name: messages.categories.number\n                        },\n                        {\n                            type: 'currency',\n                            name: messages.categories.currency\n                        },\n                        {\n                            type: 'date',\n                            name: messages.categories.date\n                        }\n                    ]\n                };\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n                this._generateFormats();\n            },\n            options: {\n                className: 'k-spreadsheet-format-cells',\n                template: '<div class=\\'k-edit-form-container\\'>' + '<div class=\\'k-root-tabs\\' data-role=\\'tabstrip\\' ' + 'data-text-field=\\'name\\' ' + 'data-bind=\\'source: categories, value: categoryFilter\\' ' + 'data-animation=\\'false\\' />' + '<div class=\\'k-spreadsheet-preview\\' data-bind=\\'text: preview\\' />' + '<script type=\\'text/x-kendo-template\\' id=\\'format-item-template\\'>' + '\\\\#: data.name \\\\#' + '</script>' + '<select data-role=\\'dropdownlist\\' class=\\'k-format-filter\\' ' + 'data-text-field=\\'description\\' ' + 'data-value-field=\\'value.name\\' ' + 'data-bind=\\'visible: showCurrencyFilter, value: currency, source: currencies\\' />' + '<ul data-role=\\'staticlist\\' tabindex=\\'0\\' ' + 'class=\\'k-list k-reset\\' ' + 'data-template=\\'format-item-template\\' ' + 'data-value-primitive=\\'true\\' ' + 'data-value-field=\\'value\\' ' + 'data-bind=\\'source: formats, value: format\\' />' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>#: messages.apply #</button>' + '<button class=\\'k-button\\' data-bind=\\'click: close\\'>#: messages.cancel #</button>' + '</div>' + '</div>'\n            },\n            _generateFormats: function () {\n                var options = this.options;\n                if (!options.currencies) {\n                    options.currencies = FormatCellsDialog.currenciesFrom(kendo.cultures);\n                }\n                if (!options.numberFormats) {\n                    options.numberFormats = [\n                        {\n                            value: '#.00%',\n                            name: '100.00%'\n                        },\n                        {\n                            value: '#%',\n                            name: '100%'\n                        },\n                        {\n                            value: '#.00',\n                            name: '1024.00'\n                        },\n                        {\n                            value: '#,###.00',\n                            name: '1,024.00'\n                        }\n                    ];\n                }\n                if (!options.dateFormats) {\n                    var calendarPatterns = kendo.cultures.current.calendars.standard.patterns;\n                    options.dateFormats = uniqueBy('value', $.map(calendarPatterns, function (format) {\n                        format = FormatCellsViewModel.convert.date(format);\n                        if (!format) {\n                            return;\n                        }\n                        return {\n                            value: format,\n                            name: formattedValue(34567.7678, format)\n                        };\n                    }));\n                }\n            },\n            open: function (range) {\n                var options = this.options;\n                var value = range.value();\n                var categories = options.categories.slice(0);\n                var element;\n                this.viewModel = new FormatCellsViewModel({\n                    currencies: options.currencies.slice(0),\n                    allFormats: {\n                        numberFormats: options.numberFormats.slice(0),\n                        dateFormats: options.dateFormats.slice(0)\n                    },\n                    categories: categories,\n                    format: range.format(),\n                    category: value instanceof Date ? categories[2] : categories[0],\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this),\n                    value: value\n                });\n                SpreadsheetDialog.fn.open.call(this);\n                element = this.dialog().element;\n                kendo.bind(element, this.viewModel);\n                var currencyFilter = element.find('select.k-format-filter').data('kendoDropDownList');\n                if (options.currencies.length > 10) {\n                    currencyFilter.setOptions({ filter: 'contains' });\n                }\n                element.find(kendo.roleSelector('staticlist')).parent().addClass('k-list-wrapper');\n            },\n            apply: function () {\n                var format = this.viewModel.format;\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: 'format',\n                        value: format\n                    }\n                });\n            }\n        });\n        FormatCellsDialog.currenciesFrom = function (cultures) {\n            return uniqueBy('description', $.map(cultures, function (culture, name) {\n                if (!/-/.test(name)) {\n                    return;\n                }\n                var currency = culture.numberFormat.currency;\n                var description = kendo.format('{0} ({1}, {2})', currency.name, currency.abbr, currency.symbol);\n                return {\n                    description: description,\n                    value: currency\n                };\n            }));\n        };\n        kendo.spreadsheet.dialogs.register('formatCells', FormatCellsDialog);\n        kendo.spreadsheet.dialogs.FormatCellsDialog = FormatCellsDialog;\n        var MessageDialog = SpreadsheetDialog.extend({\n            options: {\n                className: 'k-spreadsheet-message',\n                title: '',\n                messageId: '',\n                text: '',\n                template: '<div class=\\'k-spreadsheet-message-content\\' data-bind=\\'text: text\\' />' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: close\\'>' + '#= messages.okText #' + '</button>' + '</div>'\n            },\n            open: function () {\n                SpreadsheetDialog.fn.open.call(this);\n                var options = this.options;\n                var text = options.text;\n                if (options.messageId) {\n                    text = kendo.getter(options.messageId, true)(kendo.spreadsheet.messages.dialogs);\n                }\n                kendo.bind(this.dialog().element, {\n                    text: text,\n                    close: this.close.bind(this)\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('message', MessageDialog);\n        var ConfirmationDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.confirmationDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    text: messages.text\n                };\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n            },\n            options: {\n                className: 'k-spreadsheet-message',\n                messageId: '',\n                template: '<div class=\\'k-spreadsheet-message-content\\' data-bind=\\'text: text\\' />' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: confirm\\'>' + '#= messages.okText #' + '</button>' + '<button class=\\'k-button\\' data-bind=\\'click: cancel\\'>' + '#= messages.cancel #' + '</button>' + '</div>'\n            },\n            open: function () {\n                SpreadsheetDialog.fn.open.call(this);\n                var options = this.options;\n                var text = options.text;\n                if (options.messageId) {\n                    text = kendo.getter(options.messageId, true)(kendo.spreadsheet.messages.dialogs);\n                }\n                kendo.bind(this.dialog().element, {\n                    text: text,\n                    confirm: this.confirm.bind(this),\n                    cancel: this.close.bind(this)\n                });\n            },\n            isConfirmed: function () {\n                return this._confirmed;\n            },\n            confirm: function () {\n                this._confirmed = true;\n                this.close();\n            }\n        });\n        kendo.spreadsheet.dialogs.register('confirmation', ConfirmationDialog);\n        var ValidationErrorDialog = SpreadsheetDialog.extend({\n            options: {\n                className: 'k-spreadsheet-message',\n                title: '',\n                messageId: '',\n                text: '',\n                template: '<div class=\\'k-spreadsheet-message-content\\' data-bind=\\'text: text\\' />' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: retry\\'>' + '#= messages.retry #' + '</button>' + '<button class=\\'k-button\\' data-bind=\\'click: cancel\\'>' + '#= messages.cancel #' + '</button>' + '</div>'\n            },\n            open: function () {\n                SpreadsheetDialog.fn.open.call(this);\n                var options = this.options;\n                var text = options.text;\n                if (options.messageId) {\n                    text = kendo.getter(options.messageId, true)(kendo.spreadsheet.messages.dialogs);\n                }\n                kendo.bind(this.dialog().element, {\n                    text: text,\n                    retry: this.retry.bind(this),\n                    cancel: this.close.bind(this)\n                });\n            },\n            retry: function () {\n                this._retry = true;\n                this.close();\n            }\n        });\n        kendo.spreadsheet.dialogs.register('validationError', ValidationErrorDialog);\n        var FontFamilyDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.fontFamilyDialog || MESSAGES;\n                SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n                this._list();\n            },\n            options: { template: '<ul class=\\'k-list k-reset\\'></ul>' },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                var fonts = this.options.fonts;\n                var defaultFont = this.options.defaultFont;\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: fonts }),\n                    template: '#: data #',\n                    value: defaultFont,\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: 'fontFamily',\n                        value: e.sender.value()[0]\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('fontFamily', FontFamilyDialog);\n        var FontSizeDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.fontSizeDialog || MESSAGES;\n                SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n                this._list();\n            },\n            options: { template: '<ul class=\\'k-list k-reset\\'></ul>' },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                var sizes = this.options.sizes;\n                var defaultSize = this.options.defaultSize;\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: sizes }),\n                    template: '#: data #',\n                    value: defaultSize,\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: 'fontSize',\n                        value: kendo.parseInt(e.sender.value()[0])\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('fontSize', FontSizeDialog);\n        var BordersDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.bordersDialog || MESSAGES;\n                SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n                this.element = this.dialog().element;\n                this._borderPalette();\n                this.viewModel = kendo.observable({\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this)\n                });\n                kendo.bind(this.element.find('.k-action-buttons'), this.viewModel);\n            },\n            options: {\n                width: 177,\n                template: '<div></div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>#: messages.apply #</button>' + '<button class=\\'k-button\\' data-bind=\\'click: close\\'>#: messages.cancel #</button>' + '</div>'\n            },\n            apply: function () {\n                SpreadsheetDialog.fn.apply.call(this);\n                var state = this.value();\n                this.trigger('action', {\n                    command: 'BorderChangeCommand',\n                    options: {\n                        border: state.type,\n                        style: {\n                            size: 1,\n                            color: state.color\n                        }\n                    }\n                });\n            },\n            _borderPalette: function () {\n                var element = this.dialog().element.find('div:first');\n                this.borderPalette = new kendo.spreadsheet.BorderPalette(element, { change: this.value.bind(this) });\n            },\n            value: function (state) {\n                if (state === undefined) {\n                    return this._state;\n                } else {\n                    this._state = state;\n                }\n            }\n        });\n        kendo.spreadsheet.dialogs.register('borders', BordersDialog);\n        var ColorChooser = SpreadsheetDialog.extend({\n            init: function (options) {\n                SpreadsheetDialog.fn.init.call(this, options);\n                this.element = this.dialog().element;\n                this.property = options.property;\n                this.options.title = options.title;\n                this.viewModel = kendo.observable({\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this)\n                });\n                kendo.bind(this.element.find('.k-action-buttons'), this.viewModel);\n            },\n            options: { template: '<div></div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>#: messages.apply #</button>' + '<button class=\\'k-button\\' data-bind=\\'click: close\\'>#: messages.cancel #</button>' + '</div>' },\n            apply: function () {\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: this.property,\n                        value: this.value()\n                    }\n                });\n            },\n            value: function (e) {\n                if (e === undefined) {\n                    return this._value;\n                } else {\n                    this._value = e.value;\n                }\n            }\n        });\n        var ColorPickerDialog = ColorChooser.extend({\n            init: function (options) {\n                options.width = 177;\n                ColorChooser.fn.init.call(this, options);\n                this._colorPalette();\n            },\n            _colorPalette: function () {\n                var element = this.dialog().element.find('div:first');\n                this.colorPalette = element.kendoColorPalette({\n                    palette: [\n                        '#ffffff',\n                        '#000000',\n                        '#d6ecff',\n                        '#4e5b6f',\n                        '#7fd13b',\n                        '#ea157a',\n                        '#feb80a',\n                        '#00addc',\n                        '#738ac8',\n                        '#1ab39f',\n                        '#f2f2f2',\n                        '#7f7f7f',\n                        '#a7d6ff',\n                        '#d9dde4',\n                        '#e5f5d7',\n                        '#fad0e4',\n                        '#fef0cd',\n                        '#c5f2ff',\n                        '#e2e7f4',\n                        '#c9f7f1',\n                        '#d8d8d8',\n                        '#595959',\n                        '#60b5ff',\n                        '#b3bcca',\n                        '#cbecb0',\n                        '#f6a1c9',\n                        '#fee29c',\n                        '#8be6ff',\n                        '#c7d0e9',\n                        '#94efe3',\n                        '#bfbfbf',\n                        '#3f3f3f',\n                        '#007dea',\n                        '#8d9baf',\n                        '#b2e389',\n                        '#f272af',\n                        '#fed46b',\n                        '#51d9ff',\n                        '#aab8de',\n                        '#5fe7d5',\n                        '#a5a5a5',\n                        '#262626',\n                        '#003e75',\n                        '#3a4453',\n                        '#5ea226',\n                        '#af0f5b',\n                        '#c58c00',\n                        '#0081a5',\n                        '#425ea9',\n                        '#138677',\n                        '#7f7f7f',\n                        '#0c0c0c',\n                        '#00192e',\n                        '#272d37',\n                        '#3f6c19',\n                        '#750a3d',\n                        '#835d00',\n                        '#00566e',\n                        '#2c3f71',\n                        '#0c594f'\n                    ],\n                    change: this.value.bind(this)\n                }).data('kendoColorPalette');\n            }\n        });\n        kendo.spreadsheet.dialogs.register('colorPicker', ColorPickerDialog);\n        var CustomColorDialog = ColorChooser.extend({\n            init: function (options) {\n                options.width = 268;\n                ColorChooser.fn.init.call(this, options);\n                this.dialog().setOptions({ animation: false });\n                this.dialog().one('activate', this._colorPicker.bind(this));\n            },\n            _colorPicker: function () {\n                var element = this.dialog().element.find('div:first');\n                this.colorPicker = element.kendoFlatColorPicker({ change: this.value.bind(this) }).data('kendoFlatColorPicker');\n            }\n        });\n        kendo.spreadsheet.dialogs.register('customColor', CustomColorDialog);\n        var AlignmentDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.alignmentDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    buttons: [\n                        {\n                            property: 'textAlign',\n                            value: 'left',\n                            iconClass: 'align-left',\n                            text: messages.buttons.justtifyLeft\n                        },\n                        {\n                            property: 'textAlign',\n                            value: 'center',\n                            iconClass: 'align-center',\n                            text: messages.buttons.justifyCenter\n                        },\n                        {\n                            property: 'textAlign',\n                            value: 'right',\n                            iconClass: 'align-right',\n                            text: messages.buttons.justifyRight\n                        },\n                        {\n                            property: 'textAlign',\n                            value: 'justify',\n                            iconClass: 'align-justify',\n                            text: messages.buttons.justifyFull\n                        },\n                        {\n                            property: 'verticalAlign',\n                            value: 'top',\n                            iconClass: 'align-top',\n                            text: messages.buttons.alignTop\n                        },\n                        {\n                            property: 'verticalAlign',\n                            value: 'center',\n                            iconClass: 'align-middle',\n                            text: messages.buttons.alignMiddle\n                        },\n                        {\n                            property: 'verticalAlign',\n                            value: 'bottom',\n                            iconClass: 'align-bottom',\n                            text: messages.buttons.alignBottom\n                        }\n                    ]\n                };\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n                this._list();\n            },\n            options: { template: '<ul class=\\'k-list k-reset\\'></ul>' },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                    template: '<a title=\\'#=text#\\' data-property=\\'#=property#\\' data-value=\\'#=value#\\'>' + '<span class=\\'k-icon k-i-#=iconClass#\\'></span>' + '#=text#' + '</a>',\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                var dataItem = e.sender.value()[0];\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: dataItem.property,\n                        value: dataItem.value\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('alignment', AlignmentDialog);\n        var MergeDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.mergeDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    buttons: [\n                        {\n                            value: 'cells',\n                            iconClass: 'cells-merge',\n                            text: messages.buttons.mergeCells\n                        },\n                        {\n                            value: 'horizontally',\n                            iconClass: 'cells-merge-horizontally',\n                            text: messages.buttons.mergeHorizontally\n                        },\n                        {\n                            value: 'vertically',\n                            iconClass: 'cells-merge-vertically',\n                            text: messages.buttons.mergeVertically\n                        },\n                        {\n                            value: 'unmerge',\n                            iconClass: 'table-unmerge',\n                            text: messages.buttons.unmerge\n                        }\n                    ]\n                };\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n                this._list();\n            },\n            options: { template: '<ul class=\\'k-list k-reset\\'></ul>' },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                    template: '<a title=\\'#=text#\\' data-value=\\'#=value#\\'>' + '<span class=\\'k-icon k-icon k-i-#=iconClass#\\'></span>#=text#' + '</a>',\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                var dataItem = e.sender.value()[0];\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'MergeCellCommand',\n                    options: { value: dataItem.value }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('merge', MergeDialog);\n        var FreezeDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.freezeDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    buttons: [\n                        {\n                            value: 'panes',\n                            iconClass: 'pane-freeze',\n                            text: messages.buttons.freezePanes\n                        },\n                        {\n                            value: 'rows',\n                            iconClass: 'row-freeze',\n                            text: messages.buttons.freezeRows\n                        },\n                        {\n                            value: 'columns',\n                            iconClass: 'column-freeze',\n                            text: messages.buttons.freezeColumns\n                        },\n                        {\n                            value: 'unfreeze',\n                            iconClass: 'table-unmerge',\n                            text: messages.buttons.unfreeze\n                        }\n                    ]\n                };\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n                this._list();\n            },\n            options: { template: '<ul class=\\'k-list k-reset\\'></ul>' },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                    template: '<a title=\\'#=text#\\' data-value=\\'#=value#\\'>' + '<span class=\\'k-icon k-icon k-i-#=iconClass#\\'></span>#=text#' + '</a>',\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                var dataItem = e.sender.value()[0];\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'FreezePanesCommand',\n                    options: { value: dataItem.value }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('freeze', FreezeDialog);\n        var ValidationViewModel = kendo.spreadsheet.ValidationCellsViewModel = ObservableObject.extend({\n            init: function (options) {\n                ObservableObject.fn.init.call(this, options);\n                this.bind('change', function (e) {\n                    if (e.field === 'criterion') {\n                        this.reset();\n                        if (this.criterion === 'custom' || this.criterion === 'list') {\n                            this.setHintMessageTemplate();\n                        }\n                    }\n                    if (e.field === 'comparer') {\n                        this.setHintMessageTemplate();\n                    }\n                    if ((e.field == 'hintMessage' || e.field == 'hintTitle') && !this._mute) {\n                        this.shouldBuild = false;\n                    }\n                    if ((e.field == 'from' || e.field == 'to' || e.field == 'hintMessageTemplate' || e.field == 'type') && this.shouldBuild) {\n                        this.buildMessages();\n                    }\n                }.bind(this));\n                this.reset();\n            },\n            buildMessages: function () {\n                this._mute = true;\n                this.set('hintTitle', this.hintTitleTemplate ? kendo.format(this.hintTitleTemplate, this.type) : '');\n                this.set('hintMessage', this.hintMessageTemplate ? kendo.format(this.hintMessageTemplate, this.from, this.to) : '');\n                this._mute = false;\n            },\n            reset: function () {\n                this.setComparers();\n                this.set('comparer', this.comparers[0].type);\n                this.set('from', null);\n                this.set('to', null);\n                this.set('useCustomMessages', false);\n                this.shouldBuild = true;\n                this.hintTitleTemplate = this.defaultHintTitle;\n                this.buildMessages();\n            },\n            setComparers: function () {\n                var all = this.defaultComparers;\n                var comparers = [];\n                if (this.criterion === 'text') {\n                    var text_comparers = [\n                        'equalTo',\n                        'notEqualTo'\n                    ];\n                    for (var idx = 0; idx < all.length; idx++) {\n                        if (text_comparers[0] == all[idx].type) {\n                            comparers.push(all[idx]);\n                            text_comparers.shift();\n                        }\n                    }\n                } else {\n                    comparers = all.slice();\n                }\n                this.set('comparers', comparers);\n            },\n            setHintMessageTemplate: function () {\n                if (this.criterion !== 'custom' && this.criterion !== 'list') {\n                    this.set('hintMessageTemplate', kendo.format(this.defaultHintMessage, this.criterion, this.comparerMessages[this.comparer]));\n                } else {\n                    this.set('hintMessageTemplate', '');\n                    this.set('hintMessage', '');\n                }\n            },\n            isAny: function () {\n                return this.get('criterion') === 'any';\n            },\n            isNumber: function () {\n                return this.get('criterion') === 'number';\n            },\n            showToForNumber: function () {\n                return this.showTo() && this.isNumber();\n            },\n            showToForDate: function () {\n                return this.showTo() && this.isDate();\n            },\n            isText: function () {\n                return this.get('criterion') === 'text';\n            },\n            isDate: function () {\n                return this.get('criterion') === 'date';\n            },\n            isList: function () {\n                return this.get('criterion') === 'list';\n            },\n            isCustom: function () {\n                return this.get('criterion') === 'custom';\n            },\n            showRemove: function () {\n                return this.get('hasValidation');\n            },\n            showTo: function () {\n                return this.get('comparer') == 'between' || this.get('comparer') == 'notBetween';\n            },\n            update: function (validation) {\n                this.set('hasValidation', !!validation);\n                if (validation) {\n                    this.fromValidationObject(validation);\n                }\n            },\n            fromValidationObject: function (validation) {\n                this.set('criterion', validation.dataType);\n                this.set('comparer', validation.comparerType);\n                this.set('from', validation.from);\n                this.set('to', validation.to);\n                this.set('type', validation.type);\n                this.set('ignoreBlank', validation.allowNulls);\n                this.set('showButton', validation.showButton);\n                if (validation.messageTemplate || validation.titleTemplate) {\n                    this.hintMessageTemplate = validation.messageTemplate;\n                    this.hintMessage = validation.messageTemplate;\n                    this.hintTitleTemplate = validation.titleTemplate;\n                    this.hintTitle = validation.titleTemplate;\n                    this.useCustomMessages = true;\n                    this.buildMessages();\n                } else {\n                    this.useCustomMessages = false;\n                }\n            },\n            toValidationObject: function () {\n                if (this.criterion === 'any') {\n                    return null;\n                }\n                var options = {\n                    type: this.type,\n                    dataType: this.criterion,\n                    comparerType: this.comparer,\n                    from: this.from,\n                    to: this.to,\n                    allowNulls: this.ignoreBlank,\n                    showButton: this.showButton\n                };\n                if (this.useCustomMessages) {\n                    options.messageTemplate = this.shouldBuild ? this.hintMessageTemplate : this.hintMessage;\n                    options.titleTemplate = this.hintTitle;\n                }\n                return options;\n            }\n        });\n        var ValidationDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.validationDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    hintMessage: messages.hintMessage,\n                    hintTitle: messages.hintTitle,\n                    criteria: [\n                        {\n                            type: 'any',\n                            name: messages.criteria.any\n                        },\n                        {\n                            type: 'number',\n                            name: messages.criteria.number\n                        },\n                        {\n                            type: 'text',\n                            name: messages.criteria.text\n                        },\n                        {\n                            type: 'date',\n                            name: messages.criteria.date\n                        },\n                        {\n                            type: 'custom',\n                            name: messages.criteria.custom\n                        },\n                        {\n                            type: 'list',\n                            name: messages.criteria.list\n                        }\n                    ],\n                    comparers: [\n                        {\n                            type: 'greaterThan',\n                            name: messages.comparers.greaterThan\n                        },\n                        {\n                            type: 'lessThan',\n                            name: messages.comparers.lessThan\n                        },\n                        {\n                            type: 'between',\n                            name: messages.comparers.between\n                        },\n                        {\n                            type: 'notBetween',\n                            name: messages.comparers.notBetween\n                        },\n                        {\n                            type: 'equalTo',\n                            name: messages.comparers.equalTo\n                        },\n                        {\n                            type: 'notEqualTo',\n                            name: messages.comparers.notEqualTo\n                        },\n                        {\n                            type: 'greaterThanOrEqualTo',\n                            name: messages.comparers.greaterThanOrEqualTo\n                        },\n                        {\n                            type: 'lessThanOrEqualTo',\n                            name: messages.comparers.lessThanOrEqualTo\n                        }\n                    ],\n                    comparerMessages: messages.comparerMessages\n                };\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n            },\n            options: {\n                width: 450,\n                criterion: 'any',\n                type: 'reject',\n                ignoreBlank: true,\n                showButton: true,\n                useCustomMessages: false,\n                errorTemplate: '<div class=\"k-widget k-tooltip k-tooltip-validation\" style=\"margin:0.5em\"><span class=\"k-icon k-i-warning\"> </span>' + '#= message #<div class=\"k-callout k-callout-n\"></div></div>',\n                template: '<div class=\"k-edit-form-container\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.criteria #:</label></div>' + '<div class=\"k-edit-field\">' + '<select data-role=\"dropdownlist\" ' + 'title=\"#: messages.validationDialog.labels.criteria #\"' + 'data-text-field=\"name\" ' + 'data-value-field=\"type\" ' + 'data-bind=\"value: criterion, source: criteria\" />' + '</div>' + '<div data-bind=\"visible: isNumber\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.comparer #:</label></div>' + '<div class=\"k-edit-field\">' + '<select data-role=\"dropdownlist\" ' + 'title=\"#: messages.validationDialog.labels.comparer #\"' + 'data-text-field=\"name\" ' + 'data-value-field=\"type\" ' + 'data-bind=\"value: comparer, source: comparers\" />' + '</div>' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.min #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.min #\" title=\"#: messages.validationDialog.labels.min #\" placeholder=\"e.g. 10\" class=\"k-textbox\" data-bind=\"value: from, enabled: isNumber\" required=\"required\" />' + '</div>' + '<div data-bind=\"visible: showTo\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.max #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.max #\" title=\"#: messages.validationDialog.labels.max #\" placeholder=\"e.g. 100\" class=\"k-textbox\" data-bind=\"value: to, enabled: showToForNumber\" required=\"required\" />' + '</div>' + '</div>' + '</div>' + '<div data-bind=\"visible: isText\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.comparer #:</label></div>' + '<div class=\"k-edit-field\">' + '<select data-role=\"dropdownlist\" ' + 'title=\"#: messages.validationDialog.labels.comparer #\"' + 'data-text-field=\"name\" ' + 'data-value-field=\"type\" ' + 'data-bind=\"value: comparer, source: comparers\" />' + '</div>' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.value #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.value #\" title=\"#: messages.validationDialog.labels.value #\" class=\"k-textbox\" data-bind=\"value: from, enabled: isText\" required=\"required\" />' + '</div>' + '</div>' + '<div data-bind=\"visible: isDate\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.comparer #:</label></div>' + '<div class=\"k-edit-field\">' + '<select data-role=\"dropdownlist\" ' + 'title=\"#: messages.validationDialog.labels.comparer #\"' + 'data-text-field=\"name\" ' + 'data-value-field=\"type\" ' + 'data-bind=\"value: comparer, source: comparers\" />' + '</div>' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.start #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.start #\" title=\"#: messages.validationDialog.labels.start #\" class=\"k-textbox\" data-bind=\"value: from, enabled: isDate\" required=\"required\" />' + '</div>' + '<div data-bind=\"visible: showTo\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.end #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.end #\" title=\"#: messages.validationDialog.labels.end #\" class=\"k-textbox\" data-bind=\"value: to, enabled: showToForDate\" required=\"required\" />' + '</div>' + '</div>' + '</div>' + '<div data-bind=\"visible: isCustom\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.value #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.value #\" title=\"#: messages.validationDialog.labels.value #\" class=\"k-textbox\" data-bind=\"value: from, enabled: isCustom\" required=\"required\" />' + '</div>' + '</div>' + '<div data-bind=\"visible: isList\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.value #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.value #\" title=\"#: messages.validationDialog.labels.value #\" class=\"k-textbox\" data-bind=\"value: from, enabled: isList\" required=\"required\" />' + '</div>' + '</div>' + '<div data-bind=\"visible: isList\">' + '<div class=\"k-edit-field\">' + '<input type=\"checkbox\" name=\"showButton\" id=\"listShowButton\" class=\"k-checkbox\" data-bind=\"checked: showButton\"/>' + '<label for=\"listShowButton\" class=\"k-checkbox-label\">' + ' #: messages.validationDialog.labels.showListButton #' + '</label>' + '</div>' + '</div>' + '<div data-bind=\"visible: isDate\">' + '<div class=\"k-edit-field\">' + '<input type=\"checkbox\" name=\"showButton\" id=\"dateShowButton\" class=\"k-checkbox\" data-bind=\"checked: showButton\"/>' + '<label for=\"dateShowButton\" class=\"k-checkbox-label\">' + ' #: messages.validationDialog.labels.showCalendarButton #' + '</label>' + '</div>' + '</div>' + '<div data-bind=\"invisible: isAny\">' + '<div class=\"k-edit-field\">' + '<input type=\"checkbox\" title=\"#: messages.validationDialog.labels.ignoreBlank #\" name=\"ignoreBlank\" id=\"ignoreBlank\" class=\"k-checkbox\" data-bind=\"checked: ignoreBlank\"/>' + '<label for=\"ignoreBlank\" class=\"k-checkbox-label\">' + ' #: messages.validationDialog.labels.ignoreBlank #' + '</label>' + '</div>' + '</div>' + '<div data-bind=\"invisible: isAny\">' + '<div class=\"k-hr\"></div>' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.onInvalidData #:</label></div>' + '<div class=\"k-edit-field\">' + '<input type=\"radio\" title=\"#: messages.validationDialog.labels.rejectInput #\" id=\"validationTypeReject\" name=\"validationType\" value=\"reject\" data-bind=\"checked: type\" class=\"k-radio\" />' + '<label for=\"validationTypeReject\" class=\"k-radio-label\">' + '#: messages.validationDialog.labels.rejectInput #' + '</label> ' + '<input type=\"radio\" title=\"#: messages.validationDialog.labels.showWarning #\" id=\"validationTypeWarning\"  name=\"validationType\" value=\"warning\" data-bind=\"checked: type\" class=\"k-radio\" />' + '<label for=\"validationTypeWarning\" class=\"k-radio-label\">' + '#: messages.validationDialog.labels.showWarning #' + '</label>' + '</div>' + '</div>' + '<div data-bind=\"invisible: isAny\" class=\"hint-wrapper\">' + '<div class=\"k-edit-field\">' + '<input type=\"checkbox\" title=\"#: messages.validationDialog.labels.showHint #\" name=\"useCustomMessages\" id=\"useCustomMessages\" class=\"k-checkbox\" data-bind=\"checked: useCustomMessages\" />' + '<label class=\"k-checkbox-label\" for=\"useCustomMessages\">' + ' #: messages.validationDialog.labels.showHint #' + '</label>' + '</div>' + '<div data-bind=\"visible: useCustomMessages\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.hintTitle #:</label></div>' + '<div class=\"k-edit-field\">' + '<input class=\"k-textbox\" title=\"#: messages.validationDialog.labels.hintTitle #\" placeholder=\"#: messages.validationDialog.placeholders.typeTitle #\" data-bind=\"value: hintTitle\" />' + '</div>' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.hintMessage #:</label></div>' + '<div class=\"k-edit-field\">' + '<input class=\"k-textbox\" title=\"#: messages.validationDialog.labels.hintMessage #\" placeholder=\"#: messages.validationDialog.placeholders.typeMessage #\" data-bind=\"value: hintMessage\" />' + '</div>' + '</div>' + '</div>' + '<div class=\"k-action-buttons\">' + '<button class=\"k-button\" data-bind=\"visible: showRemove, click: remove\">#: messages.remove #</button>' + '<button class=\"k-button k-primary\" data-bind=\"click: apply\">#: messages.apply #</button>' + '<button class=\"k-button\" data-bind=\"click: close\">#: messages.cancel #</button>' + '</div>' + '</div>'\n            },\n            open: function (range) {\n                var options = this.options;\n                var element;\n                this.viewModel = new ValidationViewModel({\n                    type: options.type,\n                    defaultHintMessage: options.hintMessage,\n                    defaultHintTitle: options.hintTitle,\n                    defaultComparers: options.comparers.slice(0),\n                    comparerMessages: options.comparerMessages,\n                    criteria: options.criteria.slice(0),\n                    criterion: options.criterion,\n                    ignoreBlank: options.ignoreBlank,\n                    showButton: options.showButton,\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this),\n                    remove: this.remove.bind(this)\n                });\n                this.viewModel.update(range.validation());\n                SpreadsheetDialog.fn.open.call(this);\n                element = this.dialog().element;\n                if (this.validatable) {\n                    this.validatable.destroy();\n                }\n                kendo.bind(element, this.viewModel);\n                this.validatable = new kendo.ui.Validator(element.find('.k-edit-form-container'), {\n                    validateOnBlur: false,\n                    errorTemplate: this.options.errorTemplate || undefined\n                });\n            },\n            apply: function () {\n                if (this.validatable.validate()) {\n                    SpreadsheetDialog.fn.apply.call(this);\n                    this.trigger('action', {\n                        command: 'EditValidationCommand',\n                        options: { value: this.viewModel.toValidationObject() }\n                    });\n                }\n            },\n            remove: function () {\n                this.viewModel.set('criterion', 'any');\n                this.apply();\n            }\n        });\n        kendo.spreadsheet.dialogs.register('validation', ValidationDialog);\n        kendo.spreadsheet.dialogs.ValidationDialog = ValidationDialog;\n        function PDF_PAPER_SIZE(size) {\n            return {\n                value: size,\n                text: TEXT('exportAsDialog.pdf.paper.' + size)\n            };\n        }\n        var ExportAsDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                SpreadsheetDialog.fn.init.call(this, options);\n                options = this.options;\n                this.viewModel = kendo.observable({\n                    title: options.title,\n                    name: options.name,\n                    extension: options.extension,\n                    fileFormats: options.fileFormats,\n                    excel: options.excelExport,\n                    pdf: {\n                        proxyURL: options.pdfExport.proxyURL,\n                        forceProxy: options.pdfExport.forceProxy,\n                        title: options.pdfExport.title,\n                        author: options.pdfExport.author,\n                        subject: options.pdfExport.subject,\n                        keywords: options.pdfExport.keywords,\n                        creator: options.pdfExport.creator,\n                        date: options.pdfExport.date,\n                        fitWidth: options.pdf.fitWidth,\n                        area: options.pdf.area,\n                        areas: options.pdf.areas,\n                        paperSize: options.pdf.paperSize,\n                        paperSizes: options.pdf.paperSizes,\n                        margin: options.pdf.margin,\n                        margins: options.pdf.margins,\n                        landscape: options.pdf.landscape,\n                        guidelines: options.pdf.guidelines,\n                        hCenter: options.pdf.hCenter,\n                        vCenter: options.pdf.vCenter\n                    },\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this)\n                });\n                var dialog = this.dialog();\n                this.viewModel.bind('change', function (e) {\n                    if (e.field === 'extension') {\n                        this.set('showPdfOptions', this.extension === '.pdf' ? true : false);\n                        dialog.center();\n                    }\n                });\n                kendo.bind(dialog.element, this.viewModel);\n            },\n            options: {\n                title: TEXT('exportAsDialog.title', 'Export...'),\n                name: TEXT('exportAsDialog.defaultFileName', 'Workbook'),\n                extension: '.xlsx',\n                fileFormats: [\n                    {\n                        description: TEXT('exportAsDialog.xlsx.description', 'Excel Workbook (.xlsx)'),\n                        extension: '.xlsx'\n                    },\n                    {\n                        description: TEXT('exportAsDialog.pdf.description', 'Portable Document Format (.pdf)'),\n                        extension: '.pdf'\n                    }\n                ],\n                pdf: {\n                    fitWidth: true,\n                    area: 'workbook',\n                    areas: [\n                        {\n                            area: 'workbook',\n                            text: TEXT('exportAsDialog.pdf.area.workbook', 'Entire Workbook')\n                        },\n                        {\n                            area: 'sheet',\n                            text: TEXT('exportAsDialog.pdf.area.sheet', 'Active Sheet')\n                        },\n                        {\n                            area: 'selection',\n                            text: TEXT('exportAsDialog.pdf.area.selection', 'Selection')\n                        }\n                    ],\n                    paperSize: 'a4',\n                    paperSizes: [\n                        'a2',\n                        'a3',\n                        'a4',\n                        'a5',\n                        'b3',\n                        'b4',\n                        'b5',\n                        'folio',\n                        'legal',\n                        'letter',\n                        'tabloid',\n                        'executive'\n                    ].map(PDF_PAPER_SIZE),\n                    margin: {\n                        bottom: '0.75in',\n                        left: '0.7in',\n                        right: '0.7in',\n                        top: '0.75in'\n                    },\n                    margins: [\n                        {\n                            value: {\n                                bottom: '0.75in',\n                                left: '0.7in',\n                                right: '0.7in',\n                                top: '0.75in'\n                            },\n                            text: TEXT('exportAsDialog.pdf.margin.normal', 'Normal')\n                        },\n                        {\n                            value: {\n                                bottom: '0.75in',\n                                left: '0.25in',\n                                right: '0.25in',\n                                top: '0.75in'\n                            },\n                            text: TEXT('exportAsDialog.pdf.margin.narrow', 'Narrow')\n                        },\n                        {\n                            value: {\n                                bottom: '1in',\n                                left: '1in',\n                                right: '1in',\n                                top: '1in'\n                            },\n                            text: TEXT('exportAsDialog.pdf.margin.wide', 'Wide')\n                        }\n                    ],\n                    landscape: true,\n                    guidelines: true,\n                    hCenter: true,\n                    vCenter: true\n                },\n                width: 520,\n                template: '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.fileName #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<input class=\\'k-textbox\\' data-bind=\\'value: name\\' />' + '</div>' + '<div >' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.saveAsType #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<select data-role=\\'dropdownlist\\' class=\\'k-file-format\\' ' + 'data-text-field=\\'description\\' ' + 'data-value-field=\\'extension\\' ' + 'data-bind=\\'value: extension, source: fileFormats\\' />' + '</div>' + '</div>' + '<div class=\\'k-export-config\\' data-bind=\\'visible: showPdfOptions\\'>' + '<hr class=\\'k-hr\\' />' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.exportArea #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<select data-role=\\'dropdownlist\\' class=\\'k-file-format\\' ' + 'data-text-field=\\'text\\' ' + 'data-value-field=\\'area\\' ' + 'data-bind=\\'value: pdf.area, source: pdf.areas\\' />' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.paperSize#:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<select data-role=\\'dropdownlist\\' class=\\'k-file-format\\' ' + 'data-text-field=\\'text\\' ' + 'data-value-field=\\'value\\' ' + 'data-bind=\\'value: pdf.paperSize, source: pdf.paperSizes\\' />' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.margins #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<select data-role=\\'dropdownlist\\' class=\\'k-file-format\\' ' + 'data-value-primitive=\\'true\\'' + 'data-text-field=\\'text\\' ' + 'data-value-field=\\'value\\' ' + 'data-bind=\\'value: pdf.margin, source: pdf.margins\\' />' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.orientation #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<div class=\\'k-button-group\\'>' + '<input type=\\'radio\\' id=\\'k-orientation-portrait\\' name=\\'orientation\\' data-type=\\'boolean\\' data-bind=\\'checked: pdf.landscape\\' value=\\'false\\' />' + '<label class=\\'k-button k-button-icon k-group-start k-orientation-button\\' for=\\'k-orientation-portrait\\'><span class=\\'k-icon k-i-page-portrait\\'></span></label>' + '<input type=\\'radio\\' id=\\'k-orientation-landscape\\' name=\\'orientation\\' data-type=\\'boolean\\' data-bind=\\'checked: pdf.landscape\\' value=\\'true\\' />' + '<label class=\\'k-button k-button-icon k-group-end k-orientation-button\\' for=\\'k-orientation-landscape\\'><span class=\\'k-icon k-i-page-landscape\\'></span></label>' + '</div>' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.print #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<input class=\\'k-checkbox\\' id=\\'guidelines\\' type=\\'checkbox\\' data-bind=\\'checked: pdf.guidelines\\'/><label class=\\'k-checkbox-label\\' for=\\'guidelines\\'>#: messages.exportAsDialog.labels.guidelines#</label>' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.scale #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<input class=\\'k-checkbox\\' id=\\'fitWidth\\' type=\\'checkbox\\' data-bind=\\'checked: pdf.fitWidth\\'/><label class=\\'k-checkbox-label\\' for=\\'fitWidth\\'>#: messages.exportAsDialog.labels.fit #</label>' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.center #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<input class=\\'k-checkbox\\' id=\\'hCenter\\' type=\\'checkbox\\' data-bind=\\'checked: pdf.hCenter\\'/><label class=\\'k-checkbox-label\\' for=\\'hCenter\\'>#: messages.exportAsDialog.labels.horizontally #</label>' + '<input class=\\'k-checkbox\\' id=\\'vCenter\\' type=\\'checkbox\\' data-bind=\\'checked: pdf.vCenter\\'/><label class=\\'k-checkbox-label\\' for=\\'vCenter\\'>#: messages.exportAsDialog.labels.vertically #</label>' + '</div>' + '<div class=\\'k-page-orientation\\'>' + '<span class=\\'k-icon k-i-page-portrait\\' data-bind=\\'invisible: pdf.landscape\\'></span>' + '<span class=\\'k-icon k-i-page-landscape\\' data-bind=\\'visible: pdf.landscape\\'></span>' + '</div>' + '</div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>#: messages.save #</button>' + '<button class=\\'k-button\\' data-bind=\\'click: close\\'>#: messages.cancel #</button>' + '</div>'\n            },\n            apply: function () {\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'SaveAsCommand',\n                    options: this.viewModel\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('exportAs', ExportAsDialog);\n        function basicErrorDialog(id, msg) {\n            kendo.spreadsheet.dialogs.register(id, MessageDialog.extend({ options: { messageId: msg } }));\n        }\n        basicErrorDialog('modifyMerged', 'modifyMergedDialog.errorMessage');\n        basicErrorDialog('rangeDisabled', 'rangeDisabledDialog.errorMessage');\n        basicErrorDialog('intersectsArray', 'intersectsArrayDialog.errorMessage');\n        basicErrorDialog('overflow', 'overflowDialog.errorMessage');\n        basicErrorDialog('unsupportedSelection', 'unsupportedSelectionDialog.errorMessage');\n        basicErrorDialog('incompatibleRanges', 'incompatibleRangesDialog.errorMessage');\n        basicErrorDialog('noFillDirection', 'noFillDirectionDialog.errorMessage');\n        basicErrorDialog('duplicateSheetName', 'duplicateSheetNameDialog.errorMessage');\n        var ImportErrorDialog = MessageDialog.extend({\n            options: {\n                width: 640,\n                title: 'Errors in import',\n                template: '<div class=\\'k-spreadsheet-message-content k-spreadsheet-import-errors\\'>' + '<div class=\\'k--header-message\\'>We encountered #= errors.length # errors while reading this file.  Please be aware that some formulas might be missing, or contain invalid results.</div>' + '<div class=\\'k--errors\\'>' + '<table>' + '<thead>' + '<tr><th>Context</th><th>Error message</th></tr>' + '</thead>' + '# for (var i = 0; i < errors.length; ++i) { #' + '# var err = errors[i]; #' + '<tr><td>#: err.context #</td><td>#: err.error #</td></tr>' + '# } #' + '</table>' + '</div>' + '</div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: close\\'>' + '#: messages.okText #' + '</button>' + '</div>'\n            }\n        });\n        kendo.spreadsheet.dialogs.register('importError', ImportErrorDialog);\n        var UseKeyboardDialog = MessageDialog.extend({\n            options: {\n                title: TEXT('useKeyboardDialog.title', 'Copying and pasting'),\n                template: '#: messages.useKeyboardDialog.errorMessage #' + '<div>Ctrl+C #: messages.useKeyboardDialog.labels.forCopy #</div>' + '<div>Ctrl+X #: messages.useKeyboardDialog.labels.forCut #</div>' + '<div>Ctrl+V #: messages.useKeyboardDialog.labels.forPaste #</div>' + '<div class=\"k-action-buttons\">' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: close\\'>' + '#= messages.okText #' + '</button>' + '</div>'\n            }\n        });\n        kendo.spreadsheet.dialogs.register('useKeyboard', UseKeyboardDialog);\n        var HyperlinkDialog = SpreadsheetDialog.extend({\n            options: {\n                title: TEXT('linkDialog.title', 'Hyperlink'),\n                template: '<div class=\\'k-edit-label\\'><label>#: messages.linkDialog.labels.url #:</label></div>' + '<div class=\\'k-edit-field\\'><input class=\\'k-textbox\\' data-bind=\\'value: url\\' title=\\'#: messages.linkDialog.labels.url #\\' /></div>' + '<div class=\\'k-action-buttons\\'>' + ('<button class=\\'k-button k-left\\' data-bind=\\'click: remove\\'>#= messages.linkDialog.labels.removeLink #</button>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>#= messages.okText #</button>' + '<button class=\\'k-button\\' data-bind=\\'click: cancel\\'>#= messages.cancel #</button>') + '</div>',\n                autoFocus: false\n            },\n            open: function (range) {\n                var self = this;\n                SpreadsheetDialog.fn.open.apply(self, arguments);\n                var element = self.dialog().element;\n                var model = kendo.observable({\n                    url: range.link(),\n                    apply: function () {\n                        if (!/\\S/.test(model.url)) {\n                            model.url = null;\n                        }\n                        self.trigger('action', {\n                            command: 'HyperlinkCommand',\n                            options: { link: model.url }\n                        });\n                        self.close();\n                    },\n                    remove: function () {\n                        model.url = null;\n                        model.apply();\n                    },\n                    cancel: self.close.bind(self)\n                });\n                kendo.bind(element, model);\n                element.find('input').focus().on('keydown', function (ev) {\n                    if (ev.keyCode == 13) {\n                        model.url = $(this).val();\n                        ev.stopPropagation();\n                        ev.preventDefault();\n                        model.apply();\n                    } else if (ev.keyCode == 27) {\n                        ev.stopPropagation();\n                        ev.preventDefault();\n                        model.cancel();\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('hyperlink', HyperlinkDialog);\n        var InsertCommentDialog = SpreadsheetDialog.extend({\n            options: {\n                className: 'k-spreadsheet-insert-comment',\n                template: '<div class=\\'k-edit-label\\'><label>#: messages.insertCommentDialog.labels.comment #:</label></div><div class=\\'k-edit-field\\'><textarea rows=\\'5\\' class=\\'k-textbox\\' data-bind=\\'value: comment\\'></textarea></div><div class=\\'k-action-buttons\\'>  <button class=\\'k-button k-left\\' data-bind=\\'click: remove\\'>#: messages.insertCommentDialog.labels.removeComment #</button>  <button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>#: messages.okText #</button>  <button class=\\'k-button\\' data-bind=\\'click: cancel\\'>#= messages.cancel #</button></div>',\n                title: TEXT('insertCommentDialog.title', 'Insert comment'),\n                autoFocus: false,\n                width: 450\n            },\n            open: function (range) {\n                var self = this;\n                SpreadsheetDialog.fn.open.apply(self, arguments);\n                var element = self.dialog().element;\n                var model = kendo.observable({\n                    comment: range.comment(),\n                    apply: function () {\n                        if (!/\\S/.test(model.comment)) {\n                            model.comment = null;\n                        }\n                        self.trigger('action', {\n                            command: 'InsertCommentCommand',\n                            options: { value: model.comment }\n                        });\n                        self.close();\n                    },\n                    remove: function () {\n                        model.comment = null;\n                        model.apply();\n                    },\n                    cancel: self.close.bind(self)\n                });\n                kendo.bind(element, model);\n                element.find('textarea').focus();\n            }\n        });\n        kendo.spreadsheet.dialogs.register('insertComment', InsertCommentDialog);\n        var InsertImageDialog = SpreadsheetDialog.extend({\n            options: {\n                template: '<div class=\\'k-spreadsheet-insert-image-dialog\\'>  <label data-bind=\\'style: { background-image: imageUrl },                    css: { k-spreadsheet-has-image: hasImage, k-state-hovered: isHovered },                    events: { dragenter: dragEnter, dragover: stopEvent, dragleave: dragLeave, drop: drop }\\'>    <div data-bind=\\'text: info\\'></div>    <input type=\\'file\\' data-bind=\\'events: { change: change }\\'           accept=\\'image/png, image/jpeg, image/gif\\' />  </label></div><div class=\\'k-action-buttons\\'>  <button class=\\'k-button k-primary\\' data-bind=\\'enabled: okEnabled, click: apply\\'>#: messages.okText #</button>  <button class=\\'k-button\\' data-bind=\\'click: cancel\\'>#= messages.cancel #</button></div>',\n                title: TEXT('insertImageDialog.title', 'Insert image'),\n                width: 'auto'\n            },\n            open: function () {\n                var self = this;\n                SpreadsheetDialog.fn.open.apply(self, arguments);\n                var element = self.dialog().element;\n                var model = kendo.observable({\n                    okEnabled: false,\n                    info: kendo.spreadsheet.messages.dialogs.insertImageDialog.info,\n                    imageUrl: '',\n                    hasImage: false,\n                    isHovered: false,\n                    _url: null,\n                    _image: null,\n                    apply: function () {\n                        window.URL.revokeObjectURL(model._url);\n                        self.trigger('action', {\n                            command: 'InsertImageCommand',\n                            options: {\n                                blob: model._image,\n                                width: model._width,\n                                height: model._height\n                            }\n                        });\n                        self.close();\n                    },\n                    cancel: self.close.bind(self),\n                    stopEvent: function (ev) {\n                        ev.stopPropagation();\n                        ev.preventDefault();\n                    },\n                    drop: function (ev) {\n                        model.stopEvent(ev);\n                        model.selectFile(ev.originalEvent.dataTransfer.files);\n                        model.set('isHovered', false);\n                    },\n                    dragEnter: function (ev) {\n                        model.stopEvent(ev);\n                        model.set('isHovered', true);\n                    },\n                    dragLeave: function (ev) {\n                        model.stopEvent(ev);\n                        model.set('isHovered', false);\n                    },\n                    change: function (ev) {\n                        model.selectFile(ev.target.files);\n                    },\n                    selectFile: function (files) {\n                        var image;\n                        for (var i = 0; i < files.length; ++i) {\n                            if (/^image\\//i.test(files[i].type)) {\n                                image = files[i];\n                                break;\n                            }\n                        }\n                        if (model._url) {\n                            window.URL.revokeObjectURL(model._url);\n                        }\n                        if (image) {\n                            model._image = image;\n                            model._url = window.URL.createObjectURL(image);\n                            var img = new Image();\n                            img.src = model._url;\n                            img.onload = function () {\n                                model._width = img.width;\n                                model._height = img.height;\n                                model.set('info', kendo.spreadsheet.messages.dialogs.insertImageDialog.info);\n                                model.set('okEnabled', true);\n                                model.set('imageUrl', 'url(\\'' + model._url + '\\')');\n                                model.set('hasImage', true);\n                            };\n                        } else {\n                            model._image = null;\n                            model.set('info', kendo.spreadsheet.messages.dialogs.insertImageDialog.typeError);\n                            model.set('okEnabled', false);\n                            model.set('imageUrl', '');\n                            model.set('hasImage', false);\n                        }\n                    }\n                });\n                kendo.bind(element, model);\n            }\n        });\n        kendo.spreadsheet.dialogs.register('insertImage', InsertImageDialog);\n        function Localizable(path, def) {\n            this.path = path.split('.');\n            this.def = def;\n        }\n        Localizable.prototype.trans = function () {\n            var msg = kendo.spreadsheet.messages.dialogs;\n            for (var i = 0; i < this.path.length; ++i) {\n                msg = msg[this.path[i]];\n                if (!msg) {\n                    return this.def;\n                }\n            }\n            return msg;\n        };\n        function TEXT(path, def) {\n            return new Localizable(path, def);\n        }\n        function translate(thing) {\n            if (thing instanceof Localizable) {\n                return thing.trans();\n            } else if (Array.isArray(thing)) {\n                return thing.map(translate);\n            } else if (thing != null && typeof thing == 'object') {\n                return Object.keys(thing).reduce(function (ret, key) {\n                    ret[key] = translate(thing[key]);\n                    return ret;\n                }, {});\n            }\n            return thing;\n        }\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/sheetbinder', [\n        'kendo.core',\n        'kendo.data',\n        'spreadsheet/sheet'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var identity = function (o) {\n            return o;\n        };\n        var SheetDataSourceBinder = kendo.Class.extend({\n            init: function (options) {\n                this.options = kendo.jQuery.extend({}, this.options, options);\n                this.columns = this._normalizeColumns(this.options.columns);\n                this._sheet();\n                this._dataSource();\n                this._header();\n                this._boundRowsCount = 0;\n                this.dataSource.fetch();\n            },\n            _sheet: function () {\n                this.sheet = this.options.sheet;\n                this._sheetChangeHandler = this._sheetChange.bind(this);\n                this._sheetDeleteRowHandler = this._sheetDeleteRow.bind(this);\n                this._sheetInsertRowHandler = this._sheetInsertRow.bind(this);\n                this.sheet.bind('change', this._sheetChangeHandler).bind('afterDeleteRow', this._sheetDeleteRowHandler).bind('afterInsertRow', this._sheetInsertRowHandler);\n            },\n            _sheetInsertRow: function (e) {\n                if (e.index !== undefined) {\n                    this.dataSource.insert(Math.max(e.index - 1, 0), {});\n                }\n            },\n            _sheetDeleteRow: function (e) {\n                if (e.index !== undefined) {\n                    var dataSource = this.dataSource;\n                    var model = dataSource.view()[e.index - 1];\n                    if (model) {\n                        dataSource.remove(model);\n                    }\n                }\n            },\n            _header: function () {\n                this.sheet.batch(function () {\n                    this.columns.forEach(function (column, index) {\n                        this.sheet.range(0, index).value(column.title);\n                    }.bind(this));\n                }.bind(this));\n            },\n            _sheetChange: function (e) {\n                if (e.insertRow || e.deleteRow) {\n                    return;\n                }\n                if (e.recalc && e.ref) {\n                    var dataSource = this.dataSource;\n                    var data = dataSource.view();\n                    var columns = this.columns;\n                    var fields;\n                    if (dataSource.reader.model) {\n                        fields = dataSource.reader.model.fields;\n                    }\n                    if (!columns.length && data.length) {\n                        columns = Object.keys(data[0].toJSON());\n                    }\n                    var getters = columns.map(function (column) {\n                        var field = column.field;\n                        if (field && fields && fields[field] && fields[field].type == 'date') {\n                            return kendo.spreadsheet.numberToDate;\n                        }\n                        return identity;\n                    });\n                    this._skipRebind = true;\n                    var normalizedRef = this.sheet._grid.normalize(e.ref);\n                    var values = this.sheet.range(normalizedRef).values();\n                    normalizedRef.forEach(function (ref) {\n                        ref = ref.toRangeRef();\n                        var record;\n                        var valueIndex = 0;\n                        for (var ri = ref.topLeft.row; ri <= ref.bottomRight.row; ri++) {\n                            record = data[ri - 1];\n                            if (!record) {\n                                record = dataSource.insert(ri - 1, {});\n                                data = dataSource.view();\n                            }\n                            var colValueIndex = 0;\n                            for (var ci = ref.topLeft.col; ci <= ref.bottomRight.col && ci < columns.length; ci++) {\n                                record.set(columns[ci].field, getters[ci](values[valueIndex][colValueIndex++]));\n                            }\n                            valueIndex++;\n                        }\n                    });\n                    this._boundRowsCount = dataSource.view().length;\n                    this._skipRebind = false;\n                }\n            },\n            _normalizeColumns: function (columns) {\n                return columns.map(function (column) {\n                    var field = column.field || column;\n                    return {\n                        field: field,\n                        title: column.title || field\n                    };\n                });\n            },\n            _dataSource: function () {\n                var options = this.options;\n                var dataSource = options.dataSource;\n                dataSource = Array.isArray(dataSource) ? { data: dataSource } : dataSource;\n                if (this.dataSource && this._changeHandler) {\n                    this.dataSource.unbind('change', this._changeHandler);\n                } else {\n                    this._changeHandler = this._change.bind(this);\n                }\n                this.dataSource = kendo.data.DataSource.create(dataSource).bind('change', this._changeHandler);\n            },\n            _change: function () {\n                if (this._skipRebind) {\n                    return;\n                }\n                if (this.sheet.trigger('dataBinding')) {\n                    return;\n                }\n                var data = this.dataSource.view();\n                var columns = this.columns;\n                if (!columns.length && data.length) {\n                    this.columns = columns = this._normalizeColumns(Object.keys(data[0].toJSON()));\n                    this._header();\n                }\n                var getters = columns.map(function (column) {\n                    return kendo.getter(column.field);\n                });\n                this.sheet.batch(function () {\n                    var length = Math.max(data.length, this._boundRowsCount);\n                    for (var idx = 0; idx < length; idx++) {\n                        for (var getterIdx = 0; getterIdx < getters.length; getterIdx++) {\n                            var value = data[idx] ? getters[getterIdx](data[idx]) : null;\n                            this.sheet.range(idx + 1, getterIdx).value(value);\n                        }\n                    }\n                }.bind(this));\n                this._boundRowsCount = data.length;\n                this.sheet.trigger('dataBound');\n            },\n            destroy: function () {\n                this.dataSource.unbind('change', this._changeHandler);\n                this.sheet.unbind('change', this._sheetChangeHandler).unbind('deleteRow', this._sheetDeleteRowHandler).unbind('insertRow', this._sheetInsertRowHandler);\n            },\n            options: { columns: [] }\n        });\n        kendo.spreadsheet.SheetDataSourceBinder = SheetDataSourceBinder;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/filtermenu', [\n        'kendo.core',\n        'kendo.popup',\n        'kendo.treeview',\n        'kendo.numerictextbox',\n        'kendo.datepicker',\n        'kendo.datetimepicker'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Widget = kendo.ui.Widget;\n        var classNames = {\n            details: 'k-details',\n            button: 'k-button',\n            detailsSummary: 'k-details-summary',\n            detailsContent: 'k-details-content',\n            icon: 'k-icon',\n            iconCollapse: 'k-i-arrow-45-down-right',\n            iconExpand: 'k-i-arrow-60-right',\n            iconSearch: 'k-i-zoom',\n            textbox: 'k-textbox',\n            wrapper: 'k-spreadsheet-filter-menu',\n            filterByCondition: 'k-spreadsheet-condition-filter',\n            filterByValue: 'k-spreadsheet-value-filter',\n            valuesTreeViewWrapper: 'k-spreadsheet-value-treeview-wrapper',\n            actionButtons: 'k-action-buttons'\n        };\n        kendo.spreadsheet.messages.filterMenu = {\n            all: 'All',\n            sortAscending: 'Sort range A to Z',\n            sortDescending: 'Sort range Z to A',\n            filterByValue: 'Filter by value',\n            filterByCondition: 'Filter by condition',\n            apply: 'Apply',\n            search: 'Search',\n            addToCurrent: 'Add to current selection',\n            clear: 'Clear',\n            blanks: '(Blanks)',\n            operatorNone: 'None',\n            and: 'AND',\n            or: 'OR',\n            operators: {\n                string: {\n                    contains: 'Text contains',\n                    doesnotcontain: 'Text does not contain',\n                    startswith: 'Text starts with',\n                    endswith: 'Text ends with',\n                    matches: 'Text matches',\n                    doesnotmatch: 'Text does not match'\n                },\n                date: {\n                    eq: 'Date is',\n                    neq: 'Date is not',\n                    lt: 'Date is before',\n                    gt: 'Date is after'\n                },\n                number: {\n                    eq: 'Is equal to',\n                    neq: 'Is not equal to',\n                    gte: 'Is greater than or equal to',\n                    gt: 'Is greater than',\n                    lte: 'Is less than or equal to',\n                    lt: 'Is less than'\n                }\n            }\n        };\n        var Details = Widget.extend({\n            init: function (element, options) {\n                Widget.fn.init.call(this, element, options);\n                this.element.addClass(FilterMenu.classNames.details);\n                this._summary = this.element.find('.' + FilterMenu.classNames.detailsSummary).on('click', this._toggle.bind(this));\n                var iconClass = options.expanded ? FilterMenu.classNames.iconCollapse : FilterMenu.classNames.iconExpand;\n                this._icon = $('<span />', { 'class': FilterMenu.classNames.icon + ' ' + iconClass }).prependTo(this._summary);\n                this._container = kendo.wrap(this._summary.next(), true);\n                if (!options.expanded) {\n                    this._container.hide();\n                }\n            },\n            options: { name: 'Details' },\n            events: ['toggle'],\n            visible: function () {\n                return this.options.expanded;\n            },\n            toggle: function (show) {\n                var animation = kendo.fx(this._container).expand('vertical');\n                animation.stop()[show ? 'reverse' : 'play']();\n                this._icon.toggleClass(FilterMenu.classNames.iconExpand, show).toggleClass(FilterMenu.classNames.iconCollapse, !show);\n                this.options.expanded = !show;\n            },\n            _toggle: function () {\n                var show = this.visible();\n                this.toggle(show);\n                this.trigger('toggle', { show: show });\n            }\n        });\n        kendo.data.binders.spreadsheetFilterValue = kendo.data.Binder.extend({\n            init: function (element, bindings, options) {\n                kendo.data.Binder.fn.init.call(this, element, bindings, options);\n                this._change = $.proxy(this.change, this);\n                $(this.element).on('change', this._change);\n            },\n            refresh: function () {\n                var that = this, value = that.bindings.spreadsheetFilterValue.get();\n                $(that.element).val(value instanceof Date ? '' : value);\n            },\n            change: function () {\n                var value = this.element.value;\n                this.bindings.spreadsheetFilterValue.set(value);\n            }\n        });\n        kendo.data.binders.widget.spreadsheetFilterValue = kendo.data.Binder.extend({\n            init: function (widget, bindings, options) {\n                kendo.data.Binder.fn.init.call(this, widget.element[0], bindings, options);\n                this.widget = widget;\n                this._change = $.proxy(this.change, this);\n                this.widget.first('change', this._change);\n            },\n            refresh: function () {\n                var binding = this.bindings.spreadsheetFilterValue, value = binding.get(), type = $(this.widget.element).data('filterType');\n                if (type === 'date' && value instanceof Date || type === 'number' && !isNaN(value)) {\n                    this.widget.value(value);\n                } else {\n                    this.widget.value(null);\n                }\n            },\n            change: function () {\n                var value = this.widget.value(), binding = this.bindings.spreadsheetFilterValue;\n                binding.set(value);\n            }\n        });\n        var templates = {\n            filterByValue: '<div class=\\'' + classNames.detailsSummary + '\\'>#= messages.filterByValue #</div>' + '<div class=\\'' + classNames.detailsContent + '\\'>' + '<div class=\\'k-textbox k-space-right\\'>' + '<input placeholder=\\'#= messages.search #\\' data-#=ns#bind=\\'events: { input: filterValues }\\' />' + '<span class=\\'k-icon k-i-zoom\\' />' + '</div>' + '<div data-#=ns#bind=\\'visible: hasActiveSearch\\'><input class=\\'k-checkbox\\' type=\\'checkbox\\' data-#=ns#bind=\\'checked: appendToSearch\\' id=\\'_#=guid#\\' /><label class=\\'k-checkbox-label\\' for=\\'_#=guid#\\'>#= messages.addToCurrent #</label></div>' + '<div class=\\'' + classNames.valuesTreeViewWrapper + '\\'>' + '<div data-#=ns#role=\\'treeview\\' ' + 'data-#=ns#checkboxes=\\'{ checkChildren: true }\\' ' + 'data-#=ns#bind=\\'source: valuesDataSource, events: { check: valuesChange, select: valueSelect }\\' ' + '/>' + '</div>' + '</div>',\n            filterByCondition: '<div class=\\'' + classNames.detailsSummary + '\\'>#= messages.filterByCondition #</div>' + '<div class=\\'' + classNames.detailsContent + '\\'>' + '<div>' + '<select ' + 'data-#=ns#role=\"dropdownlist\"' + 'data-#=ns#bind=\"value: operator, source: operators, events: { change: operatorChange } \"' + 'data-value-primitive=\"false\"' + 'data-option-label=\"#=messages.operatorNone#\"' + 'data-height=\"auto\"' + 'data-text-field=\"text\"' + 'data-value-field=\"unique\">' + '</select>' + '</div>' + '<div data-#=ns#bind=\"visible: isString\">' + '<input data-filter-type=\"string\" data-#=ns#bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" class=\"k-textbox\" />' + '</div>' + '<div data-#=ns#bind=\"visible: isNumber\">' + '<input data-filter-type=\"number\" data-#=ns#role=\"numerictextbox\" data-#=ns#bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" />' + '</div>' + '<div data-#=ns#bind=\"visible: isDate\">' + '<input data-filter-type=\"date\" data-#=ns#role=\"datepicker\" data-#=ns#bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" />' + '</div>' + '</div>',\n            menuItem: '<li data-command=\\'#=command#\\' data-dir=\\'#=dir#\\'>' + '<span class=\\'k-icon k-i-#=iconClass#\\'></span>#=text#' + '</li>',\n            actionButtons: '<button data-#=ns#bind=\\'click: apply\\' class=\\'k-button k-primary\\'>#=messages.apply#</button>' + '<button data-#=ns#bind=\\'click: clear\\' class=\\'k-button\\'>#=messages.clear#</button>'\n        };\n        function distinctValues(values) {\n            var hash = {};\n            var result = [];\n            for (var i = 0; i < values.length; i++) {\n                if (!hash[values[i].value]) {\n                    hash[values[i].value] = values[i];\n                    result.push(values[i]);\n                } else if (!hash[values[i].value].checked && values[i].checked) {\n                    hash[values[i].value].checked = true;\n                }\n            }\n            return result;\n        }\n        function filter(dataSource, query) {\n            var hasVisibleChildren = false;\n            var data = dataSource instanceof kendo.data.HierarchicalDataSource && dataSource.data();\n            var valuesFilter = this;\n            var values = this.values;\n            for (var i = 0; i < data.length; i++) {\n                var item = data[i];\n                var text = item.text.toString().toLowerCase();\n                var itemVisible = query === true || query === '' || text.indexOf(query) >= 0;\n                var filterSpread = filter.bind(valuesFilter);\n                var anyVisibleChildren = filterSpread(item.children, query);\n                hasVisibleChildren = hasVisibleChildren || anyVisibleChildren || itemVisible;\n                item.hidden = !itemVisible && !anyVisibleChildren;\n                if (query.length || values && !values.length) {\n                    item.checked = !item.hidden;\n                } else if (values && values.indexOf(item.text) != -1) {\n                    item.checked = true;\n                }\n            }\n            if (data) {\n                dataSource.filter({\n                    field: 'hidden',\n                    operator: 'neq',\n                    value: true\n                });\n            }\n            return hasVisibleChildren;\n        }\n        function uncheckAll(dataSource) {\n            var data = dataSource instanceof kendo.data.HierarchicalDataSource && dataSource.data();\n            for (var i = 0; i < data.length; i++) {\n                var item = data[i];\n                item.checked = false;\n                if (item.hasChildren) {\n                    uncheckAll(item.children);\n                }\n            }\n        }\n        var FilterMenuViewModel = kendo.spreadsheet.FilterMenuViewModel = kendo.data.ObservableObject.extend({\n            valuesChange: function (e) {\n                var dataSource = e ? e.sender.dataSource : this.valuesDataSource;\n                var checked = function (item) {\n                    return item.checked;\n                };\n                var value = function (item) {\n                    return item.dataType === 'date' ? kendo.spreadsheet.dateToNumber(item.value) : item.value;\n                };\n                var unique = function (value, index, array) {\n                    return array.lastIndexOf(value) === index;\n                };\n                var data = dataSource.data();\n                var values = data[0].children.data().toJSON();\n                var blanks = values.filter(function (item) {\n                    return item.dataType === 'blank';\n                });\n                blanks = blanks.length ? blanks[0].checked : false;\n                values = values.filter(checked).map(value);\n                if (this.appendToSearch && this.valueFilter && this.valueFilter.values.length) {\n                    values = values.concat(this.valueFilter.values.toJSON()).sort().filter(unique);\n                }\n                this.set('valueFilter', {\n                    values: values,\n                    blanks: blanks\n                });\n            },\n            valueSelect: function (e) {\n                e.preventDefault();\n                var node = e.sender.dataItem(e.node);\n                node.set('checked', !node.checked);\n            },\n            hasActiveSearch: false,\n            appendToSearch: false,\n            filterValues: function (e) {\n                var query = typeof e == 'string' ? e : $(e.target).val().toLowerCase();\n                var dataSource = this.valuesDataSource;\n                this.set('hasActiveSearch', !!query);\n                var filterSpread = filter.bind(this.valueFilter);\n                uncheckAll(dataSource);\n                filterSpread(dataSource, query);\n            },\n            reset: function () {\n                this.set('customFilter', {\n                    logic: 'and',\n                    criteria: [{\n                            operator: null,\n                            value: null\n                        }]\n                });\n                this.set('valueFilter', { values: [] });\n            },\n            operatorChange: function (e) {\n                var dataItem = e.sender.dataItem();\n                this.set('operatorType', dataItem.type);\n                if (!this.get('customFilter')) {\n                    this.reset();\n                }\n                this.set('customFilter.criteria[0].operator', dataItem.value);\n            },\n            isNone: function () {\n                return this.get('operatorType') === undefined;\n            },\n            isString: function () {\n                return this.get('operatorType') === 'string';\n            },\n            isNumber: function () {\n                return this.get('operatorType') === 'number';\n            },\n            isDate: function () {\n                return this.get('operatorType') === 'date';\n            }\n        });\n        function flattenOperators(operators) {\n            var messages = kendo.spreadsheet.messages.filterMenu.operators;\n            var result = [];\n            for (var type in operators) {\n                if (!operators.hasOwnProperty(type)) {\n                    continue;\n                }\n                for (var operator in operators[type]) {\n                    if (!operators[type].hasOwnProperty(operator)) {\n                        continue;\n                    }\n                    result.push({\n                        text: messages[type][operator],\n                        value: operator,\n                        unique: type + '_' + operator,\n                        type: type\n                    });\n                }\n            }\n            return result;\n        }\n        var FilterMenuController = kendo.spreadsheet.FilterMenuController = {\n            valuesTree: function (range, column) {\n                return [{\n                        text: kendo.spreadsheet.messages.filterMenu.all,\n                        expanded: true,\n                        checked: false,\n                        items: this.values(range.resize({ top: 1 }), column)\n                    }];\n            },\n            values: function (range, column) {\n                var values = [];\n                var messages = kendo.spreadsheet.messages.filterMenu;\n                var columnRange = range.column(column);\n                var sheet = range.sheet();\n                columnRange.forEachCell(function (row, col, cell) {\n                    var checked = true;\n                    if (sheet.isHiddenRow(row)) {\n                        checked = false;\n                    }\n                    var value = cell.value;\n                    var dataType = cell.dataType;\n                    var text = cell.text;\n                    if (value === undefined) {\n                        dataType = 'blank';\n                    } else if (cell.format) {\n                        dataType = kendo.spreadsheet.formatting.type(value, cell.format);\n                    } else {\n                        dataType = typeof value;\n                    }\n                    if (value !== null && cell.format) {\n                        text = kendo.spreadsheet.formatting.text(value, cell.format);\n                    } else {\n                        text = dataType == 'blank' ? messages.blanks : value;\n                    }\n                    if (dataType === 'percent' || dataType === 'currency') {\n                        dataType = 'number';\n                    }\n                    if (dataType === 'date') {\n                        value = kendo.spreadsheet.numberToDate(value);\n                    }\n                    values.push({\n                        dataType: dataType,\n                        value: value,\n                        text: text,\n                        checked: checked\n                    });\n                });\n                values = distinctValues(values);\n                values.sort(function (a, b) {\n                    if (a.dataType === b.dataType) {\n                        return 0;\n                    }\n                    if (a.dataType === 'blank' || b.dataType === 'blank') {\n                        return a.dataType === 'blank' ? -1 : 1;\n                    }\n                    if (a.dataType === 'number' || b.dataType === 'number') {\n                        return a.dataType === 'number' ? -1 : 1;\n                    }\n                    if (a.dataType === 'date' || b.dataType === 'date') {\n                        return a.dataType === 'date' ? -1 : 1;\n                    }\n                    return 0;\n                });\n                return values;\n            },\n            filterType: function (range, column) {\n                var sheet = range.sheet();\n                var filter = this.filterForColumn(column, sheet);\n                var type;\n                filter = filter && filter.filter.toJSON();\n                if (filter && filter.filter == 'custom') {\n                    var value = filter.criteria[0].value;\n                    if (value instanceof Date) {\n                        type = 'date';\n                    } else if (typeof value == 'string') {\n                        type = 'string';\n                    } else if (typeof value == 'number') {\n                        type = 'number';\n                    }\n                }\n                if (!type) {\n                    var topValue = this.values(range.row(1), column)[0];\n                    type = topValue && topValue.dataType;\n                    if (type == 'blank') {\n                        type = null;\n                    }\n                }\n                return type;\n            },\n            filterForColumn: function (column, sheet) {\n                var allFilters = sheet.filter();\n                var filters;\n                if (allFilters) {\n                    filters = allFilters.columns.filter(function (item) {\n                        return item.index === column;\n                    })[0];\n                }\n                return filters;\n            },\n            filter: function (column, sheet) {\n                var columnFilters = this.filterForColumn(column, sheet);\n                if (!columnFilters) {\n                    return;\n                }\n                var options = columnFilters.filter.toJSON();\n                var type = options.filter;\n                delete options.filter;\n                var result = {\n                    type: type,\n                    options: options\n                };\n                var criteria = options.criteria;\n                if (criteria && criteria.length) {\n                    result.operator = criteria[0].operator;\n                }\n                return result;\n            }\n        };\n        var FilterMenu = Widget.extend({\n            init: function (element, options) {\n                Widget.call(this, element, options);\n                this.element.addClass(FilterMenu.classNames.wrapper);\n                this.viewModel = new FilterMenuViewModel({\n                    active: 'value',\n                    operator: null,\n                    operators: flattenOperators(this.options.operators),\n                    clear: this.clear.bind(this),\n                    apply: this.apply.bind(this)\n                });\n                this._filterInit();\n                this._popup();\n                this._sort();\n                this._filterByCondition();\n                this._filterByValue();\n                this._actionButtons();\n            },\n            options: {\n                name: 'FilterMenu',\n                column: 0,\n                range: null,\n                operators: {\n                    string: {\n                        contains: 'Text contains',\n                        doesnotcontain: 'Text does not contain',\n                        startswith: 'Text starts with',\n                        endswith: 'Text ends with',\n                        matches: 'Text matches',\n                        doesnotmatch: 'Text does not match'\n                    },\n                    date: {\n                        eq: 'Date is',\n                        neq: 'Date is not',\n                        lt: 'Date is before',\n                        gt: 'Date is after'\n                    },\n                    number: {\n                        eq: 'Is equal to',\n                        neq: 'Is not equal to',\n                        gte: 'Is greater than or equal to',\n                        gt: 'Is greater than',\n                        lte: 'Is less than or equal to',\n                        lt: 'Is less than'\n                    }\n                }\n            },\n            events: ['action'],\n            destroy: function () {\n                Widget.fn.destroy.call(this);\n                this.menu.destroy();\n                this.valuesTreeView.destroy();\n                this.popup.destroy();\n            },\n            openFor: function (anchor) {\n                this.popup.setOptions({ anchor: anchor });\n                this.popup.open();\n            },\n            close: function () {\n                this.popup.close();\n            },\n            clear: function () {\n                this.action({\n                    command: 'ClearFilterCommand',\n                    options: { column: this.options.column }\n                });\n                this.viewModel.reset();\n                this.close();\n            },\n            apply: function () {\n                this._active();\n                var options = {\n                    operatingRange: this.options.range,\n                    column: this.options.column\n                };\n                var valueFilter;\n                var customFilter;\n                if (this.viewModel.active === 'value') {\n                    this.viewModel.valuesChange({ sender: this.valuesTreeView });\n                    valueFilter = this.viewModel.valueFilter.toJSON();\n                    if (valueFilter.blanks || valueFilter.values && valueFilter.values.length) {\n                        options.valueFilter = valueFilter;\n                    }\n                } else if (this.viewModel.active === 'custom') {\n                    customFilter = this.viewModel.customFilter.toJSON();\n                    if (customFilter.criteria.length && customFilter.criteria[0].value !== null) {\n                        options.customFilter = customFilter;\n                    }\n                }\n                if (options.valueFilter || options.customFilter) {\n                    this.action({\n                        command: 'ApplyFilterCommand',\n                        options: options\n                    });\n                }\n            },\n            action: function (options) {\n                this.trigger('action', $.extend({}, options));\n            },\n            _filterInit: function () {\n                var column = this.options.column;\n                var range = this.options.range;\n                var sheet = range.sheet();\n                var activeFilter = FilterMenuController.filter(column, sheet);\n                if (activeFilter) {\n                    var filterType = FilterMenuController.filterType(range, column);\n                    this.viewModel.set('active', activeFilter.type);\n                    this.viewModel.set(activeFilter.type + 'Filter', activeFilter.options);\n                    if (activeFilter.type == 'custom') {\n                        this.viewModel.set('operator', filterType + '_' + activeFilter.operator);\n                        this.viewModel.set('operatorType', filterType);\n                    }\n                } else {\n                    this.viewModel.reset();\n                }\n            },\n            _popup: function () {\n                this.popup = this.element.kendoPopup({ copyAnchorStyles: false }).data('kendoPopup');\n            },\n            _sort: function () {\n                var template = kendo.template(FilterMenu.templates.menuItem);\n                var messages = kendo.spreadsheet.messages.filterMenu;\n                var items = [\n                    {\n                        command: 'sort',\n                        dir: 'asc',\n                        text: messages.sortAscending,\n                        iconClass: 'sort-asc'\n                    },\n                    {\n                        command: 'sort',\n                        dir: 'desc',\n                        text: messages.sortDescending,\n                        iconClass: 'sort-desc'\n                    }\n                ];\n                var ul = $('<ul />', { 'html': kendo.render(template, items) }).appendTo(this.element);\n                this.menu = ul.kendoMenu({\n                    orientation: 'vertical',\n                    select: function (e) {\n                        var dir = $(e.item).data('dir');\n                        var range = this.options.range.resize({ top: 1 });\n                        var options = {\n                            value: dir,\n                            sheet: false,\n                            operatingRange: range,\n                            column: this.options.column\n                        };\n                        if (range.isSortable()) {\n                            this.action({\n                                command: 'SortCommand',\n                                options: options\n                            });\n                        } else {\n                            this.close();\n                        }\n                    }.bind(this)\n                }).data('kendoMenu');\n            },\n            _appendTemplate: function (template, className, details, expanded) {\n                var compiledTemplate = kendo.template(template);\n                var wrapper = $('<div class=\\'' + className + '\\'/>').html(compiledTemplate({\n                    messages: kendo.spreadsheet.messages.filterMenu,\n                    guid: kendo.guid(),\n                    ns: kendo.ns\n                }));\n                this.element.append(wrapper);\n                if (details) {\n                    details = new Details(wrapper, {\n                        expanded: expanded,\n                        toggle: this._detailToggle.bind(this)\n                    });\n                }\n                kendo.bind(wrapper, this.viewModel);\n                return wrapper;\n            },\n            _detailToggle: function (e) {\n                this.element.find('[data-role=details]').not(e.sender.element).data('kendoDetails').toggle(!e.show);\n            },\n            _filterByCondition: function () {\n                var isExpanded = this.viewModel.active === 'custom';\n                this._appendTemplate(FilterMenu.templates.filterByCondition, FilterMenu.classNames.filterByCondition, true, isExpanded);\n            },\n            _filterByValue: function () {\n                var isExpanded = this.viewModel.active === 'value';\n                var wrapper = this._appendTemplate(FilterMenu.templates.filterByValue, FilterMenu.classNames.filterByValue, true, isExpanded);\n                this.valuesTreeView = wrapper.find('[data-role=treeview]').data('kendoTreeView');\n                var values = FilterMenuController.valuesTree(this.options.range, this.options.column);\n                this.viewModel.set('valuesDataSource', new kendo.data.HierarchicalDataSource({ data: values }));\n            },\n            _actionButtons: function () {\n                this._appendTemplate(FilterMenu.templates.actionButtons, FilterMenu.classNames.actionButtons, false);\n            },\n            _active: function () {\n                var activeContainer = this.element.find('[data-role=details]').filter(function (index, element) {\n                    return $(element).data('kendoDetails').visible();\n                });\n                if (activeContainer.hasClass(FilterMenu.classNames.filterByValue)) {\n                    this.viewModel.set('active', 'value');\n                } else if (activeContainer.hasClass(FilterMenu.classNames.filterByCondition)) {\n                    this.viewModel.set('active', 'custom');\n                }\n            }\n        });\n        kendo.spreadsheet.FilterMenu = FilterMenu;\n        $.extend(true, FilterMenu, {\n            classNames: classNames,\n            templates: templates\n        });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/editor', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var SheetEditor = kendo.Observable.extend({\n            init: function (view) {\n                kendo.Observable.fn.init.call(this);\n                this.view = view;\n                this.formulaBar = view.formulaBar;\n                this._active = false;\n                this.barInput = view.formulaBar.formulaInput;\n                this.cellInput = view.formulaInput;\n                this.barInput.syncWith(this.cellInput);\n                this.cellInput.syncWith(this.barInput);\n                this.barInput.bind('keyup', this._triggerUpdate.bind(this));\n                this.cellInput.bind('keyup', this._triggerUpdate.bind(this));\n                this.barInput.bind('blur', this._blur.bind(this));\n                this.cellInput.bind('blur', this._blur.bind(this));\n            },\n            events: [\n                'activate',\n                'deactivate',\n                'change',\n                'update'\n            ],\n            _blur: function () {\n                this.deactivate();\n            },\n            _triggerUpdate: function () {\n                this.trigger('update', { value: this.value() });\n            },\n            activeEditor: function () {\n                var editor = null;\n                var activeElement = kendo._activeElement();\n                if (this.barElement()[0] === activeElement) {\n                    editor = this.barInput;\n                } else if (this.cellElement()[0] === activeElement) {\n                    editor = this.cellInput;\n                }\n                return editor;\n            },\n            activate: function (options) {\n                this._active = true;\n                this._rect = options.rect;\n                this._range = options.range;\n                this.cellInput.position(options.rect);\n                this.cellInput.resize(options.rect);\n                this.cellInput.tooltip(options.tooltip);\n                this.cellInput.activeCell = this.barInput.activeCell = this._range.topLeft();\n                this.cellInput.activeSheet = this.barInput.activeSheet = this._range._sheet;\n                this.trigger('activate');\n                return this;\n            },\n            deactivate: function (noChange) {\n                var cellInput = this.cellInput;\n                if (!this._active) {\n                    return;\n                }\n                this._active = false;\n                if (!noChange && cellInput.value() != this._value) {\n                    this.trigger('change', {\n                        value: cellInput.value(),\n                        range: this._range\n                    });\n                }\n                this._rect = null;\n                cellInput.hide();\n                this.trigger('deactivate');\n            },\n            enable: function (enable) {\n                this.barInput.enable(enable);\n                this.cellInput.enable(enable);\n            },\n            barElement: function () {\n                return this.barInput.element;\n            },\n            cellElement: function () {\n                return this.cellInput.element;\n            },\n            focus: function (inputType) {\n                inputType = inputType || 'cell';\n                if (inputType === 'cell') {\n                    this.cellInput.element.focus();\n                    this.cellInput.end();\n                } else {\n                    this.barInput.element.focus();\n                }\n            },\n            isActive: function () {\n                return this._active;\n            },\n            isFiltered: function () {\n                return this.barInput.popup.visible() || this.cellInput.popup.visible();\n            },\n            canInsertRef: function (isKeyboardAction) {\n                var editor = this.activeEditor();\n                return editor && editor.canInsertRef(isKeyboardAction);\n            },\n            highlightedRefs: function () {\n                var editor = this.activeEditor();\n                var refs = [];\n                if (editor) {\n                    refs = editor.highlightedRefs();\n                }\n                return refs;\n            },\n            scale: function () {\n                this.cellInput.scale();\n            },\n            toggleTooltip: function (rect) {\n                this.cellInput.toggleTooltip(notEqual(this._rect, rect));\n            },\n            value: function (value, isArrayFormula) {\n                if (value === undefined) {\n                    return this.barInput.value();\n                }\n                if (value === null) {\n                    value = '';\n                }\n                this._value = value;\n                this.barInput.value(value);\n                this.cellInput.value(value);\n                this.barInput.element.toggleClass('k-spreadsheet-array-formula', !!isArrayFormula);\n            },\n            insertNewline: function () {\n                this.activeEditor().insertNewline();\n                this.scale();\n            },\n            select: function () {\n                this.activeEditor().select();\n            }\n        });\n        function notEqual(oldRect, newRect) {\n            return oldRect && (oldRect.top !== newRect.top || oldRect.left !== newRect.left);\n        }\n        kendo.spreadsheet.SheetEditor = SheetEditor;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/autofill', [\n        'spreadsheet/runtime',\n        'spreadsheet/range'\n    ], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var Range = spreadsheet.Range;\n    var runtime = spreadsheet.calc.runtime;\n    var Formula = runtime.Formula;\n    var ERR_INCOMPATIBLE = 'incompatibleRanges';\n    var ERR_NO_DIRECTION = 'noFillDirection';\n    var FillError = Range.FillError = function (msg) {\n        this.code = msg;\n    };\n    Range.prototype._previewFillFrom = function (srcRange, direction) {\n        var destRange = this, sheet = destRange._sheet;\n        if (typeof srcRange == 'string') {\n            srcRange = sheet.range(srcRange);\n        }\n        var src = srcRange._ref.toRangeRef().clone().setSheet(sheet.name());\n        var dest = destRange._ref.toRangeRef().clone().setSheet(sheet.name());\n        if (src.intersects(dest)) {\n            if (src.eq(dest)) {\n                return null;\n            }\n            dest = dest.clone();\n            if (src.topLeft.eq(dest.topLeft)) {\n                if (src.width() == dest.width()) {\n                    dest.topLeft.row += src.height();\n                    direction = 0;\n                } else if (src.height() == dest.height()) {\n                    dest.topLeft.col += src.width();\n                    direction = 1;\n                } else {\n                    throw new FillError(ERR_INCOMPATIBLE);\n                }\n            } else if (src.bottomRight.eq(dest.bottomRight)) {\n                if (src.width() == dest.width()) {\n                    dest.bottomRight.row -= src.height();\n                    direction = 2;\n                } else if (src.height() == dest.height()) {\n                    dest.bottomRight.col -= src.width();\n                    direction = 3;\n                } else {\n                    throw new FillError(ERR_INCOMPATIBLE);\n                }\n            } else {\n                throw new FillError(ERR_INCOMPATIBLE);\n            }\n            return sheet.range(dest)._previewFillFrom(srcRange, direction);\n        }\n        if (direction == null) {\n            if (src.topLeft.col == dest.topLeft.col) {\n                direction = src.topLeft.row < dest.topLeft.row ? 0 : 2;\n            } else if (src.topLeft.row == dest.topLeft.row) {\n                direction = src.topLeft.col < dest.topLeft.col ? 1 : 3;\n            } else {\n                throw new FillError(ERR_NO_DIRECTION);\n            }\n        }\n        var horizontal = direction & 1;\n        var descending = direction & 2;\n        if (horizontal && src.height() != dest.height() || !horizontal && src.width() != dest.width()) {\n            throw new FillError(ERR_INCOMPATIBLE);\n        }\n        var data = srcRange._properties(), n;\n        if (!horizontal) {\n            data = transpose(data);\n            n = dest.height();\n        } else {\n            n = dest.width();\n        }\n        var fill = new Array(data.length);\n        var hint = null;\n        for (var i = 0; i < data.length; ++i) {\n            var s = data[i];\n            var f = findSeries(s);\n            var a = fill[i] = new Array(n);\n            for (var j = 0; j < n; ++j) {\n                var idx = descending ? -j - 1 : s.length + j;\n                var srcIdx = descending ? s.length - j % s.length - 1 : j % s.length;\n                var cell = a[descending ? n - j - 1 : j] = f(idx, srcIdx);\n                if (cell.value != null) {\n                    hint = cell.value;\n                }\n            }\n        }\n        if (!horizontal) {\n            fill = transpose(fill);\n        }\n        return {\n            props: fill,\n            direction: direction,\n            dest: destRange,\n            hint: hint\n        };\n    };\n    Range.prototype.fillFrom = function (srcRange, direction) {\n        var x = this._previewFillFrom(srcRange, direction);\n        x.dest._properties(x.props, true);\n        return x.dest;\n    };\n    function linearRegression(data) {\n        var N = data.length;\n        var mx = (N + 1) / 2, my = data.reduce(function (a, b) {\n                return a + b;\n            }, 0) / N;\n        var s1 = 0, s2 = 0;\n        for (var i = 0; i < N; i++) {\n            var t1 = i + 1 - mx, t2 = data[i] - my;\n            s1 += t1 * t2;\n            s2 += t1 * t1;\n        }\n        if (!s2) {\n            return function (N) {\n                return data[N % data.length];\n            };\n        }\n        var b = s1 / s2, a = my - b * mx;\n        return function (N) {\n            return a + b * (N + 1);\n        };\n    }\n    function findSeries(properties) {\n        function findStep(a) {\n            var diff = a[1] - a[0];\n            for (var i = 2; i < a.length; ++i) {\n                if (a[i] - a[i - 1] != diff) {\n                    return null;\n                }\n            }\n            return diff;\n        }\n        function getData(a) {\n            return a.map(function (v) {\n                return v.number;\n            });\n        }\n        var series = [];\n        var data = properties.map(function (x) {\n            return x.formula || x.value;\n        });\n        forEachSeries(data, function (begin, end, type, a) {\n            var f, values;\n            if (type == 'number') {\n                values = getData(a);\n                f = linearRegression(values);\n            } else if (type == 'string' || type == 'formula' || type == 'boolean') {\n                f = function (N, i) {\n                    return data[i];\n                };\n            } else if (Array.isArray(type)) {\n                if (a.length == 1) {\n                    f = function (N) {\n                        return type[(a[0].number + N) % type.length];\n                    };\n                } else {\n                    var diff = findStep(getData(a));\n                    if (diff == null) {\n                        f = function (N) {\n                            return a[N % a.length].value;\n                        };\n                    } else {\n                        f = function (N) {\n                            var idx = a[0].number + diff * N;\n                            return type[idx % type.length];\n                        };\n                    }\n                }\n            } else if (type != 'null') {\n                values = getData(a);\n                if (values.length == 1) {\n                    values.push(values[0] + 1);\n                }\n                values = linearRegression(values);\n                f = function (N, i) {\n                    return data[i].replace(/^(.*\\D)\\d+/, '$1' + values(N, i));\n                };\n            } else {\n                f = function () {\n                    return null;\n                };\n            }\n            var s = {\n                f: f,\n                begin: begin,\n                end: end,\n                len: end - begin\n            };\n            for (var i = begin; i < end; ++i) {\n                series[i] = s;\n            }\n        });\n        return function (N, i) {\n            var s = series[i];\n            var q = N / data.length | 0;\n            var r = N % data.length;\n            var n = q * s.len + r - s.begin;\n            var value = s.f(n, i);\n            var props = clone(properties[i]);\n            delete props.enable;\n            if (value instanceof Formula) {\n                props.formula = value;\n            } else {\n                props.value = value;\n            }\n            return props;\n        };\n    }\n    function clone(obj) {\n        var copy = {};\n        Object.keys(obj || {}).forEach(function (key) {\n            copy[key] = obj[key];\n        });\n        return copy;\n    }\n    function forEachSeries(data, f) {\n        var prev = null, start = 0, a = [], type;\n        for (var i = 0; i < data.length; ++i) {\n            type = getType(data[i]);\n            a.push(type);\n            if (prev != null && type.type !== prev.type) {\n                f(start, i, prev.type, a.slice(start, i));\n                start = i;\n            }\n            prev = type;\n        }\n        f(start, i, prev.type, a.slice(start, i));\n    }\n    function getType(el) {\n        if (typeof el == 'number') {\n            return {\n                type: 'number',\n                number: el\n            };\n        }\n        if (typeof el == 'string') {\n            var lst = findStringList(el);\n            if (lst) {\n                return lst;\n            }\n            var m = /^(.*\\D)(\\d+)/.exec(el);\n            if (m) {\n                el = el.replace(/^(.*\\D)\\d+/, '$1-######');\n                return {\n                    type: el,\n                    match: m,\n                    number: parseFloat(m[2])\n                };\n            }\n            return { type: 'string' };\n        }\n        if (typeof el == 'boolean') {\n            return { type: 'boolean' };\n        }\n        if (el == null) {\n            return { type: 'null' };\n        }\n        if (el instanceof Formula) {\n            return { type: 'formula' };\n        }\n        window.console.error(el);\n        throw new Error('Cannot fill data');\n    }\n    function stringLists() {\n        var culture = kendo.culture();\n        return [\n            culture.calendars.standard.days.namesAbbr,\n            culture.calendars.standard.days.names,\n            culture.calendars.standard.months.namesAbbr,\n            culture.calendars.standard.months.names\n        ];\n    }\n    function findStringList(str) {\n        var strl = str.toLowerCase();\n        var lists = stringLists();\n        for (var i = 0; i < lists.length; ++i) {\n            var a = lists[i];\n            for (var j = a.length; --j >= 0;) {\n                var el = a[j].toLowerCase();\n                if (el == strl) {\n                    return {\n                        type: a,\n                        number: j,\n                        value: str\n                    };\n                }\n            }\n        }\n    }\n    function transpose(a) {\n        var height = a.length, width = a[0].length;\n        var t = [];\n        for (var i = 0; i < width; ++i) {\n            t[i] = [];\n            for (var j = 0; j < height; ++j) {\n                t[i][j] = a[j][i];\n            }\n        }\n        return t;\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/nameeditor', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var CLASS_NAMES = {\n            input: 'k-spreadsheet-name-editor',\n            list: 'k-spreadsheet-name-list'\n        };\n        var NameEditor = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                kendo.ui.Widget.call(this, element, options);\n                element.addClass(CLASS_NAMES.input);\n                var comboBoxTitle = options.messages.nameBox || 'Name Box';\n                var dataSource = new kendo.data.DataSource({\n                    transport: {\n                        read: function (options) {\n                            var data = [];\n                            this._workbook.forEachName(function (def) {\n                                if (!def.hidden && def.value instanceof kendo.spreadsheet.Ref) {\n                                    data.push({ name: def.name });\n                                }\n                            });\n                            options.success(data);\n                        }.bind(this),\n                        cache: false\n                    }\n                });\n                var comboElement = $('<input />').attr('title', comboBoxTitle).attr('aria-label', comboBoxTitle);\n                this.combo = comboElement.appendTo(element).kendoComboBox({\n                    clearButton: false,\n                    dataTextField: 'name',\n                    dataValueField: 'name',\n                    template: '#:data.name#<a class=\\'k-button-delete\\' href=\\'\\\\#\\'><span class=\\'k-icon k-i-close\\'></span></a>',\n                    dataSource: dataSource,\n                    autoBind: false,\n                    ignoreCase: true,\n                    change: this._on_listChange.bind(this),\n                    noDataTemplate: '<div></div>',\n                    open: function () {\n                        dataSource.read();\n                    }\n                }).getKendoComboBox();\n                this.combo.input.on('keydown', this._on_keyDown.bind(this)).on('focus', this._on_focus.bind(this));\n                this.combo.popup.element.addClass('k-spreadsheet-names-popup').on('mousemove', function (ev) {\n                    ev.stopPropagation();\n                }).on('click', '.k-button-delete', function (ev) {\n                    ev.preventDefault();\n                    ev.stopPropagation();\n                    var item = $(ev.target).closest('.k-item');\n                    item = this.combo.dataItem(item);\n                    this._deleteItem(item.name);\n                }.bind(this));\n            },\n            value: function (val) {\n                if (val === undefined) {\n                    return this.combo.value();\n                } else {\n                    this.combo.value(val);\n                }\n            },\n            _deleteItem: function (name) {\n                this.trigger('delete', { name: name });\n            },\n            _on_keyDown: function (ev) {\n                switch (ev.keyCode) {\n                case 27:\n                    this.combo.value(this._prevValue);\n                    this.trigger('cancel');\n                    break;\n                case 13:\n                    this.trigger('enter');\n                    break;\n                }\n            },\n            _on_focus: function () {\n                this._prevValue = this.combo.value();\n            },\n            _on_listChange: function () {\n                var name = this.combo.value();\n                if (name) {\n                    this.trigger('select', { name: name });\n                }\n            }\n        });\n        kendo.spreadsheet.NameEditor = NameEditor;\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/print', [\n        'kendo.pdf',\n        'spreadsheet/sheet',\n        'spreadsheet/range',\n        'spreadsheet/references',\n        'spreadsheet/numformat',\n        'util/text-metrics'\n    ], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var CellRef = spreadsheet.CellRef;\n    var kdrw = kendo.drawing;\n    var formatting = spreadsheet.formatting;\n    var geo = kendo.geometry;\n    var GUIDELINE_WIDTH = 0.8;\n    function distributeCoords(heights, pageHeight, maxEmpty, headerRows, headerCoords) {\n        var curr = 0;\n        var out = [];\n        var bottom = pageHeight;\n        var header = 0;\n        if (pageHeight && maxEmpty) {\n            maxEmpty *= pageHeight;\n        }\n        heights.forEach(function (h, i) {\n            if (headerRows != null && i < headerRows) {\n                header += h;\n            }\n            if (pageHeight && curr + h > bottom) {\n                if (bottom - curr < maxEmpty) {\n                    curr = pageHeight * Math.ceil(curr / pageHeight) + header;\n                    if (header > 0) {\n                        headerCoords.push(curr - header);\n                    }\n                }\n                bottom += pageHeight * Math.ceil(h / pageHeight);\n            }\n            out.push(curr);\n            curr += h;\n        });\n        out.push(curr);\n        return out;\n    }\n    function doLayout(sheet, range, options) {\n        var grid = sheet._grid;\n        range = grid.normalize(range);\n        var wholeRect = grid.rectangle(range);\n        var drawings = [];\n        sheet._drawings.forEach(function (d) {\n            var box = sheet.drawingBoundingBox(d);\n            if (box.intersects(wholeRect)) {\n                drawings.push({\n                    drawing: d,\n                    box: box.offset(-wholeRect.left, -wholeRect.top)\n                });\n            }\n        });\n        var cells = [];\n        var rowHeights = [];\n        var colWidths = [];\n        var mergedCells = sheet._getMergedCells(range);\n        var maxRow = -1, maxCol = -1;\n        sheet.forEach(range, function (row, col, cell) {\n            var relrow = row - range.topLeft.row;\n            var relcol = col - range.topLeft.col;\n            var rh = sheet.rowHeight(row);\n            var cw = sheet.columnWidth(col);\n            if (!options.forScreen) {\n                cell.drawings = drawings.filter(function (d) {\n                    var tl = d.drawing.topLeftCell;\n                    return tl && tl.row == row && tl.col == col;\n                });\n            }\n            if (!relcol) {\n                rowHeights.push(rh);\n            }\n            if (!relrow) {\n                colWidths.push(cw);\n            }\n            if (sheet.isHiddenColumn(col) || sheet.isHiddenRow(row) || !rh || !cw) {\n                return;\n            }\n            var nonEmpty = options.forScreen || shouldDrawCell(cell);\n            if (!(options.emptyCells || nonEmpty)) {\n                return;\n            }\n            var id = new CellRef(row, col).print();\n            if (mergedCells.secondary[id]) {\n                return;\n            }\n            if (nonEmpty) {\n                maxRow = Math.max(maxRow, relrow);\n                maxCol = Math.max(maxCol, relcol);\n            } else {\n                cell.empty = true;\n            }\n            cell.row = relrow;\n            cell.col = relcol;\n            var m = mergedCells.primary[id];\n            if (m) {\n                delete mergedCells.primary[id];\n                cell.merged = true;\n                cell.rowspan = m.height();\n                cell.colspan = m.width();\n                if (options.forScreen) {\n                    cell.width = sheet._columns.sum(m.topLeft.col, m.bottomRight.col);\n                    cell.height = sheet._rows.sum(m.topLeft.row, m.bottomRight.row);\n                }\n            } else {\n                cell.rowspan = 1;\n                cell.colspan = 1;\n            }\n            cells.push(cell);\n        });\n        rowHeights = rowHeights.slice(0, maxRow + 1);\n        colWidths = colWidths.slice(0, maxCol + 1);\n        var pageWidth = options.pageWidth;\n        var pageHeight = options.pageHeight;\n        var scaleFactor = options.scale || 1;\n        if (options.fitWidth) {\n            var width = colWidths.reduce(sum, 0);\n            if (width > pageWidth) {\n                scaleFactor = pageWidth / width;\n            }\n        }\n        pageWidth = Math.ceil(pageWidth / scaleFactor);\n        pageHeight = Math.ceil(pageHeight / scaleFactor);\n        var hyCoords = [];\n        var yCoords = distributeCoords(rowHeights, pageHeight || 0, options.maxEmpty, options.headerRows, hyCoords);\n        var xCoords = distributeCoords(colWidths, pageWidth || 0, options.maxEmpty);\n        var boxWidth = 0;\n        var boxHeight = 0;\n        var headerCells = [];\n        cells = cells.filter(function (cell) {\n            if (cell.empty && (cell.row > maxRow || cell.col > maxCol)) {\n                return false;\n            }\n            if (options.headerRows && cell.row < options.headerRows) {\n                headerCells.push(cell);\n            }\n            cell.left = xCoords[cell.col];\n            cell.top = yCoords[cell.row];\n            if (cell.merged) {\n                if (!options.forScreen) {\n                    cell.right = orlast(xCoords, cell.col + cell.colspan);\n                    cell.bottom = orlast(yCoords, cell.row + cell.rowspan);\n                    cell.width = cell.right - cell.left;\n                    cell.height = cell.bottom - cell.top;\n                } else {\n                    cell.right = cell.left + cell.width;\n                    cell.bottom = cell.top + cell.height;\n                }\n            } else {\n                cell.width = colWidths[cell.col];\n                cell.height = rowHeights[cell.row];\n                cell.bottom = cell.top + cell.height;\n                cell.right = cell.left + cell.width;\n            }\n            if (!options.forScreen) {\n                cell.drawings.forEach(function (d) {\n                    var box = d.box;\n                    box.left = cell.left + d.drawing.offsetX;\n                    box.top = cell.top + d.drawing.offsetY;\n                    box.right = box.left + box.width;\n                    box.bottom = box.top + box.height;\n                });\n            }\n            boxWidth = Math.max(boxWidth, cell.right);\n            boxHeight = Math.max(boxHeight, cell.bottom);\n            return true;\n        });\n        Object.keys(mergedCells.primary).forEach(function (id) {\n            var ref = mergedCells.primary[id];\n            sheet.forEach(ref.topLeft.toRangeRef(), function (row, col, cell) {\n                var relrow = row - range.topLeft.row;\n                var relcol = col - range.topLeft.col;\n                cell.merged = true;\n                cell.colspan = ref.width();\n                cell.rowspan = ref.height();\n                if (relrow < 0) {\n                    cell.top = -sheet._rows.sum(row, row - relrow - 1);\n                } else {\n                    cell.top = yCoords[relrow];\n                }\n                if (relcol < 0) {\n                    cell.left = -sheet._columns.sum(col, col - relcol - 1);\n                } else {\n                    cell.left = xCoords[relcol];\n                }\n                cell.height = sheet._rows.sum(ref.topLeft.row, ref.bottomRight.row);\n                cell.width = sheet._columns.sum(ref.topLeft.col, ref.bottomRight.col);\n                if (cell.height > 0 && cell.width > 0) {\n                    cell.right = cell.left + cell.width;\n                    cell.bottom = cell.top + cell.height;\n                    cell.row = relrow;\n                    cell.col = relcol;\n                    cells.push(cell);\n                }\n            });\n        });\n        if (options.headerRows) {\n            hyCoords.forEach(function (y) {\n                headerCells.forEach(function (cell) {\n                    cell = clone(cell);\n                    cell.top += y;\n                    cell.bottom = cell.top + cell.height;\n                    cells.push(cell);\n                });\n                yCoords.push(y);\n            });\n            yCoords.sort(orderCoords);\n        }\n        return {\n            width: boxWidth,\n            height: boxHeight,\n            cells: cells.sort(orderCells),\n            scale: scaleFactor,\n            xCoords: xCoords,\n            yCoords: yCoords,\n            drawings: drawings\n        };\n    }\n    function clone(hash, target) {\n        if (!target) {\n            target = {};\n        }\n        if (Object.assign) {\n            return Object.assign(target, hash);\n        }\n        return Object.keys(hash).reduce(function (copy, key) {\n            copy[key] = hash[key];\n            return copy;\n        }, target);\n    }\n    function sameBorder(a, b) {\n        return a.size === b.size && a.color === b.color;\n    }\n    function sum(a, b) {\n        return a + b;\n    }\n    function orlast(a, i) {\n        return i < a.length ? a[i] : a[a.length - 1];\n    }\n    function shouldDrawCell(cell) {\n        return cell.value != null || cell.merged || cell.background != null || cell.borderRight != null || cell.borderBottom != null || cell.validation != null && !cell.validation.value;\n    }\n    function orderCells(a, b) {\n        if (a.top < b.top) {\n            return -1;\n        } else if (a.top == b.top) {\n            if (a.left < b.left) {\n                return -1;\n            } else if (a.left == b.left) {\n                return 0;\n            } else {\n                return 1;\n            }\n        } else {\n            return 1;\n        }\n    }\n    function orderCoords(a, b) {\n        return a < b ? -1 : a > b ? 1 : 0;\n    }\n    function drawLayout(sheet, layout, group, options) {\n        var ncols = Math.ceil(layout.width / options.pageWidth);\n        var nrows = Math.ceil(layout.height / options.pageHeight);\n        var pageWidth = Math.ceil(options.pageWidth / layout.scale);\n        var pageHeight = Math.ceil(options.pageHeight / layout.scale);\n        for (var j = 0; j < nrows; ++j) {\n            for (var i = 0; i < ncols; ++i) {\n                addPage(j, i);\n            }\n        }\n        function addPage(row, col) {\n            var left = col * pageWidth;\n            var right = left + pageWidth;\n            var top = row * pageHeight;\n            var bottom = top + pageHeight;\n            var endbottom = 0, endright = 0;\n            function isInside(box) {\n                if (box.right <= left || box.left >= right || box.bottom <= top || box.top >= bottom) {\n                    return false;\n                }\n                endbottom = Math.max(box.bottom, endbottom);\n                endright = Math.max(box.right, endright);\n                return true;\n            }\n            var cells = layout.cells.filter(isInside);\n            var drawings = layout.drawings.filter(function (d) {\n                return isInside(d.box);\n            });\n            endbottom = Math.min(endbottom, bottom);\n            endright = Math.min(endright, right);\n            if (cells.length || drawings.length) {\n                var page = new kdrw.Group();\n                group.append(page);\n                var content = new kdrw.Group();\n                page.append(content);\n                content.clip(kdrw.Path.fromRect(new geo.Rect([\n                    left - 1,\n                    top - 1\n                ], [\n                    endright + 1,\n                    endbottom + 1\n                ])));\n                var matrix = geo.Matrix.scale(layout.scale, layout.scale).multiplyCopy(geo.Matrix.translate(-left, -top));\n                if (options.hCenter || options.vCenter) {\n                    matrix = matrix.multiplyCopy(geo.Matrix.translate(options.hCenter ? (right - endright) / 2 : 0, options.vCenter ? (bottom - endbottom) / 2 : 0));\n                }\n                content.transform(matrix);\n                if (options.guidelines) {\n                    var prev = null;\n                    layout.xCoords.forEach(function (x) {\n                        x = Math.min(x, endright);\n                        if (x !== prev && x >= left && x <= right) {\n                            prev = x;\n                            content.append(new kdrw.Path().moveTo(x, top).lineTo(x, endbottom).close().stroke(options.guideColor, GUIDELINE_WIDTH));\n                        }\n                    });\n                    var prev = null;\n                    layout.yCoords.forEach(function (y) {\n                        y = Math.min(y, endbottom);\n                        if (y !== prev && y >= top && y <= bottom) {\n                            prev = y;\n                            content.append(new kdrw.Path().moveTo(left, y).lineTo(endright, y).close().stroke(options.guideColor, GUIDELINE_WIDTH));\n                        }\n                    });\n                }\n                var borders = Borders();\n                cells.forEach(function (cell) {\n                    drawCell(cell, content, options);\n                    borders.add(cell, sheet);\n                });\n                var bordersGroup = new kdrw.Group();\n                borders.vert.forEach(function (a) {\n                    a.forEach(function (b) {\n                        if (!b.rendered) {\n                            b.rendered = true;\n                            bordersGroup.append(new kdrw.Path().moveTo(b.x, b.top).lineTo(b.x, b.bottom).close().stroke(b.color, b.size));\n                        }\n                    });\n                });\n                borders.horiz.forEach(function (a) {\n                    a.forEach(function (b) {\n                        if (!b.rendered) {\n                            b.rendered = true;\n                            bordersGroup.append(new kdrw.Path().moveTo(b.left, b.y).lineTo(b.right, b.y).close().stroke(b.color, b.size));\n                        }\n                    });\n                });\n                content.append(bordersGroup);\n                drawings.forEach(function (d) {\n                    var drawing = d.drawing;\n                    var image = drawing.image;\n                    if (image != null) {\n                        var box = d.box;\n                        var url = sheet._workbook.imageUrl(image);\n                        content.append(new kdrw.Image(url, new geo.Rect([\n                            box.left,\n                            box.top\n                        ], [\n                            box.width,\n                            box.height\n                        ])).opacity(drawing.opacity));\n                    }\n                });\n            }\n        }\n    }\n    function drawCell(cell, content, options) {\n        var g = new kdrw.Group();\n        content.append(g);\n        var rect = new geo.Rect([\n            cell.left,\n            cell.top\n        ], [\n            cell.width,\n            cell.height\n        ]);\n        if (cell.background || cell.merged) {\n            var r2d2 = rect;\n            if (options.guidelines) {\n                r2d2 = rect.clone();\n                r2d2.origin.x += GUIDELINE_WIDTH / 2 + 0.1;\n                r2d2.origin.y += GUIDELINE_WIDTH / 2 + 0.1;\n                r2d2.size.width -= GUIDELINE_WIDTH + 0.2;\n                r2d2.size.height -= GUIDELINE_WIDTH + 0.2;\n            }\n            g.append(new kdrw.Rect(r2d2).fill(cell.background || '#fff').stroke(null));\n        }\n        var val = cell.value;\n        if (val != null) {\n            var type = typeof val == 'number' ? 'number' : null;\n            var clip = new kdrw.Group();\n            clip.clip(kdrw.Path.fromRect(rect));\n            g.append(clip);\n            var f, format = cell.format;\n            if (!format && type == 'number' && val != Math.floor(val)) {\n                format = '0.##############';\n            }\n            if (format) {\n                f = formatting.textAndColor(val, format);\n                val = f.text;\n                if (f.type) {\n                    type = f.type;\n                }\n            } else {\n                val += '';\n            }\n            if (!cell.textAlign) {\n                switch (type) {\n                case 'number':\n                case 'date':\n                case 'percent':\n                case 'currency':\n                    cell.textAlign = 'right';\n                    break;\n                case 'boolean':\n                    cell.textAlign = 'center';\n                    break;\n                }\n            }\n            drawText(val, f && f.color || cell.color || '#000', cell, clip);\n        }\n    }\n    function applyIndent(cell, style) {\n        if (cell.indent) {\n            var indent = 1.4 * cell.indent;\n            switch (style.textAlign) {\n            case null:\n            case 'left':\n                style.paddingLeft = indent + 'ch';\n                break;\n            case 'right':\n                style.paddingRight = indent + 'ch';\n                break;\n            case 'center':\n                style.paddingLeft = indent / 2 + 'ch';\n                style.paddingRight = indent / 2 + 'ch';\n                break;\n            }\n        }\n    }\n    var CONT;\n    function drawText(text, color, cell, group) {\n        if (!CONT) {\n            CONT = document.createElement('div');\n            CONT.style.position = 'fixed';\n            CONT.style.left = '0px';\n            CONT.style.top = '0px';\n            CONT.style.visibility = 'hidden';\n            CONT.style.overflow = 'hidden';\n            CONT.style.boxSizing = 'border-box';\n            CONT.style.lineHeight = 'normal';\n            document.body.appendChild(CONT);\n        }\n        if (CONT.firstChild) {\n            CONT.removeChild(CONT.firstChild);\n        }\n        CONT.style.padding = '2px 4px';\n        CONT.style.color = color;\n        CONT.style.font = makeFontDef(cell);\n        CONT.style.width = cell.width + 'px';\n        CONT.style.textAlign = cell.textAlign || 'left';\n        CONT.style.textDecoration = cell.underline ? 'underline' : 'none';\n        applyIndent(cell, CONT.style);\n        if (cell.wrap) {\n            CONT.style.whiteSpace = 'pre-wrap';\n            CONT.style.overflowWrap = CONT.style.wordWrap = 'break-word';\n        } else {\n            CONT.style.whiteSpace = 'pre';\n            CONT.style.overflowWrap = CONT.style.wordWrap = 'normal';\n        }\n        CONT.appendChild(document.createTextNode(text));\n        var vtrans = 0;\n        switch (cell.verticalAlign) {\n        case 'center':\n            vtrans = cell.height - CONT.offsetHeight >> 1;\n            break;\n        case undefined:\n        case null:\n        case 'bottom':\n            vtrans = cell.height - CONT.offsetHeight;\n            break;\n        }\n        if (vtrans < 0) {\n            vtrans = 0;\n        }\n        var text_group = kendo.drawing.drawDOM.drawText(CONT);\n        text_group.transform(geo.Matrix.translate(cell.left, cell.top + vtrans));\n        group.append(text_group);\n    }\n    function makeFontDef(cell) {\n        var font = [];\n        if (cell.italic) {\n            font.push('italic');\n        }\n        if (cell.bold) {\n            font.push('bold');\n        }\n        font.push((cell.fontSize || 12) + 'px');\n        font.push(cell.fontFamily || 'Arial');\n        return font.join(' ');\n    }\n    function draw(sheet, range, options, callback) {\n        if (options == null && callback == null) {\n            callback = range;\n            options = {};\n            range = spreadsheet.SHEETREF;\n        }\n        if (callback == null) {\n            callback = options;\n            if (range instanceof spreadsheet.Range || range instanceof spreadsheet.Ref || typeof range == 'string') {\n                options = {};\n            } else {\n                options = range;\n                range = spreadsheet.SHEETREF;\n            }\n        }\n        options = kendo.jQuery.extend({\n            paperSize: 'A4',\n            landscape: true,\n            margin: '1cm',\n            guidelines: true,\n            guideColor: '#aaa',\n            emptyCells: true,\n            fitWidth: false,\n            center: false,\n            headerRows: null,\n            maxEmpty: 0.2,\n            scale: 1\n        }, options);\n        var group = new kdrw.Group();\n        var paper = kendo.pdf.getPaperOptions(options);\n        group.options.set('pdf', {\n            author: options.author,\n            creator: options.creator,\n            date: options.date,\n            keywords: options.keywords,\n            margin: paper.margin,\n            multiPage: true,\n            paperSize: paper.paperSize,\n            subject: options.subject,\n            title: options.title\n        });\n        var pageWidth = paper.paperSize[0];\n        var pageHeight = paper.paperSize[1];\n        if (paper.margin) {\n            pageWidth -= paper.margin.left + paper.margin.right + 1;\n            pageHeight -= paper.margin.top + paper.margin.bottom + 1;\n        }\n        options.pageWidth = pageWidth;\n        options.pageHeight = pageHeight;\n        var layout = doLayout(sheet, sheet._ref(range), options);\n        drawLayout(sheet, layout, group, options);\n        callback(group);\n    }\n    spreadsheet.Sheet.prototype.draw = function (range, options, callback) {\n        var sheet = this;\n        if (sheet._workbook) {\n            sheet.recalc(sheet._workbook._context, function () {\n                draw(sheet, range, options, callback);\n            });\n        } else {\n            draw(sheet, range, options, callback);\n        }\n    };\n    function Container() {\n    }\n    Container.prototype = {\n        forEach: function (f) {\n            Object.keys(this).forEach(function (key) {\n                f(this[key], key, this);\n            }, this);\n        }\n    };\n    function Borders() {\n        var horiz = new Container();\n        var vert = new Container();\n        function add(cell, sheet) {\n            if (sheet) {\n                var pb = sheet._properties;\n                var grid = sheet._grid;\n                cell.borderLeft = pb.get('vBorders', grid.index(cell.row, cell.col));\n                cell.borderRight = pb.get('vBorders', grid.index(cell.row, cell.col + cell.colspan));\n                cell.borderTop = pb.get('hBorders', grid.index(cell.row, cell.col));\n                cell.borderBottom = pb.get('hBorders', grid.index(cell.row + cell.rowspan, cell.col));\n            }\n            if (cell.borderLeft) {\n                addVert(cell.row, cell.col, cell.borderLeft, cell.left, cell.top, cell.bottom);\n            }\n            if (cell.borderRight) {\n                addVert(cell.row, cell.col + cell.colspan, cell.borderRight, cell.right, cell.top, cell.bottom);\n            }\n            if (cell.borderTop) {\n                addHoriz(cell.row, cell.col, cell.borderTop, cell.top, cell.left, cell.right);\n            }\n            if (cell.borderBottom) {\n                addHoriz(cell.row + cell.rowspan, cell.col, cell.borderBottom, cell.bottom, cell.left, cell.right);\n            }\n        }\n        function addVert(row, col, border, x, top, bottom) {\n            var a = vert[col] || (vert[col] = new Container());\n            var prev = row > 0 && a[row - 1];\n            if (prev && sameBorder(prev, border)) {\n                a[row] = prev;\n                prev.bottom = bottom;\n            } else {\n                a[row] = {\n                    size: border.size,\n                    color: border.color,\n                    x: x,\n                    top: top,\n                    bottom: bottom\n                };\n            }\n        }\n        function addHoriz(row, col, border, y, left, right) {\n            var a = horiz[row] || (horiz[row] = new Container());\n            var prev = col > 0 && a[col - 1];\n            if (prev && sameBorder(prev, border)) {\n                a[col] = prev;\n                prev.right = right;\n            } else {\n                a[col] = {\n                    size: border.size,\n                    color: border.color,\n                    y: y,\n                    left: left,\n                    right: right\n                };\n            }\n        }\n        return {\n            add: add,\n            horiz: horiz,\n            vert: vert\n        };\n    }\n    function drawTabularData(options) {\n        var progress = new $.Deferred();\n        var promise = progress.promise();\n        options = clone(options, {\n            dataSource: null,\n            guidelines: true,\n            guideColor: '#000',\n            columns: null,\n            headerBackground: '#999',\n            headerColor: '#000',\n            oddBackground: null,\n            evenBackground: null,\n            fontFamily: 'Arial',\n            fontSize: 12,\n            paperSize: 'A4',\n            margin: '1cm',\n            landscape: true,\n            fitWidth: false,\n            scale: 1,\n            rowHeight: 20,\n            maxEmpty: 1,\n            useGridFormat: true\n        });\n        kendo.drawing.pdf.defineFont(kendo.drawing.drawDOM.getFontFaces(document));\n        var charWidth = charWidthFunction(options.fontFamily, options.fontSize);\n        function textWidth(value) {\n            if (value != null) {\n                var width = 12;\n                for (var i = value.length; --i >= 0;) {\n                    width += charWidth(value.charAt(i));\n                }\n                return width;\n            }\n            return 0;\n        }\n        var border = options.guidelines ? {\n            size: 1,\n            color: options.guideColor\n        } : null;\n        function mkCell(data) {\n            if (!border) {\n                return data;\n            }\n            return clone(data, {\n                borderLeft: border,\n                borderTop: border,\n                borderRight: border,\n                borderBottom: border\n            });\n        }\n        options.dataSource.fetch(function () {\n            var data = options.dataSource.data();\n            if (!data.length) {\n                return progress.reject('Empty dataset');\n            }\n            var columns = options.columns.map(function (col) {\n                if (typeof col == 'string') {\n                    return {\n                        title: col,\n                        field: col\n                    };\n                } else {\n                    return col;\n                }\n            });\n            var columnTitles = columns.map(function (col) {\n                return col.title || col.field;\n            });\n            var columnWidths = columnTitles.map(textWidth);\n            var rows = data.map(function (row, rowIndex) {\n                return {\n                    cells: columns.map(function (col, colIndex) {\n                        var value = row[col.field];\n                        if (options.useGridFormat) {\n                            if (value != null) {\n                                if (col.format) {\n                                    value = kendo.format(col.format, value);\n                                } else {\n                                    value += '';\n                                }\n                            }\n                            columnWidths[colIndex] = Math.max(textWidth(value), columnWidths[colIndex]);\n                        }\n                        return mkCell({\n                            value: value,\n                            format: options.useGridFormat ? null : col.format,\n                            background: rowIndex % 2 ? options.evenBackground : options.oddBackground\n                        });\n                    })\n                };\n            });\n            rows.unshift({\n                cells: columnTitles.map(function (label) {\n                    return mkCell({\n                        value: label,\n                        background: options.headerBackground,\n                        color: options.headerColor\n                    });\n                })\n            });\n            var sheet = new kendo.spreadsheet.Sheet(rows.length + 1, columns.length + 1, options.rowHeight, 50, 20, 20, {\n                fontFamily: options.fontFamily,\n                fontSize: options.fontSize,\n                verticalAlign: 'center'\n            });\n            sheet.fromJSON({\n                name: 'Sheet1',\n                rows: rows,\n                columns: columnWidths.map(function (w, i) {\n                    return {\n                        index: i,\n                        width: w\n                    };\n                })\n            });\n            sheet.draw({\n                paperSize: options.paperSize,\n                landscape: options.landscape,\n                margin: options.margin,\n                guidelines: false,\n                scale: options.scale,\n                fitWidth: options.fitWidth,\n                maxEmpty: options.maxEmpty,\n                headerRows: 1\n            }, progress.resolve.bind(progress));\n        });\n        return promise;\n    }\n    var CACHE_CHAR_WIDTH = {};\n    var charWidthFunction = function (fontFamily, fontSize) {\n        var id = fontSize + ':' + fontFamily;\n        var func = CACHE_CHAR_WIDTH[id];\n        if (!func) {\n            var span, div = document.createElement('div');\n            div.style.position = 'fixed';\n            div.style.left = '-10000px';\n            div.style.top = '-10000px';\n            div.style.fontFamily = fontFamily;\n            div.style.fontSize = fontSize + 'px';\n            div.style.whiteSpace = 'pre';\n            for (var i = 32; i < 128; ++i) {\n                span = document.createElement('span');\n                span.appendChild(document.createTextNode(String.fromCharCode(i)));\n                div.appendChild(span);\n            }\n            document.body.appendChild(div);\n            var widths = {};\n            for (i = 32, span = div.firstChild; i < 128 && span; ++i, span = span.nextSibling) {\n                widths[i] = span.offsetWidth;\n            }\n            while (span = div.firstChild) {\n                div.removeChild(span);\n            }\n            func = CACHE_CHAR_WIDTH[id] = function (ch) {\n                var code = ch.charCodeAt(0);\n                var width = widths[code];\n                if (width == null) {\n                    span = document.createElement('span');\n                    span.appendChild(document.createTextNode(String.fromCharCode(code)));\n                    div.appendChild(span);\n                    width = widths[code] = span.offsetWidth;\n                    div.removeChild(span);\n                }\n                return width;\n            };\n        }\n        return func;\n    };\n    spreadsheet.draw = {\n        Borders: Borders,\n        doLayout: doLayout,\n        applyIndent: applyIndent\n    };\n    spreadsheet.drawTabularData = drawTabularData;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('kendo.spreadsheet', [\n        'util/undoredostack',\n        'util/text-metrics',\n        'util/parse-xml',\n        'kendo.excel',\n        'kendo.progressbar',\n        'kendo.pdf',\n        'spreadsheet/commands',\n        'spreadsheet/formulabar',\n        'spreadsheet/formulainput',\n        'spreadsheet/eventlistener',\n        'spreadsheet/rangelist',\n        'spreadsheet/propertybag',\n        'spreadsheet/references',\n        'spreadsheet/navigator',\n        'spreadsheet/axismanager',\n        'spreadsheet/clipboard',\n        'spreadsheet/range',\n        'spreadsheet/sheet',\n        'spreadsheet/sheetsbar',\n        'spreadsheet/excel-reader',\n        'spreadsheet/workbook',\n        'spreadsheet/formulacontext',\n        'spreadsheet/controller',\n        'spreadsheet/view',\n        'spreadsheet/customeditors',\n        'spreadsheet/grid',\n        'spreadsheet/axis',\n        'spreadsheet/filter',\n        'spreadsheet/sorter',\n        'spreadsheet/runtime',\n        'spreadsheet/calc',\n        'spreadsheet/numformat',\n        'spreadsheet/runtime.functions',\n        'spreadsheet/runtime.functions.2',\n        'spreadsheet/toolbar',\n        'spreadsheet/dialogs',\n        'spreadsheet/sheetbinder',\n        'spreadsheet/filtermenu',\n        'spreadsheet/editor',\n        'spreadsheet/autofill',\n        'spreadsheet/nameeditor',\n        'spreadsheet/print'\n    ], f);\n}(function () {\n    var __meta__ = {\n        id: 'spreadsheet',\n        name: 'Spreadsheet',\n        category: 'web',\n        description: 'Spreadsheet component',\n        depends: [\n            'core',\n            'binder',\n            'colorpicker',\n            'combobox',\n            'data',\n            'dom',\n            'dropdownlist',\n            'menu',\n            'ooxml',\n            'popup',\n            'sortable',\n            'tabstrip',\n            'toolbar',\n            'treeview',\n            'window',\n            'validator',\n            'excel',\n            'pdf',\n            'drawing'\n        ]\n    };\n    (function (kendo, undefined) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var keys = $.extend({\n            F10: 121,\n            F11: 122,\n            B: 66,\n            I: 73,\n            U: 85,\n            N: 78,\n            H: 72,\n            A: 65,\n            PAGEDOWN: 34,\n            PAGEUP: 33,\n            DELETE: 46,\n            R: 82\n        }, kendo.keys);\n        var Widget = kendo.ui.Widget;\n        var Workbook = kendo.spreadsheet.Workbook;\n        var Controller = kendo.spreadsheet.Controller;\n        var View = kendo.spreadsheet.View;\n        var NS = '.kendoSpreadsheet';\n        var ALL_REASONS = {\n            recalc: true,\n            selection: true,\n            activeCell: true,\n            layout: true,\n            sheetSelection: true,\n            resize: true,\n            editorChange: false,\n            editorClose: false\n        };\n        var classNames = { wrapper: 'k-widget k-spreadsheet' };\n        var Spreadsheet = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                Widget.fn.init.call(this, element, options);\n                this.element.addClass(Spreadsheet.classNames.wrapper);\n                this._view = new View(this.element, {\n                    messages: this.options.messages.view,\n                    toolbar: this.options.toolbar,\n                    sheetsbar: this.options.sheetsbar\n                });\n                this._workbook = new Workbook(this.options, this._view);\n                this._controller = new Controller(this._view, this._workbook);\n                this._autoRefresh = true;\n                this._bindWorkbookEvents();\n                this._view.workbook(this._workbook);\n                this._view.enableClipboard(false);\n                this.refresh();\n                this._view.enableClipboard(true);\n                this._resizeHandler = function () {\n                    this.resize();\n                }.bind(this);\n                $(window).on('resize' + NS, this._resizeHandler);\n                this.element.on('keydown' + NS, this._keyDown.bind(this));\n            },\n            _keyDown: function (e) {\n                var key = e.keyCode;\n                var redoTool = $('.k-spreadsheet-quick-access-toolbar [title=Redo]');\n                if (key === keys.F11 && e.shiftKey) {\n                    this._view.sheetsbar._onAddSelect();\n                    e.preventDefault();\n                    return;\n                } else if (e.altKey && key === keys.PAGEDOWN) {\n                    this._view.sheetsbar.trigger('select', {\n                        name: this._view.sheetsbar._sheets[this._view.sheetsbar._selectedIndex + 1].name(),\n                        isAddButton: false\n                    });\n                } else if (e.altKey && key === keys.PAGEUP) {\n                    this._view.sheetsbar.trigger('select', {\n                        name: this._view.sheetsbar._sheets[this._view.sheetsbar._selectedIndex - 1].name(),\n                        isAddButton: false\n                    });\n                } else if (e.altKey && key === keys.DELETE) {\n                    var closeCallback = function (e) {\n                        var dlg = e.sender;\n                        if (dlg.isConfirmed()) {\n                            this._view.sheetsbar.trigger('remove', {\n                                name: this.activeSheet()._name(),\n                                confirmation: true\n                            });\n                        }\n                    }.bind(this);\n                    this._view.sheetsbar._openDialog('confirmation', { close: closeCallback });\n                    e.preventDefault();\n                    return;\n                } else if (e.altKey && key === keys.R) {\n                    this._view.sheetsbar._createEditor();\n                    e.preventDefault();\n                    return;\n                } else if (key === keys.F10 && this._view.tabstrip || key === keys.TAB && !e.shiftKey && $(document.activeElement).is(redoTool)) {\n                    this._view.tabstrip.toolbars[this._view.tabstrip.element.find('li.k-state-active').text().toLowerCase()].element.find(':not(.k-overflow-anchor):kendoFocusable:first').focus();\n                    this._view.tabstrip.toolbars[this._view.tabstrip.element.find('li.k-state-active').text().toLowerCase()].element.find('.k-toolbar-first-visible').addClass('k-state-focused');\n                    e.preventDefault();\n                    return;\n                } else if (e.ctrlKey && key === keys.B) {\n                    $('[data-tool=bold]')[0].click();\n                } else if (e.ctrlKey && key === keys.I) {\n                    $('[data-tool=italic]')[0].click();\n                } else if (e.ctrlKey && key === keys.U) {\n                    $('[data-tool=underline]')[0].click();\n                } else if (e.altKey && key === keys.H) {\n                    this._view.tabstrip.select(0);\n                    e.preventDefault();\n                    return;\n                } else if (e.altKey && key === keys.N) {\n                    this._view.tabstrip.select(1);\n                    e.preventDefault();\n                    return;\n                } else if (e.altKey && key === keys.A) {\n                    this._view.tabstrip.select(2);\n                    e.preventDefault();\n                    return;\n                }\n            },\n            _resize: function () {\n                this.refresh({ layout: true });\n            },\n            _workbookChanging: function (e) {\n                if (this.trigger('changing', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookChange: function (e) {\n                if (this._autoRefresh) {\n                    this.refresh(e);\n                }\n                if (e.recalc && e.ref) {\n                    var range = e.range || new kendo.spreadsheet.Range(e.ref, this.activeSheet());\n                    this.trigger('change', { range: range });\n                }\n            },\n            _workbookCut: function (e) {\n                this.trigger('cut', e);\n            },\n            _workbookCopy: function (e) {\n                this.trigger('copy', e);\n            },\n            _workbookPaste: function (e) {\n                this.trigger('paste', e);\n            },\n            activeSheet: function (sheet) {\n                return this._workbook.activeSheet(sheet);\n            },\n            moveSheetToIndex: function (sheet, index) {\n                return this._workbook.moveSheetToIndex(sheet, index);\n            },\n            insertSheet: function (options) {\n                return this._workbook.insertSheet(options);\n            },\n            sheets: function () {\n                return this._workbook.sheets();\n            },\n            removeSheet: function (sheet) {\n                return this._workbook.removeSheet(sheet);\n            },\n            sheetByName: function (sheetName) {\n                return this._workbook.sheetByName(sheetName);\n            },\n            sheetIndex: function (sheet) {\n                return this._workbook.sheetIndex(sheet);\n            },\n            sheetByIndex: function (index) {\n                return this._workbook.sheetByIndex(index);\n            },\n            renameSheet: function (sheet, newSheetName) {\n                return this._workbook.renameSheet(sheet, newSheetName);\n            },\n            refresh: function (reason) {\n                if (!reason) {\n                    reason = ALL_REASONS;\n                }\n                if (!reason.editorClose) {\n                    this._view.sheet(this._workbook.activeSheet());\n                    this._controller.sheet(this._workbook.activeSheet());\n                    this._workbook.refresh(reason);\n                }\n                if (!reason.editorChange) {\n                    this._view.refresh(reason);\n                    this._controller.refresh();\n                    this._view.render(reason);\n                    this.trigger('render');\n                }\n                return this;\n            },\n            openDialog: function (name, options) {\n                return this._view.openDialog(name, options);\n            },\n            autoRefresh: function (value) {\n                if (value !== undefined) {\n                    this._autoRefresh = value;\n                    if (value === true) {\n                        this.refresh();\n                    }\n                    return this;\n                }\n                return this._autoRefresh;\n            },\n            toJSON: function () {\n                return this._workbook.toJSON();\n            },\n            fromJSON: function (json) {\n                if (json.sheets) {\n                    this._workbook.destroy();\n                    this._workbook = new Workbook($.extend({}, this.options, json));\n                    this._bindWorkbookEvents();\n                    this._view.workbook(this._workbook);\n                    this._controller.workbook(this._workbook);\n                    this.activeSheet(this.activeSheet());\n                } else {\n                    this.refresh();\n                }\n            },\n            saveJSON: function () {\n                return this._workbook.saveJSON();\n            },\n            fromFile: function (blob, name) {\n                return this._workbook.fromFile(blob, name);\n            },\n            saveAsPDF: function (options) {\n                this._workbook.saveAsPDF($.extend({}, this.options.pdf, options, { workbook: this._workbook }));\n            },\n            saveAsExcel: function (options) {\n                this._workbook.saveAsExcel(options);\n            },\n            draw: function (options, callback) {\n                this._workbook.draw(options, callback);\n            },\n            _workbookExcelExport: function (e) {\n                if (this.trigger('excelExport', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookExcelImport: function (e) {\n                if (this.trigger('excelImport', e)) {\n                    e.preventDefault();\n                } else {\n                    this._initProgress(e.promise);\n                }\n            },\n            _initProgress: function (deferred) {\n                var loading = $('<div class=\\'k-loading-mask\\' ' + 'style=\\'width: 100%; height: 100%; top: 0;\\'>' + '<div class=\\'k-loading-color\\'/>' + '</div>').appendTo(this.element);\n                var pb = $('<div class=\\'k-loading-progress\\'>').appendTo(loading).kendoProgressBar({\n                    type: 'chunk',\n                    chunkCount: 10,\n                    min: 0,\n                    max: 1,\n                    value: 0\n                }).data('kendoProgressBar');\n                deferred.progress(function (e) {\n                    pb.value(e.progress);\n                }).always(function () {\n                    kendo.destroy(loading);\n                    loading.remove();\n                });\n            },\n            _workbookPdfExport: function (e) {\n                if (this.trigger('pdfExport', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookInsertSheet: function (e) {\n                if (this.trigger('insertSheet', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookRemoveSheet: function (e) {\n                if (this.trigger('removeSheet', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookSelectSheet: function (e) {\n                if (this.trigger('selectSheet', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookRenameSheet: function (e) {\n                if (this.trigger('renameSheet', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookInsertRow: function (e) {\n                if (this.trigger('insertRow', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookInsertColumn: function (e) {\n                if (this.trigger('insertColumn', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookDeleteRow: function (e) {\n                if (this.trigger('deleteRow', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookDeleteColumn: function (e) {\n                if (this.trigger('deleteColumn', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookHideRow: function (e) {\n                if (this.trigger('hideRow', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookHideColumn: function (e) {\n                if (this.trigger('hideColumn', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookUnhideRow: function (e) {\n                if (this.trigger('unhideRow', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookUnhideColumn: function (e) {\n                if (this.trigger('unhideColumn', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookSelect: function (e) {\n                this.trigger('select', e);\n            },\n            _workbookChangeFormat: function (e) {\n                this.trigger('changeFormat', e);\n            },\n            _workbookDataBinding: function (e) {\n                if (this.trigger('dataBinding', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookDataBound: function (e) {\n                this.trigger('dataBound', e);\n            },\n            _bindWorkbookEvents: function () {\n                this._workbook.bind('cut', this._workbookCut.bind(this));\n                this._workbook.bind('copy', this._workbookCopy.bind(this));\n                this._workbook.bind('paste', this._workbookPaste.bind(this));\n                this._workbook.bind('changing', this._workbookChanging.bind(this));\n                this._workbook.bind('change', this._workbookChange.bind(this));\n                this._workbook.bind('excelExport', this._workbookExcelExport.bind(this));\n                this._workbook.bind('excelImport', this._workbookExcelImport.bind(this));\n                this._workbook.bind('pdfExport', this._workbookPdfExport.bind(this));\n                this._workbook.bind('insertSheet', this._workbookInsertSheet.bind(this));\n                this._workbook.bind('removeSheet', this._workbookRemoveSheet.bind(this));\n                this._workbook.bind('selectSheet', this._workbookSelectSheet.bind(this));\n                this._workbook.bind('renameSheet', this._workbookRenameSheet.bind(this));\n                this._workbook.bind('insertRow', this._workbookInsertRow.bind(this));\n                this._workbook.bind('insertColumn', this._workbookInsertColumn.bind(this));\n                this._workbook.bind('deleteRow', this._workbookDeleteRow.bind(this));\n                this._workbook.bind('deleteColumn', this._workbookDeleteColumn.bind(this));\n                this._workbook.bind('hideRow', this._workbookHideRow.bind(this));\n                this._workbook.bind('hideColumn', this._workbookHideColumn.bind(this));\n                this._workbook.bind('unhideRow', this._workbookUnhideRow.bind(this));\n                this._workbook.bind('unhideColumn', this._workbookUnhideColumn.bind(this));\n                this._workbook.bind('select', this._workbookSelect.bind(this));\n                this._workbook.bind('changeFormat', this._workbookChangeFormat.bind(this));\n                this._workbook.bind('dataBinding', this._workbookDataBinding.bind(this));\n                this._workbook.bind('dataBound', this._workbookDataBound.bind(this));\n            },\n            destroy: function () {\n                kendo.ui.Widget.fn.destroy.call(this);\n                this._workbook.destroy();\n                this._controller.destroy();\n                this._view.destroy();\n                if (this._resizeHandler) {\n                    $(window).off('resize' + NS, this._resizeHandler);\n                }\n            },\n            options: {\n                name: 'Spreadsheet',\n                toolbar: true,\n                sheetsbar: true,\n                rows: 200,\n                columns: 50,\n                rowHeight: 20,\n                columnWidth: 64,\n                headerHeight: 20,\n                headerWidth: 32,\n                excel: {\n                    proxyURL: '',\n                    fileName: 'Workbook.xlsx'\n                },\n                messages: {},\n                pdf: {\n                    area: 'workbook',\n                    fileName: 'Workbook.pdf',\n                    proxyURL: '',\n                    paperSize: 'a4',\n                    landscape: true,\n                    margin: null,\n                    title: null,\n                    author: null,\n                    subject: null,\n                    keywords: null,\n                    creator: 'Kendo UI PDF Generator v.' + kendo.version,\n                    date: null\n                },\n                defaultCellStyle: {\n                    fontFamily: 'Arial',\n                    fontSize: '12'\n                },\n                useCultureDecimals: false\n            },\n            defineName: function (name, value, hidden) {\n                return this._workbook.defineName(name, value, hidden);\n            },\n            undefineName: function (name) {\n                return this._workbook.undefineName(name);\n            },\n            nameValue: function (name) {\n                return this._workbook.nameValue(name);\n            },\n            forEachName: function (func) {\n                return this._workbook.forEachName(func);\n            },\n            cellContextMenu: function () {\n                return this._view.cellContextMenu;\n            },\n            rowHeaderContextMenu: function () {\n                return this._view.rowHeaderContextMenu;\n            },\n            colHeaderContextMenu: function () {\n                return this._view.colHeaderContextMenu;\n            },\n            addImage: function (image) {\n                return this._workbook.addImage(image);\n            },\n            cleanupImages: function () {\n                return this._workbook.cleanupImages();\n            },\n            events: [\n                'cut',\n                'copy',\n                'paste',\n                'pdfExport',\n                'excelExport',\n                'excelImport',\n                'changing',\n                'change',\n                'render',\n                'removeSheet',\n                'selectSheet',\n                'renameSheet',\n                'insertRow',\n                'insertColumn',\n                'deleteRow',\n                'insertSheet',\n                'deleteColumn',\n                'hideRow',\n                'hideColumn',\n                'unhideRow',\n                'unhideColumn',\n                'select',\n                'changeFormat',\n                'dataBinding',\n                'dataBound'\n            ]\n        });\n        kendo.spreadsheet.ALL_REASONS = ALL_REASONS;\n        kendo.ui.plugin(Spreadsheet);\n        $.extend(true, Spreadsheet, { classNames: classNames });\n    }(window.kendo));\n    return window.kendo;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));"]}